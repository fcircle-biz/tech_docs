<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next.js チートシート</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script src="main.js"></script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Blue（Next.js公式カラー）
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー -->
    <header class="header-rich text-white py-4 shadow-lg no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                        <i class="fas fa-code text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">Next.js チートシート</h1>
                        <p class="text-sm text-white/80">React フルスタックフレームワーク 実践リファレンス</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- ダークモード切り替えボタン -->
                    <button id="dark-mode-toggle" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/20 hover:bg-white/30 transition" title="ダークモード切り替え">
                        <i class="fas fa-moon dark-icon"></i>
                        <i class="fas fa-sun light-icon hidden"></i>
                    </button>
                    <!-- 印刷ボタン -->
                    <button onclick="window.print()" class="hidden md:flex items-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-print"></i>
                        <span>印刷</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- ============================================
             イントロセクション
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-primary-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-rocket text-white text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold text-slate-800 mb-2">Next.jsとは？</h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        Next.jsはReactベースのフルスタックWebアプリケーションフレームワークです。サーバーサイドレンダリング（SSR）、静的サイト生成（SSG）、API Routes、Server Actionsなど、モダンなWeb開発に必要な機能を統合し、高速で最適化されたアプリケーションを簡単に構築できます。
                    </p>
                    <!-- タグ -->
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>App Router
                        </span>
                        <span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>Server Components
                        </span>
                        <span class="px-3 py-1 bg-amber-100 text-amber-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>SSR/SSG/ISR
                        </span>
                        <span class="px-3 py-1 bg-violet-100 text-violet-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>TypeScript
                        </span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             プロジェクトセットアップ & ルーティング基礎
             ============================================ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

            <!-- プロジェクト作成 -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-plus-circle text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">プロジェクト作成</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-bash"># create-next-app でプロジェクト作成
npx create-next-app@latest my-app

# 対話的セットアップ
# ✔ TypeScript? → Yes
# ✔ ESLint? → Yes
# ✔ Tailwind CSS? → Yes
# ✔ src/ directory? → Yes
# ✔ App Router? → Yes
# ✔ Import alias? → @/*

cd my-app
npm run dev  # http://localhost:3000</code></pre>
                    </div>

                    <div class="text-sm text-slate-600 space-y-1">
                        <p><span class="text-primary-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">npm run dev</code> - 開発サーバー起動</p>
                        <p><span class="text-primary-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">npm run build</code> - 本番ビルド</p>
                        <p><span class="text-primary-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">npm start</code> - 本番サーバー起動</p>
                    </div>
                </div>
            </section>

            <!-- ファイルベースルーティング -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-folder-tree text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">App Router ディレクトリ構造</h3>
                </div>

                <div class="space-y-4">
                    <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-3">
                        <p class="text-sm text-emerald-800">
                            <i class="fas fa-lightbulb text-emerald-500 mr-2"></i>
                            <code class="font-mono text-xs">app/</code> フォルダ内の構造がURLに対応
                        </p>
                    </div>

                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-bash">app/
├── page.tsx            # / (ルート)
├── layout.tsx          # 全体レイアウト
├── about/
│   └── page.tsx        # /about
├── blog/
│   ├── page.tsx        # /blog
│   └── [slug]/
│       └── page.tsx    # /blog/:slug (動的)
└── api/
    └── users/
        └── route.ts    # /api/users (API Route)</code></pre>
                    </div>

                    <div class="text-sm text-slate-600 space-y-1">
                        <p><span class="text-emerald-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">page.tsx</code> - ページコンポーネント</p>
                        <p><span class="text-emerald-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">layout.tsx</code> - レイアウト（共通UI）</p>
                        <p><span class="text-emerald-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">[param]</code> - 動的ルート</p>
                    </div>
                </div>
            </section>

        </div>

        <!-- ============================================
             Server Components vs Client Components
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-violet-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-layer-group text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">Server Components vs Client Components</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Server Component -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-server"></i>Server Component（デフォルト）
                    </h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// app/page.tsx
// サーバーでレンダリング（デフォルト）
async function getData() {
  const res = await fetch('https://api.example.com/data')
  return res.json()
}

export default async function Page() {
  const data = await getData()
  return <div>{data.title}</div>
}</code></pre>
                    </div>
                    <div class="mt-3 text-xs text-violet-700 space-y-1">
                        <p>✓ サーバー側で実行</p>
                        <p>✓ データフェッチング可能</p>
                        <p>✓ バンドルサイズ削減</p>
                        <p>✓ async/await 使用可</p>
                    </div>
                </div>

                <!-- Client Component -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h4 class="font-bold text-amber-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-desktop"></i>Client Component
                    </h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// app/components/Counter.tsx
'use client'  // ← クライアントコンポーネント宣言

import { useState } from 'react'

export default function Counter() {
  const [count, setCount] = useState(0)

  return (
    <button onClick={() => setCount(count + 1)}>
      Count: {count}
    </button>
  )
}</code></pre>
                    </div>
                    <div class="mt-3 text-xs text-amber-700 space-y-1">
                        <p>✓ ブラウザで実行</p>
                        <p>✓ イベントハンドラ使用可</p>
                        <p>✓ React Hooks 使用可</p>
                        <p>✓ ブラウザAPI利用可</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             データフェッチング & キャッシュ
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-database text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">データフェッチング & キャッシュ戦略</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <!-- SSG (Static) -->
                <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                    <h4 class="font-bold text-emerald-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-file"></i>静的生成 (SSG)
                    </h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// ビルド時にキャッシュ（デフォルト）
const res = await fetch(
  'https://api.example.com/data',
  { cache: 'force-cache' }
)</code></pre>
                    </div>
                </div>

                <!-- ISR -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h4 class="font-bold text-amber-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-sync"></i>増分再生成 (ISR)
                    </h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// 60秒ごとに再検証
const res = await fetch(
  'https://api.example.com/data',
  { next: { revalidate: 60 } }
)</code></pre>
                    </div>
                </div>

                <!-- SSR (Dynamic) -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-bold text-blue-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-bolt"></i>動的レンダリング (SSR)
                    </h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// リクエスト毎に取得
const res = await fetch(
  'https://api.example.com/data',
  { cache: 'no-store' }
)</code></pre>
                    </div>
                </div>
            </div>

            <div class="mt-4 bg-primary-50 border border-primary-200 rounded-lg p-3">
                <p class="text-sm text-primary-800">
                    <i class="fas fa-lightbulb text-primary-500 mr-2"></i>
                    <strong>On-Demand Revalidation:</strong> <code class="font-mono text-xs">revalidatePath('/blog')</code> または <code class="font-mono text-xs">revalidateTag('posts')</code> で手動再検証可能
                </p>
            </div>
        </section>

        <!-- ============================================
             API Routes & Server Actions
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-exchange-alt text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">API Routes & Server Actions</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- API Route -->
                <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                    <h4 class="font-bold text-orange-800 mb-3">API Route (Route Handler)</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// app/api/users/route.ts
import { NextResponse } from 'next/server'

export async function GET() {
  const users = [{ id: 1, name: 'Alice' }]
  return NextResponse.json(users)
}

export async function POST(request: Request) {
  const body = await request.json()
  // DB処理など
  return NextResponse.json({ success: true })
}</code></pre>
                    </div>
                    <p class="mt-2 text-xs text-orange-700">外部APIとして公開される（/api/users）</p>
                </div>

                <!-- Server Action -->
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                    <h4 class="font-bold text-purple-800 mb-3">Server Action</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">// app/actions/user.ts
'use server'

export async function createUser(formData: FormData) {
  const name = formData.get('name')
  // DB処理など
  revalidatePath('/users')
  return { success: true }
}

// app/components/UserForm.tsx
'use client'
import { createUser } from '@/app/actions/user'

export default function UserForm() {
  return (
    <form action={createUser}>
      <input name="name" />
      <button type="submit">送信</button>
    </form>
  )
}</code></pre>
                    </div>
                    <p class="mt-2 text-xs text-purple-700">フォーム専用。外部公開されない</p>
                </div>
            </div>
        </section>

        <!-- ============================================
             動的ルート & メタデータ
             ============================================ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">

            <!-- 動的ルート -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-teal-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-route text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">動的ルート</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">// app/blog/[slug]/page.tsx
interface PageProps {
  params: { slug: string }
  searchParams: { [key: string]: string }
}

export default function BlogPost({ params }: PageProps) {
  return <h1>Post: {params.slug}</h1>
}

// 静的生成用パス指定
export async function generateStaticParams() {
  const posts = await getPosts()
  return posts.map((post) => ({ slug: post.slug }))
}</code></pre>
                    </div>

                    <div class="text-sm text-slate-600 space-y-1">
                        <p><span class="text-teal-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">[slug]</code> - 単一パラメータ</p>
                        <p><span class="text-teal-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">[...slug]</code> - キャッチオールルート</p>
                        <p><span class="text-teal-600 font-medium">●</span> <code class="text-xs bg-slate-100 px-1 py-0.5 rounded">[[...slug]]</code> - オプショナルキャッチオール</p>
                    </div>
                </div>
            </section>

            <!-- メタデータ -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-rose-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-tags text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">メタデータ & SEO</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">// app/page.tsx
import { Metadata } from 'next'

export const metadata: Metadata = {
  title: 'ページタイトル',
  description: 'ページ説明文',
  openGraph: {
    title: 'OGタイトル',
    description: 'OG説明文',
    images: ['/og-image.png'],
  },
}

// 動的メタデータ
export async function generateMetadata(
  { params }: PageProps
): Promise<Metadata> {
  const post = await getPost(params.slug)
  return {
    title: post.title,
    description: post.excerpt,
  }
}</code></pre>
                    </div>
                </div>
            </section>

        </div>

        <!-- ============================================
             画像 & フォント最適化
             ============================================ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">

            <!-- 画像最適化 -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-image text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">画像最適化</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">import Image from 'next/image'

// 固定サイズ
<Image
  src="/profile.png"
  alt="Profile"
  width={500}
  height={500}
  priority  // LCPの場合
/>

// レスポンシブ（親要素に合わせる）
<div className="relative w-full h-64">
  <Image
    src="/banner.png"
    alt="Banner"
    fill
    className="object-cover"
  />
</div>

// 外部画像
<Image
  src="https://example.com/image.png"
  alt="External"
  width={800}
  height={600}
  // next.config.js で domains 設定必要
/></code></pre>
                    </div>
                </div>
            </section>

            <!-- フォント最適化 -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-font text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">フォント最適化</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">// app/layout.tsx
import { Inter, Noto_Sans_JP } from 'next/font/google'

const inter = Inter({ subsets: ['latin'] })
const notoSansJP = Noto_Sans_JP({
  weight: ['400', '700'],
  subsets: ['latin'],
  variable: '--font-noto-sans-jp',
})

export default function RootLayout({ children }) {
  return (
    <html lang="ja" className={notoSansJP.variable}>
      <body className={inter.className}>
        {children}
      </body>
    </html>
  )
}</code></pre>
                    </div>
                </div>
            </section>

        </div>

        <!-- ============================================
             ミドルウェア & 認証
             ============================================ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mt-6">

            <!-- ミドルウェア -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-filter text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">ミドルウェア</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">// middleware.ts (プロジェクトルート)
import { NextResponse } from 'next/server'
import type { NextRequest } from 'next/server'

export function middleware(request: NextRequest) {
  // 認証チェック例
  const token = request.cookies.get('token')

  if (!token && request.nextUrl.pathname.startsWith('/admin')) {
    return NextResponse.redirect(new URL('/login', request.url))
  }

  return NextResponse.next()
}

export const config = {
  matcher: ['/admin/:path*', '/dashboard/:path*']
}</code></pre>
                    </div>
                </div>
            </section>

            <!-- 認証 (NextAuth.js) -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-key text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">認証 (NextAuth.js v5)</h3>
                </div>

                <div class="space-y-4">
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg"><code class="language-typescript">// auth.ts
import NextAuth from "next-auth"
import GitHub from "next-auth/providers/github"

export const { handlers, signIn, signOut, auth } = NextAuth({
  providers: [GitHub],
})

// app/api/auth/[...nextauth]/route.ts
export { handlers as GET, handlers as POST }

// サーバーコンポーネントでセッション取得
import { auth } from "@/auth"

export default async function Page() {
  const session = await auth()
  if (!session) return <div>Not authenticated</div>
  return <div>Hello {session.user?.name}</div>
}</code></pre>
                    </div>
                </div>
            </section>

        </div>

        <!-- ============================================
             実務Tips
             ============================================ -->
        <section class="mt-6 bg-slate-800 rounded-xl shadow-sm p-6 text-white">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-amber-400 rounded-lg flex items-center justify-center">
                    <i class="fas fa-star text-slate-800"></i>
                </div>
                <h3 class="text-lg font-bold">実務で役立つTips</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-cog"></i>環境変数
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">
                        <code class="text-xs bg-slate-700 px-1 py-0.5 rounded">.env.local</code> に記載。<code class="text-xs bg-slate-700 px-1 py-0.5 rounded">NEXT_PUBLIC_</code> プレフィックスでクライアント公開
                    </p>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-rocket"></i>パフォーマンス
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">
                        <code class="text-xs bg-slate-700 px-1 py-0.5 rounded">dynamic('...')</code> で動的インポート。<code class="text-xs bg-slate-700 px-1 py-0.5 rounded">loading.tsx</code> でストリーミングUI
                    </p>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-exclamation-triangle"></i>エラー処理
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">
                        <code class="text-xs bg-slate-700 px-1 py-0.5 rounded">error.tsx</code> でエラー境界。<code class="text-xs bg-slate-700 px-1 py-0.5 rounded">not-found.tsx</code> で404ページ
                    </p>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-cloud"></i>デプロイ
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">
                        Vercelへpush自動デプロイ。<code class="text-xs bg-slate-700 px-1 py-0.5 rounded">vercel.json</code> で設定カスタマイズ
                    </p>
                </div>
            </div>
        </section>

        <!-- ============================================
             特別なファイル
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-teal-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-file-code text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">App Routerの特別なファイル</h3>
            </div>

            <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-sm">
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">page.tsx</p>
                    <p class="text-xs text-teal-700">ページUI</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">layout.tsx</p>
                    <p class="text-xs text-teal-700">レイアウト</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">loading.tsx</p>
                    <p class="text-xs text-teal-700">ローディング</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">error.tsx</p>
                    <p class="text-xs text-teal-700">エラー境界</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">not-found.tsx</p>
                    <p class="text-xs text-teal-700">404ページ</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">template.tsx</p>
                    <p class="text-xs text-teal-700">再マウント型レイアウト</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">route.ts</p>
                    <p class="text-xs text-teal-700">API Route</p>
                </div>
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-3">
                    <p class="font-mono font-bold text-teal-800 mb-1">default.tsx</p>
                    <p class="text-xs text-teal-700">並列ルートフォールバック</p>
                </div>
            </div>
        </section>

        <!-- ============================================
             よく使うパターン
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-violet-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-magic text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">よく使うパターン</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- useSearchParams -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3">検索パラメータ取得</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">'use client'
import { useSearchParams } from 'next/navigation'

export default function SearchBar() {
  const searchParams = useSearchParams()
  const query = searchParams.get('q')

  return <div>検索: {query}</div>
}</code></pre>
                    </div>
                </div>

                <!-- useRouter (Client) -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3">プログラマティックナビゲーション</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">'use client'
import { useRouter } from 'next/navigation'

export default function LoginButton() {
  const router = useRouter()

  const handleLogin = async () => {
    // ログイン処理
    router.push('/dashboard')
    // または router.replace('/dashboard')
  }

  return <button onClick={handleLogin}>Login</button>
}</code></pre>
                    </div>
                </div>

                <!-- redirect (Server) -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3">サーバーサイドリダイレクト</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">import { redirect } from 'next/navigation'

export default async function Page() {
  const session = await getSession()

  if (!session) {
    redirect('/login')
  }

  return <div>Protected Page</div>
}</code></pre>
                    </div>
                </div>

                <!-- Streaming with Suspense -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3">Suspenseでストリーミング</h4>
                    <div class="code-block-wrapper">
                        <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                            <i class="fas fa-copy"></i>
                        </button>
                        <pre class="rounded-lg text-sm"><code class="language-typescript">import { Suspense } from 'react'

export default function Page() {
  return (
    <div>
      <h1>ダッシュボード</h1>
      <Suspense fallback={<div>Loading...</div>}>
        <SlowComponent />
      </Suspense>
    </div>
  )
}

async function SlowComponent() {
  const data = await fetchData()  // 遅いデータ取得
  return <div>{data}</div>
}</code></pre>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             設定ファイル
             ============================================ -->
        <section class="mt-6 bg-white rounded-xl shadow-sm border border-slate-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-cog text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">next.config.js の主要設定</h3>
            </div>

            <div class="code-block-wrapper">
                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                    <i class="fas fa-copy"></i>
                </button>
                <pre class="rounded-lg"><code class="language-javascript">/** @type {import('next').NextConfig} */
const nextConfig = {
  // 外部画像ドメイン許可
  images: {
    domains: ['example.com', 'cdn.example.com'],
    // または remotePatterns で細かく制御
    remotePatterns: [
      {
        protocol: 'https',
        hostname: '**.example.com',
      },
    ],
  },

  // リダイレクト設定
  async redirects() {
    return [
      {
        source: '/old-path',
        destination: '/new-path',
        permanent: true,
      },
    ]
  },

  // リライト設定（プロキシ）
  async rewrites() {
    return [
      {
        source: '/api/:path*',
        destination: 'https://api.example.com/:path*',
      },
    ]
  },

  // 環境変数公開
  env: {
    CUSTOM_KEY: 'value',
  },

  // 静的エクスポート（SSG完全版）
  output: 'export',

  // Strict Mode
  reactStrictMode: true,
}

module.exports = nextConfig</code></pre>
            </div>
        </section>

    </main>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300 mt-12 no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <p class="text-sm text-center">
                &copy; 2025 F-Circle. All rights reserved.<br>
                本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
            </p>
        </div>
    </footer>
</body>
</html>
