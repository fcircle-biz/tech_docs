<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQLModel チートシート</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script src="main.js"></script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Blue (Python系)
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー -->
    <header class="header-rich text-white py-4 shadow-lg no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                        <i class="fas fa-database text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">SQLModel チートシート</h1>
                        <p class="text-sm text-white/80">Pythonでデータベースをシンプルかつ型安全に扱う</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- ダークモード切り替えボタン -->
                    <button id="dark-mode-toggle" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/20 hover:bg-white/30 transition" title="ダークモード切り替え">
                        <i class="fas fa-moon dark-icon"></i>
                        <i class="fas fa-sun light-icon hidden"></i>
                    </button>
                    <!-- 印刷ボタン -->
                    <button onclick="window.print()" class="hidden md:flex items-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-print"></i>
                        <span>印刷</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- ============================================
             イントロセクション
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-primary-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-code text-white text-xl"></i>
                </div>
                <div>
                    <h2 class="text-2xl font-bold text-slate-900 mb-2">SQLModelとは？</h2>
                    <p class="text-slate-600 mb-4">
                        SQLModelは、PydanticとSQLAlchemyを組み合わせた最新のPython ORMライブラリです。
                        型ヒントを活用したシンプルなコードで、データベース操作を安全かつ効率的に実装できます。
                    </p>
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-blue-100 text-blue-800 text-sm rounded-full">型安全</span>
                        <span class="px-3 py-1 bg-emerald-100 text-emerald-800 text-sm rounded-full">シンプル</span>
                        <span class="px-3 py-1 bg-purple-100 text-purple-800 text-sm rounded-full">FastAPI連携</span>
                        <span class="px-3 py-1 bg-amber-100 text-amber-800 text-sm rounded-full">自動マイグレーション</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             基本操作カード（2カラムグリッド）
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-rocket text-primary-600"></i>
            基本操作
        </h2>

        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- インストール -->
            <div class="bg-white rounded-xl shadow-sm border border-primary-200 p-6">
                <h3 class="text-lg font-bold text-primary-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-download text-primary-600"></i>
                    インストール
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-bash">pip install sqlmodel</code></pre>
                </div>
                <p class="text-sm text-slate-600 mt-2">SQLAlchemy、Pydanticも自動でインストールされます</p>
            </div>

            <!-- モデル定義 -->
            <div class="bg-white rounded-xl shadow-sm border border-primary-200 p-6">
                <h3 class="text-lg font-bold text-primary-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-cube text-primary-600"></i>
                    モデル定義
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import SQLModel, Field
from typing import Optional

class User(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    name: str
    email: str
    age: Optional[int] = None</code></pre>
                </div>
                <p class="text-sm text-slate-600 mt-2">Pythonのクラスでテーブル構造を定義</p>
            </div>

            <!-- データベース作成 -->
            <div class="bg-white rounded-xl shadow-sm border border-emerald-200 p-6">
                <h3 class="text-lg font-bold text-emerald-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-plus-circle text-emerald-600"></i>
                    データベース/テーブル作成
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import create_engine

# エンジン作成
engine = create_engine("sqlite:///database.db")

# すべてのテーブルを作成
SQLModel.metadata.create_all(engine)</code></pre>
                </div>
                <p class="text-sm text-slate-600 mt-2">モデル定義から自動でテーブルを生成</p>
            </div>

            <!-- セッション作成 -->
            <div class="bg-white rounded-xl shadow-sm border border-purple-200 p-6">
                <h3 class="text-lg font-bold text-purple-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-link text-purple-600"></i>
                    セッション管理
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import Session

# セッション作成
with Session(engine) as session:
    # データベース操作をここに記述
    session.commit()  # 変更を保存</code></pre>
                </div>
                <p class="text-sm text-slate-600 mt-2">withブロックで自動的にクローズ</p>
            </div>
        </div>

        <!-- ============================================
             CRUD操作
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-tasks text-primary-600"></i>
            CRUD操作
        </h2>

        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- Create -->
            <div class="bg-emerald-50 rounded-xl shadow-sm border border-emerald-200 p-6">
                <h3 class="text-lg font-bold text-emerald-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-plus text-emerald-600"></i>
                    Create（作成）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">user = User(name="田中太郎", email="tanaka@example.com", age=25)

with Session(engine) as session:
    session.add(user)
    session.commit()
    session.refresh(user)  # DBから最新データを取得
    print(f"作成されたユーザーID: {user.id}")</code></pre>
                </div>
            </div>

            <!-- Read -->
            <div class="bg-blue-50 rounded-xl shadow-sm border border-blue-200 p-6">
                <h3 class="text-lg font-bold text-blue-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-search text-blue-600"></i>
                    Read（読み取り）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import select

with Session(engine) as session:
    # 全件取得
    statement = select(User)
    users = session.exec(statement).all()

    # ID指定で1件取得
    user = session.get(User, 1)</code></pre>
                </div>
            </div>

            <!-- Update -->
            <div class="bg-amber-50 rounded-xl shadow-sm border border-amber-200 p-6">
                <h3 class="text-lg font-bold text-amber-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-edit text-amber-600"></i>
                    Update（更新）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">with Session(engine) as session:
    user = session.get(User, 1)
    user.age = 26
    session.add(user)
    session.commit()
    session.refresh(user)</code></pre>
                </div>
            </div>

            <!-- Delete -->
            <div class="bg-red-50 rounded-xl shadow-sm border border-red-200 p-6">
                <h3 class="text-lg font-bold text-red-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-trash-alt text-red-600"></i>
                    Delete（削除）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">with Session(engine) as session:
    user = session.get(User, 1)
    session.delete(user)
    session.commit()</code></pre>
                </div>
            </div>
        </div>

        <!-- ============================================
             データ検索・絞り込み
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-filter text-primary-600"></i>
            データ検索・絞り込み
        </h2>

        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- 条件検索 -->
            <div class="bg-white rounded-xl shadow-sm border border-indigo-200 p-6">
                <h3 class="text-lg font-bold text-indigo-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-filter text-indigo-600"></i>
                    条件検索（WHERE）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import select

with Session(engine) as session:
    # 年齢が25歳以上のユーザー
    statement = select(User).where(User.age >= 25)
    users = session.exec(statement).all()

    # 複数条件（AND）
    statement = select(User).where(
        User.age >= 20,
        User.age <= 30
    )
    users = session.exec(statement).all()</code></pre>
                </div>
            </div>

            <!-- 並び替え・制限 -->
            <div class="bg-white rounded-xl shadow-sm border border-indigo-200 p-6">
                <h3 class="text-lg font-bold text-indigo-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-sort text-indigo-600"></i>
                    並び替え・件数制限
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import select, col

with Session(engine) as session:
    # 年齢の降順で並び替え
    statement = select(User).order_by(col(User.age).desc())

    # 最新10件のみ取得
    statement = select(User).limit(10)

    # 組み合わせ
    statement = select(User).where(User.age >= 20).order_by(User.name).limit(5)</code></pre>
                </div>
            </div>

            <!-- LIKE検索 -->
            <div class="bg-white rounded-xl shadow-sm border border-violet-200 p-6">
                <h3 class="text-lg font-bold text-violet-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-search text-violet-600"></i>
                    部分一致検索（LIKE）
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import select, col

with Session(engine) as session:
    # 名前に「田中」を含むユーザー
    statement = select(User).where(col(User.name).contains("田中"))

    # 名前が「山」で始まるユーザー
    statement = select(User).where(col(User.name).startswith("山"))</code></pre>
                </div>
            </div>

            <!-- OR条件 -->
            <div class="bg-white rounded-xl shadow-sm border border-violet-200 p-6">
                <h3 class="text-lg font-bold text-violet-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-code-branch text-violet-600"></i>
                    OR条件
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">from sqlmodel import select, or_

with Session(engine) as session:
    # 年齢が20歳未満または30歳以上
    statement = select(User).where(
        or_(User.age < 20, User.age >= 30)
    )</code></pre>
                </div>
            </div>
        </div>

        <!-- ============================================
             リレーション（1対多）
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-project-diagram text-primary-600"></i>
            リレーション（1対多）
        </h2>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <h3 class="text-lg font-bold text-slate-800 mb-3">モデル定義</h3>
            <div class="code-block-wrapper">
                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                    <i class="fas fa-copy"></i>
                </button>
                <pre class="rounded-lg"><code class="language-python">from sqlmodel import SQLModel, Field, Relationship
from typing import Optional, List

class Team(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    name: str

    # リレーション: 1つのチームは複数のユーザーを持つ
    members: List["User"] = Relationship(back_populates="team")

class User(SQLModel, table=True):
    id: Optional[int] = Field(default=None, primary_key=True)
    name: str
    team_id: Optional[int] = Field(default=None, foreign_key="team.id")

    # リレーション: 1人のユーザーは1つのチームに所属
    team: Optional[Team] = Relationship(back_populates="members")</code></pre>
            </div>
        </div>

        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <!-- リレーション作成 -->
            <div class="bg-emerald-50 rounded-xl shadow-sm border border-emerald-200 p-6">
                <h3 class="text-lg font-bold text-emerald-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-link text-emerald-600"></i>
                    リレーションの作成
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">with Session(engine) as session:
    # チーム作成
    team = Team(name="開発チーム")
    session.add(team)
    session.commit()
    session.refresh(team)

    # ユーザー作成とチーム紐付け
    user = User(name="田中太郎", team_id=team.id)
    session.add(user)
    session.commit()</code></pre>
                </div>
            </div>

            <!-- リレーション取得 -->
            <div class="bg-blue-50 rounded-xl shadow-sm border border-blue-200 p-6">
                <h3 class="text-lg font-bold text-blue-800 mb-3 flex items-center gap-2">
                    <i class="fas fa-arrows-alt-h text-blue-600"></i>
                    リレーションの取得
                </h3>
                <div class="code-block-wrapper">
                    <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                        <i class="fas fa-copy"></i>
                    </button>
                    <pre class="rounded-lg"><code class="language-python">with Session(engine) as session:
    # チームからメンバーを取得
    team = session.get(Team, 1)
    for member in team.members:
        print(member.name)

    # ユーザーからチームを取得
    user = session.get(User, 1)
    print(user.team.name)</code></pre>
                </div>
            </div>
        </div>

        <!-- ============================================
             Fieldオプション
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-cog text-primary-600"></i>
            Fieldオプション
        </h2>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="code-block-wrapper">
                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                    <i class="fas fa-copy"></i>
                </button>
                <pre class="rounded-lg"><code class="language-python">from sqlmodel import SQLModel, Field
from typing import Optional

class Product(SQLModel, table=True):
    # 主キー（自動採番）
    id: Optional[int] = Field(default=None, primary_key=True)

    # 必須項目
    name: str = Field(index=True)  # インデックス作成

    # デフォルト値
    price: int = Field(default=0)

    # 最小値・最大値
    stock: int = Field(ge=0, le=10000)  # 0以上10000以下

    # 文字列長制限
    code: str = Field(max_length=20)

    # ユニーク制約
    email: str = Field(unique=True)

    # NULL許可
    description: Optional[str] = None</code></pre>
            </div>
        </div>

        <!-- ============================================
             実務Tips（ダーク背景セクション）
             ============================================ -->
        <section class="bg-gradient-to-br from-slate-800 to-slate-900 text-white rounded-xl shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold mb-4 flex items-center gap-2">
                <i class="fas fa-lightbulb text-yellow-400"></i>
                実務Tips
            </h2>
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        トランザクション管理
                    </h3>
                    <p class="text-sm text-slate-200">
                        複数の操作を1つのトランザクションにまとめることで、データの整合性を保つ。
                        エラー時は自動的にロールバックされる。
                    </p>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        N+1問題対策
                    </h3>
                    <p class="text-sm text-slate-200">
                        リレーション取得時は<code class="bg-slate-700 px-1 rounded">selectinload()</code>や<code class="bg-slate-700 px-1 rounded">joinedload()</code>を使って
                        クエリ数を削減する。
                    </p>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        バリデーション
                    </h3>
                    <p class="text-sm text-slate-200">
                        Pydanticの機能を活用して、データ保存前に自動バリデーションを実施。
                        型安全性を確保できる。
                    </p>
                </div>
                <div class="bg-white/10 rounded-lg p-4">
                    <h3 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-check-circle"></i>
                        環境変数でDB接続
                    </h3>
                    <p class="text-sm text-slate-200">
                        本番環境では接続文字列を環境変数で管理。
                        <code class="bg-slate-700 px-1 rounded">os.getenv("DATABASE_URL")</code>で取得する。
                    </p>
                </div>
            </div>
        </section>

        <!-- ============================================
             FastAPI連携
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-bolt text-primary-600"></i>
            FastAPI連携
        </h2>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <h3 class="text-lg font-bold text-slate-800 mb-3">基本的なAPI実装</h3>
            <div class="code-block-wrapper">
                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                    <i class="fas fa-copy"></i>
                </button>
                <pre class="rounded-lg"><code class="language-python">from fastapi import FastAPI, Depends
from sqlmodel import Session, select

app = FastAPI()

# データベース接続の依存関係
def get_session():
    with Session(engine) as session:
        yield session

# ユーザー一覧取得API
@app.get("/users")
def get_users(session: Session = Depends(get_session)):
    statement = select(User)
    users = session.exec(statement).all()
    return users

# ユーザー作成API
@app.post("/users")
def create_user(user: User, session: Session = Depends(get_session)):
    session.add(user)
    session.commit()
    session.refresh(user)
    return user</code></pre>
            </div>
        </div>

        <!-- ============================================
             よくあるエラーと対処法
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-exclamation-triangle text-amber-600"></i>
            よくあるエラーと対処法
        </h2>

        <div class="space-y-4 mb-8">
            <div class="bg-red-50 rounded-lg border border-red-200 p-4">
                <h3 class="font-bold text-red-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-bug text-red-600"></i>
                    IntegrityError: UNIQUE constraint failed
                </h3>
                <p class="text-sm text-red-700 mb-2"><strong>原因:</strong> ユニーク制約違反（同じメールアドレスなど）</p>
                <p class="text-sm text-red-700"><strong>対処:</strong> 既存データの確認、または制約の見直し</p>
            </div>

            <div class="bg-amber-50 rounded-lg border border-amber-200 p-4">
                <h3 class="font-bold text-amber-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-exclamation-circle text-amber-600"></i>
                    DetachedInstanceError
                </h3>
                <p class="text-sm text-amber-700 mb-2"><strong>原因:</strong> セッションが閉じた後にリレーションにアクセス</p>
                <p class="text-sm text-amber-700"><strong>対処:</strong> セッション内でリレーションを先に読み込む、または<code class="bg-amber-100 px-1 rounded">selectinload()</code>を使用</p>
            </div>

            <div class="bg-blue-50 rounded-lg border border-blue-200 p-4">
                <h3 class="font-bold text-blue-800 mb-2 flex items-center gap-2">
                    <i class="fas fa-info-circle text-blue-600"></i>
                    テーブルが作成されない
                </h3>
                <p class="text-sm text-blue-700 mb-2"><strong>原因:</strong> モデル定義時に<code class="bg-blue-100 px-1 rounded">table=True</code>を忘れている</p>
                <p class="text-sm text-blue-700"><strong>対処:</strong> <code class="bg-blue-100 px-1 rounded">class User(SQLModel, table=True)</code>と明示的に指定</p>
            </div>
        </div>

        <!-- ============================================
             データベース接続文字列
             ============================================ -->
        <h2 class="text-2xl font-bold text-slate-900 mb-4 flex items-center gap-2">
            <i class="fas fa-database text-primary-600"></i>
            データベース接続文字列
        </h2>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="space-y-4">
                <div class="bg-teal-100 rounded-lg p-3">
                    <h4 class="font-bold text-teal-800 mb-1">SQLite（開発用）</h4>
                    <code class="text-sm text-teal-900">sqlite:///database.db</code>
                </div>
                <div class="bg-blue-100 rounded-lg p-3">
                    <h4 class="font-bold text-blue-800 mb-1">PostgreSQL</h4>
                    <code class="text-sm text-blue-900">postgresql://user:password@localhost/dbname</code>
                </div>
                <div class="bg-orange-100 rounded-lg p-3">
                    <h4 class="font-bold text-orange-800 mb-1">MySQL</h4>
                    <code class="text-sm text-orange-900">mysql://user:password@localhost/dbname</code>
                </div>
            </div>
        </div>

        <!-- ============================================
             参考リンク
             ============================================ -->
        <section class="bg-gradient-to-r from-primary-50 to-blue-50 rounded-xl shadow-sm border border-primary-200 p-6">
            <h2 class="text-xl font-bold text-slate-900 mb-4 flex items-center gap-2">
                <i class="fas fa-link text-primary-600"></i>
                参考リンク
            </h2>
            <ul class="space-y-2">
                <li>
                    <a href="https://sqlmodel.tiangolo.com/" target="_blank" class="text-primary-600 hover:text-primary-700 hover:underline flex items-center gap-2">
                        <i class="fas fa-external-link-alt text-sm"></i>
                        SQLModel公式ドキュメント
                    </a>
                </li>
                <li>
                    <a href="https://fcircle-biz.github.io/tech_docs/guide/programming-languages/python-ecosystem/sqlmodel/README.html" target="_blank" class="text-primary-600 hover:text-primary-700 hover:underline flex items-center gap-2">
                        <i class="fas fa-book text-sm"></i>
                        SQLModel入門学習ガイド
                    </a>
                </li>
                <li>
                    <a href="https://fastapi.tiangolo.com/" target="_blank" class="text-primary-600 hover:text-primary-700 hover:underline flex items-center gap-2">
                        <i class="fas fa-bolt text-sm"></i>
                        FastAPI公式ドキュメント
                    </a>
                </li>
            </ul>
        </section>

    </main>

    <!-- フッター -->
    <footer class="bg-slate-800 text-white text-center py-4 mt-8 no-print">
        <p class="text-sm">&copy; 2026 fcircle-biz Tech Docs. All rights reserved.</p>
    </footer>

    <script>
        // Highlight.js初期化
        hljs.highlightAll();
    </script>
</body>
</html>
