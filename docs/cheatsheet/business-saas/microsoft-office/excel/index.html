<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel チートシート</title>

    <!-- ダークモード早期適用(フラッシュ防止) -->
    <script src="main.js"></script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Emerald (Excel green)
                        primary: {
                            50: '#ecfdf5',
                            100: '#d1fae5',
                            200: '#a7f3d0',
                            300: '#6ee7b7',
                            400: '#34d399',
                            500: '#10b981',
                            600: '#059669',
                            700: '#047857',
                            800: '#065f46',
                            900: '#064e3b',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー -->
    <header class="header-rich header-emerald text-white py-4 shadow-lg no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="w-12 h-12 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                        <i class="fas fa-file-excel text-2xl"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold">Excel チートシート</h1>
                        <p class="text-sm text-white/80">業務を効率化するショートカットキー&関数クイックリファレンス</p>
                    </div>
                </div>
                <div class="flex items-center gap-2">
                    <!-- ダークモード切り替えボタン -->
                    <button id="dark-mode-toggle" class="w-10 h-10 flex items-center justify-center rounded-lg bg-white/20 hover:bg-white/30 transition" title="ダークモード切り替え">
                        <i class="fas fa-moon dark-icon"></i>
                        <i class="fas fa-sun light-icon hidden"></i>
                    </button>
                    <!-- 印刷ボタン -->
                    <button onclick="window.print()" class="hidden md:flex items-center gap-2 bg-white/20 hover:bg-white/30 px-4 py-2 rounded-lg transition">
                        <i class="fas fa-print"></i>
                        <span>印刷</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- ============================================
             イントロセクション
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-8">
            <div class="flex items-start gap-4">
                <div class="flex-shrink-0 w-12 h-12 bg-primary-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-table text-white text-xl"></i>
                </div>
                <div>
                    <h2 class="text-xl font-bold text-slate-800 mb-2">Excelとは?</h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        Microsoft Excelは表計算ソフトウェアの定番ツール。データ入力・集計・分析から、グラフ作成、ピボットテーブル、マクロによる自動化まで幅広い業務に対応します。ショートカットキーを使いこなすことで作業効率が大幅に向上します。
                    </p>
                    <!-- タグ -->
                    <div class="flex flex-wrap gap-2">
                        <span class="px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>表計算
                        </span>
                        <span class="px-3 py-1 bg-emerald-100 text-emerald-700 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>データ分析
                        </span>
                        <span class="px-3 py-1 bg-teal-100 text-teal-800 rounded-full text-sm font-medium">
                            <i class="fas fa-tag mr-1"></i>ビジネスツール
                        </span>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             基本ショートカットキー
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-primary-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-keyboard text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">基本ショートカットキー</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <!-- ファイル操作 -->
                <div class="bg-primary-50 border border-primary-200 rounded-lg p-4">
                    <h4 class="font-bold text-primary-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-folder-open"></i>ファイル操作
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">新規作成</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + N</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">開く</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + O</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">上書き保存</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + S</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">印刷</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + P</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">閉じる</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + W</kbd>
                        </div>
                    </div>
                </div>

                <!-- 編集操作 -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h4 class="font-bold text-amber-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-edit"></i>編集操作
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">コピー</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + C</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">切り取り</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + X</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">貼り付け</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + V</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">元に戻す</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Z</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">やり直し</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Y</kbd>
                        </div>
                    </div>
                </div>

                <!-- セル操作 -->
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <h4 class="font-bold text-indigo-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-th"></i>セル操作
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">編集モード</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">F2</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">セル削除</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + -</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">セル挿入</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + +</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">現在日付入力</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + ;</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">現在時刻入力</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + :</kbd>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             ナビゲーション & 選択
             ============================================ -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
            <!-- ナビゲーション -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-violet-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-arrows-alt text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">ナビゲーション</h3>
                </div>

                <div class="space-y-3 text-sm">
                    <div class="bg-violet-50 border border-violet-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-violet-800">データ範囲の端に移動</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + ↑↓←→</kbd>
                        </div>
                        <p class="text-xs text-violet-700">データがある最後のセルまでジャンプ</p>
                    </div>

                    <div class="bg-violet-50 border border-violet-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-violet-800">先頭セルに移動</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Home</kbd>
                        </div>
                        <p class="text-xs text-violet-700">A1セルへ移動</p>
                    </div>

                    <div class="bg-violet-50 border border-violet-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-violet-800">最終セルに移動</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + End</kbd>
                        </div>
                        <p class="text-xs text-violet-700">データがある最終セルへ移動</p>
                    </div>

                    <div class="bg-violet-50 border border-violet-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-violet-800">シート切り替え</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + PageUp/PageDown</kbd>
                        </div>
                        <p class="text-xs text-violet-700">前後のシートに移動</p>
                    </div>
                </div>
            </section>

            <!-- 選択 -->
            <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6">
                <div class="flex items-center gap-3 mb-4">
                    <div class="w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center">
                        <i class="fas fa-mouse-pointer text-white"></i>
                    </div>
                    <h3 class="text-lg font-bold text-slate-800">範囲選択</h3>
                </div>

                <div class="space-y-3 text-sm">
                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-orange-800">全選択</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + A</kbd>
                        </div>
                        <p class="text-xs text-orange-700">シート全体を選択</p>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-orange-800">データ範囲まで選択</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + ↑↓←→</kbd>
                        </div>
                        <p class="text-xs text-orange-700">データ端まで範囲を拡張</p>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-orange-800">行全体選択</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Shift + Space</kbd>
                        </div>
                        <p class="text-xs text-orange-700">現在の行全体を選択</p>
                    </div>

                    <div class="bg-orange-50 border border-orange-200 rounded-lg p-3">
                        <div class="flex justify-between mb-1">
                            <span class="font-medium text-orange-800">列全体選択</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Space</kbd>
                        </div>
                        <p class="text-xs text-orange-700">現在の列全体を選択</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- ============================================
             書式設定ショートカット
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-paint-brush text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">書式設定</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                    <h4 class="font-bold text-purple-800 mb-3">フォント</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">太字</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + B</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">斜体</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + I</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">下線</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + U</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">取り消し線</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + 5</kbd>
                        </div>
                    </div>
                </div>

                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                    <h4 class="font-bold text-purple-800 mb-3">罫線・表示形式</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">セル書式設定</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + 1</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">外枠罫線</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + &</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">罫線削除</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + _</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">数値形式</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + 1</kbd>
                        </div>
                    </div>
                </div>

                <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                    <h4 class="font-bold text-purple-800 mb-3">表示形式</h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">通貨形式</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + 4</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">パーセント形式</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + 5</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">日付形式</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + 3</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">時刻形式</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + 2</kbd>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             よく使う関数
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-function text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">よく使う関数</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- 集計関数 -->
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                    <h4 class="font-bold text-blue-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-calculator"></i>集計関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-blue-800 mb-1">合計</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=SUM(A1:A10)</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-blue-800 mb-1">平均</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=AVERAGE(A1:A10)</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-blue-800 mb-1">最大値/最小値</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=MAX(A1:A10)
=MIN(A1:A10)</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-blue-800 mb-1">個数カウント</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=COUNT(A1:A10)    // 数値のみ
=COUNTA(A1:A10)   // 空白以外</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 条件関数 -->
                <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                    <h4 class="font-bold text-emerald-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-filter"></i>条件関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-emerald-800 mb-1">IF関数</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=IF(A1>=80, "合格", "不合格")</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-emerald-800 mb-1">SUMIF関数(条件付き合計)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=SUMIF(A1:A10, ">=100", B1:B10)</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-emerald-800 mb-1">COUNTIF関数(条件カウント)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=COUNTIF(A1:A10, "合格")</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-emerald-800 mb-1">AVERAGEIF関数(条件付き平均)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=AVERAGEIF(A1:A10, ">=80", B1:B10)</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 検索関数 -->
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4">
                    <h4 class="font-bold text-amber-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-search"></i>検索関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-amber-800 mb-1">VLOOKUP関数(縦方向検索)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=VLOOKUP(A2, Sheet2!A:C, 2, FALSE)</code></pre>
                            </div>
                            <p class="text-xs text-amber-700 mt-1">検索値, 範囲, 列番号, 完全一致</p>
                        </div>
                        <div>
                            <p class="font-medium text-amber-800 mb-1">XLOOKUP関数(新バージョン)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=XLOOKUP(A2, Sheet2!A:A, Sheet2!B:B)</code></pre>
                            </div>
                            <p class="text-xs text-amber-700 mt-1">検索値, 検索範囲, 戻り範囲</p>
                        </div>
                        <div>
                            <p class="font-medium text-amber-800 mb-1">INDEX+MATCH関数</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=INDEX(B:B, MATCH(A2, A:A, 0))</code></pre>
                            </div>
                            <p class="text-xs text-amber-700 mt-1">柔軟な検索が可能</p>
                        </div>
                    </div>
                </div>

                <!-- 文字列関数 -->
                <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-4">
                    <h4 class="font-bold text-indigo-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-text-width"></i>文字列関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-indigo-800 mb-1">文字列結合</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=CONCAT(A1, " ", B1)
=A1&" "&B1  // &演算子でも可</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-indigo-800 mb-1">文字列抽出</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=LEFT(A1, 3)   // 左から3文字
=RIGHT(A1, 2)  // 右から2文字
=MID(A1, 2, 4) // 2文字目から4文字</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-indigo-800 mb-1">大文字/小文字変換</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=UPPER(A1)  // 大文字変換
=LOWER(A1)  // 小文字変換</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 日付関数 -->
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-4">
                    <h4 class="font-bold text-teal-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-calendar"></i>日付・時刻関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-teal-800 mb-1">今日の日付/現在時刻</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=TODAY()  // 今日の日付
=NOW()    // 現在日時</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-teal-800 mb-1">日付の部分抽出</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=YEAR(A1)   // 年
=MONTH(A1)  // 月
=DAY(A1)    // 日</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-teal-800 mb-1">日付計算</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=DATEDIF(A1, B1, "D")  // 日数差
=EDATE(A1, 3)          // 3ヶ月後</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 論理関数 -->
                <div class="bg-violet-50 border border-violet-200 rounded-lg p-4">
                    <h4 class="font-bold text-violet-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-project-diagram"></i>論理関数
                    </h4>
                    <div class="space-y-3 text-sm">
                        <div>
                            <p class="font-medium text-violet-800 mb-1">AND/OR関数</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=AND(A1>=80, B1>=80)  // 両方とも真
=OR(A1>=80, B1>=80)   // いずれか真</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-violet-800 mb-1">NOT関数</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=NOT(A1="")  // 空白でない場合TRUE</code></pre>
                            </div>
                        </div>
                        <div>
                            <p class="font-medium text-violet-800 mb-1">IFERROR関数(エラー処理)</p>
                            <div class="code-block-wrapper">
                                <button onclick="copyCode(this)" class="copy-btn px-2 py-1 bg-slate-600 hover:bg-slate-500 text-white text-xs rounded transition">
                                    <i class="fas fa-copy"></i>
                                </button>
                                <pre class="rounded-lg text-xs"><code>=IFERROR(A1/B1, "エラー")</code></pre>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             データ操作ショートカット
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-teal-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-database text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-slate-800">データ操作</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-teal-100 border border-teal-200 rounded-lg p-4">
                    <h4 class="font-bold text-teal-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-sort"></i>並び替え・フィルター
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">フィルター設定</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + Shift + L</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">並べ替え</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Alt + D + S</kbd>
                        </div>
                    </div>
                </div>

                <div class="bg-teal-100 border border-teal-200 rounded-lg p-4">
                    <h4 class="font-bold text-teal-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-table"></i>テーブル
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">テーブル化</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Ctrl + T</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">ピボット挿入</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Alt + N + V</kbd>
                        </div>
                    </div>
                </div>

                <div class="bg-teal-100 border border-teal-200 rounded-lg p-4">
                    <h4 class="font-bold text-teal-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-chart-bar"></i>グラフ
                    </h4>
                    <div class="space-y-2 text-sm">
                        <div class="flex justify-between">
                            <span class="text-slate-600">グラフ挿入</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">Alt + F1</kbd>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-slate-600">新規シートにグラフ</span>
                            <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs">F11</kbd>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- ============================================
             実務Tips
             ============================================ -->
        <section class="bg-slate-800 rounded-xl shadow-sm p-6 text-white mb-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-amber-400 rounded-lg flex items-center justify-center">
                    <i class="fas fa-star text-slate-800"></i>
                </div>
                <h3 class="text-lg font-bold">実務で役立つTips</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-bolt"></i>高速入力
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">複数セルに同じ値を一括入力</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">範囲選択 → 値入力 → Ctrl + Enter</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-search"></i>検索・置換
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">高速で文字列を検索・置換</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">検索: Ctrl + F<br>置換: Ctrl + H</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-shield-alt"></i>数式の表示
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">シート内の数式を確認</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">Ctrl + @</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-undo"></i>絶対参照
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">セル参照の固定・解除</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">F4キー<br>$A$1 ⇔ A$1 ⇔ $A1 ⇔ A1</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-eye"></i>非表示切替
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">行・列の表示/非表示</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">行: Ctrl + 9<br>列: Ctrl + 0</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-link"></i>リンク貼付け
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">セル参照をリンクで貼付け</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">コピー → Alt + E → S → N</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-fill-drip"></i>形式選択貼付け
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">書式のみ・値のみ貼付け</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">Ctrl + Alt + V</kbd>
                </div>

                <div class="bg-white/10 rounded-lg p-4">
                    <h4 class="font-bold text-amber-300 mb-2 flex items-center gap-2">
                        <i class="fas fa-lock"></i>シート保護
                    </h4>
                    <p class="text-sm text-slate-300 mb-2">誤操作防止にシート保護</p>
                    <kbd class="px-2 py-1 bg-slate-700 rounded font-mono text-xs">Alt → R → P → S</kbd>
                </div>
            </div>
        </section>

        <!-- ============================================
             危険な操作
             ============================================ -->
        <section class="bg-white rounded-xl shadow-sm border border-red-200 p-6">
            <div class="flex items-center gap-3 mb-6">
                <div class="w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center">
                    <i class="fas fa-exclamation-triangle text-white"></i>
                </div>
                <h3 class="text-lg font-bold text-red-800">注意が必要な操作</h3>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <h4 class="font-bold text-red-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-trash"></i>削除操作
                    </h4>
                    <div class="space-y-2 text-sm text-red-700">
                        <p><strong>行削除:</strong> <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs text-slate-800">Ctrl + -</kbd></p>
                        <p><strong>シート削除:</strong> 右クリック → 削除</p>
                        <p class="flex items-center gap-1 mt-2">
                            <i class="fas fa-skull-crossbones"></i>
                            削除前に必ずバックアップ!
                        </p>
                    </div>
                </div>

                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <h4 class="font-bold text-red-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-eraser"></i>全削除
                    </h4>
                    <div class="space-y-2 text-sm text-red-700">
                        <p><strong>内容クリア:</strong> <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs text-slate-800">Delete</kbd></p>
                        <p><strong>全てクリア:</strong> Alt → H → E → A</p>
                        <p class="flex items-center gap-1 mt-2">
                            <i class="fas fa-exclamation-circle"></i>
                            元に戻せない場合あり
                        </p>
                    </div>
                </div>

                <div class="bg-red-50 border border-red-200 rounded-lg p-4">
                    <h4 class="font-bold text-red-800 mb-3 flex items-center gap-2">
                        <i class="fas fa-save"></i>上書き保存
                    </h4>
                    <div class="space-y-2 text-sm text-red-700">
                        <p><strong>保存:</strong> <kbd class="px-2 py-1 bg-slate-100 rounded font-mono text-xs text-slate-800">Ctrl + S</kbd></p>
                        <p><strong>別名保存:</strong> F12キー</p>
                        <p class="flex items-center gap-1 mt-2">
                            <i class="fas fa-shield-alt"></i>
                            定期的にバージョン管理
                        </p>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300 mt-12 no-print">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <p class="text-sm text-center">
                &copy; 2025 F-Circle. All rights reserved.<br>
                本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
            </p>
        </div>
    </footer>
</body>
</html>
