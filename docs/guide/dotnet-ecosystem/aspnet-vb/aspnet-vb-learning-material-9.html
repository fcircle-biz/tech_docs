<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET VB.NETå­¦ç¿’æ•™æ ç¬¬9ç«  - ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .navbar {
            background-color: #0078d4;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .security-note {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ff9800;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .security-table {
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">ASP.NET VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">ç¬¬1ç« : Web Formså…¥é–€</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">ç¬¬2ç« : Webã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">ç¬¬3ç« : ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">ç¬¬4ç« : ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">ç¬¬5ç« : çŠ¶æ…‹ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">ç¬¬6ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">ç¬¬7ç« : ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">ç¬¬8ç« : ãƒã‚¹ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter9">ç¬¬9ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬9ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—</h1>
                </div>

                <div id="chapter9">
                    <h2 class="chapter-title">Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¨ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ </h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹èªè¨¼ãƒ»èªå¯ã®åŸºæœ¬æ¦‚å¿µ</li>
                            <li>ASP.NETãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…æ–¹æ³•</li>
                            <li>ãƒ­ã‚°ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ä½¿ç”¨ã¨ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</li>
                            <li>ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã®å®Ÿè£…</li>
                            <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–ã€XSSå¯¾ç­–ãªã©ï¼‰</li>
                            <li>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–</li>
                        </ul>
                    </div>

                    <div class="security-note">
                        <h6>ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®é‡è¦æ€§</h6>
                        <p>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯å¤–éƒ¨ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ãªãŸã‚ã€ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã¯æœ€é‡è¦èª²é¡Œã§ã™ã€‚é©åˆ‡ãªèªè¨¼ãƒ»èªå¯ãªã—ã«æ©Ÿå¯†æƒ…å ±ãŒæ¼æ´©ã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã“ã®ç« ã§ã¯ã‚»ã‚­ãƒ¥ã‚¢ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã®åŸºç¤ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>
                    </div>

                    <h3 class="section-title">9.1 èªè¨¼ã¨èªå¯ã®åŸºæœ¬æ¦‚å¿µ</h3>
                    <p>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®åŸºç›¤ã¨ãªã‚‹èªè¨¼ï¼ˆAuthenticationï¼‰ã¨èªå¯ï¼ˆAuthorizationï¼‰ã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <h4>èªè¨¼ã¨èªå¯ã®é•ã„</h4>
                    <table class="table table-striped security-table">
                        <thead>
                            <tr>
                                <th>æ¦‚å¿µ</th>
                                <th>è‹±èª</th>
                                <th>ç›®çš„</th>
                                <th>å…·ä½“ä¾‹</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>èªè¨¼</td>
                                <td>Authentication</td>
                                <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª°ã‹ã‚’ç¢ºèª</td>
                                <td>ãƒ­ã‚°ã‚¤ãƒ³ã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰èªè¨¼</td>
                            </tr>
                            <tr>
                                <td>èªå¯</td>
                                <td>Authorization</td>
                                <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèª</td>
                                <td>ç®¡ç†è€…ç”»é¢ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-1: ASP.NETãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®è¨­å®š</h5>
                        <p>ASP.NETã®æ¨™æº–çš„ãªãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­å®šã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã¨ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>æ‰‹é †</h6>
                        <ol>
                            <li>Web.configãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã®è¨­å®šã‚’è¿½åŠ </li>
                            <li>æ¥ç¶šæ–‡å­—åˆ—ã‚’è¨­å®šï¼ˆSQL Server Express LocalDBã‚’ä½¿ç”¨ï¼‰</li>
                            <li>aspnet_regsql.exeã‚’å®Ÿè¡Œã—ã¦ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒã‚’ä½œæˆ</li>
                            <li>Login.aspxãƒšãƒ¼ã‚¸ã‚’ä½œæˆ</li>
                        </ol>
                        <h6>Web.configè¨­å®šä¾‹</h6>
                        <pre class="code-block"><code class="language-html">&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="MembershipDB" 
         connectionString="Data Source=(localdb)\MSSQLLocalDB;Initial Catalog=MembershipDB;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
  
  &lt;system.web&gt;
    &lt;membership defaultProvider="SqlProvider"&gt;
      &lt;providers&gt;
        &lt;add name="SqlProvider" 
             type="System.Web.Security.SqlMembershipProvider" 
             connectionStringName="MembershipDB"
             enablePasswordRetrieval="false"
             enablePasswordReset="true"
             requiresQuestionAndAnswer="false"
             applicationName="/"
             requiresUniqueEmail="false"
             passwordFormat="Hashed"
             maxInvalidPasswordAttempts="5"
             minRequiredPasswordLength="6"
             minRequiredNonalphanumericCharacters="0" /&gt;
      &lt;/providers&gt;
    &lt;/membership&gt;
    
    &lt;roleManager enabled="true" defaultProvider="SqlProvider"&gt;
      &lt;providers&gt;
        &lt;add name="SqlProvider" 
             type="System.Web.Security.SqlRoleProvider" 
             connectionStringName="MembershipDB"
             applicationName="/" /&gt;
      &lt;/providers&gt;
    &lt;/roleManager&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;</code></pre>
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <p>ãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãŒä½œæˆã•ã‚Œã€ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã®åŸºç›¤ãŒæ§‹ç¯‰ã•ã‚Œã¾ã™ã€‚</p>
                    </div>

                    <h3 class="section-title">9.2 ãƒ­ã‚°ã‚¤ãƒ³ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®å®Ÿè£…</h3>
                    <p>ASP.NETã®Loginã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-2: ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã®ä½œæˆ</h5>
                        <p>Loginã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ãŸãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>Login.aspxï¼ˆVB.NETï¼‰</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ Page Language="VB" AutoEventWireup="false" CodeBehind="Login.aspx.vb" Inherits="WebApplication.Login" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head runat="server"&gt;
    &lt;title&gt;ãƒ­ã‚°ã‚¤ãƒ³&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div&gt;
            &lt;h2&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ­ã‚°ã‚¤ãƒ³&lt;/h2&gt;
            &lt;asp:Login ID="Login1" runat="server"
                       DestinationPageUrl="~/Default.aspx"
                       TitleText="ãƒ­ã‚°ã‚¤ãƒ³"
                       UserNameLabelText="ãƒ¦ãƒ¼ã‚¶ãƒ¼å:"
                       PasswordLabelText="ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰:"
                       LoginButtonText="ãƒ­ã‚°ã‚¤ãƒ³"
                       CreateUserText="æ–°è¦ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²"
                       CreateUserUrl="~/Register.aspx"
                       FailureText="ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"&gt;
            &lt;/asp:Login&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        <h6>Register.aspxï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ï¼‰</h6>
                        <pre class="code-block"><code class="language-html">&lt;asp:CreateUserWizard ID="CreateUserWizard1" runat="server"
                      ContinueDestinationPageUrl="~/Default.aspx"
                      CreateUserButtonText="ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ"
                      ContinueButtonText="ç¶šè¡Œ"&gt;
    &lt;WizardSteps&gt;
        &lt;asp:CreateUserWizardStep ID="CreateUserWizardStep1" runat="server"&gt;
        &lt;/asp:CreateUserWizardStep&gt;
        &lt;asp:CompleteWizardStep ID="CompleteWizardStep1" runat="server"&gt;
        &lt;/asp:CompleteWizardStep&gt;
    &lt;/WizardSteps&gt;
&lt;/asp:CreateUserWizard&gt;</code></pre>
                    </div>

                    <h3 class="section-title">9.3 ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</h3>
                    <p>ãƒ­ãƒ¼ãƒ«ï¼ˆå½¹å‰²ï¼‰ã«åŸºã¥ã„ãŸã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿè£…ã—ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™ã«å¿œã˜ãŸæ©Ÿèƒ½åˆ¶é™ã‚’è¡Œã„ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-3: ãƒ­ãƒ¼ãƒ«ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…</h5>
                        <p>ç®¡ç†è€…ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ãƒ¼ãƒ«ã‚’ä½œæˆã—ã€ãƒšãƒ¼ã‚¸ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>ãƒ­ãƒ¼ãƒ«ä½œæˆï¼ˆVB.NETï¼‰</h6>
                        <pre class="code-block"><code class="language-vbnet">Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    ' ãƒ­ãƒ¼ãƒ«ãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
    If Not Roles.RoleExists("Administrator") Then
        Roles.CreateRole("Administrator")
    End If
    
    If Not Roles.RoleExists("User") Then
        Roles.CreateRole("User")
    End If
End Sub

Protected Sub btnAssignRole_Click(sender As Object, e As EventArgs) Handles btnAssignRole.Click
    Dim userName As String = txtUserName.Text
    Dim roleName As String = ddlRoles.SelectedValue
    
    If Membership.GetUser(userName) IsNot Nothing Then
        Roles.AddUserToRole(userName, roleName)
        lblMessage.Text = String.Format("ãƒ¦ãƒ¼ã‚¶ãƒ¼ '{0}' ã‚’ãƒ­ãƒ¼ãƒ« '{1}' ã«è¿½åŠ ã—ã¾ã—ãŸã€‚", userName, roleName)
    Else
        lblMessage.Text = "æŒ‡å®šã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚"
    End If
End Sub</code></pre>
                        <h6>ãƒšãƒ¼ã‚¸ãƒ¬ãƒ™ãƒ«ã§ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆWeb.configï¼‰</h6>
                        <pre class="code-block"><code class="language-html">&lt;location path="Admin"&gt;
  &lt;system.web&gt;
    &lt;authorization&gt;
      &lt;allow roles="Administrator" /&gt;
      &lt;deny users="*" /&gt;
    &lt;/authorization&gt;
  &lt;/system.web&gt;
&lt;/location&gt;

&lt;location path="User"&gt;
  &lt;system.web&gt;
    &lt;authorization&gt;
      &lt;allow roles="Administrator,User" /&gt;
      &lt;deny users="?" /&gt;
    &lt;/authorization&gt;
  &lt;/system.web&gt;
&lt;/location&gt;</code></pre>
                    </div>

                    <h3 class="section-title">9.4 ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
                    <p>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è„†å¼±æ€§ã‹ã‚‰å®ˆã‚‹ãŸã‚ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <h4>ä¸»è¦ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è„…å¨ã¨å¯¾ç­–</h4>
                    <table class="table table-striped security-table">
                        <thead>
                            <tr>
                                <th>è„…å¨</th>
                                <th>èª¬æ˜</th>
                                <th>å¯¾ç­–</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>XSSï¼ˆã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒ†ã‚£ãƒ³ã‚°ï¼‰</td>
                                <td>æ‚ªæ„ã®ã‚ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆæ³¨å…¥</td>
                                <td>å…¥åŠ›å€¤ã®æ¤œè¨¼ã€HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°</td>
                            </tr>
                            <tr>
                                <td>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³</td>
                                <td>SQLã‚¯ã‚¨ãƒªã®ä¸æ­£æ“ä½œ</td>
                                <td>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨</td>
                            </tr>
                            <tr>
                                <td>CSRFï¼ˆã‚¯ãƒ­ã‚¹ã‚µã‚¤ãƒˆãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ•ã‚©ãƒ¼ã‚¸ã‚§ãƒªï¼‰</td>
                                <td>ãªã‚Šã™ã¾ã—ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</td>
                                <td>ViewStateã®æ´»ç”¨ã€ãƒˆãƒ¼ã‚¯ãƒ³æ¤œè¨¼</td>
                            </tr>
                            <tr>
                                <td>ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯</td>
                                <td>ã‚»ãƒƒã‚·ãƒ§ãƒ³IDã®ç›—ç”¨</td>
                                <td>HTTPSä½¿ç”¨ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-4: XSSå¯¾ç­–ã¨HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°</h5>
                        <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ãƒ‡ãƒ¼ã‚¿ã®é©åˆ‡ãªå‡¦ç†ã¨XSSæ”»æ’ƒå¯¾ç­–ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>å®‰å…¨ãªå‡ºåŠ›å‡¦ç†ï¼ˆVB.NETï¼‰</h6>
                        <pre class="code-block"><code class="language-vbnet">' å±é™ºãªå‡¦ç†ï¼ˆXSSè„†å¼±æ€§ã‚ã‚Šï¼‰
lblUnsafe.Text = Request.QueryString("message")

' å®‰å…¨ãªå‡¦ç†ï¼ˆHTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼‰
lblSafe.Text = Server.HtmlEncode(Request.QueryString("message"))

' ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®æ¤œè¨¼
Protected Sub btnSubmit_Click(sender As Object, e As EventArgs) Handles btnSubmit.Click
    Dim userInput As String = txtUserInput.Text
    
    ' å…¥åŠ›å€¤æ¤œè¨¼ï¼ˆé•·ã•ãƒã‚§ãƒƒã‚¯ï¼‰
    If userInput.Length > 100 Then
        lblError.Text = "å…¥åŠ›ãŒé•·ã™ãã¾ã™ã€‚"
        Return
    End If
    
    ' å±é™ºãªæ–‡å­—ã®é™¤å»
    userInput = userInput.Replace("&lt;script", "").Replace("javascript:", "")
    
    ' HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦å®‰å…¨ã«è¡¨ç¤º
    lblResult.Text = Server.HtmlEncode(userInput)
End Sub

' ValidatorControlsã‚’ä½¿ç”¨ã—ãŸæ¤œè¨¼
Protected Sub CustomValidator1_ServerValidate(source As Object, args As ServerValidateEventArgs) Handles CustomValidator1.ServerValidate
    ' ã‚«ã‚¹ã‚¿ãƒ æ¤œè¨¼ãƒ­ã‚¸ãƒƒã‚¯
    Dim input As String = args.Value
    
    ' SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã®åŸºæœ¬ãƒã‚§ãƒƒã‚¯
    If input.Contains("'") OrElse input.Contains("--") OrElse input.Contains("DROP") Then
        args.IsValid = False
    Else
        args.IsValid = True
    End If
End Sub</code></pre>
                    </div>

                    <h3 class="section-title">9.5 ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¼·åŒ–</h3>
                    <p>ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å¼·åŒ–ã¨HTTPSé€šä¿¡ã®å®Ÿè£…ã«ã¤ã„ã¦å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-5: ã‚»ã‚­ãƒ¥ã‚¢ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®å®Ÿè£…</h5>
                        <p>ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è¨­å®šã¨HTTPSå¼·åˆ¶ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>Web.configã§ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š</h6>
                        <pre class="code-block"><code class="language-html">&lt;system.web&gt;
  &lt;sessionState 
    mode="InProc"
    timeout="20"
    cookieless="false"
    cookieTimeout="20"
    cookieName="ASP.NET_SessionId"
    cookieSameSite="Strict"
    httpOnlyCookies="true"
    useHostingIdentity="false"
    regenerateExpiredSessionId="true" /&gt;
    
  &lt;httpCookies httpOnlyCookies="true" requireSSL="true" /&gt;
  
  &lt;compilation debug="false" targetFramework="4.8" /&gt;
&lt;/system.web&gt;</code></pre>
                        <h6>ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆç®¡ç†ï¼ˆVB.NETï¼‰</h6>
                        <pre class="code-block"><code class="language-vbnet">Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    ' ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆãƒã‚§ãƒƒã‚¯
    If Session("UserID") Is Nothing Then
        Response.Redirect("~/Login.aspx?timeout=true")
    End If
    
    ' ã‚»ãƒƒã‚·ãƒ§ãƒ³æ›´æ–°
    Session("LastActivity") = DateTime.Now
End Sub

Protected Sub Application_PreSendRequestHeaders(sender As Object, e As EventArgs)
    ' ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ã®è¿½åŠ 
    Response.Headers.Remove("Server")
    Response.Headers.Add("X-Content-Type-Options", "nosniff")
    Response.Headers.Add("X-Frame-Options", "DENY")
    Response.Headers.Add("X-XSS-Protection", "1; mode=block")
End Sub</code></pre>
                    </div>

                    <div class="security-note">
                        <h6>ğŸ” ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h6>
                        <ul>
                            <li><strong>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–</strong>: å¹³æ–‡ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ä¿å­˜ã¯çµ¶å¯¾ã«ç¦æ­¢</li>
                            <li><strong>å¼·åº¦è¦ä»¶</strong>: æœ€å°8æ–‡å­—ã€è‹±æ•°å­—è¨˜å·ã®çµ„ã¿åˆã‚ã›</li>
                            <li><strong>ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯</strong>: é€£ç¶šãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä¸€æ™‚åœæ­¢</li>
                            <li><strong>å®šæœŸçš„ãªå¤‰æ›´ä¿ƒé€²</strong>: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æœ‰åŠ¹æœŸé™ã®è¨­å®š</li>
                        </ul>
                    </div>

                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>èªè¨¼ï¼ˆAuthenticationï¼‰ã¨èªå¯ï¼ˆAuthorizationï¼‰ã®é•ã„ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>ASP.NETãƒ¡ãƒ³ãƒãƒ¼ã‚·ãƒƒãƒ—ã‚·ã‚¹ãƒ†ãƒ ã®ä¸»è¦ãªè¨­å®šé …ç›®ã‚’3ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>XSSæ”»æ’ƒã‚’é˜²ããŸã‚ã®VB.NETã§ã®ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°æ‰‹æ³•ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã§ã€ŒAdministratorã€ãƒ­ãƒ¼ãƒ«ã®ã¿ã«ã‚¢ã‚¯ã‚»ã‚¹ã‚’è¨±å¯ã™ã‚‹Web.configè¨­å®šã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</li>
                            <li>ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒã‚¤ã‚¸ãƒ£ãƒƒã‚¯å¯¾ç­–ã¨ã—ã¦å®Ÿè£…ã™ã¹ãè¨­å®šã‚’3ã¤èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li><strong>èªè¨¼</strong>ï¼šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª°ã‹ã‚’ç¢ºèªã™ã‚‹å‡¦ç†ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ï¼‰ã€‚<strong>èªå¯</strong>ï¼šèªè¨¼ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèªã™ã‚‹å‡¦ç†ï¼ˆç®¡ç†è€…ç”»é¢ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ãªã©ï¼‰ã€‚</li>
                                <li>connectionStringNameï¼ˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šï¼‰ã€passwordFormatï¼ˆãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å½¢å¼ï¼‰ã€minRequiredPasswordLengthï¼ˆæœ€å°ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é•·ï¼‰</li>
                                <li>Server.HtmlEncode()ã‚’ä½¿ç”¨ã—ã¦ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã‚’HTMLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã€ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚¿ã‚°ã®å®Ÿè¡Œã‚’é˜²ã</li>
                                <li>
                                    <pre>&lt;location path="Admin"&gt;
  &lt;system.web&gt;
    &lt;authorization&gt;
      &lt;allow roles="Administrator" /&gt;
      &lt;deny users="*" /&gt;
    &lt;/authorization&gt;
  &lt;/system.web&gt;
&lt;/location&gt;</pre>
                                </li>
                                <li>HTTPSé€šä¿¡ã®å¼·åˆ¶ã€httpOnlyCookiesã®æœ‰åŠ¹åŒ–ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®é©åˆ‡ãªè¨­å®š</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-8.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="aspnet-vb-learning-material-10.html" class="btn btn-primary">æ¬¡ã®ç«  â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Highlight.js åˆæœŸåŒ– -->
    <script>hljs.highlightAll();</script>
</body>
</html>