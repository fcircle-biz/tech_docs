<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第3章 - 制御構造とプロシージャ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #5c6bc0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #5c6bc0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #5c6bc0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #7986cb;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        .quiz-container {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #5c6bc0;
        }
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .nav-link.active {
            background-color: #5c6bc0 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>VB.NET学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-1.html">
                                第1章: VB.NET入門と開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-2.html">
                                第2章: VB.NET基本文法
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="vbnet-learning-material-3.html">
                                第3章: 制御構造とプロシージャ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-4.html">
                                第4章: 配列とコレクション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-5.html">
                                第5章: オブジェクト指向プログラミング基礎
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-6.html">
                                第6章: オブジェクト指向プログラミング応用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-7.html">
                                第7章: 例外処理とデバッグ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-8.html">
                                第8章: ファイル操作と文字列処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-9.html">
                                第9章: .NET Frameworkライブラリ活用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-10.html">
                                第10章: 実践的なアプリケーション開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: 制御構造とプロシージャ</h1>
                </div>

                <div id="chapter3">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">プログラムの流れを制御する</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>条件分岐（If文、Select Case文）の使い方を習得する</li>
                            <li>繰り返し処理（For文、While文、Do文）を理解する</li>
                            <li>サブルーチン（Subプロシージャ）の概念と作成方法を学ぶ</li>
                            <li>関数（Functionプロシージャ）の使い方と戻り値の扱いを理解する</li>
                            <li>パラメータの受け渡し方法を習得する</li>
                            <li>プロシージャの活用によるコードの構造化を学ぶ</li>
                        </ul>
                    </div>

                    <!-- セクション1: 条件分岐の概念 -->
                    <h3 class="section-title">3.1 条件分岐とは</h3>
                    
                    <p>
                        <strong>条件分岐</strong>とは、プログラムの実行中に条件に応じて処理を変更する仕組みです。日常生活でも「雨が降っていたら傘を持つ、晴れていたら傘は持たない」といった条件による判断を行っています。プログラムでも同様の判断ロジックを実装できます。
                    </p>

                    <h4>条件分岐を使用する場面</h4>
                    <ul>
                        <li><strong>ユーザー入力の検証</strong>: 有効な値が入力されているか確認</li>
                        <li><strong>権限チェック</strong>: ユーザーが特定の操作を実行できるか判定</li>
                        <li><strong>エラーハンドリング</strong>: 異常な状態に応じた適切な処理</li>
                        <li><strong>ビジネスロジック</strong>: 業務ルールに基づいた分岐処理</li>
                        <li><strong>設定による動作変更</strong>: 設定値に応じた処理の切り替え</li>
                    </ul>

                    <!-- セクション2: If文 -->
                    <h3 class="section-title">3.2 If文による条件分岐</h3>
                    
                    <p>
                        <strong>If文</strong>は、最も基本的な条件分岐の構文です。条件式がTrueの場合とFalseの場合で異なる処理を実行できます。
                    </p>

                    <h4>If文の基本構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 基本のIf文
If 条件式 Then
    ' 条件がTrueの時の処理
End If

' If-Else文
If 条件式 Then
    ' 条件がTrueの時の処理
Else
    ' 条件がFalseの時の処理
End If

' If-ElseIf-Else文
If 条件式1 Then
    ' 条件式1がTrueの時の処理
ElseIf 条件式2 Then
    ' 条件式2がTrueの時の処理
Else
    ' すべての条件がFalseの時の処理
End If</code></pre>

                    <h4>具体的な使用例</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim score As Integer = 85
        
        If score >= 90 Then
            Console.WriteLine("優秀です！")
        ElseIf score >= 80 Then
            Console.WriteLine("良好です")
        ElseIf score >= 70 Then
            Console.WriteLine("普通です")
        ElseIf score >= 60 Then
            Console.WriteLine("もう少し頑張りましょう")
        Else
            Console.WriteLine("再試験が必要です")
        End If
    End Sub
End Module</code></pre>

                    <!-- 実習課題1 -->
                    <div class="exercise-container">
                        <h5>実習 3-1: 温度による服装判定プログラム</h5>
                        <p>気温に応じて適切な服装を判定するプログラムを作成しましょう。</p>
                        
                        <h6>仕様</h6>
                        <ul>
                            <li>30度以上: "半袖とサンダルがおすすめ"</li>
                            <li>25度以上: "半袖で過ごしやすい"</li>
                            <li>20度以上: "長袖が適している"</li>
                            <li>15度以上: "軽いジャケットが必要"</li>
                            <li>10度以上: "厚手のコートが必要"</li>
                            <li>10度未満: "防寒対策をしっかりと"</li>
                        </ul>
                        
                        <h6>サンプルコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim temperature As Integer = 22
        
        Console.WriteLine("今日の気温: " & temperature & "度")
        Console.Write("服装のアドバイス: ")
        
        If temperature >= 30 Then
            Console.WriteLine("半袖とサンダルがおすすめ")
        ElseIf temperature >= 25 Then
            Console.WriteLine("半袖で過ごしやすい")
        ElseIf temperature >= 20 Then
            Console.WriteLine("長袖が適している")
        ElseIf temperature >= 15 Then
            Console.WriteLine("軽いジャケットが必要")
        ElseIf temperature >= 10 Then
            Console.WriteLine("厚手のコートが必要")
        Else
            Console.WriteLine("防寒対策をしっかりと")
        End If
        
        Console.ReadKey()
    End Sub
End Module</code></pre>
                    </div>

                    <!-- セクション3: Select Case文 -->
                    <h3 class="section-title">3.3 Select Case文による多重分岐</h3>
                    
                    <p>
                        <strong>Select Case文</strong>は、一つの変数や式の値に応じて複数の処理を選択する場合に使用します。多数のElseIfを使うより読みやすく、効率的です。
                    </p>

                    <h4>Select Case文の構文</h4>
                    <pre class="code-block"><code class="language-vbnet">Select Case 変数または式
    Case 値1
        ' 値1に該当する処理
    Case 値2, 値3
        ' 値2または値3に該当する処理
    Case 値4 To 値5
        ' 値4から値5の範囲に該当する処理
    Case Is > 値6
        ' 値6より大きい場合の処理
    Case Else
        ' どのCaseにも該当しない場合の処理
End Select</code></pre>

                    <h4>実用的な例：曜日判定</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim dayOfWeek As Integer = DateTime.Now.DayOfWeek
        Dim message As String
        
        Select Case dayOfWeek
            Case 0
                message = "日曜日 - ゆっくり休む日"
            Case 1
                message = "月曜日 - 新しい週の始まり"
            Case 2, 3, 4
                message = "平日 - 仕事や勉強に集中"
            Case 5
                message = "金曜日 - 週末が待ち遠しい"
            Case 6
                message = "土曜日 - 趣味の時間"
            Case Else
                message = "不明な曜日"
        End Select
        
        Console.WriteLine(message)
    End Sub
End Module</code></pre>

                    <!-- セクション4: 繰り返し処理の概念 -->
                    <h3 class="section-title">3.4 繰り返し処理（ループ）とは</h3>
                    
                    <p>
                        <strong>繰り返し処理（ループ）</strong>は、同じ処理を複数回実行するための仕組みです。手作業で同じ処理を何度も書く代わりに、ループを使うことで効率的にプログラムを作成できます。
                    </p>

                    <h4>ループが活用される場面</h4>
                    <ul>
                        <li><strong>データ処理</strong>: リストや配列の全要素に対する処理</li>
                        <li><strong>計算処理</strong>: 合計、平均、最大値などの算出</li>
                        <li><strong>ファイル処理</strong>: ファイルの全行読み込み</li>
                        <li><strong>ユーザー入力</strong>: 有効な値が入力されるまでの反復</li>
                        <li><strong>レポート生成</strong>: 複数のデータを順次処理</li>
                    </ul>

                    <div class="mermaid">
                        graph TD
                            A["ループ開始"] --> B["条件チェック"]
                            B -->|条件True| C["処理実行"]
                            C --> D["カウンタ更新"]
                            D --> B
                            B -->|条件False| E["ループ終了"]
                            
                            style A fill:#e8f5e8
                            style B fill:#fff3e0
                            style C fill:#e1f5fe
                            style D fill:#f3e5f5
                            style E fill:#fce4ec
                    </div>

                    <!-- セクション5: For文 -->
                    <h3 class="section-title">3.5 For文による回数指定ループ</h3>
                    
                    <p>
                        <strong>For文</strong>は、繰り返し回数が決まっている場合に使用する最も一般的なループです。開始値から終了値まで、指定した間隔で変数を変化させながら処理を実行します。
                    </p>

                    <h4>For文の基本構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 基本のFor文
For カウンタ変数 = 開始値 To 終了値
    ' 繰り返し処理
Next カウンタ変数

' ステップ指定のFor文
For カウンタ変数 = 開始値 To 終了値 Step 増減値
    ' 繰り返し処理
Next カウンタ変数</code></pre>

                    <h4>様々なFor文の例</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        ' 基本的なFor文（1から5まで）
        Console.WriteLine("=== 基本のFor文 ===")
        For i As Integer = 1 To 5
            Console.WriteLine("回数: " & i)
        Next i
        
        ' ステップを指定（2から10まで2間隔）
        Console.WriteLine(vbCrLf & "=== ステップ指定 ===")
        For i As Integer = 2 To 10 Step 2
            Console.WriteLine("偶数: " & i)
        Next i
        
        ' 逆順（10から1まで-1間隔）
        Console.WriteLine(vbCrLf & "=== 逆順ループ ===")
        For i As Integer = 10 To 1 Step -1
            Console.WriteLine("カウントダウン: " & i)
        Next i
        
        ' 実用例：合計計算
        Console.WriteLine(vbCrLf & "=== 合計計算 ===")
        Dim sum As Integer = 0
        For i As Integer = 1 To 100
            sum += i
        Next i
        Console.WriteLine("1から100までの合計: " & sum)
        
        Console.ReadKey()
    End Sub
End Module</code></pre>

                    <!-- セクション6: While文とDo文 -->
                    <h3 class="section-title">3.6 While文とDo文による条件ループ</h3>
                    
                    <p>
                        <strong>While文</strong>と<strong>Do文</strong>は、条件が満たされる間、繰り返し処理を実行するループです。For文と異なり、繰り返し回数があらかじめ決まっていない場合に使用します。
                    </p>

                    <h4>While文の構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' While文
While 条件式
    ' 条件がTrueの間繰り返される処理
End While</code></pre>

                    <h4>Do文の構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' Do While文（条件を先にチェック）
Do While 条件式
    ' 条件がTrueの間繰り返される処理
Loop

' Do Until文（条件が偽の間継続）
Do Until 条件式
    ' 条件がFalseの間繰り返される処理
Loop

' Do Loop While文（条件を後でチェック）
Do
    ' 最低1回は実行される処理
Loop While 条件式</code></pre>

                    <h4>実用例：入力検証</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim userInput As String
        Dim number As Integer
        Dim isValid As Boolean = False
        
        ' 有効な数値が入力されるまで繰り返し
        Console.WriteLine("1から10の間の数値を入力してください:")
        
        Do While Not isValid
            Console.Write("数値を入力: ")
            userInput = Console.ReadLine()
            
            If Integer.TryParse(userInput, number) Then
                If number >= 1 And number <= 10 Then
                    isValid = True
                    Console.WriteLine("正しい入力です: " & number)
                Else
                    Console.WriteLine("1から10の間で入力してください。")
                End If
            Else
                Console.WriteLine("数値を入力してください。")
            End If
        Loop
        
        Console.ReadKey()
    End Sub
End Module</code></pre>

                    <!-- 実習課題2 -->
                    <div class="exercise-container">
                        <h5>実習 3-2: 数当てゲーム</h5>
                        <p>コンピュータが生成した1-100の乱数を当てるゲームを作成しましょう。</p>
                        
                        <h6>仕様</h6>
                        <ul>
                            <li>コンピュータが1-100の範囲でランダムな数を生成</li>
                            <li>ユーザーに数値の入力を促す</li>
                            <li>入力値が答えより大きいか小さいかをヒントとして表示</li>
                            <li>正解まで繰り返し、試行回数を表示</li>
                        </ul>
                        
                        <h6>サンプルコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim random As New Random()
        Dim answer As Integer = random.Next(1, 101)
        Dim userGuess As Integer
        Dim attempts As Integer = 0
        Dim isCorrect As Boolean = False
        
        Console.WriteLine("=== 数当てゲーム ===")
        Console.WriteLine("1から100の間の数を当ててください！")
        
        Do While Not isCorrect
            Console.Write("あなたの予想: ")
            Dim input As String = Console.ReadLine()
            attempts += 1
            
            If Integer.TryParse(input, userGuess) Then
                If userGuess = answer Then
                    isCorrect = True
                    Console.WriteLine("正解です！ 答えは " & answer & " でした。")
                    Console.WriteLine("試行回数: " & attempts & "回")
                ElseIf userGuess < answer Then
                    Console.WriteLine("もっと大きい数です。")
                Else
                    Console.WriteLine("もっと小さい数です。")
                End If
            Else
                Console.WriteLine("有効な数値を入力してください。")
                attempts -= 1  ' 無効な入力は回数に含めない
            End If
        Loop
        
        Console.WriteLine("ゲーム終了！お疲れ様でした。")
        Console.ReadKey()
    End Sub
End Module</code></pre>
                    </div>

                    <!-- セクション7: プロシージャの概念 -->
                    <h3 class="section-title">3.7 プロシージャとは</h3>
                    
                    <p>
                        <strong>プロシージャ</strong>は、特定の処理をまとめた再利用可能なコードブロックです。プログラムを機能ごとに分割することで、コードの読みやすさ、保守性、再利用性が向上します。
                    </p>

                    <h4>プロシージャを使用する利点</h4>
                    <ul>
                        <li><strong>コードの再利用</strong>: 同じ処理を複数箇所で使用可能</li>
                        <li><strong>保守性の向上</strong>: 機能の修正が一箇所で済む</li>
                        <li><strong>可読性の向上</strong>: プログラムの構造が明確になる</li>
                        <li><strong>デバッグの容易さ</strong>: 問題のある処理を特定しやすい</li>
                        <li><strong>チーム開発</strong>: 機能を分担して開発可能</li>
                    </ul>

                    <h4>プロシージャの種類</h4>
                    <div class="mermaid">
                        graph TD
                            A["VB.NETプロシージャ"] --> B["Subプロシージャ<br/>(処理のみ)"]
                            A --> C["Functionプロシージャ<br/>(戻り値あり)"]
                            
                            B --> D["値を返さない"]
                            B --> E["処理の実行"]
                            B --> F["状態の変更"]
                            
                            C --> G["値を返す"]
                            C --> H["計算結果"]
                            C --> I["判定結果"]
                            
                            style A fill:#e1f5fe
                            style B fill:#e8f5e8
                            style C fill:#fff3e0
                    </div>

                    <!-- セクション8: Subプロシージャ -->
                    <h3 class="section-title">3.8 Subプロシージャ（サブルーチン）</h3>
                    
                    <p>
                        <strong>Subプロシージャ</strong>は、値を返さない処理をまとめたプロシージャです。特定のタスクを実行し、処理が完了すると呼び出し元に戻ります。
                    </p>

                    <h4>Subプロシージャの構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 基本的なSubプロシージャ
Sub プロシージャ名()
    ' 処理内容
End Sub

' パラメータ付きSubプロシージャ
Sub プロシージャ名(パラメータ1 As データ型, パラメータ2 As データ型)
    ' 処理内容
End Sub

' 呼び出し方
プロシージャ名()
プロシージャ名(引数1, 引数2)</code></pre>

                    <h4>実用例：挨拶メッセージ</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        ' Subプロシージャの呼び出し
        ShowWelcomeMessage()
        ShowPersonalizedMessage("田中さん")
        ShowDetailedMessage("佐藤さん", 25)
        
        Console.ReadKey()
    End Sub
    
    ' パラメータなしのSubプロシージャ
    Sub ShowWelcomeMessage()
        Console.WriteLine("=== システムへようこそ ===")
        Console.WriteLine("このプログラムをお使いいただき、ありがとうございます。")
        Console.WriteLine()
    End Sub
    
    ' パラメータ1つのSubプロシージャ
    Sub ShowPersonalizedMessage(name As String)
        Console.WriteLine("こんにちは、" & name & "！")
        Console.WriteLine("今日も一日頑張りましょう。")
        Console.WriteLine()
    End Sub
    
    ' 複数パラメータのSubプロシージャ
    Sub ShowDetailedMessage(name As String, age As Integer)
        Console.WriteLine("ユーザー情報:")
        Console.WriteLine("お名前: " & name)
        Console.WriteLine("年齢: " & age & "歳")
        
        If age >= 20 Then
            Console.WriteLine("成人の方ですね。")
        Else
            Console.WriteLine("未成年の方ですね。")
        End If
        Console.WriteLine()
    End Sub
End Module</code></pre>

                    <!-- セクション9: Functionプロシージャ -->
                    <h3 class="section-title">3.9 Functionプロシージャ（関数）</h3>
                    
                    <p>
                        <strong>Functionプロシージャ</strong>は、処理を実行し、その結果を戻り値として返すプロシージャです。計算処理や判定処理に適しています。
                    </p>

                    <h4>Functionプロシージャの構文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 基本的なFunctionプロシージャ
Function プロシージャ名() As 戻り値の型
    ' 処理内容
    Return 戻り値
End Function

' パラメータ付きFunctionプロシージャ
Function プロシージャ名(パラメータ1 As データ型) As 戻り値の型
    ' 処理内容
    Return 戻り値
End Function

' 呼び出しと結果の受け取り
Dim result As データ型 = プロシージャ名()
Dim value As データ型 = プロシージャ名(引数)</code></pre>

                    <h4>実用例：計算と判定の関数</h4>
                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        ' Functionプロシージャの使用例
        Dim radius As Double = 5.0
        Dim area As Double = CalculateCircleArea(radius)
        Console.WriteLine("半径 " & radius & " の円の面積: " & area.ToString("F2"))
        
        Dim temperature As Integer = 25
        Dim comfort As String = GetComfortLevel(temperature)
        Console.WriteLine("気温 " & temperature & "度: " & comfort)
        
        Dim price As Decimal = 1000
        Dim finalPrice As Decimal = CalculateFinalPrice(price, True)
        Console.WriteLine("最終価格: " & finalPrice.ToString("C"))
        
        Console.ReadKey()
    End Sub
    
    ' 円の面積を計算するFunction
    Function CalculateCircleArea(radius As Double) As Double
        Const PI As Double = 3.14159
        Return PI * radius * radius
    End Function
    
    ' 温度による快適さを判定するFunction
    Function GetComfortLevel(temperature As Integer) As String
        If temperature >= 25 And temperature <= 28 Then
            Return "快適"
        ElseIf temperature >= 20 And temperature < 25 Then
            Return "やや涼しい"
        ElseIf temperature > 28 And temperature <= 32 Then
            Return "やや暑い"
        ElseIf temperature > 32 Then
            Return "暑い"
        Else
            Return "寒い"
        End If
    End Function
    
    ' 税込み価格を計算するFunction（会員割引あり）
    Function CalculateFinalPrice(basePrice As Decimal, isMember As Boolean) As Decimal
        Const TAX_RATE As Decimal = 0.1D
        Const MEMBER_DISCOUNT_RATE As Decimal = 0.05D
        
        Dim discountedPrice As Decimal = basePrice
        If isMember Then
            discountedPrice = basePrice * (1 - MEMBER_DISCOUNT_RATE)
        End If
        
        Return discountedPrice * (1 + TAX_RATE)
    End Function
End Module</code></pre>

                    <!-- セクション10: パラメータの受け渡し -->
                    <h3 class="section-title">3.10 パラメータの受け渡し方法</h3>
                    
                    <p>
                        VB.NETでは、プロシージャにデータを渡す方法として<strong>値渡し（ByVal）</strong>と<strong>参照渡し（ByRef）</strong>があります。それぞれ異なる特性を持っています。
                    </p>

                    <h4>値渡し（ByVal）と参照渡し（ByRef）</h4>
                    <table class="table table-bordered">
                        <thead class="table-primary">
                            <tr>
                                <th>項目</th>
                                <th>ByVal（値渡し）</th>
                                <th>ByRef（参照渡し）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>渡されるもの</strong></td>
                                <td>値のコピー</td>
                                <td>変数自体への参照</td>
                            </tr>
                            <tr>
                                <td><strong>プロシージャ内での変更</strong></td>
                                <td>元の変数に影響しない</td>
                                <td>元の変数に影響する</td>
                            </tr>
                            <tr>
                                <td><strong>メモリ使用量</strong></td>
                                <td>コピーを作成するため多め</td>
                                <td>参照のみなので少なめ</td>
                            </tr>
                            <tr>
                                <td><strong>安全性</strong></td>
                                <td>元データが変更されない</td>
                                <td>意図しない変更の可能性</td>
                            </tr>
                            <tr>
                                <td><strong>デフォルト</strong></td>
                                <td>VB.NETのデフォルト</td>
                                <td>明示的に指定が必要</td>
                            </tr>
                        </tbody>
                    </table>

                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim originalValue As Integer = 10
        
        Console.WriteLine("=== 値渡し（ByVal）の例 ===")
        Console.WriteLine("呼び出し前: " & originalValue)
        ModifyByValue(originalValue)
        Console.WriteLine("呼び出し後: " & originalValue) ' 変更されない
        
        Console.WriteLine()
        Console.WriteLine("=== 参照渡し（ByRef）の例 ===")
        Console.WriteLine("呼び出し前: " & originalValue)
        ModifyByReference(originalValue)
        Console.WriteLine("呼び出し後: " & originalValue) ' 変更される
        
        Console.ReadKey()
    End Sub
    
    ' ByVal（値渡し）- デフォルト
    Sub ModifyByValue(ByVal value As Integer)
        value = value * 2
        Console.WriteLine("プロシージャ内: " & value)
    End Sub
    
    ' ByRef（参照渡し）- 明示的に指定
    Sub ModifyByReference(ByRef value As Integer)
        value = value * 2
        Console.WriteLine("プロシージャ内: " & value)
    End Sub
End Module</code></pre>

                    <!-- 実習課題3 -->
                    <div class="exercise-container">
                        <h5>実習 3-3: 学生成績管理システム</h5>
                        <p>複数のプロシージャを使って、学生の成績を管理するシステムを作成しましょう。</p>
                        
                        <h6>要求機能</h6>
                        <ul>
                            <li>学生情報の表示（Sub）</li>
                            <li>成績の平均計算（Function）</li>
                            <li>成績評価の判定（Function）</li>
                            <li>複数科目の合計計算（Function）</li>
                        </ul>
                        
                        <h6>サンプルコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Dim studentName As String = "田中太郎"
        Dim mathScore As Integer = 85
        Dim englishScore As Integer = 78
        Dim scienceScore As Integer = 92
        
        ' 学生情報の表示
        ShowStudentInfo(studentName)
        
        ' 各科目の成績表示と評価
        ShowSubjectResult("数学", mathScore)
        ShowSubjectResult("英語", englishScore)
        ShowSubjectResult("理科", scienceScore)
        
        ' 平均点の計算と表示
        Dim average As Double = CalculateAverage(mathScore, englishScore, scienceScore)
        Console.WriteLine("平均点: " & average.ToString("F1") & "点")
        
        ' 総合評価
        Dim overallGrade As String = GetOverallGrade(average)
        Console.WriteLine("総合評価: " & overallGrade)
        
        ' 合計点
        Dim totalScore As Integer = CalculateTotal(mathScore, englishScore, scienceScore)
        Console.WriteLine("合計点: " & totalScore & "点")
        
        Console.ReadKey()
    End Sub
    
    ' 学生情報表示（Sub）
    Sub ShowStudentInfo(studentName As String)
        Console.WriteLine("=== 成績表 ===")
        Console.WriteLine("学生名: " & studentName)
        Console.WriteLine("---------------")
    End Sub
    
    ' 科目結果表示（Sub）
    Sub ShowSubjectResult(subjectName As String, score As Integer)
        Dim grade As String = GetGradeFromScore(score)
        Console.WriteLine(subjectName & ": " & score & "点 (" & grade & ")")
    End Sub
    
    ' スコアから評価を取得（Function）
    Function GetGradeFromScore(score As Integer) As String
        If score >= 90 Then
            Return "A"
        ElseIf score >= 80 Then
            Return "B"
        ElseIf score >= 70 Then
            Return "C"
        ElseIf score >= 60 Then
            Return "D"
        Else
            Return "F"
        End If
    End Function
    
    ' 平均計算（Function）
    Function CalculateAverage(score1 As Integer, score2 As Integer, score3 As Integer) As Double
        Return (score1 + score2 + score3) / 3.0
    End Function
    
    ' 総合評価（Function）
    Function GetOverallGrade(average As Double) As String
        If average >= 90 Then
            Return "優秀"
        ElseIf average >= 80 Then
            Return "良好"
        ElseIf average >= 70 Then
            Return "普通"
        ElseIf average >= 60 Then
            Return "要努力"
        Else
            Return "要補習"
        End If
    End Function
    
    ' 合計計算（Function）
    Function CalculateTotal(score1 As Integer, score2 As Integer, score3 As Integer) As Integer
        Return score1 + score2 + score3
    End Function
End Module</code></pre>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>If文の構文で正しいのはどれでしょうか？</strong><br>
                                a) If (条件) { 処理 }<br>
                                b) If 条件 Then 処理 End If<br>
                                c) if 条件: 処理<br>
                                d) If 条件 Do 処理 End
                            </li>
                            <li>
                                <strong>Select Case文で範囲を指定する記述は？</strong><br>
                                a) Case 1-5<br>
                                b) Case 1...5<br>
                                c) Case 1 To 5<br>
                                d) Case 1:5
                            </li>
                            <li>
                                <strong>For文で逆順にカウントするには？</strong><br>
                                a) For i = 10 To 1<br>
                                b) For i = 10 To 1 Step -1<br>
                                c) For i = 10 Down To 1<br>
                                d) For i = 1 To 10 Reverse
                            </li>
                            <li>
                                <strong>Functionプロシージャの特徴は？</strong><br>
                                a) 値を返さない<br>
                                b) 値を返す<br>
                                c) パラメータを受け取れない<br>
                                d) 1回しか呼び出せない
                            </li>
                            <li>
                                <strong>VB.NETのデフォルトのパラメータ受け渡し方法は？</strong><br>
                                a) ByRef<br>
                                b) ByVal<br>
                                c) ByValue<br>
                                d) ByReference
                            </li>
                        </ol>
                        
                        <details>
                            <summary>解答を表示</summary>
                            <ol>
                                <li><strong>b) If 条件 Then 処理 End If</strong> - VB.NETのIf文は「If-Then-End If」の構文を使用します。</li>
                                <li><strong>c) Case 1 To 5</strong> - Select Case文では「To」キーワードで範囲を指定します。</li>
                                <li><strong>b) For i = 10 To 1 Step -1</strong> - 「Step -1」で逆順にカウントできます。</li>
                                <li><strong>b) 値を返す</strong> - Functionプロシージャは戻り値を持つのが特徴です。</li>
                                <li><strong>b) ByVal</strong> - VB.NETはデフォルトで値渡し（ByVal）を使用します。</li>
                            </ol>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">3.11 第3章のまとめ</h3>
                    
                    <div class="highlight">
                        <h5>この章で学んだこと</h5>
                        <ul>
                            <li><strong>条件分岐</strong>: If文とSelect Case文による処理の分岐</li>
                            <li><strong>繰り返し処理</strong>: For文、While文、Do文によるループ制御</li>
                            <li><strong>Subプロシージャ</strong>: 処理をまとめる再利用可能なコードブロック</li>
                            <li><strong>Functionプロシージャ</strong>: 値を返す関数の作成と使用</li>
                            <li><strong>パラメータ受け渡し</strong>: ByVal（値渡し）とByRef（参照渡し）の違い</li>
                            <li><strong>コード構造化</strong>: プロシージャを使ったプログラムの整理</li>
                        </ul>
                    </div>

                    <p>
                        第3章では、プログラムの流れを制御する重要な概念を学習しました。これらの制御構造とプロシージャの概念は、より複雑なプログラムを作成する際の基礎となります。次の第4章では、複数のデータを効率的に管理する配列とコレクションについて学習します。
                    </p>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-2.html" class="btn btn-secondary">← 前の章: VB.NET基本文法</a>
                        <a href="vbnet-learning-material-4.html" class="btn btn-primary">次の章: 配列とコレクション →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>