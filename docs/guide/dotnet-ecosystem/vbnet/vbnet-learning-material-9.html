<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NETå­¦ç¿’æ•™æ ç¬¬9ç«  - .NET Frameworkãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ´»ç”¨</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #0078d4; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #0078d4; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #0078d4; padding-bottom: 0.5rem; }
        .section-title { color: #2196F3; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e1f5fe; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #0078d4; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .nav-link.active { background-color: #0078d4 !important; color: white !important; }
        pre { background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 1rem; margin: 1rem 0; }
        code { background-color: #f8f9fa; padding: 0.2rem 0.4rem; border-radius: 3px; }
        .code-block { background-color: #1e1e1e; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="../README.md">VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-1.html">ç¬¬1ç« : VB.NETå…¥é–€</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-2.html">ç¬¬2ç« : åŸºæœ¬æ–‡æ³•</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-3.html">ç¬¬3ç« : åˆ¶å¾¡æ§‹é€ </a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-4.html">ç¬¬4ç« : é…åˆ—ã¨ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-5.html">ç¬¬5ç« : OOPåŸºç¤</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-6.html">ç¬¬6ç« : OOPå¿œç”¨</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-7.html">ç¬¬7ç« : ä¾‹å¤–å‡¦ç†</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-8.html">ç¬¬8ç« : ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ</a></li>
                        <li class="nav-item"><a class="nav-link active" href="#chapter9">ç¬¬9ç« : .NETãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬9ç« : .NET Frameworkãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ´»ç”¨</h1>
                </div>

                <div id="chapter9">
                    <h2 class="chapter-title">.NET Frameworkãƒ©ã‚¤ãƒ–ãƒ©ãƒªæ´»ç”¨</h2>
                    
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>DateTimeæ§‹é€ ä½“ã‚’ä½¿ç”¨ã—ãŸæ—¥ä»˜ãƒ»æ™‚åˆ»å‡¦ç†ã‚’ç¿’å¾—ã™ã‚‹</li>
                            <li>Mathã‚¯ãƒ©ã‚¹ã¨Randomã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹æ•°å­¦çš„æ“ä½œã‚’å­¦ç¿’ã™ã‚‹</li>
                            <li>LINQã‚’ä½¿ç”¨ã—ãŸãƒ‡ãƒ¼ã‚¿ã‚¯ã‚¨ãƒªå‡¦ç†ã‚’ç†è§£ã™ã‚‹</li>
                            <li>ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®æ¦‚å¿µã¨æ´»ç”¨æ–¹æ³•ã‚’å­¦ã¶</li>
                            <li>å®Ÿç”¨çš„ãª.NETãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’çµ„ã¿åˆã‚ã›ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">9.1 DateTimeæ§‹é€ ä½“</h3>
                    <p>æ—¥ä»˜ã¨æ™‚åˆ»ã®å‡¦ç†ã¯å¤šãã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§å¿…è¦ã«ãªã‚‹é‡è¦ãªæ©Ÿèƒ½ã§ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' ç¾åœ¨ã®æ—¥ä»˜ã¨æ™‚åˆ»
Dim now As DateTime = DateTime.Now
Console.WriteLine($"ç¾åœ¨æ—¥æ™‚: {now}")
Console.WriteLine($"ç¾åœ¨æ—¥ä»˜: {now.ToShortDateString()}")
Console.WriteLine($"ç¾åœ¨æ™‚åˆ»: {now.ToShortTimeString()}")

' ç‰¹å®šã®æ—¥ä»˜ã®ä½œæˆ
Dim specificDate As New DateTime(2024, 1, 1, 9, 30, 0)
Console.WriteLine($"æŒ‡å®šæ—¥æ™‚: {specificDate}")

' æ—¥ä»˜ã®è¨ˆç®—
Dim tomorrow As DateTime = now.AddDays(1)
Dim nextWeek As DateTime = now.AddDays(7)
Dim nextMonth As DateTime = now.AddMonths(1)
Dim nextYear As DateTime = now.AddYears(1)

Console.WriteLine($"æ˜æ—¥: {tomorrow.ToShortDateString()}")
Console.WriteLine($"æ¥é€±: {nextWeek.ToShortDateString()}")
Console.WriteLine($"æ¥æœˆ: {nextMonth.ToShortDateString()}")
Console.WriteLine($"æ¥å¹´: {nextYear.ToShortDateString()}")

' æ—¥ä»˜ã®æ¯”è¼ƒ
Dim date1 As New DateTime(2024, 1, 1)
Dim date2 As New DateTime(2024, 12, 31)

If date1 < date2 Then
    Console.WriteLine($"{date1.ToShortDateString()}ã¯{date2.ToShortDateString()}ã‚ˆã‚Šå‰ã§ã™")
End If

' æ—¥ä»˜ã®å·®ã‚’è¨ˆç®—
Dim span As TimeSpan = date2 - date1
Console.WriteLine($"æ—¥æ•°ã®å·®: {span.Days}æ—¥")</code></pre>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-1: å¹´é½¢è¨ˆç®—ãƒ»è¨˜å¿µæ—¥ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h5>
                        <p>DateTimeæ§‹é€ ä½“ã‚’æ´»ç”¨ã—ã¦ã€å¹´é½¢è¨ˆç®—ã‚„è¨˜å¿µæ—¥ã¾ã§ã®æ—¥æ•°ã‚’ç®¡ç†ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚</p>
                        <pre class="code-block"><code class="language-vbnet">Public Class Person
    Public Property Name As String
    Public Property BirthDate As DateTime
    
    Public Sub New(name As String, birthDate As DateTime)
        Me.Name = name
        Me.BirthDate = birthDate
    End Sub
    
    Public ReadOnly Property Age As Integer
        Get
            Dim today As DateTime = DateTime.Today
            Dim age As Integer = today.Year - BirthDate.Year
            
            ' èª•ç”Ÿæ—¥ãŒã¾ã æ¥ã¦ã„ãªã„å ´åˆã¯1ã‚’å¼•ã
            If today < BirthDate.AddYears(age) Then
                age -= 1
            End If
            
            Return age
        End Get
    End Property
    
    Public ReadOnly Property DaysUntilNextBirthday As Integer
        Get
            Dim today As DateTime = DateTime.Today
            Dim nextBirthday As DateTime = New DateTime(today.Year, BirthDate.Month, BirthDate.Day)
            
            ' ä»Šå¹´ã®èª•ç”Ÿæ—¥ãŒéãã¦ã„ã‚‹å ´åˆã¯æ¥å¹´ã®èª•ç”Ÿæ—¥ã‚’è¨ˆç®—
            If nextBirthday < today Then
                nextBirthday = nextBirthday.AddYears(1)
            End If
            
            Return (nextBirthday - today).Days
        End Get
    End Property
End Class

Module Module1
    Sub Main()
        ' äººç‰©ãƒ‡ãƒ¼ã‚¿ã®ä½œæˆ
        Dim people As New List(Of Person) From {
            New Person("ç”°ä¸­å¤ªéƒ", New DateTime(1990, 3, 15)),
            New Person("ä½è—¤èŠ±å­", New DateTime(1985, 7, 22)),
            New Person("éˆ´æœ¨ä¸€éƒ", New DateTime(2000, 11, 8)),
            New Person("é«˜æ©‹ç¾å’²", New DateTime(1995, 1, 30))
        }
        
        Console.WriteLine("=== å¹´é½¢ãƒ»èª•ç”Ÿæ—¥æƒ…å ± ===")
        For Each person As Person In people
            Console.WriteLine($"{person.Name}: {person.Age}æ­³")
            Console.WriteLine($"  èª•ç”Ÿæ—¥: {person.BirthDate.ToString("yyyyå¹´MMæœˆddæ—¥")}")
            Console.WriteLine($"  æ¬¡ã®èª•ç”Ÿæ—¥ã¾ã§: {person.DaysUntilNextBirthday}æ—¥")
            Console.WriteLine()
        Next
        
        ' è¨˜å¿µæ—¥ã®ç®¡ç†
        ManageAnniversaries()
        
        Console.ReadLine()
    End Sub
    
    Sub ManageAnniversaries()
        Console.WriteLine("=== è¨˜å¿µæ—¥ç®¡ç† ===")
        
        Dim anniversaries As New Dictionary(Of String, DateTime) From {
            {"æ–°å¹´", New DateTime(DateTime.Now.Year, 1, 1)},
            {"ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ãƒ‡ãƒ¼", New DateTime(DateTime.Now.Year, 2, 14)},
            {"ãƒ›ãƒ¯ã‚¤ãƒˆãƒ‡ãƒ¼", New DateTime(DateTime.Now.Year, 3, 14)},
            {"ã‚¯ãƒªã‚¹ãƒã‚¹", New DateTime(DateTime.Now.Year, 12, 25)}
        }
        
        Dim today As DateTime = DateTime.Today
        
        For Each anniversary As KeyValuePair(Of String, DateTime) In anniversaries
            Dim eventDate As DateTime = anniversary.Value
            
            ' ä»Šå¹´ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒéãã¦ã„ã‚‹å ´åˆã¯æ¥å¹´ã®ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¨ˆç®—
            If eventDate < today Then
                eventDate = eventDate.AddYears(1)
            End If
            
            Dim daysUntil As Integer = (eventDate - today).Days
            
            If daysUntil = 0 Then
                Console.WriteLine($"ğŸ‰ ä»Šæ—¥ã¯{anniversary.Key}ã§ã™ï¼")
            ElseIf daysUntil <= 30 Then
                Console.WriteLine($"ğŸ“… {anniversary.Key}ã¾ã§ã‚ã¨{daysUntil}æ—¥ã§ã™")
            End If
        Next
        
        ' ç¾åœ¨ã®å­£ç¯€ã‚’åˆ¤å®š
        Dim currentSeason As String = GetCurrentSeason(today)
        Console.WriteLine($"ç¾åœ¨ã®å­£ç¯€: {currentSeason}")
    End Sub
    
    Function GetCurrentSeason(currentDate As DateTime) As String
        Dim month As Integer = currentDate.Month
        
        Select Case month
            Case 3, 4, 5
                Return "æ˜¥"
            Case 6, 7, 8
                Return "å¤"
            Case 9, 10, 11
                Return "ç§‹"
            Case 12, 1, 2
                Return "å†¬"
            Case Else
                Return "ä¸æ˜"
        End Select
    End Function
End Module</code></pre>
                    </div>

                    <h3 class="section-title">9.2 Mathã‚¯ãƒ©ã‚¹ã¨Randomã‚¯ãƒ©ã‚¹</h3>
                    <p>æ•°å­¦çš„è¨ˆç®—ã¨ä¹±æ•°ç”Ÿæˆã®ãŸã‚ã®ä¾¿åˆ©ãªã‚¯ãƒ©ã‚¹ã§ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' Mathã‚¯ãƒ©ã‚¹ã®ä¸»è¦ãƒ¡ã‚½ãƒƒãƒ‰
Console.WriteLine("=== Math ã‚¯ãƒ©ã‚¹ ===")
Console.WriteLine($"å††å‘¨ç‡: {Math.PI}")
Console.WriteLine($"è‡ªç„¶å¯¾æ•°ã®åº•: {Math.E}")

Dim value As Double = -3.7
Console.WriteLine($"çµ¶å¯¾å€¤ |{value}|: {Math.Abs(value)}")
Console.WriteLine($"åˆ‡ã‚Šä¸Šã’: {Math.Ceiling(value)}")
Console.WriteLine($"åˆ‡ã‚Šæ¨ã¦: {Math.Floor(value)}")
Console.WriteLine($"å››æ¨äº”å…¥: {Math.Round(value)}")

Console.WriteLine($"2ã®3ä¹—: {Math.Pow(2, 3)}")
Console.WriteLine($"âˆš16: {Math.Sqrt(16)}")
Console.WriteLine($"æœ€å¤§å€¤ (5, 8): {Math.Max(5, 8)}")
Console.WriteLine($"æœ€å°å€¤ (5, 8): {Math.Min(5, 8)}")

' Randomã‚¯ãƒ©ã‚¹ã®ä½¿ç”¨
Console.WriteLine()
Console.WriteLine("=== Random ã‚¯ãƒ©ã‚¹ ===")
Dim random As New Random()

' åŸºæœ¬çš„ãªä¹±æ•°ç”Ÿæˆ
For i As Integer = 1 To 5
    Console.WriteLine($"ä¹±æ•° {i}: {random.Next()}")
Next

' ç¯„å›²æŒ‡å®šã®ä¹±æ•°
Console.WriteLine()
Console.WriteLine("1-10ã®ä¹±æ•°:")
For i As Integer = 1 To 5
    Console.WriteLine($"ä¹±æ•° {i}: {random.Next(1, 11)}")
Next

' æµ®å‹•å°æ•°ç‚¹ä¹±æ•°
Console.WriteLine()
Console.WriteLine("0.0-1.0ã®ä¹±æ•°:")
For i As Integer = 1 To 5
    Console.WriteLine($"ä¹±æ•° {i}: {random.NextDouble():F3}")
Next</code></pre>

                    <h3 class="section-title">9.3 LINQï¼ˆLanguage Integrated Queryï¼‰</h3>
                    <p>LINQã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«ã‚¯ã‚¨ãƒªã§ãã¾ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">Imports System.Linq

' ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
Dim numbers() As Integer = {1, 2, 3, 4, 5, 6, 7, 8, 9, 10}
Dim names() As String = {"Alice", "Bob", "Charlie", "Diana", "Eve"}

' LINQ ã‚¯ã‚¨ãƒªæ§‹æ–‡
Dim evens = From num In numbers Where num Mod 2 = 0 Select num
Console.WriteLine("å¶æ•°: " & String.Join(", ", evens))

' LINQ ãƒ¡ã‚½ãƒƒãƒ‰æ§‹æ–‡
Dim squares = numbers.Where(Function(n) n > 5).Select(Function(n) n * n)
Console.WriteLine("5ã‚ˆã‚Šå¤§ãã„æ•°ã®å¹³æ–¹: " & String.Join(", ", squares))

' é›†ç´„é–¢æ•°
Console.WriteLine($"åˆè¨ˆ: {numbers.Sum()}")
Console.WriteLine($"å¹³å‡: {numbers.Average():F2}")
Console.WriteLine($"æœ€å¤§å€¤: {numbers.Max()}")
Console.WriteLine($"æœ€å°å€¤: {numbers.Min()}")
Console.WriteLine($"è¦ç´ æ•°: {numbers.Count()}")

' æ¡ä»¶ä»˜ãé›†ç´„
Dim evenSum = numbers.Where(Function(n) n Mod 2 = 0).Sum()
Console.WriteLine($"å¶æ•°ã®åˆè¨ˆ: {evenSum}")

' æ–‡å­—åˆ—æ“ä½œã¨LINQ
Dim longNames = names.Where(Function(name) name.Length > 4)
Console.WriteLine("4æ–‡å­—ã‚ˆã‚Šé•·ã„åå‰: " & String.Join(", ", longNames))</code></pre>

                    <h3 class="section-title">9.4 ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹</h3>
                    <p>å‹å®‰å…¨æ€§ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸¡ç«‹ã™ã‚‹ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹ã®æ¦‚å¿µã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ã‚¯ãƒ©ã‚¹ã®å®šç¾©
Public Class Stack(Of T)
    Private items As New List(Of T)()
    
    Public Sub Push(item As T)
        items.Add(item)
    End Sub
    
    Public Function Pop() As T
        If items.Count = 0 Then
            Throw New InvalidOperationException("ã‚¹ã‚¿ãƒƒã‚¯ãŒç©ºã§ã™")
        End If
        
        Dim lastIndex As Integer = items.Count - 1
        Dim item As T = items(lastIndex)
        items.RemoveAt(lastIndex)
        Return item
    End Function
    
    Public ReadOnly Property Count As Integer
        Get
            Return items.Count
        End Get
    End Property
    
    Public ReadOnly Property IsEmpty As Boolean
        Get
            Return items.Count = 0
        End Get
    End Property
End Class

' ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®å®šç¾©
Public Function Swap(Of T)(ByRef a As T, ByRef b As T)
    Dim temp As T = a
    a = b
    b = temp
End Function

' ä½¿ç”¨ä¾‹
Module Module1
    Sub Main()
        ' æ•´æ•°ã‚¹ã‚¿ãƒƒã‚¯
        Dim intStack As New Stack(Of Integer)()
        intStack.Push(1)
        intStack.Push(2)
        intStack.Push(3)
        
        Console.WriteLine("æ•´æ•°ã‚¹ã‚¿ãƒƒã‚¯:")
        While Not intStack.IsEmpty
            Console.WriteLine($"Pop: {intStack.Pop()}")
        End While
        
        ' æ–‡å­—åˆ—ã‚¹ã‚¿ãƒƒã‚¯
        Dim stringStack As New Stack(Of String)()
        stringStack.Push("Hello")
        stringStack.Push("World")
        stringStack.Push("VB.NET")
        
        Console.WriteLine()
        Console.WriteLine("æ–‡å­—åˆ—ã‚¹ã‚¿ãƒƒã‚¯:")
        While Not stringStack.IsEmpty
            Console.WriteLine($"Pop: {stringStack.Pop()}")
        End While
        
        ' ã‚¸ã‚§ãƒãƒªãƒƒã‚¯ãƒ¡ã‚½ãƒƒãƒ‰ã®ä½¿ç”¨
        Dim x As Integer = 10
        Dim y As Integer = 20
        Console.WriteLine($"äº¤æ›å‰: x={x}, y={y}")
        Swap(x, y)
        Console.WriteLine($"äº¤æ›å¾Œ: x={x}, y={y}")
        
        Console.ReadLine()
    End Sub
End Module</code></pre>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-2: ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ—ãƒ­ã‚°ãƒ©ãƒ </h5>
                        <p>LINQã€Mathã€Randomã‚¯ãƒ©ã‚¹ã‚’çµ„ã¿åˆã‚ã›ã¦ã€ãƒ‡ãƒ¼ã‚¿åˆ†æã‚’è¡Œã†ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã—ã¾ã—ã‚‡ã†ã€‚</p>
                        <pre class="code-block"><code class="language-vbnet">Imports System.Linq

Public Class SalesData
    Public Property Date As DateTime
    Public Property ProductName As String
    Public Property Quantity As Integer
    Public Property UnitPrice As Decimal
    Public Property SalesPerson As String
    
    Public ReadOnly Property TotalAmount As Decimal
        Get
            Return Quantity * UnitPrice
        End Get
    End Property
End Class

Module Module1
    Sub Main()
        ' ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®ç”Ÿæˆ
        Dim salesData As List(Of SalesData) = GenerateSampleData()
        
        ' ãƒ‡ãƒ¼ã‚¿åˆ†æã®å®Ÿè¡Œ
        AnalyzeSalesData(salesData)
        
        Console.ReadLine()
    End Sub
    
    Function GenerateSampleData() As List(Of SalesData)
        Dim data As New List(Of SalesData)()
        Dim random As New Random()
        Dim products() As String = {"ãƒãƒ¼ãƒˆPC", "ãƒã‚¦ã‚¹", "ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰", "ãƒ¢ãƒ‹ã‚¿ãƒ¼", "ãƒ—ãƒªãƒ³ã‚¿ãƒ¼"}
        Dim salesPeople() As String = {"ç”°ä¸­", "ä½è—¤", "éˆ´æœ¨", "é«˜æ©‹", "ä¼Šè—¤"}
        
        ' éå»30æ—¥é–“ã®ãƒ©ãƒ³ãƒ€ãƒ ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
        For i As Integer = 0 To 99
            Dim saleDate As DateTime = DateTime.Today.AddDays(-random.Next(0, 30))
            Dim product As String = products(random.Next(products.Length))
            Dim quantity As Integer = random.Next(1, 6)
            Dim unitPrice As Decimal = random.Next(1000, 50000)
            Dim salesPerson As String = salesPeople(random.Next(salesPeople.Length))
            
            data.Add(New SalesData With {
                .Date = saleDate,
                .ProductName = product,
                .Quantity = quantity,
                .UnitPrice = unitPrice,
                .SalesPerson = salesPerson
            })
        Next
        
        Return data
    End Function
    
    Sub AnalyzeSalesData(data As List(Of SalesData))
        Console.WriteLine("=== å£²ä¸Šãƒ‡ãƒ¼ã‚¿åˆ†æ ===")
        Console.WriteLine($"ç·ãƒ¬ã‚³ãƒ¼ãƒ‰æ•°: {data.Count}")
        Console.WriteLine()
        
        ' åŸºæœ¬çµ±è¨ˆ
        Dim totalSales As Decimal = data.Sum(Function(s) s.TotalAmount)
        Dim averageSales As Decimal = data.Average(Function(s) s.TotalAmount)
        Dim maxSales As Decimal = data.Max(Function(s) s.TotalAmount)
        Dim minSales As Decimal = data.Min(Function(s) s.TotalAmount)
        
        Console.WriteLine("=== åŸºæœ¬çµ±è¨ˆ ===")
        Console.WriteLine($"ç·å£²ä¸Š: {totalSales:C}")
        Console.WriteLine($"å¹³å‡å£²ä¸Š: {averageSales:C}")
        Console.WriteLine($"æœ€é«˜å£²ä¸Š: {maxSales:C}")
        Console.WriteLine($"æœ€ä½å£²ä¸Š: {minSales:C}")
        Console.WriteLine()
        
        ' å•†å“åˆ¥å£²ä¸Š
        Console.WriteLine("=== å•†å“åˆ¥å£²ä¸Š ===")
        Dim productSales = data.GroupBy(Function(s) s.ProductName) _
                              .Select(Function(g) New With {
                                  .Product = g.Key,
                                  .TotalSales = g.Sum(Function(s) s.TotalAmount),
                                  .Count = g.Count()
                              }) _
                              .OrderByDescending(Function(p) p.TotalSales)
        
        For Each item In productSales
            Console.WriteLine($"{item.Product}: {item.TotalSales:C} ({item.Count}ä»¶)")
        Next
        Console.WriteLine()
        
        ' å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š
        Console.WriteLine("=== å–¶æ¥­æ‹…å½“è€…åˆ¥å£²ä¸Š ===")
        Dim salesPersonPerformance = data.GroupBy(Function(s) s.SalesPerson) _
                                         .Select(Function(g) New With {
                                             .SalesPerson = g.Key,
                                             .TotalSales = g.Sum(Function(s) s.TotalAmount),
                                             .Count = g.Count(),
                                             .Average = g.Average(Function(s) s.TotalAmount)
                                         }) _
                                         .OrderByDescending(Function(p) p.TotalSales)
        
        For Each person In salesPersonPerformance
            Console.WriteLine($"{person.SalesPerson}: {person.TotalSales:C} ({person.Count}ä»¶, å¹³å‡ {person.Average:C})")
        Next
        Console.WriteLine()
        
        ' æ—¥åˆ¥å£²ä¸Šãƒˆãƒ¬ãƒ³ãƒ‰
        Console.WriteLine("=== ç›´è¿‘7æ—¥é–“ã®å£²ä¸Šãƒˆãƒ¬ãƒ³ãƒ‰ ===")
        Dim dailySales = data.Where(Function(s) s.Date >= DateTime.Today.AddDays(-7)) _
                            .GroupBy(Function(s) s.Date) _
                            .Select(Function(g) New With {
                                .Date = g.Key,
                                .TotalSales = g.Sum(Function(s) s.TotalAmount),
                                .Count = g.Count()
                            }) _
                            .OrderBy(Function(d) d.Date)
        
        For Each day In dailySales
            Console.WriteLine($"{day.Date:MM/dd}: {day.TotalSales:C} ({day.Count}ä»¶)")
        Next
        
        ' é«˜é¡å–å¼•ã®åˆ†æ
        Console.WriteLine()
        Console.WriteLine("=== é«˜é¡å–å¼•ï¼ˆ5ä¸‡å††ä»¥ä¸Šï¼‰===")
        Dim highValueSales = data.Where(Function(s) s.TotalAmount >= 50000) _
                                .OrderByDescending(Function(s) s.TotalAmount) _
                                .Take(5)
        
        For Each sale In highValueSales
            Console.WriteLine($"{sale.Date:MM/dd} - {sale.ProductName} ({sale.Quantity}å€‹) - {sale.SalesPerson} - {sale.TotalAmount:C}")
        Next
    End Sub
End Module</code></pre>
                    </div>

                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>ç¾åœ¨ã®æ—¥ä»˜ã¨æ™‚åˆ»ã‚’å–å¾—ã™ã‚‹DateTimeã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>2ã¤ã®æ•°å€¤ã®æœ€å¤§å€¤ã‚’æ±‚ã‚ã‚‹Mathã‚¯ãƒ©ã‚¹ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ã‚‰æ¡ä»¶ã«åˆã†è¦ç´ ã‚’æŠ½å‡ºã™ã‚‹LINQãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>å‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒ©ã‚¹ã‚„é–¢æ•°ã‚’æ±ç”¨åŒ–ã™ã‚‹æ©Ÿèƒ½ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ</li>
                            <li>LINQã§ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®åˆè¨ˆå€¤ã‚’æ±‚ã‚ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>DateTime.Now</li>
                                <li>Math.Max</li>
                                <li>Where</li>
                                <li>ã‚¸ã‚§ãƒãƒªã‚¯ã‚¹</li>
                                <li>Sum</li>
                            </ol>
                        </details>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-8.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="vbnet-learning-material-10.html" class="btn btn-primary">æ¬¡ã®ç«  â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js åˆæœŸåŒ– -->
    <script>hljs.highlightAll();</script>
</body>
</html>