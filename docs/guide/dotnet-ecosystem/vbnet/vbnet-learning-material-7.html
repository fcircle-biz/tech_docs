<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第7章 - 例外処理とデバッグ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #5c6bc0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #5c6bc0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #5c6bc0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #7986cb;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        .quiz-container {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #5c6bc0;
        }
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .nav-link.active {
            background-color: #5c6bc0 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>VB.NET学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-1.html">
                                第1章: VB.NET入門と開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-2.html">
                                第2章: VB.NET基本文法
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-3.html">
                                第3章: 制御構造とプロシージャ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-4.html">
                                第4章: 配列とコレクション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-5.html">
                                第5章: オブジェクト指向プログラミング基礎
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-6.html">
                                第6章: オブジェクト指向プログラミング応用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="vbnet-learning-material-7.html">
                                第7章: 例外処理とデバッグ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-8.html">
                                第8章: ファイル操作と文字列処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-9.html">
                                第9章: .NET Frameworkライブラリ活用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-10.html">
                                第10章: 実践的なアプリケーション開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: 例外処理とデバッグ</h1>
                </div>

                <div id="chapter7">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">堅牢なプログラムを作る</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>例外（Exception）の概念と種類を理解する</li>
                            <li>Try-Catch-Finally文による例外処理を習得する</li>
                            <li>カスタム例外クラスの作成方法を学ぶ</li>
                            <li>Visual Studioのデバッグ機能を活用する</li>
                            <li>ブレークポイントとステップ実行の使い方を学ぶ</li>
                            <li>効果的なエラーハンドリング戦略を身につける</li>
                        </ul>
                    </div>

                    <!-- セクション1: 例外処理の概念 -->
                    <h3 class="section-title">7.1 例外処理とは</h3>
                    
                    <p>
                        <strong>例外処理</strong>は、プログラムの実行中に発生するエラーや予期しない状況に対処するための仕組みです。ファイルが見つからない、ネットワーク接続が切れる、ゼロ除算が発生するなど、様々な問題が発生する可能性があります。
                    </p>

                    <h4>例外処理の重要性</h4>
                    <ul>
                        <li><strong>プログラムの安定性</strong>: 予期しないエラーでプログラムが終了するのを防ぐ</li>
                        <li><strong>ユーザー体験の向上</strong>: 適切なエラーメッセージでユーザーをガイド</li>
                        <li><strong>デバッグの効率化</strong>: エラーの原因と場所を特定しやすくする</li>
                        <li><strong>保守性の向上</strong>: 問題の対処方法が明確になる</li>
                    </ul>

                    <div class="mermaid">
                        graph TD
                            A["正常な処理開始"] --> B["例外が発生"]
                            B --> C["例外処理なし"]
                            B --> D["例外処理あり"]
                            
                            C --> E["プログラム強制終了"]
                            D --> F["適切な処理"]
                            F --> G["処理継続または安全な終了"]
                            
                            style C fill:#ffebee
                            style E fill:#ffebee
                            style D fill:#e8f5e8
                            style F fill:#e8f5e8
                            style G fill:#e8f5e8
                    </div>

                    <!-- セクション2: Try-Catch-Finally文 -->
                    <h3 class="section-title">7.2 Try-Catch-Finally文</h3>
                    
                    <p>
                        <strong>Try-Catch-Finally文</strong>は、VB.NETで例外処理を実装するための基本構文です。例外が発生する可能性のあるコードをTryブロックで囲み、例外をCatchブロックで捕捉し、Finallyブロックで後処理を行います。
                    </p>

                    <pre class="code-block"><code class="language-vbnet">Try
    ' 例外が発生する可能性のあるコード
    Dim result As Integer = 10 / 0
Catch ex As DivideByZeroException
    ' 特定の例外を捕捉
    Console.WriteLine("ゼロで除算しようとしました: " & ex.Message)
Catch ex As Exception
    ' すべての例外を捕捉
    Console.WriteLine("エラーが発生しました: " & ex.Message)
Finally
    ' 必ず実行される処理（例外の有無に関係なく）
    Console.WriteLine("処理を完了しました")
End Try</code></pre>

                    <!-- 実習課題1 -->
                    <div class="exercise-container">
                        <h5>実習 7-1: 安全な計算機プログラム</h5>
                        <p>例外処理を使って、ユーザー入力エラーに対応できる計算機を作成しましょう。</p>
                        
                        <h6>サンプルコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Console.WriteLine("=== 安全な計算機 ===")
        
        Try
            Console.Write("最初の数値を入力してください: ")
            Dim num1 As Double = Convert.ToDouble(Console.ReadLine())
            
            Console.Write("演算子を入力してください (+, -, *, /): ")
            Dim operator As String = Console.ReadLine()
            
            Console.Write("2番目の数値を入力してください: ")
            Dim num2 As Double = Convert.ToDouble(Console.ReadLine())
            
            Dim result As Double = PerformCalculation(num1, operator, num2)
            Console.WriteLine($"結果: {num1} {operator} {num2} = {result}")
            
        Catch ex As FormatException
            Console.WriteLine("エラー: 数値の形式が正しくありません")
        Catch ex As DivideByZeroException
            Console.WriteLine("エラー: ゼロで除算はできません")
        Catch ex As ArgumentException
            Console.WriteLine("エラー: " & ex.Message)
        Catch ex As Exception
            Console.WriteLine("予期しないエラーが発生しました: " & ex.Message)
        Finally
            Console.WriteLine("計算処理を終了します")
        End Try
        
        Console.ReadKey()
    End Sub
    
    Function PerformCalculation(num1 As Double, operator As String, num2 As Double) As Double
        Select Case operator
            Case "+"
                Return num1 + num2
            Case "-"
                Return num1 - num2
            Case "*"
                Return num1 * num2
            Case "/"
                If num2 = 0 Then
                    Throw New DivideByZeroException("ゼロで除算することはできません")
                End If
                Return num1 / num2
            Case Else
                Throw New ArgumentException("無効な演算子です: " & operator)
        End Select
    End Function
End Module</code></pre>
                    </div>

                    <!-- セクション3: カスタム例外 -->
                    <h3 class="section-title">7.3 カスタム例外クラス</h3>
                    
                    <p>
                        独自の例外クラスを作成することで、アプリケーション固有のエラー状況をより適切に表現できます。カスタム例外は<strong>Exception</strong>クラスを継承して作成します。
                    </p>

                    <pre class="code-block"><code class="language-vbnet">' カスタム例外クラス
Public Class InsufficientFundsException
    Inherits Exception
    
    Public ReadOnly Property Balance As Decimal
    Public ReadOnly Property RequestedAmount As Decimal
    
    Public Sub New(balance As Decimal, requestedAmount As Decimal)
        MyBase.New($"残高不足です。残高: {balance:C}, 要求額: {requestedAmount:C}")
        Me.Balance = balance
        Me.RequestedAmount = requestedAmount
    End Sub
    
    Public Sub New(message As String, balance As Decimal, requestedAmount As Decimal)
        MyBase.New(message)
        Me.Balance = balance
        Me.RequestedAmount = requestedAmount
    End Sub
End Class

' カスタム例外を使用するクラス
Public Class BankAccount
    Private _balance As Decimal
    Private _accountNumber As String
    
    Public Sub New(accountNumber As String, initialBalance As Decimal)
        _accountNumber = accountNumber
        _balance = initialBalance
    End Sub
    
    Public Sub Withdraw(amount As Decimal)
        If amount <= 0 Then
            Throw New ArgumentException("出金額は正の数である必要があります")
        End If
        
        If amount > _balance Then
            Throw New InsufficientFundsException(_balance, amount)
        End If
        
        _balance -= amount
        Console.WriteLine($"{amount:C}を出金しました。残高: {_balance:C}")
    End Sub
    
    Public ReadOnly Property Balance As Decimal
        Get
            Return _balance
        End Get
    End Property
End Class</code></pre>

                    <!-- セクション4: デバッグ技法 -->
                    <h3 class="section-title">7.4 Visual Studioデバッグ技法</h3>
                    
                    <p>
                        <strong>デバッグ</strong>は、プログラムの問題を発見し、修正するプロセスです。Visual Studioには強力なデバッグツールが組み込まれており、効率的な問題解決を支援します。
                    </p>

                    <h4>主要なデバッグ機能</h4>
                    <table class="table table-striped">
                        <thead class="table-primary">
                            <tr>
                                <th>機能</th>
                                <th>ショートカット</th>
                                <th>説明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>ブレークポイント</strong></td>
                                <td>F9</td>
                                <td>実行を一時停止する位置を設定</td>
                            </tr>
                            <tr>
                                <td><strong>デバッグ開始</strong></td>
                                <td>F5</td>
                                <td>デバッグモードでプログラムを実行</td>
                            </tr>
                            <tr>
                                <td><strong>ステップオーバー</strong></td>
                                <td>F10</td>
                                <td>次の行に進む（関数の中に入らない）</td>
                            </tr>
                            <tr>
                                <td><strong>ステップイン</strong></td>
                                <td>F11</td>
                                <td>関数の中に入って実行</td>
                            </tr>
                            <tr>
                                <td><strong>ステップアウト</strong></td>
                                <td>Shift+F11</td>
                                <td>現在の関数から抜ける</td>
                            </tr>
                            <tr>
                                <td><strong>継続実行</strong></td>
                                <td>F5</td>
                                <td>次のブレークポイントまで実行</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>デバッグのベストプラクティス</h4>
                    <div class="highlight">
                        <ul>
                            <li><strong>戦略的なブレークポイント配置</strong>: 問題が発生する可能性の高い場所に設定</li>
                            <li><strong>変数の監視</strong>: ウォッチウィンドウで重要な変数の値を追跡</li>
                            <li><strong>呼び出しスタックの確認</strong>: 関数の呼び出し経路を理解</li>
                            <li><strong>条件付きブレークポイント</strong>: 特定の条件でのみ停止するように設定</li>
                            <li><strong>即座ウィンドウの活用</strong>: 実行中に式の評価や変数の変更が可能</li>
                        </ul>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>Try-Catch-Finally文で必ず実行されるブロックは？</strong><br>
                                a) Try<br>
                                b) Catch<br>
                                c) Finally<br>
                                d) すべて
                            </li>
                            <li>
                                <strong>カスタム例外クラスが継承すべきクラスは？</strong><br>
                                a) Object<br>
                                b) Exception<br>
                                c) Error<br>
                                d) SystemException
                            </li>
                            <li>
                                <strong>ブレークポイントを設定するショートカットキーは？</strong><br>
                                a) F5<br>
                                b) F9<br>
                                c) F10<br>
                                d) F11
                            </li>
                            <li>
                                <strong>例外処理の主な目的は？</strong><br>
                                a) プログラムの高速化<br>
                                b) メモリ使用量の削減<br>
                                c) プログラムの安定性向上<br>
                                d) コードの短縮
                            </li>
                        </ol>
                        
                        <details>
                            <summary>解答を表示</summary>
                            <ol>
                                <li><strong>c) Finally</strong> - Finallyブロックは例外の有無に関係なく必ず実行されます。</li>
                                <li><strong>b) Exception</strong> - カスタム例外はExceptionクラスを継承して作成します。</li>
                                <li><strong>b) F9</strong> - F9キーでブレークポイントの設定/解除ができます。</li>
                                <li><strong>c) プログラムの安定性向上</strong> - 例外処理により予期しないエラーでの異常終了を防げます。</li>
                            </ol>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">7.5 第7章のまとめ</h3>
                    
                    <div class="highlight">
                        <h5>この章で学んだこと</h5>
                        <ul>
                            <li><strong>例外処理</strong>: Try-Catch-Finally文による堅牢なエラーハンドリング</li>
                            <li><strong>例外の種類</strong>: システム例外と独自例外の理解</li>
                            <li><strong>カスタム例外</strong>: アプリケーション固有の例外クラス作成</li>
                            <li><strong>デバッグ技法</strong>: Visual Studioツールを使った効率的な問題解決</li>
                            <li><strong>ブレークポイント</strong>: 実行制御と変数監視</li>
                            <li><strong>エラーハンドリング戦略</strong>: ユーザー体験を考慮した例外対応</li>
                        </ul>
                    </div>

                    <p>
                        第7章では、プログラムの品質と安定性を向上させる例外処理とデバッグ技法を学習しました。これらの技術は、実用的なアプリケーション開発において不可欠なスキルです。次の第8章では、ファイル操作と文字列処理について学習します。
                    </p>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-6.html" class="btn btn-secondary">← 前の章: オブジェクト指向プログラミング応用</a>
                        <a href="vbnet-learning-material-8.html" class="btn btn-primary">次の章: ファイル操作と文字列処理 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2025 F-Circle All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>