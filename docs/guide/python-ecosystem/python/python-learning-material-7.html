<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python学習教材 第7章 - オブジェクト指向プログラミング入門</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* Python専用カラーテーマ */
        :root {
            --python-primary: #3776ab;
            --python-secondary: #ffd43b;
            --python-accent: #4b8bbe;
            --python-bg-light: #f0f6fc;
            --python-bg-yellow: #fffbf0;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        .navbar {
            background-color: var(--python-primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
        }

        .chapter-title {
            color: var(--python-primary);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid var(--python-primary);
            padding-bottom: 0.5rem;
            font-weight: 600;
        }

        .section-title {
            color: var(--python-accent);
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
            font-weight: 500;
        }

        .quiz-container {
            background-color: var(--python-bg-light);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--python-primary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .highlight {
            background-color: var(--python-bg-yellow);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid var(--python-secondary);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .nav-link.active {
            background-color: var(--python-primary) !important;
            color: white !important;
        }

        .nav-link {
            color: #6c757d;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background-color: var(--python-bg-light);
            color: var(--python-primary);
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            color: var(--python-primary);
            font-weight: 500;
        }

        .btn-primary {
            background-color: var(--python-primary);
            border-color: var(--python-primary);
        }

        .btn-primary:hover {
            background-color: var(--python-accent);
            border-color: var(--python-accent);
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../README.html">
                <strong>Python学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.html">学習ガイド</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="../../../../cheatsheet/python/python-basics-cheatsheet.html">チートシート</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-1.html">
                                第1章: Python入門と開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-2.html">
                                第2章: 基本的な文法と変数
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-3.html">
                                第3章: 制御構造の基礎
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-4.html">
                                第4章: 関数とモジュール
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-5.html">
                                第5章: データ構造の基礎
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-6.html">
                                第6章: ファイル操作と例外処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="python-learning-material-7.html">
                                第7章: オブジェクト指向プログラミング入門
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-8.html">
                                第8章: 標準ライブラリの活用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-9.html">
                                第9章: 外部ライブラリとパッケージ管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="python-learning-material-10.html">
                                第10章: 実践プロジェクト開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: オブジェクト指向プログラミング入門</h1>
                </div>

                <div id="chapter7">
                    <h2 class="chapter-title">オブジェクト指向プログラミング入門</h2>
                    
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>オブジェクト指向プログラミングの基本概念を理解する</li>
                            <li>クラスの設計と実装ができるようになる</li>
                            <li>インスタンス変数とクラス変数の使い分けを習得する</li>
                            <li>継承とポリモーフィズムの概念を理解し活用する</li>
                            <li>カプセル化（情報隠蔽）の重要性と実装方法を学ぶ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">7.1 クラスとオブジェクトの基礎</h3>
                    <p>クラスは、データ（属性）と機能（メソッド）をまとめたオブジェクトの設計図です。オブジェクトはクラスから作られた実体（インスタンス）です。</p>
                    
                    <h4>基本的なクラスの定義</h4>
                    <pre><code># 基本的なクラスの定義
class Person:
    def __init__(self, name, age):
        """コンストラクタ（初期化メソッド）"""
        self.name = name  # インスタンス変数
        self.age = age
    
    def greet(self):
        """メソッドの定義"""
        return f"こんにちは、私は{self.name}です。{self.age}歳です。"
    
    def have_birthday(self):
        """年齢を1つ増やすメソッド"""
        self.age += 1
        return f"{self.name}の誕生日！{self.age}歳になりました。"

# インスタンス（オブジェクト）の作成
person1 = Person("田中太郎", 25)
person2 = Person("佐藤花子", 30)

# メソッドの呼び出し
print(person1.greet())
print(person2.greet())

# インスタンス変数へのアクセス
print(f"{person1.name}の年齢: {person1.age}")

# メソッドによる状態の変更
print(person1.have_birthday())</code></pre>

                    <h4>クラス変数とインスタンス変数</h4>
                    <pre><code>class Student:
    # クラス変数（全インスタンスで共有）
    school_name = "Python高等学校"
    student_count = 0
    
    def __init__(self, name, grade):
        # インスタンス変数（インスタンス固有）
        self.name = name
        self.grade = grade
        self.subjects = []
        
        # 学生数をカウント
        Student.student_count += 1
    
    def add_subject(self, subject):
        """履修科目を追加"""
        self.subjects.append(subject)
        return f"{self.name}が{subject}を履修しました"
    
    @classmethod
    def get_student_count(cls):
        """クラスメソッド：学生数を取得"""
        return f"現在の学生数: {cls.student_count}人"
    
    @staticmethod
    def is_passing_grade(score):
        """静的メソッド：合格判定"""
        return score >= 60

# インスタンスの作成
student1 = Student("山田太郎", 2)
student2 = Student("田中花子", 3)

print(Student.get_student_count())  # 現在の学生数: 2人
print(Student.is_passing_grade(75))  # True

# クラス変数はすべてのインスタンスで共有
print(student1.school_name)  # Python高等学校
print(student2.school_name)  # Python高等学校</code></pre>

                    <div class="exercise-container">
                        <h5>実習 7-1: 銀行口座クラスの実装</h5>
                        <p>銀行口座の機能を持つクラスを作成し、入金・出金・残高照会の機能を実装しましょう。</p>
                        
                        <h6>コード例</h6>
                        <pre><code>class BankAccount:
    # クラス変数
    bank_name = "Python銀行"
    account_count = 0
    
    def __init__(self, account_holder, initial_balance=0):
        """口座の初期化"""
        self.account_number = f"ACC{BankAccount.account_count + 1:06d}"
        self.account_holder = account_holder
        self.balance = initial_balance
        self.transaction_history = []
        
        BankAccount.account_count += 1
        
        # 初期取引記録
        if initial_balance > 0:
            self.transaction_history.append(f"口座開設: +{initial_balance}円")
    
    def deposit(self, amount):
        """入金処理"""
        if amount <= 0:
            return "入金額は正の数である必要があります"
        
        self.balance += amount
        self.transaction_history.append(f"入金: +{amount}円")
        return f"{amount}円を入金しました。残高: {self.balance}円"
    
    def withdraw(self, amount):
        """出金処理"""
        if amount <= 0:
            return "出金額は正の数である必要があります"
        
        if amount > self.balance:
            return f"残高不足です。現在の残高: {self.balance}円"
        
        self.balance -= amount
        self.transaction_history.append(f"出金: -{amount}円")
        return f"{amount}円を出金しました。残高: {self.balance}円"
    
    def get_balance(self):
        """残高照会"""
        return f"現在の残高: {self.balance}円"
    
    def get_account_info(self):
        """口座情報の表示"""
        info = f"""
=== {self.bank_name} 口座情報 ===
口座番号: {self.account_number}
口座名義: {self.account_holder}
現在残高: {self.balance}円
        """
        return info
    
    def get_transaction_history(self, limit=5):
        """取引履歴の表示"""
        history = self.transaction_history[-limit:]  # 最新のlimit件
        result = f"\n=== {self.account_holder}様の取引履歴（最新{len(history)}件）===\n"
        for i, transaction in enumerate(reversed(history), 1):
            result += f"{i}. {transaction}\n"
        return result

# 使用例
# 口座を作成
account1 = BankAccount("田中太郎", 10000)
account2 = BankAccount("佐藤花子")

# 口座情報を表示
print(account1.get_account_info())

# 入出金を実行
print(account1.deposit(5000))
print(account1.withdraw(3000))
print(account1.get_balance())

print(account2.deposit(2000))
print(account2.withdraw(2500))  # 残高不足

# 取引履歴を表示
print(account1.get_transaction_history())</code></pre>
                    </div>

                    <h3 class="section-title">7.2 特殊メソッド（マジックメソッド）</h3>
                    <p>特殊メソッドは、Pythonの組み込み関数や演算子と連携するためのメソッドです。</p>
                    
                    <h4>主要な特殊メソッド</h4>
                    <pre><code>class Book:
    def __init__(self, title, author, pages):
        self.title = title
        self.author = author
        self.pages = pages
    
    def __str__(self):
        """str()関数で呼ばれる（ユーザー向け表示）"""
        return f"『{self.title}』著者: {self.author}"
    
    def __repr__(self):
        """repr()関数で呼ばれる（開発者向け表示）"""
        return f"Book('{self.title}', '{self.author}', {self.pages})"
    
    def __len__(self):
        """len()関数で呼ばれる"""
        return self.pages
    
    def __eq__(self, other):
        """==演算子で呼ばれる"""
        if isinstance(other, Book):
            return self.title == other.title and self.author == other.author
        return False
    
    def __lt__(self, other):
        """<演算子で呼ばれる（ページ数で比較）"""
        if isinstance(other, Book):
            return self.pages < other.pages
        return NotImplemented
    
    def __add__(self, other):
        """+演算子で呼ばれる（ページ数を合計）"""
        if isinstance(other, Book):
            return self.pages + other.pages
        return NotImplemented

# 特殊メソッドの使用例
book1 = Book("Python入門", "田中太郎", 300)
book2 = Book("データ分析の基礎", "佐藤花子", 250)
book3 = Book("Python入門", "田中太郎", 300)

print(str(book1))     # __str__が呼ばれる
print(repr(book1))    # __repr__が呼ばれる
print(len(book1))     # __len__が呼ばれる: 300

print(book1 == book3) # __eq__が呼ばれる: True
print(book1 < book2)  # __lt__が呼ばれる: False
print(book1 + book2)  # __add__が呼ばれる: 550</code></pre>

                    <h3 class="section-title">7.3 継承と多態性</h3>
                    <p>継承は既存のクラスを拡張して新しいクラスを作成する機能です。多態性（ポリモーフィズム）は、同じインターフェースで異なる処理を実現する概念です。</p>
                    
                    <h4>基本的な継承</h4>
                    <pre><code># 基底クラス（親クラス）
class Animal:
    def __init__(self, name, species):
        self.name = name
        self.species = species
    
    def make_sound(self):
        return f"{self.name}が鳴いています"
    
    def info(self):
        return f"名前: {self.name}, 種類: {self.species}"

# 派生クラス（子クラス）
class Dog(Animal):
    def __init__(self, name, breed):
        super().__init__(name, "犬")  # 親クラスのコンストラクタを呼び出し
        self.breed = breed
    
    def make_sound(self):
        """メソッドのオーバーライド"""
        return f"{self.name}がワンワンと吠えています"
    
    def fetch(self):
        """犬特有のメソッド"""
        return f"{self.name}がボールを取りに行きました"

class Cat(Animal):
    def __init__(self, name, indoor=True):
        super().__init__(name, "猫")
        self.indoor = indoor
    
    def make_sound(self):
        """メソッドのオーバーライド"""
        return f"{self.name}がニャーニャーと鳴いています"
    
    def climb(self):
        """猫特有のメソッド"""
        return f"{self.name}が高い所に登りました"

# 継承の使用例
dog = Dog("ポチ", "柴犬")
cat = Cat("ミケ", indoor=True)

print(dog.info())        # 継承されたメソッド
print(dog.make_sound())  # オーバーライドされたメソッド
print(dog.fetch())       # 派生クラス独自のメソッド

print(cat.info())
print(cat.make_sound())
print(cat.climb())

# ポリモーフィズムの例
animals = [dog, cat]
for animal in animals:
    print(animal.make_sound())  # 同じメソッド名で異なる動作</code></pre>

                    <div class="exercise-container">
                        <h5>実習 7-2: 図形クラスの継承システム</h5>
                        <p>基底クラスShapeと、その派生クラスCircle、Rectangleを作成し、面積と周囲の長さを計算する機能を実装しましょう。</p>
                        
                        <h6>コード例</h6>
                        <pre><code>import math

class Shape:
    """図形の基底クラス"""
    
    def __init__(self, name):
        self.name = name
    
    def area(self):
        """面積を計算（派生クラスでオーバーライド）"""
        raise NotImplementedError("派生クラスで実装してください")
    
    def perimeter(self):
        """周囲の長さを計算（派生クラスでオーバーライド）"""
        raise NotImplementedError("派生クラスで実装してください")
    
    def info(self):
        """図形の情報を表示"""
        return f"""
図形: {self.name}
面積: {self.area():.2f}
周囲の長さ: {self.perimeter():.2f}
        """

class Circle(Shape):
    """円クラス"""
    
    def __init__(self, radius):
        super().__init__("円")
        self.radius = radius
    
    def area(self):
        """円の面積"""
        return math.pi * self.radius ** 2
    
    def perimeter(self):
        """円の周囲（円周）"""
        return 2 * math.pi * self.radius
    
    def diameter(self):
        """直径（円特有のメソッド）"""
        return 2 * self.radius

class Rectangle(Shape):
    """長方形クラス"""
    
    def __init__(self, width, height):
        super().__init__("長方形")
        self.width = width
        self.height = height
    
    def area(self):
        """長方形の面積"""
        return self.width * self.height
    
    def perimeter(self):
        """長方形の周囲"""
        return 2 * (self.width + self.height)
    
    def diagonal(self):
        """対角線の長さ（長方形特有のメソッド）"""
        return math.sqrt(self.width ** 2 + self.height ** 2)

class Square(Rectangle):
    """正方形クラス（長方形の特殊ケース）"""
    
    def __init__(self, side):
        super().__init__(side, side)
        self.name = "正方形"
        self.side = side

def compare_shapes(shapes):
    """複数の図形を比較"""
    print("=== 図形比較 ===")
    
    shapes_sorted = sorted(shapes, key=lambda s: s.area(), reverse=True)
    
    for i, shape in enumerate(shapes_sorted, 1):
        print(f"{i}位: {shape.info()}")

# 使用例
circle = Circle(5)
rectangle = Rectangle(4, 6)
square = Square(5)

# 各図形の情報を表示
print(circle.info())
print(f"直径: {circle.diameter():.2f}")

print(rectangle.info())
print(f"対角線: {rectangle.diagonal():.2f}")

print(square.info())

# 図形を比較
shapes = [circle, rectangle, square]
compare_shapes(shapes)</code></pre>
                    </div>

                    <h3 class="section-title">7.4 カプセル化とアクセス制御</h3>
                    <p>カプセル化は、データと機能をまとめ、外部からの不適切なアクセスを制限する仕組みです。</p>
                    
                    <h4>プライベート属性とプロパティ</h4>
                    <pre><code>class Temperature:
    def __init__(self, celsius=0):
        self._celsius = celsius  # プロテクテッド（慣例）
        self.__kelvin_offset = 273.15  # プライベート（名前マングリング）
    
    @property
    def celsius(self):
        """摂氏温度のゲッター"""
        return self._celsius
    
    @celsius.setter
    def celsius(self, value):
        """摂氏温度のセッター（検証付き）"""
        if value < -273.15:
            raise ValueError("絶対零度以下の温度は設定できません")
        self._celsius = value
    
    @property
    def fahrenheit(self):
        """華氏温度（計算プロパティ）"""
        return self._celsius * 9/5 + 32
    
    @fahrenheit.setter
    def fahrenheit(self, value):
        """華氏温度のセッター"""
        celsius_value = (value - 32) * 5/9
        self.celsius = celsius_value  # セッターの検証を利用
    
    @property
    def kelvin(self):
        """ケルビン温度（計算プロパティ）"""
        return self._celsius + self.__kelvin_offset
    
    def __str__(self):
        return f"{self._celsius}°C ({self.fahrenheit:.1f}°F, {self.kelvin:.1f}K)"

# プロパティの使用例
temp = Temperature(25)
print(temp)  # 25°C (77.0°F, 298.1K)

# プロパティによる値の設定
temp.celsius = 30
print(temp)  # 30°C (86.0°F, 303.1K)

temp.fahrenheit = 100
print(temp)  # 37.8°C (100.0°F, 310.9K)

# 検証機能のテスト
try:
    temp.celsius = -300  # 絶対零度以下はエラー
except ValueError as e:
    print(f"エラー: {e}")

# プライベート属性へのアクセス（名前マングリング）
# print(temp.__kelvin_offset)  # AttributeError
print(temp._Temperature__kelvin_offset)  # 273.15（推奨されない）</code></pre>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>問題1:</strong> クラス変数とインスタンス変数の違いは何ですか？</li>
                            <li><strong>問題2:</strong> <code>super()</code>関数の役割は何ですか？</li>
                            <li><strong>問題3:</strong> <code>@property</code>デコレータを使う利点は何ですか？</li>
                            <li><strong>問題4:</strong> 以下のコードの出力は何ですか？<br>
                                <code>class Test:<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;count = 0<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;def __init__(self):<br>
                                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Test.count += 1<br>
                                <br>
                                t1 = Test()<br>
                                t2 = Test()<br>
                                print(Test.count)</code>
                            </li>
                        </ol>
                        
                        <details style="margin-top: 1rem;">
                            <summary>解答を見る</summary>
                            <div style="margin-top: 0.5rem;">
                                <p><strong>解答:</strong></p>
                                <ol>
                                    <li>クラス変数：全インスタンスで共有 / インスタンス変数：各インスタンス固有</li>
                                    <li>親クラスのメソッドを呼び出すために使用</li>
                                    <li>メソッドを属性のように扱え、値の検証や計算を透過的に行える</li>
                                    <li>2（2つのインスタンスが作成されたため）</li>
                                </ol>
                            </div>
                        </details>
                    </div>

                    <h3 class="section-title">7.5 まとめ</h3>
                    <p>この章では、オブジェクト指向プログラミングの基本概念について学習しました。適切な設計により、保守性と拡張性の高いプログラムを作成できます。</p>

                    <div class="highlight">
                        <h6>重要なポイント</h6>
                        <ul>
                            <li>クラス：データと機能をまとめた設計図</li>
                            <li>継承：既存クラスを拡張して新機能を追加</li>
                            <li>ポリモーフィズム：同じインターフェースで異なる動作</li>
                            <li>カプセル化：データの隠蔽と保護</li>
                            <li>特殊メソッド：Pythonの組み込み機能との連携</li>
                        </ul>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="python-learning-material-6.html" class="btn btn-secondary">← 前の章: ファイル操作と例外処理</a>
                        <a href="python-learning-material-8.html" class="btn btn-primary">次の章: 標準ライブラリの活用 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>