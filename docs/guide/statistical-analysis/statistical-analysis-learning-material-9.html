<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計解析学習教材 第9章 - ベイズ統計と時系列分析</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; background-color: #f8f9fa; }
        .navbar { background-color: #1e88e5; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #ffffff; border-right: 1px solid #dee2e6; padding: 1rem; }
        .sidebar .nav-link { color: #495057; padding: 0.5rem 1rem; border-radius: 5px; margin-bottom: 0.25rem; }
        .sidebar .nav-link:hover { background-color: #e3f2fd; }
        .sidebar .nav-link.active { background-color: #1e88e5 !important; color: white !important; }
        .chapter-title { color: #1e88e5; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 3px solid #1e88e5; padding-bottom: 0.5rem; }
        .section-title { color: #42a5f5; margin-top: 2rem; margin-bottom: 1rem; border-left: 4px solid #42a5f5; padding-left: 0.75rem; }
        .highlight { background-color: #fff3e0; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #ff9800; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #1e88e5; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .code-block { background-color: #1e1e1e; color: white; border-radius: 5px; padding: 1rem; margin: 1rem 0; overflow-x: auto; }
        main { background-color: #ffffff; min-height: calc(100vh - 56px); padding: 2rem; }
        footer { margin-top: 3rem; background-color: #1e88e5; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid"><a class="navbar-brand" href="#"><strong>統計解析学習教材</strong></a></div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>学習章</span></h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-1.html">第1章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-2.html">第2章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-3.html">第3章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-4.html">第4章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-5.html">第5章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-6.html">第6章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-7.html">第7章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-8.html">第8章</a></li>
                        <li class="nav-item"><a class="nav-link active" href="statistical-analysis-learning-material-9.html">第9章</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-10.html">第10章</a></li>
                    </ul>
                </div>
            </nav>
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第9章: ベイズ統計と時系列分析</h1>
                </div>
                <div id="chapter9">
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>ベイズの定理を理解し、事前分布と事後分布の概念を理解する</li>
                            <li>時系列データの特徴（トレンド、季節性）を理解する</li>
                            <li>自己相関と偏自己相関を計算し解釈できる</li>
                            <li>基本的な時系列モデル（移動平均、ARIMA）を理解する</li>
                        </ul>
                    </div>

                    <h3 class="section-title">9.1 ベイズ統計の基礎</h3>
                    <h4>ベイズの定理</h4>
                    <p>
                        ベイズの定理は、新しい情報（データ）を得たときに、事前の信念（事前確率）を更新する方法を提供します：<br>
                        <strong>P(θ|データ) = P(データ|θ) × P(θ) / P(データ)</strong>
                    </p>

                    <ul>
                        <li><strong>P(θ)</strong>: 事前分布（データを見る前の信念）</li>
                        <li><strong>P(データ|θ)</strong>: 尤度（パラメータθのもとでデータが観測される確率）</li>
                        <li><strong>P(θ|データ)</strong>: 事後分布（データを見た後の更新された信念）</li>
                    </ul>

                    <div class="mermaid">
                        flowchart LR
                            A["事前分布<br/>P(θ)"] --> B["ベイズの定理"]
                            C["尤度<br/>P(データ|θ)"] --> B
                            B --> D["事後分布<br/>P(θ|データ)"]

                            style A fill:#e3f2fd
                            style C fill:#fff3e0
                            style B fill:#f3e5f5
                            style D fill:#e8f5e9
                    </div>

                    <h4>ベイズ推定の例（コイン投げ）</h4>
                    <pre class="code-block"><code class="language-r"># R: ベイズ推定（ベータ分布を事前分布とする）
# コイン投げで表が7回、裏が3回出た場合
# 表が出る確率pの事後分布を求める

# 事前分布: ベータ分布(1, 1) = 一様分布
prior_a <- 1
prior_b <- 1

# データ: 表7回、裏3回
heads <- 7
tails <- 3

# 事後分布: ベータ分布(a+heads, b+tails)
posterior_a <- prior_a + heads
posterior_b <- prior_b + tails

# 事後分布の可視化
p <- seq(0, 1, length=100)
posterior <- dbeta(p, posterior_a, posterior_b)
plot(p, posterior, type="l", lwd=2,
     main="表が出る確率pの事後分布",
     xlab="p", ylab="確率密度")

# 事後平均（推定値）
posterior_mean <- posterior_a / (posterior_a + posterior_b)
print(paste("事後平均:", posterior_mean))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: ベイズ推定
from scipy.stats import beta
import numpy as np
import matplotlib.pyplot as plt

# 事前分布: ベータ分布(1, 1)
prior_a = 1
prior_b = 1

# データ: 表7回、裏3回
heads = 7
tails = 3

# 事後分布: ベータ分布(a+heads, b+tails)
posterior_a = prior_a + heads
posterior_b = prior_b + tails

# 可視化
p = np.linspace(0, 1, 100)
posterior = beta.pdf(p, posterior_a, posterior_b)

plt.plot(p, posterior, lw=2)
plt.title('表が出る確率pの事後分布')
plt.xlabel('p')
plt.ylabel('確率密度')
plt.show()

# 事後平均
posterior_mean = posterior_a / (posterior_a + posterior_b)
print(f"事後平均: {posterior_mean}")</code></pre>

                    <h3 class="section-title">9.2 時系列データの基礎</h3>
                    <h4>時系列データとは</h4>
                    <p>
                        時系列データは、時間順に観測されたデータです。
                        株価、気温、売上など、多くの実データが時系列の形式をとります。
                    </p>

                    <h4>時系列データの構成要素</h4>
                    <ul>
                        <li><strong>トレンド</strong>: 長期的な増加・減少傾向</li>
                        <li><strong>季節性</strong>: 周期的に繰り返されるパターン</li>
                        <li><strong>周期性</strong>: 不規則な周期で繰り返されるパターン</li>
                        <li><strong>ランダム変動</strong>: 説明できない不規則な変動</li>
                    </ul>

                    <pre class="code-block"><code class="language-r"># R: 時系列データの可視化
# 組み込みの時系列データ（航空機乗客数）
data(AirPassengers)
ts_data <- AirPassengers

# 時系列プロット
plot(ts_data, main="月次航空機乗客数",
     xlab="年", ylab="乗客数")

# 時系列分解（トレンド、季節性、残差）
decomp <- decompose(ts_data)
plot(decomp)</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 時系列データの可視化
import pandas as pd
import matplotlib.pyplot as plt
from statsmodels.tsa.seasonal import seasonal_decompose

# サンプルデータ（ランダム生成）
dates = pd.date_range('2020-01', periods=48, freq='M')
data = pd.Series(
    100 + np.arange(48) * 2 +  # トレンド
    10 * np.sin(np.arange(48) * 2 * np.pi / 12) +  # 季節性
    np.random.randn(48) * 5,  # ノイズ
    index=dates
)

# プロット
plt.figure(figsize=(10, 4))
plt.plot(data)
plt.title('時系列データ')
plt.xlabel('日付')
plt.ylabel('値')
plt.show()

# 時系列分解
decomposition = seasonal_decompose(data, model='additive')
decomposition.plot()
plt.show()</code></pre>

                    <h3 class="section-title">9.3 自己相関分析</h3>
                    <h4>自己相関関数（ACF）</h4>
                    <p>
                        自己相関は、時系列データが過去の自分自身とどの程度相関しているかを示します。
                        ACFプロットにより、データの周期性やパターンを把握できます。
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 自己相関と偏自己相関
data(AirPassengers)

# ACFプロット（自己相関関数）
acf(AirPassengers, main="自己相関関数 (ACF)")

# PACFプロット（偏自己相関関数）
pacf(AirPassengers, main="偏自己相関関数 (PACF)")</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 自己相関と偏自己相関
from statsmodels.graphics.tsaplots import plot_acf, plot_pacf
import matplotlib.pyplot as plt

# ACFプロット
fig, axes = plt.subplots(2, 1, figsize=(10, 6))
plot_acf(data, lags=20, ax=axes[0])
axes[0].set_title('自己相関関数 (ACF)')

# PACFプロット
plot_pacf(data, lags=20, ax=axes[1])
axes[1].set_title('偏自己相関関数 (PACF)')
plt.tight_layout()
plt.show()</code></pre>

                    <h3 class="section-title">9.4 ARIMAモデル</h3>
                    <h4>ARIMAモデルとは</h4>
                    <p>
                        ARIMA（AutoRegressive Integrated Moving Average）モデルは、時系列予測の代表的な手法です。
                        AR（自己回帰）、I（差分）、MA（移動平均）の3つの要素から構成されます。
                    </p>

                    <ul>
                        <li><strong>AR(p)</strong>: p期前までの値を使った予測</li>
                        <li><strong>I(d)</strong>: データをd回差分して定常化</li>
                        <li><strong>MA(q)</strong>: q期前までの誤差を使った予測</li>
                    </ul>

                    <pre class="code-block"><code class="language-r"># R: ARIMAモデル
data(AirPassengers)

# ARIMAモデルの当てはめ（自動選択）
library(forecast)
model <- auto.arima(AirPassengers)
summary(model)

# 予測（12ヶ月先まで）
forecast_result <- forecast(model, h=12)
plot(forecast_result, main="ARIMA予測")</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: ARIMAモデル
from statsmodels.tsa.arima.model import ARIMA
import matplotlib.pyplot as plt

# ARIMAモデルの当てはめ（ARIMA(1,1,1)）
model = ARIMA(data, order=(1, 1, 1))
fitted_model = model.fit()

print(fitted_model.summary())

# 予測（12期先まで）
forecast = fitted_model.forecast(steps=12)
print(forecast)</code></pre>

                    <div class="exercise-container">
                        <h5>実習 9-1: 時系列分析の実践</h5>
                        <p><strong>課題1: 時系列分解</strong></p>
                        <p>
                            組み込みの時系列データ（AirPassengersなど）を使って、以下を実行してください：
                        </p>
                        <ol>
                            <li>時系列データをプロット</li>
                            <li>トレンド、季節性、残差に分解</li>
                            <li>各要素の特徴を記述</li>
                        </ol>

                        <p><strong>課題2: 自己相関分析</strong></p>
                        <ol>
                            <li>ACFプロットとPACFプロットを作成</li>
                            <li>自己相関のパターンから何が読み取れるか考察</li>
                            <li>適切なARIMAモデルのパラメータを検討</li>
                        </ol>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>ベイズ統計における事前分布と事後分布の違いを説明してください。</li>
                            <li>時系列データの4つの構成要素を挙げてください。</li>
                            <li>自己相関関数（ACF）は何を表しますか？</li>
                            <li>ARIMAモデルの3つの要素（AR、I、MA）をそれぞれ説明してください。</li>
                            <li>定常性とは何ですか？なぜ時系列分析で重要ですか？</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4 mb-4">
                        <a href="statistical-analysis-learning-material-8.html" class="btn btn-secondary">← 前の章</a>
                        <a href="statistical-analysis-learning-material-10.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <footer class="text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
</body>
</html>