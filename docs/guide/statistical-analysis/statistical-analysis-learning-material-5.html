<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計解析学習教材 第5章 - 仮説検定の基礎</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; background-color: #f8f9fa; }
        .navbar { background-color: #1e88e5; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #ffffff; border-right: 1px solid #dee2e6; padding: 1rem; }
        .sidebar .nav-link { color: #495057; padding: 0.5rem 1rem; border-radius: 5px; margin-bottom: 0.25rem; }
        .sidebar .nav-link:hover { background-color: #e3f2fd; }
        .sidebar .nav-link.active { background-color: #1e88e5 !important; color: white !important; }
        .chapter-title { color: #1e88e5; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 3px solid #1e88e5; padding-bottom: 0.5rem; }
        .section-title { color: #42a5f5; margin-top: 2rem; margin-bottom: 1rem; border-left: 4px solid #42a5f5; padding-left: 0.75rem; }
        .highlight { background-color: #fff3e0; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #ff9800; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #1e88e5; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .code-block { background-color: #1e1e1e; color: white; border-radius: 5px; padding: 1rem; margin: 1rem 0; overflow-x: auto; }
        main { background-color: #ffffff; min-height: calc(100vh - 56px); padding: 2rem; }
        footer { margin-top: 3rem; background-color: #1e88e5; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid"><a class="navbar-brand" href="#"><i class="fas fa-chart-bar"></i><strong>統計解析学習教材</strong></a></div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>学習章</span></h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-1.html">第1章: 統計解析入門と環境構築</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-2.html">第2章: 記述統計学の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-3.html">第3章: 確率の基礎と確率分布</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-4.html">第4章: 推測統計の基礎</a></li>
                        <li class="nav-item"><a class="nav-link active" href="statistical-analysis-learning-material-5.html">第5章: 仮説検定の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-6.html">第6章: 分散分析とカイ二乗検定</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-7.html">第7章: 相関と回帰分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-8.html">第8章: 多変量解析入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-9.html">第9章: ベイズ統計と時系列分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-10.html">第10章: ノンパラメトリック検定と実践プロジェクト</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第5章: 仮説検定の基礎</h1>
                </div>

                <div id="chapter5">
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>仮説検定の基本的な考え方とプロセスを理解する</li>
                            <li>帰無仮説、対立仮説、有意水準、p値の意味を理解する</li>
                            <li>第1種の誤りと第2種の誤りを理解する</li>
                            <li>t検定を適切に選択し実行できる</li>
                        </ul>
                    </div>

                    <h3 class="section-title">5.1 仮説検定の基本概念</h3>

                    <h4>仮説検定とは</h4>
                    <p>
                        仮説検定は、データに基づいて仮説が正しいかどうかを統計的に判断する手法です。
                        「新薬は効果があるか」「処理前後で差があるか」といった問いに答えるために使われます。
                    </p>

                    <div class="mermaid">
                        flowchart TB
                            A([仮説の設定]) --> B[帰無仮説H₀と対立仮説H₁]
                            B --> C[有意水準αの設定]
                            C --> D[検定統計量の計算]
                            D --> E[p値の算出]
                            E --> F{p値 &lt; α?}
                            F -->|Yes| G[帰無仮説を棄却]
                            F -->|No| H[帰無仮説を棄却しない]

                            style A fill:#e3f2fd
                            style G fill:#ffebee
                            style H fill:#e8f5e9
                    </div>

                    <h4>帰無仮説と対立仮説</h4>
                    <ul>
                        <li><strong>帰無仮説（H₀）</strong>: 「差がない」「効果がない」という仮説。検定で否定したい仮説。</li>
                        <li><strong>対立仮説（H₁）</strong>: 「差がある」「効果がある」という仮説。検定で支持したい仮説。</li>
                    </ul>

                    <h4>有意水準とp値</h4>
                    <p>
                        <strong>有意水準（α）</strong>は、帰無仮説を棄却する基準となる確率で、通常は5%（0.05）または1%（0.01）に設定します。<br>
                        <strong>p値</strong>は、帰無仮説が正しいと仮定したときに、観測されたデータ以上に極端な結果が得られる確率です。
                    </p>

                    <div class="warning">
                        <h6>p値の解釈の注意点</h6>
                        <p>
                            <strong>p値 &lt; 0.05 の場合:</strong> 統計的に有意（帰無仮説を棄却）<br>
                            <strong>p値 ≥ 0.05 の場合:</strong> 統計的に有意でない（帰無仮説を棄却できない）<br>
                            注意: p値が小さいことは「効果が大きい」ことを意味しません。あくまで「偶然では説明しにくい」ということです。
                        </p>
                    </div>

                    <h3 class="section-title">5.2 検定の誤り</h3>

                    <h4>第1種の誤り（α）と第2種の誤り（β）</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th></th>
                                <th>H₀が真実</th>
                                <th>H₁が真実</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>H₀を棄却</strong></td>
                                <td style="background-color: #ffebee;">第1種の誤り（α）<br>偽陽性</td>
                                <td style="background-color: #e8f5e9;">正しい判断</td>
                            </tr>
                            <tr>
                                <td><strong>H₀を棄却しない</strong></td>
                                <td style="background-color: #e8f5e9;">正しい判断</td>
                                <td style="background-color: #ffebee;">第2種の誤り（β）<br>偽陰性</td>
                            </tr>
                        </tbody>
                    </table>

                    <p>
                        <strong>検出力（1-β）</strong>は、対立仮説が真のときに正しく帰無仮説を棄却できる確率です。
                        検出力を高めるには、標本サイズを大きくすることが有効です。
                    </p>

                    <h3 class="section-title">5.3 1標本t検定</h3>

                    <h4>1標本t検定の目的</h4>
                    <p>
                        1標本t検定は、標本平均が特定の値（μ₀）と異なるかどうかを検定します。
                        例：「製品の平均重量が規格値500gと異なるか」
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 1標本t検定
# 例：製品重量が規格値500gと異なるか
weights <- c(498, 502, 495, 505, 500, 497, 503, 499)

# 両側検定（μ ≠ 500）
result <- t.test(weights, mu=500)
print(result)

# 結果の解釈
print(paste("p値:", result$p.value))
if(result$p.value < 0.05) {
  print("帰無仮説を棄却: 平均は500gと異なる")
} else {
  print("帰無仮説を棄却できない: 平均が500gと異なるとは言えない")
}</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 1標本t検定
from scipy import stats

weights = [498, 502, 495, 505, 500, 497, 503, 499]

# 両側検定
t_stat, p_value = stats.ttest_1samp(weights, popmean=500)

print(f"t統計量: {t_stat}")
print(f"p値: {p_value}")

if p_value < 0.05:
    print("帰無仮説を棄却: 平均は500gと異なる")
else:
    print("帰無仮説を棄却できない")</code></pre>

                    <h3 class="section-title">5.4 2標本t検定</h3>

                    <h4>2標本t検定の目的</h4>
                    <p>
                        2標本t検定は、独立した2つのグループの平均値が異なるかを検定します。
                        例：「新薬群とプラセボ群で効果に差があるか」
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 2標本t検定
group_A <- c(75, 82, 78, 85, 80)  # 新薬群
group_B <- c(68, 72, 70, 75, 71)  # プラセボ群

# 等分散を仮定する検定
result_equal <- t.test(group_A, group_B, var.equal=TRUE)

# 等分散を仮定しない検定（Welchのt検定）
result_welch <- t.test(group_A, group_B, var.equal=FALSE)

print(result_welch)
print(paste("p値:", result_welch$p.value))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 2標本t検定
from scipy import stats

group_A = [75, 82, 78, 85, 80]
group_B = [68, 72, 70, 75, 71]

# 等分散を仮定する検定
t_stat, p_value = stats.ttest_ind(group_A, group_B,
                                   equal_var=True)

# 等分散を仮定しない検定（Welch）
t_stat_welch, p_value_welch = stats.ttest_ind(
    group_A, group_B, equal_var=False)

print(f"Welchのt検定 p値: {p_value_welch}")</code></pre>

                    <h3 class="section-title">5.5 対応のあるt検定</h3>

                    <h4>対応のあるt検定の目的</h4>
                    <p>
                        対応のあるt検定は、同一の対象に対する前後比較やペアデータの差を検定します。
                        例：「トレーニング前後でスコアが向上したか」
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 対応のあるt検定
before <- c(65, 70, 68, 72, 67, 69, 71, 66)
after  <- c(72, 75, 71, 78, 70, 74, 76, 69)

# 対応のあるt検定
result <- t.test(before, after, paired=TRUE)
print(result)

# 差の平均を確認
diff <- after - before
print(paste("平均差:", mean(diff)))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 対応のあるt検定
from scipy import stats

before = [65, 70, 68, 72, 67, 69, 71, 66]
after  = [72, 75, 71, 78, 70, 74, 76, 69]

# 対応のあるt検定
t_stat, p_value = stats.ttest_rel(before, after)

print(f"t統計量: {t_stat}")
print(f"p値: {p_value}")

import numpy as np
print(f"平均差: {np.mean(np.array(after) - np.array(before))}")</code></pre>

                    <div class="exercise-container">
                        <h5>実習 5-1: 仮説検定の実践</h5>
                        <p><strong>課題1: 1標本t検定</strong></p>
                        <p>
                            あるメーカーが製造するチョコレートの平均重量は50gと表示されています。
                            無作為に抽出した10個の実測値は以下の通りです：<br>
                            49.2, 50.5, 48.8, 50.1, 49.5, 50.3, 49.7, 50.0, 49.9, 50.2
                        </p>
                        <p>平均重量が50gと異なるかを検定してください（有意水準5%）。</p>

                        <p><strong>課題2: 2標本t検定</strong></p>
                        <p>
                            新しい学習法（A群）と従来の学習法（B群）で成績に差があるかを調べます：<br>
                            A群: 85, 90, 88, 92, 87<br>
                            B群: 78, 82, 80, 85, 79
                        </p>
                        <p>2つの学習法で平均点に差があるかを検定してください。</p>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>p値が0.03の場合、有意水準5%で帰無仮説をどう判断しますか？</li>
                            <li>第1種の誤りと第2種の誤りの違いを説明してください。</li>
                            <li>対応のあるt検定を使うべき状況を2つ挙げてください。</li>
                            <li>両側検定と片側検定の違いは何ですか？</li>
                            <li>「統計的に有意でない」という結果は「差がない」ことを証明していますか？</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4 mb-4">
                        <a href="statistical-analysis-learning-material-4.html" class="btn btn-secondary">← 前の章</a>
                        <a href="statistical-analysis-learning-material-6.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <footer class="text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
</body>
</html>