<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Struts 1.x学習教材 第6章 - バリデーション機能とエラーハンドリング</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #f57c00;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #f57c00;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #f57c00;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #ff9800;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #f57c00;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #2196f3;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #f57c00 !important;
            color: white !important;
        }

        /* ボタンスタイル */
        .btn-orange {
            background-color: #f57c00;
            border-color: #f57c00;
            color: white;
        }

        .btn-orange:hover {
            background-color: #e65100;
            border-color: #e65100;
            color: white;
        }

        /* バリデーション関連のスタイル */
        .validation-card {
            border: 2px solid #4caf50;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .validation-card .card-header {
            background-color: #e8f5e8;
            border-bottom: 1px solid #4caf50;
            font-weight: bold;
            color: #2e7d32;
        }

        /* アニメーション */
        .fade-in {
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg fixed-top">
        <div class="container">
            <a class="navbar-brand text-white fw-bold" href="#main-content">✅ Struts 1.x 学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="../README.md">📚 Strutsガイド</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="struts1-learning-material-5.html">⬅️ 第5章</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link text-white" href="struts1-learning-material-7.html">➡️ 第7章</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- メインコンテンツ -->
    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                        <span>第6章の内容</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="#intro">✅ はじめに</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#overview">🎯 バリデーションの重要性</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#actionform-validation">📋 ActionFormでのバリデーション</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#validator-framework">🔧 Validatorフレームワーク</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#validation-xml">📄 validation.xml設定</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#custom-validation">🔨 カスタムバリデーション</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#error-handling">⚠️ エラーハンドリング</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#best-practices">💡 ベストプラクティス</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#exercise">💻 実習課題</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#quiz">📝 理解度確認</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツエリア -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4" id="main-content">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3">
                    <h1 class="chapter-title">第6章 - バリデーション機能とエラーハンドリング</h1>
                </div>

                <!-- 学習目標 -->
                <div class="highlight">
                    <h3>🎯 この章の学習目標</h3>
                    <ul>
                        <li>Webアプリケーションにおけるバリデーションの重要性を理解する</li>
                        <li>ActionFormでの基本的なバリデーション実装方法を習得する</li>
                        <li>Validatorフレームワークを使った宣言的なバリデーションを学ぶ</li>
                        <li>カスタムバリデーションの実装方法を理解する</li>
                        <li>適切なエラーハンドリングとユーザビリティ向上のための手法を学習する</li>
                    </ul>
                </div>

                <!-- はじめに -->
                <section id="intro">
                    <h2 class="section-title">✅ はじめに</h2>
                    
                    <p>Webアプリケーションにおいて、<strong>バリデーション（入力検証）</strong>は極めて重要な機能です。ユーザーから送信されるデータが適切な形式であることを確認し、不正なデータによるアプリケーションの誤動作やセキュリティ問題を防ぐ役割を果たします。</p>

                    <div class="highlight">
                        <h4>💡 なぜバリデーションが必要なのか？</h4>
                        <p>Webアプリケーションは、さまざまなユーザーからの多様な入力を受け取ります。しかし、すべてのユーザーが正しいデータを入力するとは限りません：</p>
                        
                        <ul>
                            <li><strong>入力ミス</strong>：メールアドレスの記述間違い、必須項目の未入力</li>
                            <li><strong>悪意のある入力</strong>：SQLインジェクション、XSS攻撃などを狙った不正なデータ</li>
                            <li><strong>システム制限</strong>：データベースのフィールド長を超える入力</li>
                            <li><strong>業務ルール違反</strong>：年齢制限、在庫数超過など業務固有の制約</li>
                        </ul>
                        
                        <p><strong>例え：</strong> バリデーションは「空港のセキュリティチェック」のようなものです。すべての荷物（入力データ）をチェックし、危険物（不正なデータ）や制限を超えるもの（形式違反）を事前に発見して、飛行機（システム）の安全な運航を保証します。</p>
                    </div>

                    <div class="mermaid">
                        graph LR
                            A[ユーザー入力] --> B[バリデーション処理]
                            B --> C{入力チェック}
                            C -->|OK| D[業務処理実行]
                            C -->|NG| E[エラーメッセージ表示]
                            D --> F[成功画面]
                            E --> G[入力画面に戻る]
                            
                            style A fill:#e3f2fd
                            style B fill:#e8f5e8
                            style C fill:#fff3e0
                            style D fill:#e8f5e8
                            style E fill:#ffebee
                            style F fill:#e8f5e8
                            style G fill:#fff3e0
                    </div>
                </section>

                <!-- バリデーションの重要性 -->
                <section id="overview">
                    <h2 class="section-title">🎯 Webアプリケーションにおけるバリデーションの重要性</h2>
                    
                    <p>Webアプリケーションでのバリデーションには、複数の観点から重要性があります。</p>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card validation-card h-100">
                                <div class="card-header">
                                    🛡️ セキュリティの保護
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>SQLインジェクション攻撃の防止</li>
                                        <li>クロスサイトスクリプティング（XSS）対策</li>
                                        <li>不正なファイルアップロードの防止</li>
                                        <li>パスワードポリシーの強制</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <div class="card validation-card h-100">
                                <div class="card-header">
                                    🗄️ データ整合性の維持
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>データベース制約違反の防止</li>
                                        <li>データ型の適合性確保</li>
                                        <li>必須項目の入力保証</li>
                                        <li>一意制約の確認</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="card validation-card h-100">
                                <div class="card-header">
                                    👤 ユーザビリティの向上
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>わかりやすいエラーメッセージの提供</li>
                                        <li>入力値の保持（再入力の手間軽減）</li>
                                        <li>リアルタイム検証によるUX向上</li>
                                        <li>適切な入力形式の案内</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <div class="card validation-card h-100">
                                <div class="card-header">
                                    💼 業務ルールの確保
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>年齢制限や期限の確認</li>
                                        <li>在庫数や予算制限のチェック</li>
                                        <li>権限に基づく入力制限</li>
                                        <li>複雑な業務ロジックの適用</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3>📊 バリデーションの種類と実装レイヤー</h3>
                    
                    <div class="info">
                        <h4>🔍 クライアントサイドバリデーション vs サーバーサイドバリデーション</h4>
                        
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>種類</th>
                                    <th>実装場所</th>
                                    <th>利点</th>
                                    <th>注意点</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>クライアントサイド</strong></td>
                                    <td>JavaScript<br>（ブラウザ）</td>
                                    <td>即座のフィードバック<br>サーバー負荷軽減</td>
                                    <td>簡単に回避可能<br>セキュリティ面で不十分</td>
                                </tr>
                                <tr>
                                    <td><strong>サーバーサイド</strong></td>
                                    <td>Java<br>（Strutsアプリケーション）</td>
                                    <td>確実なセキュリティ<br>回避不可能</td>
                                    <td>サーバー往復が必要<br>レスポンス時間の遅延</td>
                                </tr>
                            </tbody>
                        </table>
                        
                        <p><strong>重要:</strong> セキュリティ上の理由から、<strong>サーバーサイドバリデーションは必須</strong>です。クライアントサイドバリデーションは、ユーザビリティ向上のための補助的な機能として位置づけるべきです。</p>
                    </div>
                </section>

                <!-- ActionFormでのバリデーション -->
                <section id="actionform-validation">
                    <h2 class="section-title">📋 ActionFormでのバリデーション実装</h2>
                    
                    <p>Struts 1.xでは、<strong>ActionForm</strong>クラスの<code>validate()</code>メソッドをオーバーライドすることで、サーバーサイドバリデーションを実装できます。</p>

                    <h3>🔍 基本的なvalidateメソッドの実装</h3>
                    
                    <pre class="code-block"><code class="language-java">public class UserForm extends ActionForm {
    private String username;
    private String email;
    private String password;
    private int age;
    
    // getter/setterメソッド（省略）
    
    @Override
    public ActionErrors validate(ActionMapping mapping, 
                                HttpServletRequest request) {
        
        ActionErrors errors = new ActionErrors();
        
        // ユーザー名の必須チェック
        if (username == null || username.trim().length() == 0) {
            errors.add("username", new ActionMessage("error.required", "ユーザー名"));
        } else if (username.length() > 20) {
            errors.add("username", new ActionMessage("error.maxlength", "ユーザー名", "20"));
        }
        
        // メールアドレスの形式チェック
        if (email != null && !email.trim().isEmpty()) {
            if (!isValidEmail(email)) {
                errors.add("email", new ActionMessage("error.email", "メールアドレス"));
            }
        } else {
            errors.add("email", new ActionMessage("error.required", "メールアドレス"));
        }
        
        // パスワードの強度チェック
        if (password == null || password.length() < 8) {
            errors.add("password", new ActionMessage("error.password.minlength", "8"));
        }
        
        // 年齢の範囲チェック
        if (age < 0 || age > 150) {
            errors.add("age", new ActionMessage("error.range", "年齢", "0", "150"));
        }
        
        return errors;
    }
    
    // メールアドレス形式チェックのヘルパーメソッド
    private boolean isValidEmail(String email) {
        String emailPattern = "^[A-Za-z0-9+_.-]+@([A-Za-z0-9.-]+\\.[A-Za-z]{2,})$";
        return email.matches(emailPattern);
    }
}</code></pre>

                    <div class="highlight">
                        <h4>📝 validateメソッドの仕組み</h4>
                        
                        <ol>
                            <li><strong>ActionErrorsオブジェクトの生成</strong>：エラー情報を格納するコンテナを作成</li>
                            <li><strong>各フィールドの検証</strong>：業務ルールに基づいて入力値をチェック</li>
                            <li><strong>エラーメッセージの追加</strong>：問題がある場合はActionMessageを作成してActionErrorsに追加</li>
                            <li><strong>結果の返却</strong>：エラーがあるかどうかに関わらずActionErrorsオブジェクトを返却</li>
                        </ol>
                        
                        <p><strong>重要:</strong> ActionErrorsが空でない場合、Strutsフレームワークは自動的にAction処理をスキップし、input属性で指定されたページに遷移します。</p>
                    </div>

                    <h3>🔄 バリデーション処理の流れ</h3>
                    
                    <div class="mermaid">
                        sequenceDiagram
                            participant User as ユーザー
                            participant Browser as ブラウザ
                            participant Struts as Strutsフレームワーク
                            participant Form as ActionForm
                            participant Action as Action
                            
                            User->>Browser: フォーム送信
                            Browser->>Struts: HTTPリクエスト
                            Struts->>Form: ActionFormインスタンス作成
                            Struts->>Form: リクエストパラメータ設定
                            
                            alt validate="true"の場合
                                Struts->>Form: validate()メソッド実行
                                Form->>Struts: ActionErrors返却
                                
                                alt エラーありの場合
                                    Struts->>Browser: input属性のページに遷移
                                    Browser->>User: エラーメッセージ表示
                                else エラーなしの場合
                                    Struts->>Action: execute()メソッド実行
                                    Action->>Struts: 正常処理結果
                                    Struts->>Browser: 成功ページに遷移
                                end
                            else validate="false"の場合
                                Struts->>Action: validate()をスキップしてexecute()実行
                            end
                    </div>

                    <h3>💬 メッセージリソースの設定</h3>
                    
                    <p>エラーメッセージは、<strong>MessageResources.properties</strong>ファイルに定義します：</p>

                    <pre class="code-block"><code class="language-ini"># 基本的なエラーメッセージ
error.required = {0}は必須項目です。
error.maxlength = {0}は{1}文字以下で入力してください。
error.minlength = {0}は{1}文字以上で入力してください。
error.email = {0}の形式が正しくありません。
error.range = {0}は{1}から{2}の範囲で入力してください。

# 特定項目のエラーメッセージ
error.password.minlength = パスワードは{0}文字以上である必要があります。
error.username.duplicate = このユーザー名は既に使用されています。</code></pre>

                    <div class="info">
                        <h4>📱 パラメータ化されたメッセージの利点</h4>
                        <ul>
                            <li><strong>再利用性</strong>：同じメッセージ形式を複数の項目で使用可能</li>
                            <li><strong>国際化対応</strong>：言語ごとに異なるファイルを用意するだけで多言語対応</li>
                            <li><strong>保守性</strong>：メッセージ変更時にコード修正が不要</li>
                            <li><strong>統一性</strong>：アプリケーション全体で一貫したメッセージ形式</li>
                        </ul>
                    </div>
                </section>

                <!-- Validatorフレームワーク -->
                <section id="validator-framework">
                    <h2 class="section-title">🔧 Validatorフレームワークの活用</h2>
                    
                    <p>ActionFormのvalidateメソッドでバリデーションを実装することもできますが、より効率的で保守性の高い方法として、<strong>Validatorフレームワーク</strong>があります。これは宣言的にバリデーションルールを定義できる仕組みです。</p>

                    <div class="highlight">
                        <h4>⚖️ ActionFormのvalidate vs Validatorフレームワーク</h4>
                        
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>項目</th>
                                    <th>ActionForm validate()</th>
                                    <th>Validatorフレームワーク</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>記述方法</strong></td>
                                    <td>Javaコード</td>
                                    <td>XML設定ファイル</td>
                                </tr>
                                <tr>
                                    <td><strong>保守性</strong></td>
                                    <td>コード変更が必要</td>
                                    <td>設定ファイル変更のみ</td>
                                </tr>
                                <tr>
                                    <td><strong>再利用性</strong></td>
                                    <td>クラスごとに個別実装</td>
                                    <td>共通ルールの再利用可能</td>
                                </tr>
                                <tr>
                                    <td><strong>複雑度</strong></td>
                                    <td>複雑なロジックも自由に実装</td>
                                    <td>基本的なバリデーションに向く</td>
                                </tr>
                                <tr>
                                    <td><strong>JavaScript生成</strong></td>
                                    <td>手動実装</td>
                                    <td>自動生成可能</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3>🛠️ Validatorフレームワークの基本設定</h3>

                    <h4>1️⃣ struts-config.xmlでの設定</h4>
                    
                    <pre class="code-block"><code class="language-xml">&lt;struts-config&gt;
    
    &lt;!-- Validatorプラグインの設定 --&gt;
    &lt;plug-in className="org.apache.struts.validator.ValidatorPlugIn"&gt;
        &lt;set-property property="pathnames" value="/WEB-INF/validator-rules.xml,/WEB-INF/validation.xml"/&gt;
    &lt;/plug-in&gt;
    
    &lt;!-- ValidatorActionFormの使用 --&gt;
    &lt;form-beans&gt;
        &lt;form-bean name="userForm" type="org.apache.struts.validator.ValidatorActionForm"/&gt;
    &lt;/form-beans&gt;
    
&lt;/struts-config&gt;</code></pre>

                    <h4>2️⃣ 標準ルールファイル（validator-rules.xml）</h4>
                    
                    <p>Strutsには、以下のような標準的なバリデーションルールが予め定義されています：</p>

                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ルール名</th>
                                <th>説明</th>
                                <th>用途例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>required</code></td>
                                <td>必須入力チェック</td>
                                <td>名前、メールアドレス</td>
                            </tr>
                            <tr>
                                <td><code>mask</code></td>
                                <td>正規表現パターンチェック</td>
                                <td>郵便番号、電話番号</td>
                            </tr>
                            <tr>
                                <td><code>email</code></td>
                                <td>メールアドレス形式チェック</td>
                                <td>メールアドレス</td>
                            </tr>
                            <tr>
                                <td><code>minlength</code></td>
                                <td>最小文字数チェック</td>
                                <td>パスワード</td>
                            </tr>
                            <tr>
                                <td><code>maxlength</code></td>
                                <td>最大文字数チェック</td>
                                <td>コメント、説明文</td>
                            </tr>
                            <tr>
                                <td><code>range</code></td>
                                <td>数値範囲チェック</td>
                                <td>年齢、価格</td>
                            </tr>
                            <tr>
                                <td><code>date</code></td>
                                <td>日付形式チェック</td>
                                <td>生年月日</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- validation.xml設定 -->
                <section id="validation-xml">
                    <h2 class="section-title">📄 validation.xmlでのルール定義</h2>
                    
                    <p><strong>validation.xml</strong>ファイルでは、各フォームに対するバリデーションルールを定義します。</p>

                    <h3>📝 基本的なvalidation.xmlの例</h3>
                    
                    <pre class="code-block"><code class="language-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE form-validation PUBLIC
    "-//Apache Software Foundation//DTD Commons Validator Rules Configuration 1.3.0//EN"
    "http://jakarta.apache.org/commons/dtds/validator_1_3_0.dtd"&gt;

&lt;form-validation&gt;
    
    &lt;!-- グローバル定数の定義 --&gt;
    &lt;global&gt;
        &lt;constant&gt;
            &lt;constant-name&gt;zip&lt;/constant-name&gt;
            &lt;constant-value&gt;^\d{3}-\d{4}$&lt;/constant-value&gt;
        &lt;/constant&gt;
        &lt;constant&gt;
            &lt;constant-name&gt;phone&lt;/constant-name&gt;
            &lt;constant-value&gt;^\d{2,4}-\d{2,4}-\d{4}$&lt;/constant-value&gt;
        &lt;/constant&gt;
    &lt;/global&gt;
    
    &lt;!-- ユーザー登録フォームのバリデーション --&gt;
    &lt;formset&gt;
        &lt;form name="/userRegister"&gt;
            
            &lt;!-- ユーザー名：必須、最大20文字 --&gt;
            &lt;field property="username" depends="required,maxlength"&gt;
                &lt;arg0 key="label.username"/&gt;
                &lt;arg1 name="maxlength" key="${var:maxlength}" resource="false"/&gt;
                &lt;var&gt;
                    &lt;var-name&gt;maxlength&lt;/var-name&gt;
                    &lt;var-value&gt;20&lt;/var-value&gt;
                &lt;/var&gt;
            &lt;/field&gt;
            
            &lt;!-- メールアドレス：必須、形式チェック --&gt;
            &lt;field property="email" depends="required,email"&gt;
                &lt;arg0 key="label.email"/&gt;
            &lt;/field&gt;
            
            &lt;!-- パスワード：必須、最小8文字 --&gt;
            &lt;field property="password" depends="required,minlength"&gt;
                &lt;arg0 key="label.password"/&gt;
                &lt;arg1 name="minlength" key="${var:minlength}" resource="false"/&gt;
                &lt;var&gt;
                    &lt;var-name&gt;minlength&lt;/var-name&gt;
                    &lt;var-value&gt;8&lt;/var-value&gt;
                &lt;/var&gt;
            &lt;/field&gt;
            
            &lt;!-- 年齢：必須、範囲チェック（0-150） --&gt;
            &lt;field property="age" depends="required,intRange"&gt;
                &lt;arg0 key="label.age"/&gt;
                &lt;arg1 name="intRange" key="${var:min}" resource="false"/&gt;
                &lt;arg2 name="intRange" key="${var:max}" resource="false"/&gt;
                &lt;var&gt;
                    &lt;var-name&gt;min&lt;/var-name&gt;
                    &lt;var-value&gt;0&lt;/var-value&gt;
                &lt;/var&gt;
                &lt;var&gt;
                    &lt;var-name&gt;max&lt;/var-name&gt;
                    &lt;var-value&gt;150&lt;/var-value&gt;
                &lt;/var&gt;
            &lt;/field&gt;
            
            &lt;!-- 郵便番号：パターンチェック（任意項目） --&gt;
            &lt;field property="zipCode" depends="mask"&gt;
                &lt;arg0 key="label.zipcode"/&gt;
                &lt;var&gt;
                    &lt;var-name&gt;mask&lt;/var-name&gt;
                    &lt;var-value&gt;${zip}&lt;/var-value&gt;
                &lt;/var&gt;
            &lt;/field&gt;
            
        &lt;/form&gt;
    &lt;/formset&gt;
    
&lt;/form-validation&gt;</code></pre>

                    <div class="highlight">
                        <h4>🔍 validation.xmlの要素説明</h4>
                        
                        <ul>
                            <li><strong>&lt;global&gt;</strong>：全体で共通使用する定数や設定</li>
                            <li><strong>&lt;formset&gt;</strong>：フォームのグループ化（国際化対応時にlocale別も可能）</li>
                            <li><strong>&lt;form name="/actionPath"&gt;</strong>：アクションパスに対応するバリデーション定義</li>
                            <li><strong>&lt;field&gt;</strong>：個別フィールドのバリデーション設定</li>
                            <li><strong>depends属性</strong>：適用するバリデーションルール（カンマ区切りで複数指定可能）</li>
                            <li><strong>&lt;arg&gt;</strong>：エラーメッセージのパラメータ</li>
                            <li><strong>&lt;var&gt;</strong>：ルール固有の変数（maxlength、minlength等）</li>
                        </ul>
                    </div>

                    <h3>🌐 クライアントサイドバリデーションの自動生成</h3>
                    
                    <p>Validatorフレームワークでは、サーバーサイドのルール定義から自動的にJavaScriptを生成できます：</p>

                    <pre class="code-block"><code class="language-jsp">&lt;%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %&gt;

&lt;html:html&gt;
&lt;head&gt;
    &lt;title&gt;ユーザー登録&lt;/title&gt;
    
    &lt;!-- Validatorが生成するJavaScript --&gt;
    &lt;html:javascript formName="userForm"/&gt;
&lt;/head&gt;
&lt;body&gt;
    
    &lt;!-- onsubmit属性でクライアントサイドバリデーション実行 --&gt;
    &lt;html:form action="/userRegister" onsubmit="return validateUserForm(this)"&gt;
        &lt;!-- フォーム内容 --&gt;
    &lt;/html:form&gt;
    
&lt;/body&gt;
&lt;/html:html&gt;</code></pre>

                    <div class="info">
                        <h4>⚡ クライアントサイドバリデーションの利点</h4>
                        <ul>
                            <li><strong>即座のフィードバック</strong>：サーバー通信なしでエラーを通知</li>
                            <li><strong>ユーザビリティ向上</strong>：入力中にリアルタイムでチェック</li>
                            <li><strong>サーバー負荷軽減</strong>：明らかなエラーを事前に除去</li>
                            <li><strong>自動生成</strong>：サーバーサイドルールと一致するJavaScriptを自動作成</li>
                        </ul>
                        
                        <p><strong>注意:</strong> クライアントサイドバリデーションは補助的な機能です。セキュリティ上の理由から、必ずサーバーサイドでも同じチェックを行ってください。</p>
                    </div>
                </section>

                <!-- カスタムバリデーション -->
                <section id="custom-validation">
                    <h2 class="section-title">🔨 カスタムバリデーションの実装</h2>
                    
                    <p>標準的なValidatorルールでは対応できない複雑な業務ルールについては、独自のカスタムバリデーションを実装できます。</p>

                    <h3>🛠️ カスタムバリデータの作成手順</h3>

                    <h4>1️⃣ カスタムバリデータクラスの実装</h4>
                    
                    <pre class="code-block"><code class="language-java">package com.example.validator;

import org.apache.commons.validator.Field;
import org.apache.commons.validator.ValidatorAction;
import org.apache.commons.validator.ValidatorException;
import org.apache.struts.action.ActionMessages;
import org.apache.struts.validator.Resources;

import javax.servlet.http.HttpServletRequest;

public class CustomValidator {
    
    /**
     * ユーザー名の重複チェック
     * データベースに同じユーザー名が存在するかチェックします
     */
    public static boolean validateUniqueUsername(Object bean,
                                               ValidatorAction va,
                                               Field field,
                                               ActionMessages errors,
                                               HttpServletRequest request) {
        
        String value = (String) field.getProperty(bean);
        
        if (value == null || value.trim().isEmpty()) {
            return true; // 空文字の場合はrequiredルールに任せる
        }
        
        // データベースでの重複チェック（実際のDAOクラスを使用）
        try {
            UserDAO userDAO = new UserDAO();
            if (userDAO.existsByUsername(value)) {
                errors.add(field.getKey(), Resources.getActionMessage(
                    request, va, field));
                return false;
            }
        } catch (Exception e) {
            // ログ出力
            System.err.println("Database error during username validation: " + e.getMessage());
            return false;
        }
        
        return true;
    }
    
    /**
     * 日付の論理チェック（開始日 <= 終了日）
     */
    public static boolean validateDateRange(Object bean,
                                          ValidatorAction va,
                                          Field field,
                                          ActionMessages errors,
                                          HttpServletRequest request) {
        
        // フィールド変数から開始日・終了日のプロパティ名を取得
        String startDateProperty = field.getVarValue("startDate");
        String endDateProperty = field.getVarValue("endDate");
        
        try {
            // BeanUtilsを使用してプロパティ値を取得
            String startDateStr = BeanUtils.getProperty(bean, startDateProperty);
            String endDateStr = BeanUtils.getProperty(bean, endDateProperty);
            
            if (startDateStr != null && endDateStr != null && 
                !startDateStr.isEmpty() && !endDateStr.isEmpty()) {
                
                SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd");
                Date startDate = sdf.parse(startDateStr);
                Date endDate = sdf.parse(endDateStr);
                
                if (startDate.after(endDate)) {
                    errors.add(field.getKey(), Resources.getActionMessage(
                        request, va, field));
                    return false;
                }
            }
            
        } catch (Exception e) {
            errors.add(field.getKey(), Resources.getActionMessage(
                request, va, field));
            return false;
        }
        
        return true;
    }
}</code></pre>

                    <h4>2️⃣ validator-rules.xmlへの追加</h4>
                    
                    <pre class="code-block"><code class="language-xml">&lt;validator name="uniqueUsername"
           classname="com.example.validator.CustomValidator"
           method="validateUniqueUsername"
           methodParams="java.lang.Object,
                        org.apache.commons.validator.ValidatorAction,
                        org.apache.commons.validator.Field,
                        org.apache.struts.action.ActionMessages,
                        javax.servlet.http.HttpServletRequest"
           msg="errors.username.duplicate"/&gt;

&lt;validator name="dateRange"
           classname="com.example.validator.CustomValidator"
           method="validateDateRange"
           methodParams="java.lang.Object,
                        org.apache.commons.validator.ValidatorAction,
                        org.apache.commons.validator.Field,
                        org.apache.struts.action.ActionMessages,
                        javax.servlet.http.HttpServletRequest"
           msg="errors.date.range"/&gt;</code></pre>

                    <h4>3️⃣ validation.xmlでの使用</h4>
                    
                    <pre class="code-block"><code class="language-xml">&lt;field property="username" depends="required,maxlength,uniqueUsername"&gt;
    &lt;arg0 key="label.username"/&gt;
    &lt;arg1 name="maxlength" key="${var:maxlength}" resource="false"/&gt;
    &lt;var&gt;
        &lt;var-name&gt;maxlength&lt;/var-name&gt;
        &lt;var-value&gt;20&lt;/var-value&gt;
    &lt;/var&gt;
&lt;/field&gt;

&lt;field property="dummy" depends="dateRange"&gt;
    &lt;arg0 key="label.date.period"/&gt;
    &lt;var&gt;
        &lt;var-name&gt;startDate&lt;/var-name&gt;
        &lt;var-value&gt;startDate&lt;/var-value&gt;
    &lt;/var&gt;
    &lt;var&gt;
        &lt;var-name&gt;endDate&lt;/var-name&gt;
        &lt;var-value&gt;endDate&lt;/var-value&gt;
    &lt;/var&gt;
&lt;/field&gt;</code></pre>

                    <div class="warning">
                        <h4>⚠️ カスタムバリデータ実装時の注意点</h4>
                        <ul>
                            <li><strong>パフォーマンス</strong>：データベース接続など重い処理は必要最小限に</li>
                            <li><strong>例外処理</strong>：外部リソースへのアクセス時は適切な例外処理を実装</li>
                            <li><strong>null安全性</strong>：入力値がnullや空文字の場合の処理を考慮</li>
                            <li><strong>分離原則</strong>：バリデーション処理にビジネスロジックを混入させない</li>
                        </ul>
                    </div>
                </section>

                <!-- エラーハンドリング -->
                <section id="error-handling">
                    <h2 class="section-title">⚠️ 効果的なエラーハンドリング</h2>
                    
                    <p>バリデーションエラーが発生した際のエラーハンドリングは、ユーザビリティに大きく影響します。適切なエラー表示とユーザーガイダンスが重要です。</p>

                    <h3>🎨 ユーザーフレンドリーなエラー表示</h3>

                    <h4>📋 基本的なエラー表示パターン</h4>
                    
                    <pre class="code-block"><code class="language-jsp">&lt;%-- 全体のエラーメッセージ表示 --%&gt;
&lt;logic:messagesPresent&gt;
    &lt;div class="alert alert-danger"&gt;
        &lt;h4&gt;入力内容に問題があります&lt;/h4&gt;
        &lt;ul&gt;
            &lt;html:messages id="error"&gt;
                &lt;li&gt;&lt;bean:write name="error"/&gt;&lt;/li&gt;
            &lt;/html:messages&gt;
        &lt;/ul&gt;
    &lt;/div&gt;
&lt;/logic:messagesPresent&gt;

&lt;html:form action="/userRegister"&gt;
    &lt;table&gt;
        &lt;tr&gt;
            &lt;td&gt;ユーザー名:&lt;/td&gt;
            &lt;td&gt;
                &lt;html:text property="username"/&gt;
                &lt;!-- 特定フィールドのエラー表示 --&gt;
                &lt;logic:messagesPresent property="username"&gt;
                    &lt;div class="field-error"&gt;
                        &lt;html:messages id="error" property="username"&gt;
                            &lt;span class="error-text"&gt;&lt;bean:write name="error"/&gt;&lt;/span&gt;
                        &lt;/html:messages&gt;
                    &lt;/div&gt;
                &lt;/logic:messagesPresent&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;!-- 他のフィールド --&gt;
    &lt;/table&gt;
&lt;/html:form&gt;</code></pre>

                    <h4>🎯 エラー表示のベストプラクティス</h4>
                    
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-success text-white">
                                    ✅ 推奨されるアプローチ
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>具体的で実行可能なメッセージ</li>
                                        <li>エラー箇所の明確な指示</li>
                                        <li>入力値の保持</li>
                                        <li>視覚的に分かりやすい表示</li>
                                        <li>正しい入力例の提示</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card h-100">
                                <div class="card-header bg-danger text-white">
                                    ❌ 避けるべきアプローチ
                                </div>
                                <div class="card-body">
                                    <ul class="mb-0">
                                        <li>技術的すぎるエラーメッセージ</li>
                                        <li>「エラーが発生しました」のような曖昧な表現</li>
                                        <li>入力値のクリア</li>
                                        <li>エラー箇所が分からない表示</li>
                                        <li>解決方法の説明不足</li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <h3>🔄 Action処理でのエラーハンドリング</h3>
                    
                    <p>バリデーションエラー以外にも、Action処理中に業務ロジックエラーが発生する場合があります：</p>

                    <pre class="code-block"><code class="language-java">public ActionForward execute(ActionMapping mapping, ActionForm form,
                            HttpServletRequest request, HttpServletResponse response)
                            throws Exception {
    
    UserForm userForm = (UserForm) form;
    ActionMessages errors = new ActionMessages();
    
    try {
        // 業務処理の実行
        UserService userService = new UserService();
        userService.registerUser(userForm.getUsername(), 
                               userForm.getEmail(), 
                               userForm.getPassword());
        
        // 成功メッセージの設定
        ActionMessages messages = new ActionMessages();
        messages.add(ActionMessages.GLOBAL_MESSAGE, 
                    new ActionMessage("message.user.register.success"));
        saveMessages(request, messages);
        
        return mapping.findForward("success");
        
    } catch (DuplicateUserException e) {
        // 重複ユーザーエラー
        errors.add("username", new ActionMessage("error.username.duplicate"));
        saveErrors(request, errors);
        return mapping.getInputForward();
        
    } catch (InvalidEmailException e) {
        // メールアドレスエラー
        errors.add("email", new ActionMessage("error.email.invalid"));
        saveErrors(request, errors);
        return mapping.getInputForward();
        
    } catch (SystemException e) {
        // システムエラー
        log.error("System error during user registration", e);
        errors.add(ActionMessages.GLOBAL_MESSAGE, 
                  new ActionMessage("error.system.general"));
        saveErrors(request, errors);
        return mapping.findForward("error");
    }
}</code></pre>

                    <div class="info">
                        <h4>💡 エラーハンドリングの戦略</h4>
                        <ul>
                            <li><strong>例外の分類</strong>：業務例外とシステム例外を明確に分離</li>
                            <li><strong>適切な遷移先</strong>：エラー種類に応じた適切なページに遷移</li>
                            <li><strong>ログの記録</strong>：デバッグに必要な情報を適切にログ出力</li>
                            <li><strong>ユーザー向けメッセージ</strong>：技術的な詳細を隠した分かりやすいメッセージ</li>
                        </ul>
                    </div>
                </section>

                <!-- ベストプラクティス -->
                <section id="best-practices">
                    <h2 class="section-title">💡 バリデーションのベストプラクティス</h2>

                    <div class="highlight">
                        <h4>✅ 設計・実装のベストプラクティス</h4>
                        <ul>
                            <li><strong>多層防御</strong>：クライアント側とサーバー側の両方でバリデーション実装</li>
                            <li><strong>早期チェック</strong>：可能な限り早い段階でのエラー検出</li>
                            <li><strong>適切な分離</strong>：バリデーションロジックとビジネスロジックの分離</li>
                            <li><strong>再利用性</strong>：共通的なバリデーションルールの部品化</li>
                            <li><strong>保守性</strong>：設定ファイルによる宣言的なルール定義</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h4>⚠️ セキュリティ考慮事項</h4>
                        <ul>
                            <li><strong>クライアント側バリデーションは補助的</strong>：必ずサーバー側でも同様のチェック実装</li>
                            <li><strong>入力値のサニタイズ</strong>：HTMLエスケープなどの適切な処理</li>
                            <li><strong>SQLインジェクション対策</strong>：プリペアドステートメントの使用</li>
                            <li><strong>ファイルアップロード</strong>：ファイル種類・サイズの厳格なチェック</li>
                        </ul>
                    </div>

                    <h3>📊 パフォーマンス最適化</h3>
                    
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>項目</th>
                                <th>推奨アプローチ</th>
                                <th>理由</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>データベースアクセス</td>
                                <td>必要最小限に抑制</td>
                                <td>バリデーション処理の高速化</td>
                            </tr>
                            <tr>
                                <td>正規表現</td>
                                <td>コンパイル済みパターンの再利用</td>
                                <td>CPU使用率の削減</td>
                            </tr>
                            <tr>
                                <td>エラーメッセージ</td>
                                <td>MessageResourcesキャッシュ活用</td>
                                <td>メモリ効率とパフォーマンス向上</td>
                            </tr>
                            <tr>
                                <td>バリデーション順序</td>
                                <td>軽いチェックから重いチェックへ</td>
                                <td>早期エラー検出による処理短縮</td>
                            </tr>
                        </tbody>
                    </table>
                </section>

                <!-- 実習課題 -->
                <section id="exercise">
                    <div class="exercise-container">
                        <h2>💻 実習課題</h2>
                        
                        <h3>📋 課題1: ActionFormでのバリデーション実装</h3>
                        <p>以下の仕様に従って、商品登録フォームのバリデーションを実装してください。</p>
                        
                        <div class="highlight">
                            <h4>🎯 バリデーション要件</h4>
                            <ul>
                                <li><strong>商品名</strong>：必須、最大50文字</li>
                                <li><strong>価格</strong>：必須、正の整数、最大999,999円</li>
                                <li><strong>カテゴリID</strong>：必須、1-10の範囲</li>
                                <li><strong>商品説明</strong>：任意、最大500文字</li>
                                <li><strong>発売日</strong>：必須、YYYY-MM-DD形式、今日以降の日付</li>
                            </ul>
                        </div>

                        <h4>💡 解答のポイント</h4>
                        <details>
                            <summary>クリックしてヒントを表示</summary>
                            <div class="info">
                                <ul>
                                    <li>ActionFormのvalidateメソッドをオーバーライド</li>
                                    <li>各フィールドのチェック処理を順次実装</li>
                                    <li>日付形式チェックにはSimpleDateFormatを使用</li>
                                    <li>適切なエラーメッセージキーを使用</li>
                                </ul>
                            </div>
                        </details>

                        <h3>📋 課題2: Validatorフレームワーク設定</h3>
                        <p>課題1と同じ要件をValidatorフレームワークで実装してください。</p>
                        
                        <div class="highlight">
                            <h4>🎯 作成ファイル</h4>
                            <ul>
                                <li>validation.xml：バリデーションルール定義</li>
                                <li>MessageResources.properties：エラーメッセージ定義</li>
                                <li>JSPページ：エラー表示対応</li>
                            </ul>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <section id="quiz">
                    <div class="quiz-container">
                        <h2>📝 理解度確認クイズ</h2>

                        <div class="quiz-item">
                            <h4>❓ 問題1</h4>
                            <p>ActionFormの<strong>validate()</strong>メソッドが<code>null</code>または空のActionErrorsを返した場合、Strutsはどのような動作をしますか？</p>
                            
                            <div class="quiz-options">
                                <label><input type="radio" name="q1" value="a"> a) エラーページに遷移する</label><br>
                                <label><input type="radio" name="q1" value="b"> b) Actionクラスのexecute()メソッドを実行する</label><br>
                                <label><input type="radio" name="q1" value="c"> c) input属性のページに遷移する</label><br>
                                <label><input type="radio" name="q1" value="d"> d) 処理を停止してエラーを出力する</label>
                            </div>
                            
                            <div class="quiz-answer" style="display: none;">
                                <strong>正解: b) Actionクラスのexecute()メソッドを実行する</strong><br>
                                ActionErrorsが空（エラーなし）の場合、バリデーションが成功したとみなされ、通常通りActionクラスの処理が実行されます。
                            </div>
                        </div>

                        <div class="quiz-item">
                            <h4>❓ 問題2</h4>
                            <p>Validatorフレームワークで、複数のバリデーションルールを一つのフィールドに適用する場合、<code>depends</code>属性にはどのように記述しますか？</p>
                            
                            <div class="quiz-options">
                                <label><input type="radio" name="q2" value="a"> a) depends="required AND maxlength"</label><br>
                                <label><input type="radio" name="q2" value="b"> b) depends="required,maxlength"</label><br>
                                <label><input type="radio" name="q2" value="c"> c) depends="required|maxlength"</label><br>
                                <label><input type="radio" name="q2" value="d"> d) depends="required;maxlength"</label>
                            </div>
                            
                            <div class="quiz-answer" style="display: none;">
                                <strong>正解: b) depends="required,maxlength"</strong><br>
                                複数のバリデーションルールは、カンマ（,）で区切って指定します。記載された順序で実行されます。
                            </div>
                        </div>

                        <div class="quiz-item">
                            <h4>❓ 問題3</h4>
                            <p>クライアントサイドバリデーションについて、セキュリティの観点から正しい記述はどれですか？</p>
                            
                            <div class="quiz-options">
                                <label><input type="radio" name="q3" value="a"> a) クライアントサイドバリデーションのみで十分</label><br>
                                <label><input type="radio" name="q3" value="b"> b) サーバーサイドバリデーションのみで十分</label><br>
                                <label><input type="radio" name="q3" value="c"> c) 必ずサーバーサイドでもバリデーションを行う必要がある</label><br>
                                <label><input type="radio" name="q3" value="d"> d) どちらか一方があればよい</label>
                            </div>
                            
                            <div class="quiz-answer" style="display: none;">
                                <strong>正解: c) 必ずサーバーサイドでもバリデーションを行う必要がある</strong><br>
                                クライアントサイドバリデーションは簡単に回避できるため、セキュリティ上の理由から必ずサーバーサイドでも同様のチェックが必要です。
                            </div>
                        </div>

                        <button type="button" class="btn btn-orange mt-3" onclick="showAllAnswers()">解答を表示</button>
                    </div>
                </section>

                <!-- ナビゲーション -->
                <div class="d-flex justify-content-between mt-4">
                    <a href="struts1-learning-material-5.html" class="btn btn-outline-secondary">⬅️ 第5章に戻る</a>
                    <a href="struts1-learning-material-7.html" class="btn btn-orange">第7章に進む ➡️</a>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap 5 JS CDN -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ページ読み込み時の初期化
        document.addEventListener('DOMContentLoaded', function() {
            // Highlight.js初期化
            hljs.highlightAll();
            
            // Mermaid.js初期化
            mermaid.initialize({
                startOnLoad: true,
                theme: 'default'
            });
            
            // スムーズスクロール
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });
            
            // サイドバーのアクティブリンク更新
            const observerOptions = {
                root: null,
                rootMargin: '0px 0px -80% 0px',
                threshold: 0.1
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const id = entry.target.getAttribute('id');
                        document.querySelectorAll('.nav-link').forEach(link => {
                            link.classList.remove('active');
                        });
                        const activeLink = document.querySelector(`a[href="#${id}"]`);
                        if (activeLink) {
                            activeLink.classList.add('active');
                        }
                    }
                });
            }, observerOptions);
            
            // セクション要素を監視対象に追加
            document.querySelectorAll('section[id]').forEach(section => {
                observer.observe(section);
            });
        });
        
        // クイズ解答表示機能
        function showAllAnswers() {
            document.querySelectorAll('.quiz-answer').forEach(answer => {
                answer.style.display = 'block';
            });
        }
    </script>
</body>
</html>