<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSP/Servlet初心者向け学習教材 - 第5章: リクエストとレスポンスの処理</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        code {
            display: block;
            background-color: #f5f5f5;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .quiz-question {
            font-weight: 500;
            margin-bottom: 1rem;
        }
        .diagram {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            text-align: center;
        }
        .exercise {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        #table-of-contents .list-group-item {
            border: none;
            padding: 0.5rem 1rem;
        }
        #table-of-contents .list-group-item-action {
            color: #1976d2;
        }
        /* 選択された目次項目のスタイル */
        #table-of-contents .list-group-item-action.active,
        .list-group-item.active {
            color: white !important; /* テキストを白色にして青い背景に対してコントラストをつける */
            background-color: #1976d2;
            border-color: #1976d2;
        }
        .section-nav {
            padding-left: 1rem;
        }
        .inline-code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            display: inline;
        }
        footer {
            background-color: #1565c0;
            color: white;
            padding: 1rem 0;
            margin-top: 3rem;
        }
        .table-example {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
        }
        .table-example th {
            background-color: #e3f2fd;
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .table-example td {
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .example-result {
            background-color: #f1f8e9;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#tableOfContents">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">JSP/Servlet初心者向け学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#introduction">はじめに</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#chapter5">第5章: リクエストとレスポンスの処理</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <!-- Sidebar - Table of Contents -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">目次</h5>
                        </div>
                        <div id="table-of-contents" class="list-group list-group-flush">
                            <a href="#introduction" class="list-group-item list-group-item-action">はじめに</a>
                            <a href="#chapter5" class="list-group-item list-group-item-action">第5章: リクエストとレスポンスの処理</a>
                            <div class="section-nav">
                                <a href="#request-response-basics" class="list-group-item list-group-item-action">5.1 リクエストとレスポンスの基本</a>
                                <a href="#request-object" class="list-group-item list-group-item-action">5.2 requestオブジェクトの活用</a>
                                <a href="#response-object" class="list-group-item list-group-item-action">5.3 responseオブジェクトの活用</a>
                                <a href="#get-post" class="list-group-item list-group-item-action">5.4 GETとPOSTの違いと使い分け</a>
                                <a href="#form-handling" class="list-group-item list-group-item-action">5.5 フォーム入力の処理</a>
                                <a href="#encoding" class="list-group-item list-group-item-action">5.6 文字エンコーディングの処理</a>
                                <a href="#chapter5-quiz" class="list-group-item list-group-item-action">5.7 理解度確認テスト</a>
                            </div>
                            <a href="#next-steps" class="list-group-item list-group-item-action">次のステップ</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <section id="introduction">
                    <h1 class="display-5 mb-4">JSP/Servlet初心者向け学習教材</h1>
                    <p class="lead">この第5章では、JSP/Servletアプリケーションでのリクエストとレスポンスの処理方法について学習します。HTTPリクエストからデータを取得する方法、適切なレスポンスを返す方法、そしてGETとPOSTメソッドの違いを理解しましょう。</p>

                    <div class="note">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>HTTPリクエストとレスポンスの仕組み</li>
                            <li><code>request</code>オブジェクトからデータを取得する方法</li>
                            <li><code>response</code>オブジェクトを使って出力する方法</li>
                            <li>GETメソッドとPOSTメソッドの違いと適切な使い分け</li>
                            <li>フォームデータの処理方法</li>
                            <li>文字エンコーディングの設定</li>
                        </ul>
                    </div>
                </section>

                <section id="chapter5">
                    <h2 class="chapter-title">第5章：リクエストとレスポンスの処理</h2>
                    <p>WebアプリケーションはHTTPプロトコルを通じてクライアント（ブラウザ）とサーバー間でデータをやり取りします。この章では、Servletおよび
                    JSPでリクエストデータを受け取り、適切なレスポンスを返す方法について詳しく学びます。</p>

                    <section id="request-response-basics">
                        <h3 class="section-title">5.1 リクエストとレスポンスの基本</h3>
                        <p>Webアプリケーションにおけるリクエストとレスポンスのライフサイクルを理解することは非常に重要です。以下にHTTPリクエスト・レスポンスの基本的な流れを説明します。</p>

                        <h4>HTTPリクエスト・レスポンスサイクル</h4>
                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- クライアント -->
                                <rect x="50" y="100" width="120" height="60" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="110" y="135" text-anchor="middle" font-size="16">ブラウザ</text>
                                
                                <!-- サーバー -->
                                <rect x="430" y="100" width="120" height="60" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="490" y="135" text-anchor="middle" font-size="16">サーバー</text>
                                
                                <!-- リクエスト矢印 -->
                                <path d="M170,120 L430,120" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />
                                <rect x="250" y="90" width="100" height="30" fill="#c8e6c9" stroke="#388e3c" stroke-width="1" rx="5" />
                                <text x="300" y="110" text-anchor="middle" font-size="14">HTTPリクエスト</text>
                                
                                <!-- レスポンス矢印 -->
                                <path d="M430,140 L170,140" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)" />
                                <rect x="250" y="150" width="100" height="30" fill="#ffecb3" stroke="#ffa000" stroke-width="1" rx="5" />
                                <text x="300" y="170" text-anchor="middle" font-size="14">HTTPレスポンス</text>
                                
                                <!-- リクエスト詳細 -->
                                <rect x="50" y="200" width="250" height="80" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="1" rx="3" />
                                <text x="60" y="220" font-size="14" font-weight="bold">HTTPリクエスト内容:</text>
                                <text x="60" y="240" font-size="14">・メソッド (GET, POST等)</text>
                                <text x="60" y="260" font-size="14">・URL、クエリパラメータ</text>
                                <text x="60" y="280" font-size="14">・ヘッダー、クッキー、フォームデータ</text>
                                
                                <!-- レスポンス詳細 -->
                                <rect x="310" y="200" width="240" height="80" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="1" rx="3" />
                                <text x="320" y="220" font-size="14" font-weight="bold">HTTPレスポンス内容:</text>
                                <text x="320" y="240" font-size="14">・ステータスコード (200, 404等)</text>
                                <text x="320" y="260" font-size="14">・ヘッダー情報</text>
                                <text x="320" y="280" font-size="14">・レスポンスボディ (HTML等)</text>
                                
                                <!-- マーカー定義 -->
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#1976d2" />
                                    </marker>
                                    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#f44336" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図5.1: HTTPリクエスト・レスポンスサイクル</p>
                        </div>

                        <h4>ServletでのリクエスとレスポンスオブジェクトとDiパターン</h4>
                        <p>ServletでHTTPリクエストを処理する際、コンテナ（Tomcat等）は自動的に<span class="inline-code">HttpServletRequest</span>と
                        <span class="inline-code">HttpServletResponse</span>のインスタンスを生成し、Servletのメソッドに注入します。これはDI（依存性の注入）パターンの一例です。</p>

                        <code>@WebServlet("/hello")
public class HelloServlet extends HttpServlet {
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // requestからデータを取得
        String name = request.getParameter("name");
        
        // responseに出力
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        out.println("&lt;!DOCTYPE html&gt;");
        out.println("&lt;html&gt;&lt;head&gt;&lt;title&gt;Hello&lt;/title&gt;&lt;/head&gt;");
        out.println("&lt;body&gt;");
        out.println("&lt;h1&gt;Hello, " + (name != null ? name : "Guest") + "!&lt;/h1&gt;");
        out.println("&lt;/body&gt;&lt;/html&gt;");
    }
}</code>

                        <p>上記の例では、<span class="inline-code">HttpServletRequest</span>オブジェクトから「name」パラメータの値を取得し、
                        <span class="inline-code">HttpServletResponse</span>オブジェクトを使用してHTMLレスポンスを生成しています。</p>

                        <div class="note">
                            <h5>JSPでのリクエストとレスポンスオブジェクト</h5>
                            <p>JSPでは、<span class="inline-code">request</span>と<span class="inline-code">response</span>がデフォルトで暗黙オブジェクトとして利用可能です。つまり、明示的に宣言せずに直接使用できます。</p>
                            <p>例：<span class="inline-code">&lt;%= request.getParameter("name") %&gt;</span></p>
                        </div>
                    </section>

                    <section id="request-object">
                        <h3 class="section-title">5.2 requestオブジェクトの活用</h3>
                        <p><span class="inline-code">HttpServletRequest</span>オブジェクト（JSPでは<span class="inline-code">request</span>オブジェクト）は、クライアントからのリクエスト情報を取得するための多くのメソッドを提供しています。</p>

                        <h4>主なrequestメソッド</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getParameter(String name)</span></td>
                                    <td>指定した名前のパラメータ値を取得</td>
                                    <td><span class="inline-code">String name = request.getParameter("username");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getParameterValues(String name)</span></td>
                                    <td>複数の値を持つパラメータの全値を取得</td>
                                    <td><span class="inline-code">String[] hobbies = request.getParameterValues("hobby");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getParameterNames()</span></td>
                                    <td>全パラメータ名の列挙を取得</td>
                                    <td><span class="inline-code">Enumeration&lt;String&gt; names = request.getParameterNames();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getMethod()</span></td>
                                    <td>HTTPメソッド（GET/POST等）を取得</td>
                                    <td><span class="inline-code">String method = request.getMethod();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getRequestURI()</span></td>
                                    <td>リクエストURIを取得</td>
                                    <td><span class="inline-code">String uri = request.getRequestURI();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getContextPath()</span></td>
                                    <td>アプリケーションのコンテキストパスを取得</td>
                                    <td><span class="inline-code">String contextPath = request.getContextPath();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getHeader(String name)</span></td>
                                    <td>指定したHTTPヘッダーの値を取得</td>
                                    <td><span class="inline-code">String userAgent = request.getHeader("User-Agent");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getCookies()</span></td>
                                    <td>リクエストで送信されたクッキーを取得</td>
                                    <td><span class="inline-code">Cookie[] cookies = request.getCookies();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getSession()</span></td>
                                    <td>セッションオブジェクトを取得</td>
                                    <td><span class="inline-code">HttpSession session = request.getSession();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">setAttribute(String name, Object value)</span></td>
                                    <td>リクエスト属性を設定</td>
                                    <td><span class="inline-code">request.setAttribute("user", userObj);</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getAttribute(String name)</span></td>
                                    <td>リクエスト属性を取得</td>
                                    <td><span class="inline-code">User user = (User)request.getAttribute("user");</span></td>
                                </tr>
                            </table>
                        </div>

                        <h4>リクエストパラメータの取得例</h4>
                        <p>以下のHTMLフォームからのデータを処理するServletの例を見てみましょう：</p>

                        <code>&lt;!-- userForm.html --&gt;
&lt;form action="processUser" method="post"&gt;
    &lt;div&gt;
        &lt;label for="username"&gt;ユーザー名:&lt;/label&gt;
        &lt;input type="text" id="username" name="username"&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;label for="email"&gt;メールアドレス:&lt;/label&gt;
        &lt;input type="email" id="email" name="email"&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;p&gt;趣味:&lt;/p&gt;
        &lt;input type="checkbox" id="hobby1" name="hobby" value="読書"&gt;
        &lt;label for="hobby1"&gt;読書&lt;/label&gt;
        &lt;input type="checkbox" id="hobby2" name="hobby" value="旅行"&gt;
        &lt;label for="hobby2"&gt;旅行&lt;/label&gt;
        &lt;input type="checkbox" id="hobby3" name="hobby" value="スポーツ"&gt;
        &lt;label for="hobby3"&gt;スポーツ&lt;/label&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;input type="submit" value="送信"&gt;
    &lt;/div&gt;
&lt;/form&gt;</code>

                        <p>上記フォームからのデータを処理するServlet：</p>

                        <code>@WebServlet("/processUser")
public class UserProcessServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // 文字エンコーディングの設定
        request.setCharacterEncoding("UTF-8");
        
        // 単一値パラメータの取得
        String username = request.getParameter("username");
        String email = request.getParameter("email");
        
        // 複数値パラメータの取得
        String[] hobbies = request.getParameterValues("hobby");
        
        // レスポンスの設定
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        out.println("&lt;!DOCTYPE html&gt;");
        out.println("&lt;html&gt;&lt;head&gt;&lt;title&gt;ユーザー情報&lt;/title&gt;&lt;/head&gt;");
        out.println("&lt;body&gt;");
        out.println("&lt;h1&gt;ユーザー情報&lt;/h1&gt;");
        out.println("&lt;p&gt;ユーザー名: " + username + "&lt;/p&gt;");
        out.println("&lt;p&gt;メールアドレス: " + email + "&lt;/p&gt;");
        
        out.println("&lt;p&gt;趣味:&lt;/p&gt;");
        out.println("&lt;ul&gt;");
        if (hobbies != null) {
            for (String hobby : hobbies) {
                out.println("&lt;li&gt;" + hobby + "&lt;/li&gt;");
            }
        } else {
            out.println("&lt;li&gt;選択された趣味はありません&lt;/li&gt;");
        }
        out.println("&lt;/ul&gt;");
        
        out.println("&lt;/body&gt;&lt;/html&gt;");
    }
}</code>

                        <h4>リクエスト属性とスコープ</h4>
                        <p><span class="inline-code">setAttribute()</span>および<span class="inline-code">getAttribute()</span>メソッドを使用すると、リクエストスコープ内でデータを共有できます。これは特にフォワードを使用する場合に便利です。</p>

                        <code>@WebServlet("/userInfo")
public class UserInfoServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // ユーザー情報を作成
        User user = new User();
        user.setId(1001);
        user.setName("山田太郎");
        user.setEmail("yamada@example.com");
        
        // リクエスト属性としてユーザー情報を設定
        request.setAttribute("user", user);
        
        // JSPページにフォワード
        RequestDispatcher dispatcher = request.getRequestDispatcher("/WEB-INF/views/userDetails.jsp");
        dispatcher.forward(request, response);
    }
}</code>

                        <p>JSPページでのリクエスト属性の使用：</p>

                        <code>&lt;%-- userDetails.jsp --%&gt;
&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;ユーザー詳細&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;ユーザー詳細情報&lt;/h1&gt;
    
    &lt;%-- リクエスト属性からユーザー情報を取得 --%&gt;
    &lt;jsp:useBean id="user" class="com.example.User" scope="request" /&gt;
    
    &lt;p&gt;ID: &lt;jsp:getProperty name="user" property="id" /&gt;&lt;/p&gt;
    &lt;p&gt;名前: &lt;jsp:getProperty name="user" property="name" /&gt;&lt;/p&gt;
    &lt;p&gt;メール: &lt;jsp:getProperty name="user" property="email" /&gt;&lt;/p&gt;
    
    &lt;%-- または以下のようにEL式を使用することもできます --%&gt;
    &lt;p&gt;ID: ${user.id}&lt;/p&gt;
    &lt;p&gt;名前: ${user.name}&lt;/p&gt;
    &lt;p&gt;メール: ${user.email}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="exercise">
                            <h5>演習 5.2.1: リクエストパラメータの処理</h5>
                            <ol>
                                <li>名前、年齢、性別、および複数選択可能な興味（チェックボックス）を含むHTMLフォームを作成してください。</li>
                                <li>フォームデータを処理するServletを作成し、すべてのパラメータを取得して表示してください。</li>
                                <li>興味（複数選択）がある場合とない場合の両方を適切に処理するようにしてください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="response-object">
                        <h3 class="section-title">5.3 responseオブジェクトの活用</h3>
                        <p><span class="inline-code">HttpServletResponse</span>オブジェクト（JSPでは<span class="inline-code">response</span>オブジェクト）は、クライアントに送り返すレスポンスを設定するためのメソッドを提供します。</p>

                        <h4>主なresponseメソッド</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">setContentType(String type)</span></td>
                                    <td>レスポンスのContent-Typeヘッダーを設定</td>
                                    <td><span class="inline-code">response.setContentType("text/html;charset=UTF-8");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">setCharacterEncoding(String charset)</span></td>
                                    <td>レスポンスの文字エンコーディングを設定</td>
                                    <td><span class="inline-code">response.setCharacterEncoding("UTF-8");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getWriter()</span></td>
                                    <td>レスポンスに文字テキストを書き込むためのPrintWriterを取得</td>
                                    <td><span class="inline-code">PrintWriter out = response.getWriter();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">getOutputStream()</span></td>
                                    <td>レスポンスにバイナリデータを書き込むためのServletOutputStreamを取得</td>
                                    <td><span class="inline-code">ServletOutputStream out = response.getOutputStream();</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">setStatus(int sc)</span></td>
                                    <td>HTTPステータスコードを設定</td>
                                    <td><span class="inline-code">response.setStatus(HttpServletResponse.SC_OK);</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">sendError(int sc)</span></td>
                                    <td>エラーステータスコードとデフォルトエラーページを送信</td>
                                    <td><span class="inline-code">response.sendError(HttpServletResponse.SC_NOT_FOUND);</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">setHeader(String name, String value)</span></td>
                                    <td>レスポンスヘッダーを設定</td>
                                    <td><span class="inline-code">response.setHeader("Cache-Control", "no-cache");</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">addCookie(Cookie cookie)</span></td>
                                    <td>レスポンスにクッキーを追加</td>
                                    <td><span class="inline-code">response.addCookie(new Cookie("username", "john"));</span></td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">sendRedirect(String location)</span></td>
                                    <td>指定されたURLにクライアントをリダイレクト</td>
                                    <td><span class="inline-code">response.sendRedirect("success.jsp");</span></td>
                                </tr>
                            </table>
                        </div>

                        <h4>さまざまなコンテンツタイプのレスポンス</h4>
                        <p>Servletから異なるタイプのコンテンツを返す例を見てみましょう：</p>

                        <p><strong>1. HTMLレスポンス（テキスト）</strong></p>
                        <code>@WebServlet("/htmlResponse")
public class HtmlResponseServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        response.setContentType("text/html;charset=UTF-8");
        PrintWriter out = response.getWriter();
        
        out.println("&lt;!DOCTYPE html&gt;");
        out.println("&lt;html&gt;&lt;head&gt;&lt;title&gt;HTML Response&lt;/title&gt;&lt;/head&gt;");
        out.println("&lt;body&gt;");
        out.println("&lt;h1&gt;これはHTMLレスポンスです&lt;/h1&gt;");
        out.println("&lt;p&gt;現在の時刻: " + new java.util.Date() + "&lt;/p&gt;");
        out.println("&lt;/body&gt;&lt;/html&gt;");
    }
}</code>

                        <p><strong>2. JSONレスポンス</strong></p>
                        <code>@WebServlet("/jsonResponse")
public class JsonResponseServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // JSONレスポンスの設定
        response.setContentType("application/json");
        response.setCharacterEncoding("UTF-8");
        
        PrintWriter out = response.getWriter();
        
        // 簡単なJSON文字列を生成（実際のアプリケーションではJSONライブラリを使用した方が良い）
        String jsonResponse = "{"
                + "\"status\": \"success\","
                + "\"message\": \"データが正常に取得されました\","
                + "\"timestamp\": \"" + System.currentTimeMillis() + "\","
                + "\"data\": ["
                + "  {\"id\": 1, \"name\": \"鈴木一郎\", \"age\": 28},"
                + "  {\"id\": 2, \"name\": \"佐藤二郎\", \"age\": 32},"
                + "  {\"id\": 3, \"name\": \"田中三郎\", \"age\": 25}"
                + "]"
                + "}";
        
        out.print(jsonResponse);
    }
}</code>

                        <p><strong>3. バイナリデータ（画像）レスポンス</strong></p>
                        <code>@WebServlet("/imageResponse")
public class ImageResponseServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // 画像ファイルのパス
        String imagePath = getServletContext().getRealPath("/WEB-INF/images/sample.jpg");
        File imageFile = new File(imagePath);
        
        if (imageFile.exists()) {
            // 画像のMIMEタイプを設定
            response.setContentType("image/jpeg");
            
            // Content-Lengthヘッダーを設定
            response.setContentLength((int)imageFile.length());
            
            // ファイルをバイトストリームとして読み込む
            try (FileInputStream in = new FileInputStream(imageFile);
                 ServletOutputStream out = response.getOutputStream()) {
                
                // バッファーを使用してファイルを読み込み、出力ストリームに書き込む
                byte[] buffer = new byte[4096];
                int bytesRead;
                
                while ((bytesRead = in.read(buffer)) != -1) {
                    out.write(buffer, 0, bytesRead);
                }
            }
        } else {
            // 画像が見つからない場合は404エラーを返す
            response.sendError(HttpServletResponse.SC_NOT_FOUND, "画像が見つかりません");
        }
    }
}</code>

                        <h4>レスポンスヘッダーの設定</h4>
                        <p>レスポンスヘッダーを設定すると、ブラウザの挙動を制御したり、追加情報を提供したりできます。</p>

                        <code>@WebServlet("/headerExample")
public class HeaderExampleServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // キャッシュを無効化するヘッダーを設定
        response.setHeader("Cache-Control", "no-cache, no-store, must-revalidate");
        response.setHeader("Pragma", "no-cache");
        response.setDateHeader("Expires", 0);
        
        // カスタムヘッダーを追加
        response.setHeader("X-Custom-Header", "サンプル値");
        
        // CSV形式のファイルをダウンロードさせるヘッダーを設定
        response.setContentType("text/csv");
        response.setHeader("Content-Disposition", "attachment; filename=\"data.csv\"");
        
        // CSVデータを出力
        PrintWriter out = response.getWriter();
        out.println("ID,名前,年齢");
        out.println("1,鈴木一郎,28");
        out.println("2,佐藤二郎,32");
        out.println("3,田中三郎,25");
    }
}</code>

                        <h4>リダイレクトとフォワード</h4>
                        <p>Servletからクライアントを別のリソースに転送する方法は主に2つあります：</p>

                        <p><strong>1. リダイレクト</strong>（クライアント側でのリダイレクト）：</p>
                        <code>@WebServlet("/redirectExample")
public class RedirectExampleServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // 何らかの処理...
        
        // クライアントを別のURLにリダイレクト
        response.sendRedirect(request.getContextPath() + "/success.jsp");
    }
}</code>

                        <p><strong>2. フォワード</strong>（サーバー側での転送）：</p>
                        <code>@WebServlet("/forwardExample")
public class ForwardExampleServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // リクエスト属性を設定
        request.setAttribute("message", "フォワードされたメッセージ");
        
        // サーバー内部でリクエストを転送
        RequestDispatcher dispatcher = request.getRequestDispatcher("/WEB-INF/views/result.jsp");
        dispatcher.forward(request, response);
    }
}</code>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 350" width="600" height="350">
                                <!-- クライアント -->
                                <rect x="50" y="100" width="120" height="60" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="110" y="135" text-anchor="middle" font-size="16">ブラウザ</text>
                                
                                <!-- リダイレクト図 -->
                                <text x="200" y="50" font-size="18" font-weight="bold">リダイレクト (sendRedirect)</text>
                                
                                <!-- サーバー -->
                                <rect x="300" y="80" width="100" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="350" y="105" text-anchor="middle" font-size="14">Servlet A</text>
                                
                                <rect x="430" y="80" width="100" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="480" y="105" text-anchor="middle" font-size="14">Servlet B</text>
                                
                                <!-- リダイレクトの矢印 -->
                                <path d="M170,100 L300,100" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />
                                <text x="235" y="95" text-anchor="middle" font-size="12">リクエスト1</text>
                                
                                <path d="M400,100 L170,130" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)" />
                                <text x="285" y="130" text-anchor="middle" font-size="12">302リダイレクト</text>
                                
                                <path d="M170,140 L430,140" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />
                                <text x="300" y="160" text-anchor="middle" font-size="12">リクエスト2</text>
                                
                                <path d="M430,140 L170,170" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)" />
                                <text x="300" y="180" text-anchor="middle" font-size="12">レスポンス</text>
                                
                                <!-- フォワード図 -->
                                <text x="200" y="230" font-size="18" font-weight="bold">フォワード (forward)</text>
                                
                                <rect x="300" y="260" width="100" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="350" y="285" text-anchor="middle" font-size="14">Servlet A</text>
                                
                                <rect x="430" y="260" width="100" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="480" y="285" text-anchor="middle" font-size="14">Servlet B</text>
                                
                                <!-- フォワードの矢印 -->
                                <path d="M170,280 L300,280" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />
                                <text x="235" y="275" text-anchor="middle" font-size="12">リクエスト</text>
                                
                                <path d="M400,275 C420,275 420,290 400,290" stroke="#4caf50" stroke-width="2" marker-end="url(#arrowGreen)" fill="none" />
                                <text x="420" y="285" text-anchor="middle" font-size="12">フォワード</text>
                                
                                <path d="M430,280 L170,310" stroke="#f44336" stroke-width="2" marker-end="url(#arrowRed)" />
                                <text x="300" y="320" text-anchor="middle" font-size="12">レスポンス</text>
                                
                                <!-- マーカー定義 -->
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#1976d2" />
                                    </marker>
                                    <marker id="arrowRed" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#f44336" />
                                    </marker>
                                    <marker id="arrowGreen" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#4caf50" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図5.2: リダイレクトとフォワードの違い</p>
                        </div>

                        <div class="note">
                            <h5>リダイレクトとフォワードの主な違い</h5>
                            <ul>
                                <li><strong>リダイレクト</strong>: クライアント（ブラウザ）が新しいURLにリクエストを送信します。URLが変わり、リクエスト属性は維持されません。</li>
                                <li><strong>フォワード</strong>: サーバー内部でリクエストが転送されます。URLは変わらず、リクエスト属性は維持されます。</li>
                            </ul>
                        </div>

                        <div class="exercise">
                            <h5>演習 5.3.1: レスポンスの種類</h5>
                            <ol>
                                <li>HTMLレスポンス、JSONレスポンス、ファイルダウンロードレスポンスをそれぞれ返す3つのServletを作成してください。</li>
                                <li>JSONレスポンスには、名前、年齢、住所を含む少なくとも3つのユーザー情報を含めてください。</li>
                                <li>ファイルダウンロードのServletでは、ユーザーに「sample.txt」という名前でテキストファイルをダウンロードさせるレスポンスヘッダーを設定し、ファイルの内容は自由に作成してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="get-post">
                        <h3 class="section-title">5.4 GETとPOSTの違いと使い分け</h3>
                        <p>HTTPプロトコルでは、クライアントからサーバーへのリクエストを送信する主な方法として「GET」と「POST」の2つのメソッドがあります。それぞれの特徴と適切な使い分けについて解説します。</p>

                        <h4>GETメソッド</h4>
                        <p>GETメソッドは、サーバーからデータを「取得」するために使用されます。</p>
                        
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th colspan="2">GETメソッドの特徴</th>
                                </tr>
                                <tr>
                                    <td>パラメータの送信方法</td>
                                    <td>URLのクエリ文字列として送信される（例: <span class="inline-code">?name=value&amp;id=123</span>）</td>
                                </tr>
                                <tr>
                                    <td>可視性</td>
                                    <td>パラメータはURLに表示される（ブックマーク可能）</td>
                                </tr>
                                <tr>
                                    <td>データ量の制限</td>
                                    <td>URLの長さに制限があるため、送信できるデータ量に制限がある</td>
                                </tr>
                                <tr>
                                    <td>キャッシュ</td>
                                    <td>ブラウザにキャッシュされることがある</td>
                                </tr>
                                <tr>
                                    <td>Servletでの処理</td>
                                    <td><span class="inline-code">doGet()</span>メソッドで処理</td>
                                </tr>
                                <tr>
                                    <td>適した用途</td>
                                    <td>データの検索、情報の表示、ページナビゲーションなど</td>
                                </tr>
                            </table>
                        </div>

                        <h4>POSTメソッド</h4>
                        <p>POSTメソッドは、サーバーにデータを「送信」するために使用されます。</p>
                        
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th colspan="2">POSTメソッドの特徴</th>
                                </tr>
                                <tr>
                                    <td>パラメータの送信方法</td>
                                    <td>HTTPリクエストのボディ部分に含まれる</td>
                                </tr>
                                <tr>
                                    <td>可視性</td>
                                    <td>パラメータはURLに表示されない</td>
                                </tr>
                                <tr>
                                    <td>データ量の制限</td>
                                    <td>GETよりも多くのデータを送信可能</td>
                                </tr>
                                <tr>
                                    <td>キャッシュ</td>
                                    <td>通常はキャッシュされない</td>
                                </tr>
                                <tr>
                                    <td>Servletでの処理</td>
                                    <td><span class="inline-code">doPost()</span>メソッドで処理</td>
                                </tr>
                                <tr>
                                    <td>適した用途</td>
                                    <td>フォーム送信、データ更新、ファイルアップロードなど</td>
                                </tr>
                            </table>
                        </div>

                        <h4>GETとPOSTの比較図</h4>
                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- タイトル -->
                                <text x="300" y="30" text-anchor="middle" font-size="18" font-weight="bold">GETとPOSTの比較</text>
                                
                                <!-- GET部分 -->
                                <rect x="50" y="50" width="220" height="220" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="160" y="80" text-anchor="middle" font-size="16" font-weight="bold">GETメソッド</text>
                                
                                <!-- GETリクエスト図 -->
                                <rect x="70" y="100" width="180" height="30" fill="#bbdefb" stroke="#1976d2" stroke-width="1" rx="3" />
                                <text x="160" y="120" text-anchor="middle" font-size="12">HTTPリクエストヘッダー</text>
                                
                                <rect x="70" y="130" width="180" height="20" fill="#e1f5fe" stroke="#1976d2" stroke-width="1" rx="0" />
                                <text x="160" y="145" text-anchor="middle" font-size="10">GET /page?name=value&id=123 HTTP/1.1</text>
                                
                                <rect x="70" y="150" width="180" height="100" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="1" rx="3" />
                                <text x="160" y="200" text-anchor="middle" font-size="12" fill="#9e9e9e">(空のリクエストボディ)</text>
                                
                                <!-- POST部分 -->
                                <rect x="330" y="50" width="220" height="220" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5" />
                                <text x="440" y="80" text-anchor="middle" font-size="16" font-weight="bold">POSTメソッド</text>
                                
                                <!-- POSTリクエスト図 -->
                                <rect x="350" y="100" width="180" height="30" fill="#e1bee7" stroke="#9c27b0" stroke-width="1" rx="3" />
                                <text x="440" y="120" text-anchor="middle" font-size="12">HTTPリクエストヘッダー</text>
                                
                                <rect x="350" y="130" width="180" height="20" fill="#f3e5f5" stroke="#9c27b0" stroke-width="1" rx="0" />
                                <text x="440" y="145" text-anchor="middle" font-size="10">POST /page HTTP/1.1</text>
                                
                                <rect x="350" y="150" width="180" height="100" fill="#f8bbd0" stroke="#e91e63" stroke-width="1" rx="3" />
                                <text x="440" y="165" text-anchor="middle" font-size="12">HTTPリクエストボディ</text>
                                <text x="440" y="190" text-anchor="middle" font-size="10">name=value&id=123</text>
                                <text x="440" y="210" text-anchor="middle" font-size="10">その他のデータ...</text>
                                <text x="440" y="230" text-anchor="middle" font-size="10">(大量のデータや非ASCII文字も可)</text>
                            </svg>
                            <p class="text-center">図5.3: GETメソッドとPOSTメソッドの比較</p>
                        </div>

                        <h4>適切な使い分け</h4>
                        <p>GETとPOSTは、それぞれの特性に応じて適切に使い分けることが重要です：</p>
                        
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>GETを使用すべき場合</th>
                                    <th>POSTを使用すべき場合</th>
                                </tr>
                                <tr>
                                    <td>
                                        <ul>
                                            <li>データの取得や参照（検索、一覧表示など）</li>
                                            <li>ブックマーク可能なURLが必要な場合</li>
                                            <li>ブラウザの「戻る」ボタンでページを再表示しても安全な場合</li>
                                            <li>少量のテキストデータのみを送信する場合</li>
                                        </ul>
                                    </td>
                                    <td>
                                        <ul>
                                            <li>データベースの更新（新規登録、更新、削除）</li>
                                            <li>大量のデータの送信</li>
                                            <li>機密情報（パスワードなど）の送信</li>
                                            <li>ファイルのアップロード</li>
                                            <li>複数行テキストやバイナリデータの送信</li>
                                        </ul>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <h4>HTMLフォームからのデータ送信とServletでの処理</h4>
                        <p>HTMLフォームでは、<span class="inline-code">method</span>属性でGETまたはPOSTを指定します：</p>

                        <code>&lt;!-- GETメソッドを使用するフォーム --&gt;
&lt;form action="search" method="get"&gt;
    &lt;label for="keyword"&gt;検索キーワード:&lt;/label&gt;
    &lt;input type="text" id="keyword" name="keyword"&gt;
    &lt;button type="submit"&gt;検索&lt;/button&gt;
&lt;/form&gt;

&lt;!-- POSTメソッドを使用するフォーム --&gt;
&lt;form action="register" method="post"&gt;
    &lt;div&gt;
        &lt;label for="username"&gt;ユーザー名:&lt;/label&gt;
        &lt;input type="text" id="username" name="username"&gt;
    &lt;/div&gt;
    &lt;div&gt;
        &lt;label for="password"&gt;パスワード:&lt;/label&gt;
        &lt;input type="password" id="password" name="password"&gt;
    &lt;/div&gt;
    &lt;button type="submit"&gt;登録&lt;/button&gt;
&lt;/form&gt;</code>

                        <p>Servletでは、GETリクエストは<span class="inline-code">doGet()</span>メソッド、POSTリクエストは<span class="inline-code">doPost()</span>メソッドで処理します：</p>

                        <code>@WebServlet("/search")
public class SearchServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // GETリクエストの処理（検索処理など）
        String keyword = request.getParameter("keyword");
        
        // 検索処理...
        
        // 結果を表示するJSPにフォワード
        request.setAttribute("results", searchResults);
        request.getRequestDispatcher("/WEB-INF/views/searchResults.jsp").forward(request, response);
    }
}

@WebServlet("/register")
public class RegisterServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // POSTリクエストの処理（登録処理など）
        request.setCharacterEncoding("UTF-8");
        
        String username = request.getParameter("username");
        String password = request.getParameter("password");
        
        // 登録処理...
        
        // 登録成功後にリダイレクト
        response.sendRedirect(request.getContextPath() + "/registerSuccess.jsp");
    }
}</code>

                        <h4>両方のメソッドを処理するServlet</h4>
                        <p>一つのServletで両方のHTTPメソッドを処理する場合：</p>

                        <code>@WebServlet("/user")
public class UserServlet extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // GETリクエストの処理（ユーザー情報の表示など）
        String userId = request.getParameter("id");
        
        // ユーザー情報を取得...
        
        // ユーザー詳細ページを表示
        request.setAttribute("user", user);
        request.getRequestDispatcher("/WEB-INF/views/userDetails.jsp").forward(request, response);
    }
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // POSTリクエストの処理（ユーザー情報の更新など）
        request.setCharacterEncoding("UTF-8");
        
        String userId = request.getParameter("id");
        String name = request.getParameter("name");
        String email = request.getParameter("email");
        
        // ユーザー情報の更新処理...
        
        // 更新成功後にリダイレクト
        response.sendRedirect(request.getContextPath() + "/user?id=" + userId);
    }
}</code>

                        <div class="warning">
                            <h5>セキュリティに関する注意</h5>
                            <p>GETメソッドで機密情報（パスワードなど）を送信することは避けてください。GETパラメータはURLに表示され、ブラウザの履歴やサーバーのログに記録される可能性があります。機密情報の送信には必ずPOSTメソッドを使用しましょう。</p>
                        </div>

                        <div class="exercise">
                            <h5>演習 5.4.1: GETとPOSTの使い分け</h5>
                            <ol>
                                <li>商品検索フォーム（GETメソッド）と商品登録フォーム（POSTメソッド）を含むHTMLページを作成してください。</li>
                                <li>検索フォームを処理するServlet（doGet）と登録フォームを処理するServlet（doPost）を実装してください。</li>
                                <li>検索結果を表示するJSPページと登録完了を表示するJSPページを作成してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="form-handling">
                        <h3 class="section-title">5.5 フォーム入力の処理</h3>
                        <p>Webアプリケーションでは、ユーザーからのフォーム入力を正しく処理することが重要です。ここではさまざまなフォーム要素からの入力の取得と検証方法について説明します。</p>

                        <h4>さまざまなフォーム要素からのデータ取得</h4>
                        <p>HTMLフォームには様々な入力要素があり、それぞれの処理方法が異なります。以下に主なフォーム要素からのデータ取得方法を示します：</p>

                        <code>&lt;!-- 複数のフォーム要素を含むHTMLフォーム --&gt;
&lt;form action="processForm" method="post"&gt;
    &lt;!-- テキスト入力 --&gt;
    &lt;div&gt;
        &lt;label for="name"&gt;名前:&lt;/label&gt;
        &lt;input type="text" id="name" name="name"&gt;
    &lt;/div&gt;
    
    &lt;!-- パスワード入力 --&gt;
    &lt;div&gt;
        &lt;label for="password"&gt;パスワード:&lt;/label&gt;
        &lt;input type="password" id="password" name="password"&gt;
    &lt;/div&gt;
    
    &lt;!-- ラジオボタン --&gt;
    &lt;div&gt;
        &lt;p&gt;性別:&lt;/p&gt;
        &lt;input type="radio" id="male" name="gender" value="male"&gt;
        &lt;label for="male"&gt;男性&lt;/label&gt;
        &lt;input type="radio" id="female" name="gender" value="female"&gt;
        &lt;label for="female"&gt;女性&lt;/label&gt;
        &lt;input type="radio" id="other" name="gender" value="other"&gt;
        &lt;label for="other"&gt;その他&lt;/label&gt;
    &lt;/div&gt;
    
    &lt;!-- チェックボックス（複数選択） --&gt;
    &lt;div&gt;
        &lt;p&gt;興味のある言語:&lt;/p&gt;
        &lt;input type="checkbox" id="java" name="language" value="Java"&gt;
        &lt;label for="java"&gt;Java&lt;/label&gt;
        &lt;input type="checkbox" id="python" name="language" value="Python"&gt;
        &lt;label for="python"&gt;Python&lt;/label&gt;
        &lt;input type="checkbox" id="javascript" name="language" value="JavaScript"&gt;
        &lt;label for="javascript"&gt;JavaScript&lt;/label&gt;
    &lt;/div&gt;
    
    &lt;!-- セレクトボックス（ドロップダウン） --&gt;
    &lt;div&gt;
        &lt;label for="country"&gt;国:&lt;/label&gt;
        &lt;select id="country" name="country"&gt;
            &lt;option value=""&gt;選択してください&lt;/option&gt;
            &lt;option value="jp"&gt;日本&lt;/option&gt;
            &lt;option value="us"&gt;アメリカ&lt;/option&gt;
            &lt;option value="uk"&gt;イギリス&lt;/option&gt;
            &lt;option value="fr"&gt;フランス&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    
    &lt;!-- 複数選択セレクトボックス --&gt;
    &lt;div&gt;
        &lt;label for="skills"&gt;スキル:&lt;/label&gt;
        &lt;select id="skills" name="skills" multiple&gt;
            &lt;option value="html"&gt;HTML&lt;/option&gt;
            &lt;option value="css"&gt;CSS&lt;/option&gt;
            &lt;option value="js"&gt;JavaScript&lt;/option&gt;
            &lt;option value="java"&gt;Java&lt;/option&gt;
            &lt;option value="db"&gt;データベース&lt;/option&gt;
        &lt;/select&gt;
    &lt;/div&gt;
    
    &lt;!-- テキストエリア --&gt;
    &lt;div&gt;
        &lt;label for="comments"&gt;コメント:&lt;/label&gt;
        &lt;textarea id="comments" name="comments" rows="4" cols="50"&gt;&lt;/textarea&gt;
    &lt;/div&gt;
    
    &lt;!-- 隠しフィールド --&gt;
    &lt;input type="hidden" name="formId" value="registration"&gt;
    
    &lt;!-- 送信ボタン --&gt;
    &lt;div&gt;
        &lt;button type="submit"&gt;送信&lt;/button&gt;
    &lt;/div&gt;
&lt;/form&gt;</code>

                        <p>上記のフォームからのデータを処理するServlet：</p>

                        <code>@WebServlet("/processForm")
public class FormProcessingServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // 文字エンコーディングの設定
        request.setCharacterEncoding("UTF-8");
        
        // 単一値のパラメータを取得
        String name = request.getParameter("name");
        String password = request.getParameter("password");
        String gender = request.getParameter("gender");
        String country = request.getParameter("country");
        String comments = request.getParameter("comments");
        String formId = request.getParameter("formId");
        
        // 複数値のパラメータを取得
        String[] languages = request.getParameterValues("language");
        String[] skills = request.getParameterValues("skills");
        
        // 入力値の検証
        List&lt;String&gt; errors = new ArrayList&lt;&gt;();
        
        if (name == null || name.trim().isEmpty()) {
            errors.add("名前は必須です。");
        }
        
        if (password == null || password.length() < 8) {
            errors.add("パスワードは8文字以上である必要があります。");
        }
        
        if (gender == null) {
            errors.add("性別を選択してください。");
        }
        
        if (country == null || country.isEmpty()) {
            errors.add("国を選択してください。");
        }
        
        // エラーがある場合はフォームページに戻る
        if (!errors.isEmpty()) {
            request.setAttribute("errors", errors);
            request.getRequestDispatcher("/form.jsp").forward(request, response);
            return;
        }
        
        // 正常な処理（例：データベースに保存など）
        // ...
        
        // 処理結果をJSPページに表示
        request.setAttribute("name", name);
        request.setAttribute("gender", gender);
        request.setAttribute("country", country);
        request.setAttribute("languages", languages);
        request.setAttribute("skills", skills);
        request.setAttribute("comments", comments);
        
        request.getRequestDispatcher("/WEB-INF/views/formResult.jsp").forward(request, response);
    }
}</code>

                        <h4>入力値の検証（バリデーション）</h4>
                        <p>フォーム入力値の検証は、データの整合性を確保し、セキュリティリスクを低減するために重要です。主なバリデーション方法には以下があります：</p>

                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>検証の種類</th>
                                    <th>説明</th>
                                    <th>実装例</th>
                                </tr>
                                <tr>
                                    <td>必須フィールドチェック</td>
                                    <td>値が入力されているかを確認</td>
                                    <td><span class="inline-code">if (value == null || value.trim().isEmpty()) {...}</span></td>
                                </tr>
                                <tr>
                                    <td>長さチェック</td>
                                    <td>文字列の長さが適切かを確認</td>
                                    <td><span class="inline-code">if (value.length() < minLength || value.length() > maxLength) {...}</span></td>
                                </tr>
                                <tr>
                                    <td>パターンマッチング</td>
                                    <td>正規表現を使用して形式を検証</td>
                                    <td><span class="inline-code">if (!Pattern.matches("[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}", email)) {...}</span></td>
                                </tr>
                                <tr>
                                    <td>数値範囲チェック</td>
                                    <td>数値が特定の範囲内かを確認</td>
                                    <td><span class="inline-code">int age = Integer.parseInt(ageStr);<br>if (age < 18 || age > 100) {...}</span></td>
                                </tr>
                                <tr>
                                    <td>型変換チェック</td>
                                    <td>文字列が特定の型に変換可能かを確認</td>
                                    <td><span class="inline-code">try { Integer.parseInt(value); } catch (NumberFormatException e) {...}</span></td>
                                </tr>
                                <tr>
                                    <td>選択肢の検証</td>
                                    <td>選択値が有効な選択肢の一つかを確認</td>
                                    <td><span class="inline-code">List&lt;String&gt; validOptions = Arrays.asList("A", "B", "C");<br>if (!validOptions.contains(value)) {...}</span></td>
                                </tr>
                            </table>
                        </div>

                        <h4>バリデーションエラーの処理と表示</h4>
                        <p>バリデーションエラーが発生した場合、ユーザーに適切にフィードバックを提供することが重要です。JSPでのエラー表示例：</p>

                        <code>&lt;%-- form.jsp --%&gt;
&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;ユーザー登録フォーム&lt;/title&gt;
    &lt;style&gt;
        .error-message {
            color: red;
            font-size: 0.9em;
            margin-bottom: 10px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;ユーザー登録&lt;/h1&gt;
    
    &lt;%-- エラーメッセージの表示 --%&gt;
    &lt;c:if test="${not empty errors}"&gt;
        &lt;div class="error-message"&gt;
            &lt;ul&gt;
                &lt;c:forEach var="error" items="${errors}"&gt;
                    &lt;li&gt;${error}&lt;/li&gt;
                &lt;/c:forEach&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/c:if&gt;
    
    &lt;%-- フォームの内容（前のコードと同様） --%&gt;
    &lt;form action="processForm" method="post"&gt;
        &lt;!-- フォーム要素... --&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>クライアントサイドとサーバーサイドのバリデーション</h5>
                            <p>効果的なフォームバリデーションには、クライアントサイド（JavaScript）とサーバーサイド（Java）の両方でのバリデーションを組み合わせることが推奨されます：</p>
                            <ul>
                                <li><strong>クライアントサイドバリデーション</strong>: ユーザーに即時フィードバックを提供し、不要なサーバーリクエストを減らします。</li>
                                <li><strong>サーバーサイドバリデーション</strong>: セキュリティのために必須です。クライアントサイドバリデーションは簡単に回避できるため、サーバーサイドでも必ず検証する必要があります。</li>
                            </ul>
                        </div>

                        <div class="exercise">
                            <h5>演習 5.5.1: フォームバリデーション</h5>
                            <ol>
                                <li>以下のフィールドを持つユーザー登録フォームを作成してください：
                                    <ul>
                                        <li>ユーザー名（必須、3〜20文字）</li>
                                        <li>メールアドレス（必須、有効なメール形式）</li>
                                        <li>パスワード（必須、8文字以上、英数字と特殊文字を含む）</li>
                                        <li>パスワード確認（必須、パスワードと一致）</li>
                                        <li>年齢（必須、18〜100の範囲）</li>
                                        <li>利用規約への同意（必須、チェックボックス）</li>
                                    </ul>
                                </li>
                                <li>全てのフィールドを適切にバリデーションするServletを作成してください。</li>
                                <li>バリデーションエラーメッセージを表示するJSPページを実装してください。</li>
                                <li>成功時には登録完了ページにリダイレクトするようにしてください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="encoding">
                        <h3 class="section-title">5.6 文字エンコーディングの処理</h3>
                        <p>Webアプリケーションで日本語などの非ASCII文字を正しく処理するには、文字エンコーディングの設定が重要です。ここでは、JSP/Servletでの文字エンコーディングの設定方法について説明します。</p>

                        <h4>文字化けの原因と対策</h4>
                        <p>文字化けは、異なる文字エンコーディング間での変換時に発生することがあります。主な原因と対策は以下の通りです：</p>

                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>コンポーネント</th>
                                    <th>設定方法</th>
                                </tr>
                                <tr>
                                    <td>HTMLフォーム</td>
                                    <td>
                                        <code>&lt;meta charset="UTF-8"&gt;</code><br>
                                        <code>&lt;form ... accept-charset="UTF-8"&gt;</code>
                                    </td>
                                </tr>
                                <tr>
                                    <td>リクエスト</td>
                                    <td>
                                        <code>request.setCharacterEncoding("UTF-8");</code>
                                    </td>
                                </tr>
                                <tr>
                                    <td>レスポンス</td>
                                    <td>
                                        <code>response.setContentType("text/html;charset=UTF-8");</code><br>
                                        <code>response.setCharacterEncoding("UTF-8");</code>
                                    </td>
                                </tr>
                                <tr>
                                    <td>JSPページ</td>
                                    <td>
                                        <code>&lt;%@ page pageEncoding="UTF-8" %&gt;</code><br>
                                        <code>&lt;%@ page contentType="text/html;charset=UTF-8" %&gt;</code>
                                    </td>
                                </tr>
                                <tr>
                                    <td>web.xml</td>
                                    <td>
                                        <code>&lt;request-character-encoding&gt;UTF-8&lt;/request-character-encoding&gt;</code><br>
                                        <code>&lt;response-character-encoding&gt;UTF-8&lt;/response-character-encoding&gt;</code>
                                    </td>
                                </tr>
                            </table>
                        </div>

                        <h4>Servletでの文字エンコーディング設定</h4>
                        <p>Servletでリクエストとレスポンスの文字エンコーディングを設定する方法：</p>

                        <code>@WebServlet("/encodeExample")
public class EncodingExampleServlet extends HttpServlet {
    
    @Override
    protected void doPost(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        // リクエストの文字エンコーディングを設定
        // 注意: setCharacterEncoding()は必ずパラメータにアクセスする前に呼び出す必要がある
        request.setCharacterEncoding("UTF-8");
        
        // パラメータ取得
        String japaneseName = request.getParameter("name");
        
        // レスポンスの文字エンコーディングを設定
        response.setContentType("text/html;charset=UTF-8");
        response.setCharacterEncoding("UTF-8");
        
        PrintWriter out = response.getWriter();
        out.println("&lt;!DOCTYPE html&gt;");
        out.println("&lt;html&gt;&lt;head&gt;&lt;meta charset=\"UTF-8\"&gt;&lt;title&gt;エンコーディング例&lt;/title&gt;&lt;/head&gt;");
        out.println("&lt;body&gt;");
        out.println("&lt;h1&gt;受け取ったパラメータ&lt;/h1&gt;");
        out.println("&lt;p&gt;名前: " + japaneseName + "&lt;/p&gt;");
        out.println("&lt;/body&gt;&lt;/html&gt;");
    }
}</code>

                        <h4>web.xmlでの文字エンコーディング設定</h4>
                        <p>Jakarta EE 9（Servlet 5.0）以降では、web.xmlで全アプリケーションのデフォルト文字エンコーディングを設定できます：</p>

                        <code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
         version="5.0"&gt;
         
    &lt;display-name&gt;Character Encoding Example&lt;/display-name&gt;
    
    &lt;!-- 全リクエストのデフォルト文字エンコーディングをUTF-8に設定 --&gt;
    &lt;request-character-encoding&gt;UTF-8&lt;/request-character-encoding&gt;
    
    &lt;!-- 全レスポンスのデフォルト文字エンコーディングをUTF-8に設定 --&gt;
    &lt;response-character-encoding&gt;UTF-8&lt;/response-character-encoding&gt;
    
    &lt;!-- その他の設定... --&gt;
    
&lt;/web-app&gt;</code>

                        <h4>フィルターを使用したエンコーディング設定</h4>
                        <p>Servlet 5.0より前のバージョンや、より柔軟な制御が必要な場合は、フィルターを使用してエンコーディングを設定できます：</p>

                        <code>@WebFilter("/*")  // 全てのリクエストに適用
public class CharacterEncodingFilter implements Filter {
    
    @Override
    public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain)
            throws IOException, ServletException {
        // リクエストの文字エンコーディングを設定
        request.setCharacterEncoding("UTF-8");
        
        // レスポンスの文字エンコーディングを設定
        response.setCharacterEncoding("UTF-8");
        
        // フィルターチェーンの次のフィルターへ処理を渡す
        chain.doFilter(request, response);
    }
    
    @Override
    public void init(FilterConfig filterConfig) throws ServletException {
        // 初期化処理（必要に応じて）
    }
    
    @Override
    public void destroy() {
        // リソース解放処理（必要に応じて）
    }
}</code>

                        <h4>JSPでの文字エンコーディング設定</h4>
                        <p>JSPファイルでは、ページディレクティブで文字エンコーディングを指定します：</p>

                        <code>&lt;%-- JSPファイルの先頭に記述 --%&gt;
&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;エンコーディング例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;日本語表示テスト&lt;/h1&gt;
    &lt;p&gt;こんにちは、世界！&lt;/p&gt;
    
    &lt;%-- リクエストパラメータを表示 --%&gt;
    &lt;p&gt;名前: ${param.name}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>文字エンコーディングに関する注意点</h5>
                            <ul>
                                <li><strong>request.setCharacterEncoding()のタイミング</strong>：この設定は必ずパラメータにアクセスする前に行う必要があります。</li>
                                <li><strong>ソースファイルのエンコーディング</strong>：Java/JSPソースファイル自体も適切な文字エンコーディング（通常はUTF-8）で保存してください。</li>
                                <li><strong>データベース接続</strong>：データベースとの接続時にも適切な文字エンコーディング設定が必要です（例：<span class="inline-code">jdbc:mysql://localhost:3306/mydb?characterEncoding=UTF-8</span>）。</li>
                                <li><strong>HTTP Content-Type</strong>：適切なContent-Typeヘッダーを設定することで、ブラウザに文字エンコーディングを正しく伝えることができます。</li>
                            </ul>
                        </div>

                        <div class="exercise">
                            <h5>演習 5.6.1: 文字エンコーディングの設定</h5>
                            <ol>
                                <li>日本語の入力フィールドを含むHTMLフォームを作成してください。</li>
                                <li>フォームのデータを処理するServletを作成し、適切な文字エンコーディング設定を行ってください。</li>
                                <li>入力された日本語データを正しく表示するJSPページを作成してください。</li>
                                <li>web.xmlまたはフィルターを使用して、アプリケーション全体のデフォルト文字エンコーディングを設定してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="chapter5-quiz">
                        <h3 class="section-title">5.7 理解度確認テスト</h3>
                        <div class="quiz-container">
                            <h4>第5章の理解度チェック</h4>
                            <p>以下の問題に答えて、第5章の内容の理解度を確認しましょう。</p>
                            
                            <div class="quiz-question">
                                <p><strong>問題1:</strong> HttpServletRequestオブジェクトからフォームパラメータを取得するための正しいメソッドはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                                    <label class="form-check-label" for="q1a">
                                        request.getAttribute("name")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                    <label class="form-check-label" for="q1b">
                                        request.getParameter("name")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                                        <label class="form-check-label" for="q1c">
                                        request.getFormInput("name")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                                        <label class="form-check-label" for="q1d">
                                        request.getValue("name")
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題2:</strong> チェックボックスなど、同じ名前で複数の値を持つパラメータを取得するための正しいメソッドはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                                    <label class="form-check-label" for="q2a">
                                        request.getParameters("hobby")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                    <label class="form-check-label" for="q2b">
                                        request.getParameterValues("hobby")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                                        <label class="form-check-label" for="q2c">
                                        request.getMultipleParameters("hobby")
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                                        <label class="form-check-label" for="q2d">
                                        request.getAllParameters("hobby")
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題3:</strong> レスポンスでJSONデータを返す場合に設定すべき適切なContent-Typeは何ですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                                    <label class="form-check-label" for="q3a">
                                        text/json
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                    <label class="form-check-label" for="q3b">
                                        text/javascript
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                                        <label class="form-check-label" for="q3c">
                                        application/json
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                                        <label class="form-check-label" for="q3d">
                                        application/text
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題4:</strong> GETメソッドとPOSTメソッドの違いについて正しい説明はどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
                                    <label class="form-check-label" for="q4a">
                                        GETはデータを送信できないが、POSTはデータを送信できる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                    <label class="form-check-label" for="q4b">
                                        GETはURLにパラメータを含み、POSTはリクエストボディにデータを含む
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
                                        <label class="form-check-label" for="q4c">
                                        GETは常に安全で、POSTは常に安全ではない
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
                                        <label class="form-check-label" for="q4d">
                                        GETはフォームデータ送信に使用できないが、POSTは使用できる
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題5:</strong> ユーザーを別のURLにリダイレクトするためのメソッドはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
                                    <label class="form-check-label" for="q5a">
                                        response.redirect(url)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                    <label class="form-check-label" for="q5b">
                                        response.sendRedirect(url)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
                                        <label class="form-check-label" for="q5c">
                                        request.forward(url)
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
                                        <label class="form-check-label" for="q5d">
                                        request.redirect(url)
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題6:</strong> リクエストの文字エンコーディングを設定するタイミングとして正しいのはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q6" id="q6a" value="a">
                                    <label class="form-check-label" for="q6a">
                                        パラメータにアクセスする前
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q6" id="q6b" value="b">
                                    <label class="form-check-label" for="q6b">
                                        パラメータにアクセスした後
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q6" id="q6c" value="c">
                                        <label class="form-check-label" for="q6c">
                                        レスポンスを送信する直前
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q6" id="q6d" value="d">
                                        <label class="form-check-label" for="q6d">
                                        いつでも設定可能で、タイミングは関係ない
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary mt-3" id="checkAnswers">回答を確認</button>
                            <div id="quizResults" class="mt-3 d-none">
                                <div class="alert alert-success">
                                    <h5>正解:</h5>
                                    <ol>
                                        <li>b（request.getParameter("name")）</li>
                                        <li>b（request.getParameterValues("hobby")）</li>
                                        <li>c（application/json）</li>
                                        <li>b（GETはURLにパラメータを含み、POSTはリクエストボディにデータを含む）</li>
                                        <li>b（response.sendRedirect(url)）</li>
                                        <li>a（パラメータにアクセスする前）</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="next-steps">
                        <h3 class="section-title">次のステップ</h3>
                        <p>この章では、JSP/Servletアプリケーションでリクエストとレスポンスを処理する基本的な方法について学びました。GETとPOSTの違い、フォーム入力の処理、文字エンコーディングの設定など、Webアプリケーション開発の重要な側面を理解することができたと思います。</p>
                        <p>次の章では、セッション管理とクッキーについて学習し、ユーザー状態の維持方法を理解します。また、MVCパターンを使ったアプリケーション設計についても学びます。</p>
                        <div class="note">
                            <h5>推奨される追加学習</h5>
                            <ul>
                                <li><strong>Jakarta Servlet仕様</strong>：<a href="https://jakarta.ee/specifications/servlet/" target="_blank">Jakarta Servlet Specification</a>のRequest/Responseの章を読む</li>
                                <li><strong>HTTP仕様</strong>：<a href="https://developer.mozilla.org/ja/docs/Web/HTTP" target="_blank">MDN Web Docs - HTTP</a>で詳細なHTTPプロトコルについて学ぶ</li>
                                <li><strong>フォーム処理</strong>：より複雑なフォーム処理とバリデーションについて学習する</li>
                                <li><strong>Java Beans</strong>：フォームデータをJava Beansにマッピングする方法を学ぶ</li>
                            </ul>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">Copyright © 2025 F-Circle All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 理解度テストの回答確認ボタンの処理
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.getElementById('quizResults').classList.remove('d-none');
        });
    </script>
</body>
</html>