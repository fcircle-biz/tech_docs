<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java学習教材 第8章 - コレクションフレームワーク応用</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #f57c00; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #f57c00; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #f57c00; padding-bottom: 0.5rem; }
        .section-title { color: #ff9800; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #fff3e0; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #f57c00; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .code-block { background-color: #1e1e1e; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
        .nav-link.active { background-color: #f57c00 !important; color: white !important; }
        .info-box { background-color: #e3f2fd; border-left: 4px solid #2196f3; padding: 1rem; margin: 1rem 0; border-radius: 4px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Java学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="../README.md">学習ガイド</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-1.html">第1章: Java基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-2.html">第2章: Java言語の基本</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-3.html">第3章: オブジェクト指向入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-4.html">第4章: オブジェクト指向応用</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-5.html">第5章: Java API基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-6.html">第6章: 例外処理</a></li>
                        <li class="nav-item"><a class="nav-link" href="java-learning-material-7.html">第7章: 入出力操作</a></li>
                        <li class="nav-item"><a class="nav-link active" href="java-learning-material-8.html">第8章: コレクション応用</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第8章: コレクションフレームワーク応用</h1>
                </div>

                <div id="chapter8">
                    <h2 class="chapter-title">モダンなデータ処理技術</h2>
                    
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>イテレータによるコレクションの安全な走査</li>
                            <li>ジェネリクスによる型安全なコレクション</li>
                            <li>Comparator インターフェースによる比較・ソート</li>
                            <li>ラムダ式による関数型プログラミング</li>
                            <li>Stream API による効率的なデータ処理</li>
                            <li>Optional クラスによるnull安全プログラミング</li>
                        </ul>
                    </div>

                    <h3 class="section-title">8.1 イテレータ（Iterator）</h3>
                    <p>イテレータは、コレクションの要素を順序立てて取得するための統一されたインターフェースです。</p>

                    <div class="exercise-container">
                        <h5>実習 8-1: イテレータの使用</h5>
                        <h6>IteratorExample.java</h6>
                        <pre class="code-block"><code class="language-java">import java.util.*;

public class IteratorExample {
    
    public static void main(String[] args) {
        List&lt;String&gt; fruits = Arrays.asList("りんご", "バナナ", "オレンジ", "ぶどう", "いちご");
        
        System.out.println("=== 基本的なイテレータ使用 ===");
        Iterator&lt;String&gt; iterator = fruits.iterator();
        while (iterator.hasNext()) {
            String fruit = iterator.next();
            System.out.println("果物: " + fruit);
        }
        
        // ListIterator（双方向）
        System.out.println("\n=== ListIterator（双方向） ===");
        List&lt;Integer&gt; numbers = new ArrayList&lt;&gt;(Arrays.asList(1, 2, 3, 4, 5));
        ListIterator&lt;Integer&gt; listIterator = numbers.listIterator();
        
        // 前方向への走査
        System.out.println("前方向:");
        while (listIterator.hasNext()) {
            System.out.print(listIterator.next() + " ");
        }
        System.out.println();
        
        // 後方向への走査
        System.out.println("後方向:");
        while (listIterator.hasPrevious()) {
            System.out.print(listIterator.previous() + " ");
        }
        System.out.println();
        
        // 安全な要素削除
        System.out.println("\n=== 安全な要素削除 ===");
        List&lt;Integer&gt; numberList = new ArrayList&lt;&gt;(Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10));
        System.out.println("削除前: " + numberList);
        
        Iterator&lt;Integer&gt; iter = numberList.iterator();
        while (iter.hasNext()) {
            Integer num = iter.next();
            if (num % 2 == 0) {  // 偶数を削除
                iter.remove();
            }
        }
        System.out.println("削除後: " + numberList);
        
        // 拡張for文との比較
        System.out.println("\n=== 拡張for文 vs イテレータ ===");
        List&lt;String&gt; colors = Arrays.asList("赤", "青", "緑", "黄");
        
        // 拡張for文（読み取り専用）
        System.out.println("拡張for文:");
        for (String color : colors) {
            System.out.print(color + " ");
        }
        System.out.println();
        
        // イテレータ（変更可能）
        System.out.println("イテレータ:");
        for (Iterator&lt;String&gt; it = colors.iterator(); it.hasNext(); ) {
            System.out.print(it.next() + " ");
        }
        System.out.println();
    }
}</code></pre>
                    </div>

                    <h3 class="section-title">8.2 ジェネリクス</h3>
                    <p>ジェネリクスにより、コレクションに格納するデータ型を指定し、型安全性を確保できます。</p>

                    <div class="exercise-container">
                        <h5>実習 8-2: ジェネリクスの活用</h5>
                        <h6>GenericsExample.java</h6>
                        <pre class="code-block"><code class="language-java">import java.util.*;

// ジェネリッククラスの定義
class Pair&lt;T, U&gt; {
    private T first;
    private U second;
    
    public Pair(T first, U second) {
        this.first = first;
        this.second = second;
    }
    
    public T getFirst() { return first; }
    public U getSecond() { return second; }
    
    @Override
    public String toString() {
        return "(" + first + ", " + second + ")";
    }
}

// 境界付きジェネリクス
class NumberContainer&lt;T extends Number&gt; {
    private List&lt;T&gt; numbers;
    
    public NumberContainer() {
        this.numbers = new ArrayList&lt;&gt;();
    }
    
    public void add(T number) {
        numbers.add(number);
    }
    
    public double getSum() {
        return numbers.stream().mapToDouble(Number::doubleValue).sum();
    }
    
    public T getMax() {
        return numbers.stream()
                     .max((a, b) -&gt; Double.compare(a.doubleValue(), b.doubleValue()))
                     .orElse(null);
    }
    
    public List&lt;T&gt; getNumbers() { return new ArrayList&lt;&gt;(numbers); }
}

public class GenericsExample {
    
    // ジェネリックメソッド
    public static &lt;T&gt; void swap(T[] array, int i, int j) {
        T temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
    
    // ワイルドカード使用
    public static void printCollection(Collection&lt;?&gt; collection) {
        for (Object item : collection) {
            System.out.print(item + " ");
        }
        System.out.println();
    }
    
    // 上限境界ワイルドカード
    public static double calculateSum(List&lt;? extends Number&gt; numbers) {
        double sum = 0.0;
        for (Number num : numbers) {
            sum += num.doubleValue();
        }
        return sum;
    }
    
    public static void main(String[] args) {
        System.out.println("=== Pairクラスの使用 ===");
        Pair&lt;String, Integer&gt; nameAge = new Pair&lt;&gt;("田中太郎", 25);
        Pair&lt;Integer, String&gt; idName = new Pair&lt;&gt;(101, "佐藤花子");
        
        System.out.println("名前と年齢: " + nameAge);
        System.out.println("IDと名前: " + idName);
        
        System.out.println("\n=== NumberContainerの使用 ===");
        NumberContainer&lt;Integer&gt; intContainer = new NumberContainer&lt;&gt;();
        intContainer.add(10);
        intContainer.add(20);
        intContainer.add(30);
        intContainer.add(15);
        
        System.out.println("整数リスト: " + intContainer.getNumbers());
        System.out.println("合計: " + intContainer.getSum());
        System.out.println("最大値: " + intContainer.getMax());
        
        NumberContainer&lt;Double&gt; doubleContainer = new NumberContainer&lt;&gt;();
        doubleContainer.add(3.14);
        doubleContainer.add(2.71);
        doubleContainer.add(1.41);
        
        System.out.println("実数リスト: " + doubleContainer.getNumbers());
        System.out.println("合計: " + doubleContainer.getSum());
        
        System.out.println("\n=== ジェネリックメソッドの使用 ===");
        String[] fruits = {"りんご", "バナナ", "オレンジ"};
        System.out.println("交換前: " + Arrays.toString(fruits));
        swap(fruits, 0, 2);
        System.out.println("交換後: " + Arrays.toString(fruits));
        
        System.out.println("\n=== ワイルドカードの使用 ===");
        List&lt;String&gt; stringList = Arrays.asList("A", "B", "C");
        List&lt;Integer&gt; intList = Arrays.asList(1, 2, 3);
        List&lt;Double&gt; doubleList = Arrays.asList(1.1, 2.2, 3.3);
        
        System.out.print("文字列コレクション: ");
        printCollection(stringList);
        System.out.print("整数コレクション: ");
        printCollection(intList);
        
        System.out.println("整数リスト合計: " + calculateSum(intList));
        System.out.println("実数リスト合計: " + calculateSum(doubleList));
    }
}</code></pre>
                    </div>

                    <h3 class="section-title">8.3 ラムダ式と関数型インターフェース</h3>
                    <p>Java 8で導入されたラムダ式により、関数型プログラミングのスタイルでより簡潔なコードを書けます。</p>

                    <div class="exercise-container">
                        <h5>実習 8-3: ラムダ式の活用</h5>
                        <h6>LambdaExample.java</h6>
                        <pre class="code-block"><code class="language-java">import java.util.*;
import java.util.function.*;

public class LambdaExample {
    
    public static void main(String[] args) {
        List&lt;String&gt; names = Arrays.asList("田中", "佐藤", "山田", "鈴木", "高橋");
        List&lt;Integer&gt; numbers = Arrays.asList(1, 2, 3, 4, 5, 6, 7, 8, 9, 10);
        
        System.out.println("=== 従来の書き方 vs ラムダ式 ===");
        
        // 従来の書き方（匿名クラス）
        Collections.sort(names, new Comparator&lt;String&gt;() {
            @Override
            public int compare(String a, String b) {
                return a.compareTo(b);
            }
        });
        
        // ラムダ式
        Collections.sort(names, (a, b) -&gt; a.compareTo(b));
        // さらに簡潔に
        Collections.sort(names, String::compareTo);
        
        System.out.println("ソート結果: " + names);
        
        System.out.println("\n=== 関数型インターフェースの使用 ===");
        
        // Predicate（条件判定）
        Predicate&lt;Integer&gt; isEven = n -&gt; n % 2 == 0;
        Predicate&lt;Integer&gt; isPositive = n -&gt; n &gt; 0;
        Predicate&lt;Integer&gt; isEvenAndPositive = isEven.and(isPositive);
        
        System.out.println("偶数の判定:");
        numbers.forEach(n -&gt; {
            if (isEven.test(n)) {
                System.out.print(n + " ");
            }
        });
        System.out.println();
        
        System.out.println("偶数かつ正数の判定:");
        numbers.stream()
               .filter(isEvenAndPositive)
               .forEach(n -&gt; System.out.print(n + " "));
        System.out.println();
        
        // Function（関数適用）
        Function&lt;String, Integer&gt; stringLength = String::length;
        Function&lt;Integer, String&gt; doubleAndToString = n -&gt; String.valueOf(n * 2);
        Function&lt;String, String&gt; lengthDoubleToString = stringLength.andThen(doubleAndToString);
        
        System.out.println("\n関数の合成:");
        names.forEach(name -&gt; {
            System.out.println(name + " -&gt; " + lengthDoubleToString.apply(name));
        });
        
        // Consumer（値の消費）
        Consumer&lt;String&gt; printer = System.out::println;
        Consumer&lt;String&gt; upperCasePrinter = s -&gt; System.out.println(s.toUpperCase());
        
        System.out.println("\nConsumerの使用:");
        names.forEach(printer.andThen(upperCasePrinter));
        
        // Supplier（値の供給）
        Supplier&lt;String&gt; randomName = () -&gt; {
            String[] nameArray = {"太郎", "花子", "次郎", "美咲"};
            return nameArray[new Random().nextInt(nameArray.length)];
        };
        
        System.out.println("\nランダムな名前:");
        for (int i = 0; i < 3; i++) {
            System.out.println(randomName.get());
        }
        
        // カスタム関数型インターフェース
        Calculator add = (a, b) -&gt; a + b;
        Calculator multiply = (a, b) -&gt; a * b;
        
        System.out.println("\nカスタム関数型インターフェース:");
        System.out.println("5 + 3 = " + add.calculate(5, 3));
        System.out.println("5 × 3 = " + multiply.calculate(5, 3));
    }
    
    // カスタム関数型インターフェース
    @FunctionalInterface
    interface Calculator {
        int calculate(int a, int b);
    }
}</code></pre>
                    </div>

                    <h3 class="section-title">8.4 Stream API</h3>
                    <p>Stream APIにより、コレクションデータの処理を宣言的かつ効率的に行えます。</p>

                    <div class="exercise-container">
                        <h5>実習 8-4: Stream APIの活用</h5>
                        <h6>StreamExample.java</h6>
                        <pre class="code-block"><code class="language-java">import java.util.*;
import java.util.stream.*;

class Employee {
    private String name;
    private String department;
    private int age;
    private double salary;
    
    public Employee(String name, String department, int age, double salary) {
        this.name = name;
        this.department = department;
        this.age = age;
        this.salary = salary;
    }
    
    // ゲッター
    public String getName() { return name; }
    public String getDepartment() { return department; }
    public int getAge() { return age; }
    public double getSalary() { return salary; }
    
    @Override
    public String toString() {
        return String.format("%s(%s, %d歳, %.0f万円)", name, department, age, salary);
    }
}

public class StreamExample {
    
    public static void main(String[] args) {
        List&lt;Employee&gt; employees = Arrays.asList(
            new Employee("田中太郎", "開発部", 28, 500),
            new Employee("佐藤花子", "営業部", 32, 450),
            new Employee("山田次郎", "開発部", 25, 400),
            new Employee("鈴木美咲", "企画部", 29, 520),
            new Employee("高橋健一", "営業部", 35, 600),
            new Employee("中村直美", "開発部", 27, 480)
        );
        
        System.out.println("=== 基本的なStream操作 ===");
        
        // フィルタリング
        System.out.println("開発部の従業員:");
        employees.stream()
                .filter(e -&gt; "開発部".equals(e.getDepartment()))
                .forEach(System.out::println);
        
        // マッピング
        System.out.println("\n従業員名のリスト:");
        List&lt;String&gt; names = employees.stream()
                                    .map(Employee::getName)
                                    .collect(Collectors.toList());
        System.out.println(names);
        
        // ソート
        System.out.println("\n年齢順（昇順）:");
        employees.stream()
                .sorted(Comparator.comparingInt(Employee::getAge))
                .forEach(System.out::println);
        
        System.out.println("\n給与順（降順）:");
        employees.stream()
                .sorted(Comparator.comparingDouble(Employee::getSalary).reversed())
                .forEach(System.out::println);
        
        System.out.println("\n=== 集約操作 ===");
        
        // 数値操作
        OptionalDouble averageAge = employees.stream()
                                           .mapToInt(Employee::getAge)
                                           .average();
        System.out.println("平均年齢: " + averageAge.orElse(0) + "歳");
        
        double totalSalary = employees.stream()
                                    .mapToDouble(Employee::getSalary)
                                    .sum();
        System.out.println("総給与: " + totalSalary + "万円");
        
        Optional&lt;Employee&gt; youngestEmployee = employees.stream()
                                                    .min(Comparator.comparingInt(Employee::getAge));
        System.out.println("最年少: " + youngestEmployee.orElse(null));
        
        // グループ化
        System.out.println("\n=== グループ化 ===");
        Map&lt;String, List&lt;Employee&gt;&gt; byDepartment = employees.stream()
                                                         .collect(Collectors.groupingBy(Employee::getDepartment));
        
        byDepartment.forEach((dept, empList) -&gt; {
            System.out.println(dept + ":");
            empList.forEach(e -&gt; System.out.println("  " + e.getName()));
        });
        
        // 部署別平均給与
        System.out.println("\n部署別平均給与:");
        Map&lt;String, Double&gt; avgSalaryByDept = employees.stream()
                                                    .collect(Collectors.groupingBy(
                                                        Employee::getDepartment,
                                                        Collectors.averagingDouble(Employee::getSalary)
                                                    ));
        
        avgSalaryByDept.forEach((dept, avgSalary) -&gt; 
            System.out.println(dept + ": " + String.format("%.1f", avgSalary) + "万円"));
        
        System.out.println("\n=== 条件判定 ===");
        
        boolean anyHighSalary = employees.stream()
                                       .anyMatch(e -&gt; e.getSalary() &gt;= 550);
        System.out.println("550万円以上の従業員がいる: " + anyHighSalary);
        
        boolean allAdults = employees.stream()
                                   .allMatch(e -&gt; e.getAge() &gt;= 20);
        System.out.println("全員20歳以上: " + allAdults);
        
        long developersCount = employees.stream()
                                      .filter(e -&gt; "開発部".equals(e.getDepartment()))
                                      .count();
        System.out.println("開発部の人数: " + developersCount + "人");
        
        System.out.println("\n=== 複雑なStream処理 ===");
        
        // チェーン処理の例
        String result = employees.stream()
                               .filter(e -&gt; e.getAge() &lt; 30)                    // 30歳未満
                               .filter(e -&gt; e.getSalary() &gt;= 450)              // 450万円以上
                               .sorted(Comparator.comparing(Employee::getName)) // 名前順
                               .map(Employee::getName)                         // 名前のみ抽出
                               .collect(Collectors.joining(", "));            // 文字列結合
        
        System.out.println("30歳未満で450万円以上の従業員: " + result);
        
        // 並列Stream
        System.out.println("\n=== 並列処理 ===");
        long start = System.currentTimeMillis();
        
        // 重い処理のシミュレーション
        int sum = IntStream.range(1, 1000000)
                          .parallel()
                          .map(i -&gt; i * i)
                          .reduce(0, Integer::sum);
        
        long end = System.currentTimeMillis();
        System.out.println("並列処理結果: " + sum);
        System.out.println("処理時間: " + (end - start) + "ms");
    }
}</code></pre>
                    </div>

                    <h3 class="section-title">8.5 Optional クラス</h3>
                    <p>OptionalクラスによりNullPointerExceptionを避け、より安全なコードを書けます。</p>

                    <div class="exercise-container">
                        <h5>実習 8-5: Optional クラスの活用</h5>
                        <h6>OptionalExample.java</h6>
                        <pre class="code-block"><code class="language-java">import java.util.*;

public class OptionalExample {
    
    public static void main(String[] args) {
        List&lt;String&gt; names = Arrays.asList("田中", "佐藤", null, "山田", "");
        
        System.out.println("=== Optionalの基本使用 ===");
        
        // Optional の作成
        Optional&lt;String&gt; name1 = Optional.of("田中太郎");           // null不可
        Optional&lt;String&gt; name2 = Optional.ofNullable(null);       // null可
        Optional&lt;String&gt; name3 = Optional.empty();               // 空のOptional
        
        System.out.println("name1 存在: " + name1.isPresent());
        System.out.println("name2 存在: " + name2.isPresent());
        System.out.println("name3 存在: " + name3.isPresent());
        
        // 値の取得
        System.out.println("\n=== 値の取得方法 ===");
        
        // get() - 危険（値がない場合は例外）
        try {
            System.out.println("name1 値: " + name1.get());
            // System.out.println("name2 値: " + name2.get()); // 例外発生
        } catch (NoSuchElementException e) {
            System.out.println("値が存在しません");
        }
        
        // orElse() - デフォルト値を提供
        System.out.println("name2 デフォルト値: " + name2.orElse("デフォルト名"));
        
        // orElseGet() - Supplier でデフォルト値を生成
        System.out.println("name3 生成値: " + name3.orElseGet(() -&gt; "生成された名前"));
        
        // orElseThrow() - カスタム例外をスロー
        try {
            String value = name2.orElseThrow(() -&gt; new IllegalStateException("名前が設定されていません"));
        } catch (IllegalStateException e) {
            System.out.println("例外: " + e.getMessage());
        }
        
        System.out.println("\n=== Optionalの操作 ===");
        
        // ifPresent() - 値が存在する場合のみ処理実行
        name1.ifPresent(name -&gt; System.out.println("挨拶: こんにちは、" + name + "さん"));
        name2.ifPresent(name -&gt; System.out.println("これは表示されない"));
        
        // ifPresentOrElse() - 値の有無で処理を分岐
        name1.ifPresentOrElse(
            name -&gt; System.out.println("名前あり: " + name),
            () -&gt; System.out.println("名前なし")
        );
        
        name2.ifPresentOrElse(
            name -&gt; System.out.println("名前あり: " + name),
            () -&gt; System.out.println("名前なし")
        );
        
        // map() - 値が存在する場合のみ変換
        Optional&lt;Integer&gt; nameLength = name1.map(String::length);
        System.out.println("名前の長さ: " + nameLength.orElse(0));
        
        Optional&lt;String&gt; upperCaseName = name1.map(String::toUpperCase);
        System.out.println("大文字変換: " + upperCaseName.orElse("なし"));
        
        // filter() - 条件に一致する場合のみ値を保持
        Optional&lt;String&gt; shortName = name1.filter(name -&gt; name.length() &lt;= 3);
        System.out.println("短い名前: " + shortName.orElse("該当なし"));
        
        // flatMap() - Optional を返すメソッドと組み合わせ
        Optional&lt;String&gt; result = name1.flatMap(OptionalExample::findNickname);
        System.out.println("ニックネーム: " + result.orElse("不明"));
        
        System.out.println("\n=== 実用的なOptional使用例 ===");
        
        // リストから条件に一致する最初の要素を検索
        Optional&lt;String&gt; firstLongName = names.stream()
                                            .filter(Objects::nonNull)           // null除外
                                            .filter(name -&gt; !name.isEmpty())     // 空文字除外
                                            .filter(name -&gt; name.length() &gt; 1)   // 2文字以上
                                            .findFirst();
        
        System.out.println("最初の有効な名前: " + firstLongName.orElse("見つからない"));
        
        // Optional のチェーン処理
        String processedName = findPersonById(1)
            .map(Person::getName)
            .filter(name -&gt; name.length() &gt; 2)
            .map(String::toUpperCase)
            .orElse("UNKNOWN");
        
        System.out.println("処理結果: " + processedName);
        
        // Optional の or() メソッド（Java 9+）
        Optional&lt;String&gt; alternative = name2.or(() -&gt; Optional.of("代替値"));
        System.out.println("代替値: " + alternative.get());
    }
    
    // Optional を返すメソッドの例
    private static Optional&lt;String&gt; findNickname(String fullName) {
        Map&lt;String, String&gt; nicknames = Map.of(
            "田中太郎", "タロー",
            "佐藤花子", "ハナコ"
        );
        return Optional.ofNullable(nicknames.get(fullName));
    }
    
    private static Optional&lt;Person&gt; findPersonById(int id) {
        // 実際のデータベース検索の代わり
        if (id == 1) {
            return Optional.of(new Person("田中太郎"));
        }
        return Optional.empty();
    }
    
    static class Person {
        private String name;
        
        public Person(String name) {
            this.name = name;
        }
        
        public String getName() {
            return name;
        }
    }
}</code></pre>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>Iterator とは何か、また拡張for文との使い分けについて説明してください。</li>
                            <li>ジェネリクスを使用するメリットを3つ挙げ、境界付きジェネリクスの用途を説明してください。</li>
                            <li>ラムダ式の基本構文を説明し、どのような場面で有効活用できるか述べてください。</li>
                            <li>Stream API の中間操作と終端操作の違いを説明し、それぞれの例を3つずつ挙げてください。</li>
                            <li>Optional クラスを使用することで避けられる問題と、適切な使用方法を説明してください。</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="java-learning-material-7.html" class="btn btn-secondary">← 前の章 入出力操作</a>
                        <a href="../README.md" class="btn btn-primary">学習ガイドに戻る</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>