<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VBAå­¦ç¿’æ•™æ ç¬¬9ç«  - ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ãƒ‡ãƒãƒƒã‚°</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #1565c0; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #1565c0; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #1565c0; padding-bottom: 0.5rem; }
        .section-title { color: #1976d2; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .code-block { background-color: #1e1e1e; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
        code { display: block; font-family: Consolas, Monaco, 'Andale Mono', monospace; white-space: pre; overflow-x: auto; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 2rem 0; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 2rem 0; }
        .highlight { background-color: #fff3e0; padding: 1rem; border-left: 4px solid #ff9800; margin: 1rem 0; }
        .warning { background-color: #ffebee; padding: 1rem; border-left: 4px solid #f44336; margin: 1rem 0; }
        .tip { background-color: #e8f5e8; padding: 1rem; border-left: 4px solid #4caf50; margin: 1rem 0; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">VBAå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="../../../../README.md">ãƒ›ãƒ¼ãƒ </a></li>
                    <li class="nav-item"><a class="nav-link" href="README.md">ã‚¬ã‚¤ãƒ‰ä¸€è¦§</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading">å­¦ç¿’å†…å®¹</h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-01.html">ç¬¬1ç« : VBAã®åŸºæœ¬ã¨ãƒã‚¯ãƒ­è¨˜éŒ²</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-02.html">ç¬¬2ç« : å¤‰æ•°ã¨ãƒ‡ãƒ¼ã‚¿å‹</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-03.html">ç¬¬3ç« : åˆ¶å¾¡æ§‹é€ </a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-04.html">ç¬¬4ç« : ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã¨ãƒ•ã‚¡ãƒ³ã‚¯ã‚·ãƒ§ãƒ³</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-05.html">ç¬¬5ç« : Excelã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ¢ãƒ‡ãƒ«</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-06.html">ç¬¬6ç« : ã‚»ãƒ«ãƒ»ã‚·ãƒ¼ãƒˆãƒ»ãƒ–ãƒƒã‚¯æ“ä½œ</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-07.html">ç¬¬7ç« : ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ ã¨GUI</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-08.html">ç¬¬8ç« : ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã¨ãƒ‡ãƒ¼ã‚¿å‡¦ç†</a></li>
                        <li class="nav-item"><a class="nav-link active" href="#chapter9">ç¬¬9ç« : ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ãƒ‡ãƒãƒƒã‚°</a></li>
                        <li class="nav-item"><a class="nav-link" href="vba-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µçš„ãªè‡ªå‹•åŒ–ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬9ç« : ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ãƒ‡ãƒãƒƒã‚°</h1>
                </div>

                <div id="chapter9">
                    <h2 class="chapter-title">ã‚¨ãƒ©ãƒ¼å‡¦ç†ã¨ãƒ‡ãƒãƒƒã‚°</h2>
                    
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã¨åŸå› ã®ç†è§£</li>
                            <li>On Erroræ–‡ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼å‡¦ç†</li>
                            <li>ãƒ‡ãƒãƒƒã‚°æŠ€è¡“ã®ç¿’å¾—</li>
                            <li>ãƒ­ã‚°æ©Ÿèƒ½ã®å®Ÿè£…</li>
                            <li>å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">9.1 ã‚¨ãƒ©ãƒ¼ã®ç¨®é¡</h3>
                    <p>VBAã§ç™ºç”Ÿã™ã‚‹ä¸»è¦ãªã‚¨ãƒ©ãƒ¼ã®ç¨®é¡ã‚’ç†è§£ã—ã€é©åˆ‡ã«å¯¾å‡¦ã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>

                    <div class="warning">
                        <h5>âš ï¸ ä¸»è¦ãªã‚¨ãƒ©ãƒ¼ã®ç¨®é¡</h5>
                        <ul>
                            <li><strong>æ§‹æ–‡ã‚¨ãƒ©ãƒ¼</strong>: ã‚³ãƒ¼ãƒ‰ã®æ–‡æ³•ãŒé–“é•ã£ã¦ã„ã‚‹</li>
                            <li><strong>å®Ÿè¡Œæ™‚ã‚¨ãƒ©ãƒ¼</strong>: å®Ÿè¡Œä¸­ã«ç™ºç”Ÿã™ã‚‹ã‚¨ãƒ©ãƒ¼</li>
                            <li><strong>è«–ç†ã‚¨ãƒ©ãƒ¼</strong>: æœŸå¾…ã—ãŸçµæœã«ãªã‚‰ãªã„</li>
                            <li><strong>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¨ãƒ©ãƒ¼</strong>: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒè¦‹ã¤ã‹ã‚‰ãªã„</li>
                        </ul>
                    </div>

                    <h3 class="section-title">9.2 On Erroræ–‡ã«ã‚ˆã‚‹ã‚¨ãƒ©ãƒ¼å‡¦ç†</h3>
                    <p>On Erroræ–‡ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’æ•æ‰ã—ã€é©åˆ‡ã«å‡¦ç†ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-1: åŸºæœ¬çš„ãªã‚¨ãƒ©ãƒ¼å‡¦ç†</h5>
                        <pre class="code-block"><code class="language-vbnet" aria-label="VBAã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«">Sub åŸºæœ¬ã‚¨ãƒ©ãƒ¼å‡¦ç†()
    On Error GoTo ã‚¨ãƒ©ãƒ¼å‡¦ç†
    
    Dim æ•°å€¤1 As Integer
    Dim æ•°å€¤2 As Integer
    Dim çµæœ As Double
    
    æ•°å€¤1 = InputBox("æœ€åˆã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
    æ•°å€¤2 = InputBox("äºŒç•ªç›®ã®æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
    
    çµæœ = æ•°å€¤1 / æ•°å€¤2
    
    MsgBox "è¨ˆç®—çµæœ: " & çµæœ
    
    Exit Sub
    
ã‚¨ãƒ©ãƒ¼å‡¦ç†:
    Select Case Err.Number
        Case 11 ' 0é™¤ç®—ã‚¨ãƒ©ãƒ¼
            MsgBox "0ã§å‰²ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“", vbCritical
        Case 13 ' å‹ä¸ä¸€è‡´ã‚¨ãƒ©ãƒ¼
            MsgBox "æ•°å€¤ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„", vbExclamation
        Case Else
            MsgBox "äºˆæœŸã—ãªã„ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ" & vbCrLf & _
                   "ã‚¨ãƒ©ãƒ¼ç•ªå·: " & Err.Number & vbCrLf & _
                   "ã‚¨ãƒ©ãƒ¼å†…å®¹: " & Err.Description, vbCritical
    End Select
    
    Err.Clear
End Sub</code></pre>
                    </div>

                    <h3 class="section-title">9.3 Resumeæ–‡ã®ä½¿ç”¨</h3>
                    <p>Resumeæ–‡ã‚’ä½¿ç”¨ã—ã¦ã‚¨ãƒ©ãƒ¼å¾Œã®å‡¦ç†ã‚’ç¶™ç¶šã§ãã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-2: Resumeæ–‡ã®æ´»ç”¨</h5>
                        <pre class="code-block"><code class="language-vbnet" aria-label="VBAã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«">Sub Resumeæ–‡æ´»ç”¨()
    On Error GoTo ã‚¨ãƒ©ãƒ¼å‡¦ç†
    
    Dim ãƒ•ã‚¡ã‚¤ãƒ«å As String
    Dim ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå· As Integer
    
å†è©¦è¡Œ:
    ãƒ•ã‚¡ã‚¤ãƒ«å = InputBox("é–‹ããƒ•ã‚¡ã‚¤ãƒ«åã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
    
    If ãƒ•ã‚¡ã‚¤ãƒ«å = "" Then Exit Sub
    
    ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå· = FreeFile
    Open ãƒ•ã‚¡ã‚¤ãƒ«å For Input As #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·
    
    ' ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ã‚’èª­ã¿è¾¼ã¿
    Dim è¡Œãƒ‡ãƒ¼ã‚¿ As String
    Dim è¡Œç•ªå· As Integer
    è¡Œç•ªå· = 1
    
    Do While Not EOF(ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·)
        Line Input #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·, è¡Œãƒ‡ãƒ¼ã‚¿
        Cells(è¡Œç•ªå·, 1).Value = è¡Œãƒ‡ãƒ¼ã‚¿
        è¡Œç•ªå· = è¡Œç•ªå· + 1
    Loop
    
    Close #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·
    MsgBox "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£å¸¸ã«èª­ã¿è¾¼ã¿ã¾ã—ãŸ"
    
    Exit Sub
    
ã‚¨ãƒ©ãƒ¼å‡¦ç†:
    Select Case Err.Number
        Case 53 ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚‰ãªã„
            If MsgBox("ãƒ•ã‚¡ã‚¤ãƒ«ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚å†è©¦è¡Œã—ã¾ã™ã‹ï¼Ÿ", vbYesNo) = vbYes Then
                Resume å†è©¦è¡Œ
            Else
                Resume Next
            End If
        Case 76 ' ãƒ‘ã‚¹ãŒè¦‹ã¤ã‹ã‚‰ãªã„
            MsgBox "æŒ‡å®šã•ã‚ŒãŸãƒ‘ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", vbCritical
            Resume Next
        Case Else
            MsgBox "ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: " & Err.Description, vbCritical
            Resume Next
    End Select
End Sub</code></pre>
                    </div>

                    <h3 class="section-title">9.4 ãƒ‡ãƒãƒƒã‚°æŠ€è¡“</h3>
                    <p>åŠ¹ç‡çš„ãªãƒ‡ãƒãƒƒã‚°æŠ€è¡“ã‚’å­¦ã³ã€å•é¡Œã‚’è¿…é€Ÿã«ç‰¹å®šãƒ»è§£æ±ºã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-3: ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•</h5>
                        <pre class="code-block"><code class="language-vbnet" aria-label="VBAã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«">Sub ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•ãƒ‡ãƒ¢()
    Dim i As Integer
    Dim åˆè¨ˆ As Long
    Dim é…åˆ—ãƒ‡ãƒ¼ã‚¿(1 To 10) As Integer
    
    ' ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–
    For i = 1 To 10
        é…åˆ—ãƒ‡ãƒ¼ã‚¿(i) = i * 2
        Debug.Print "é…åˆ—ãƒ‡ãƒ¼ã‚¿(" & i & ") = " & é…åˆ—ãƒ‡ãƒ¼ã‚¿(i)
    Next i
    
    ' æ¡ä»¶ä»˜ããƒ–ãƒ¬ãƒ¼ã‚¯ãƒã‚¤ãƒ³ãƒˆã®ä½¿ç”¨ä¾‹
    For i = 1 To 10
        åˆè¨ˆ = åˆè¨ˆ + é…åˆ—ãƒ‡ãƒ¼ã‚¿(i)
        
        ' ãƒ‡ãƒãƒƒã‚°æƒ…å ±ã®å‡ºåŠ›
        Debug.Print "ãƒ«ãƒ¼ãƒ— " & i & ": åˆè¨ˆ = " & åˆè¨ˆ
        
        ' æ¡ä»¶ãƒã‚§ãƒƒã‚¯
        If åˆè¨ˆ > 50 Then
            Debug.Print "åˆè¨ˆãŒ50ã‚’è¶…ãˆã¾ã—ãŸ: " & åˆè¨ˆ
            Stop ' ãƒ‡ãƒãƒƒã‚¬ãƒ¼ã§åœæ­¢
        End If
    Next i
    
    MsgBox "æœ€çµ‚åˆè¨ˆ: " & åˆè¨ˆ
End Sub

Sub ã‚¦ã‚©ãƒƒãƒå¼ãƒ‡ãƒ¢()
    Dim é¡§å®¢å As String
    Dim å£²ä¸Š As Currency
    Dim åˆ©ç›Šç‡ As Double
    
    é¡§å®¢å = "æ ªå¼ä¼šç¤¾ABC"
    å£²ä¸Š = 1000000
    åˆ©ç›Šç‡ = 0.15
    
    ' ã‚¦ã‚©ãƒƒãƒå¼ã§ä»¥ä¸‹ã®å¤‰æ•°ã‚’ç›£è¦–
    ' é¡§å®¢å, å£²ä¸Š, åˆ©ç›Šç‡, å£²ä¸Š * åˆ©ç›Šç‡
    
    Dim åˆ©ç›Š As Currency
    åˆ©ç›Š = å£²ä¸Š * åˆ©ç›Šç‡
    
    Debug.Print "é¡§å®¢: " & é¡§å®¢å
    Debug.Print "å£²ä¸Š: " & Format(å£²ä¸Š, "#,##0")
    Debug.Print "åˆ©ç›Š: " & Format(åˆ©ç›Š, "#,##0")
End Sub</code></pre>
                    </div>

                    <h3 class="section-title">9.5 ãƒ­ã‚°æ©Ÿèƒ½ã®å®Ÿè£…</h3>
                    <p>å‡¦ç†ã®å±¥æ­´ã‚’è¨˜éŒ²ã—ã€å•é¡Œã®åŸå› ã‚’ç‰¹å®šã—ã‚„ã™ãã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-4: ãƒ­ã‚°æ©Ÿèƒ½ã®ä½œæˆ</h5>
                        <pre class="code-block"><code class="language-vbnet" aria-label="VBAã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«">Sub ãƒ­ã‚°å‡ºåŠ›(ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ As String, Optional ãƒ¬ãƒ™ãƒ« As String = "INFO")
    Dim ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« As String
    Dim ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå· As Integer
    Dim ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— As String
    
    ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« = ThisWorkbook.Path & "\application.log"
    ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— = Format(Now, "yyyy-mm-dd hh:mm:ss")
    
    ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå· = FreeFile
    Open ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ« For Append As #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·
    
    Print #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·, ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ— & " [" & ãƒ¬ãƒ™ãƒ« & "] " & ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
    
    Close #ãƒ•ã‚¡ã‚¤ãƒ«ç•ªå·
End Sub

Sub ãƒ­ã‚°æ©Ÿèƒ½ãƒ‡ãƒ¢()
    On Error GoTo ã‚¨ãƒ©ãƒ¼å‡¦ç†
    
    Call ãƒ­ã‚°å‡ºåŠ›("å‡¦ç†é–‹å§‹", "INFO")
    
    Dim i As Integer
    Dim ãƒ‡ãƒ¼ã‚¿ As Variant
    
    For i = 1 To 5
        Call ãƒ­ã‚°å‡ºåŠ›("ãƒ«ãƒ¼ãƒ— " & i & " é–‹å§‹", "DEBUG")
        
        ' ä½•ã‚‰ã‹ã®å‡¦ç†
        ãƒ‡ãƒ¼ã‚¿ = Cells(i, 1).Value
        
        If IsEmpty(ãƒ‡ãƒ¼ã‚¿) Then
            Call ãƒ­ã‚°å‡ºåŠ›("è¡Œ " & i & " ã®ãƒ‡ãƒ¼ã‚¿ãŒç©ºã§ã™", "WARN")
        Else
            Call ãƒ­ã‚°å‡ºåŠ›("è¡Œ " & i & " ã®ãƒ‡ãƒ¼ã‚¿: " & ãƒ‡ãƒ¼ã‚¿, "INFO")
        End If
        
        Call ãƒ­ã‚°å‡ºåŠ›("ãƒ«ãƒ¼ãƒ— " & i & " çµ‚äº†", "DEBUG")
    Next i
    
    Call ãƒ­ã‚°å‡ºåŠ›("å‡¦ç†æ­£å¸¸çµ‚äº†", "INFO")
    Exit Sub
    
ã‚¨ãƒ©ãƒ¼å‡¦ç†:
    Call ãƒ­ã‚°å‡ºåŠ›("ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: " & Err.Description, "ERROR")
    MsgBox "ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚"
End Sub</code></pre>
                    </div>

                    <h3 class="section-title">9.6 å …ç‰¢ãªãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ</h3>
                    <p>ã‚¨ãƒ©ãƒ¼ã«å¼·ã„ã€ä¿¡é ¼æ€§ã®é«˜ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ä½œæˆã™ã‚‹æŠ€è¡“ã‚’å­¦ã³ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 9-5: å …ç‰¢ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†</h5>
                        <pre class="code-block"><code class="language-vbnet" aria-label="VBAã‚³ãƒ¼ãƒ‰ã‚µãƒ³ãƒ—ãƒ«">Function å®‰å…¨ãªæ•°å€¤å¤‰æ›(å…¥åŠ›å€¤ As Variant) As Variant
    On Error GoTo ã‚¨ãƒ©ãƒ¼å‡¦ç†
    
    If IsEmpty(å…¥åŠ›å€¤) Or IsNull(å…¥åŠ›å€¤) Then
        å®‰å…¨ãªæ•°å€¤å¤‰æ› = 0
        Exit Function
    End If
    
    If IsNumeric(å…¥åŠ›å€¤) Then
        å®‰å…¨ãªæ•°å€¤å¤‰æ› = CDbl(å…¥åŠ›å€¤)
    Else
        å®‰å…¨ãªæ•°å€¤å¤‰æ› = 0
    End If
    
    Exit Function
    
ã‚¨ãƒ©ãƒ¼å‡¦ç†:
    å®‰å…¨ãªæ•°å€¤å¤‰æ› = 0
End Function

Sub å …ç‰¢ãªãƒ‡ãƒ¼ã‚¿å‡¦ç†()
    On Error GoTo ã‚¨ãƒ©ãƒ¼å‡¦ç†
    
    Dim ws As Worksheet
    Dim æœ€çµ‚è¡Œ As Long
    Dim i As Long
    Dim å£²ä¸Š As Double
    Dim åˆè¨ˆ As Double
    Dim ã‚¨ãƒ©ãƒ¼ä»¶æ•° As Long
    
    Set ws = ThisWorkbook.Worksheets("å£²ä¸Šãƒ‡ãƒ¼ã‚¿")
    æœ€çµ‚è¡Œ = ws.Cells(ws.Rows.Count, 1).End(xlUp).Row
    
    Call ãƒ­ã‚°å‡ºåŠ›("ãƒ‡ãƒ¼ã‚¿å‡¦ç†é–‹å§‹ã€‚å¯¾è±¡è¡Œæ•°: " & æœ€çµ‚è¡Œ, "INFO")
    
    For i = 2 To æœ€çµ‚è¡Œ
        å£²ä¸Š = å®‰å…¨ãªæ•°å€¤å¤‰æ›(ws.Cells(i, 3).Value)
        
        If å£²ä¸Š = 0 And Not IsEmpty(ws.Cells(i, 3).Value) Then
            ã‚¨ãƒ©ãƒ¼ä»¶æ•° = ã‚¨ãƒ©ãƒ¼ä»¶æ•° + 1
            Call ãƒ­ã‚°å‡ºåŠ›("è¡Œ " & i & ": ç„¡åŠ¹ãªå£²ä¸Šãƒ‡ãƒ¼ã‚¿", "WARN")
        End If
        
        åˆè¨ˆ = åˆè¨ˆ + å£²ä¸Š
    Next i
    
    ws.Range("D1").Value = "åˆè¨ˆå£²ä¸Š"
    ws.Range("D2").Value = åˆè¨ˆ
    ws.Range("D3").Value = "ã‚¨ãƒ©ãƒ¼ä»¶æ•°: " & ã‚¨ãƒ©ãƒ¼ä»¶æ•°
    
    Call ãƒ­ã‚°å‡ºåŠ›("ãƒ‡ãƒ¼ã‚¿å‡¦ç†å®Œäº†ã€‚åˆè¨ˆ: " & åˆè¨ˆ, "INFO")
    
    If ã‚¨ãƒ©ãƒ¼ä»¶æ•° > 0 Then
        MsgBox "å‡¦ç†ã¯å®Œäº†ã—ã¾ã—ãŸãŒã€" & ã‚¨ãƒ©ãƒ¼ä»¶æ•° & "ä»¶ã®ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã—ãŸã€‚"
    Else
        MsgBox "å‡¦ç†ãŒæ­£å¸¸ã«å®Œäº†ã—ã¾ã—ãŸã€‚"
    End If
    
    Exit Sub
    
ã‚¨ãƒ©ãƒ¼å‡¦ç†:
    Call ãƒ­ã‚°å‡ºåŠ›("è‡´å‘½çš„ã‚¨ãƒ©ãƒ¼: " & Err.Description, "ERROR")
    MsgBox "å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & Err.Description
End Sub</code></pre>
                    </div>

                    <div class="tip">
                        <h5>ğŸ’¡ ã‚¨ãƒ©ãƒ¼å‡¦ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h5>
                        <ul>
                            <li>ã™ã¹ã¦ã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã«ã‚¨ãƒ©ãƒ¼å‡¦ç†ã‚’å®Ÿè£…ã™ã‚‹</li>
                            <li>å…·ä½“çš„ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’æä¾›ã™ã‚‹</li>
                            <li>ãƒ­ã‚°æ©Ÿèƒ½ã‚’æ´»ç”¨ã—ã¦å•é¡Œã‚’è¿½è·¡ã™ã‚‹</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤ºã™ã‚‹</li>
                            <li>ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿæ™‚ã«ã‚‚å®‰å…¨ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’çµ‚äº†ã™ã‚‹</li>
                        </ul>
                    </div>

                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>ã‚¨ãƒ©ãƒ¼ã‚’æ•æ‰ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¯ï¼Ÿ</li>
                            <li>ã‚¨ãƒ©ãƒ¼å¾Œã«å‡¦ç†ã‚’ç¶™ç¶šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã¯ï¼Ÿ</li>
                            <li>ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã«å‡ºåŠ›ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ï¼Ÿ</li>
                            <li>ã‚¨ãƒ©ãƒ¼æƒ…å ±ã‚’ã‚¯ãƒªã‚¢ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ï¼Ÿ</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="vba-learning-material-08.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="vba-learning-material-10.html" class="btn btn-primary">æ¬¡ã®ç«  â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- å­¦ç¿’é€²æ—ç®¡ç†æ©Ÿèƒ½ -->
    <script>
        // å­¦ç¿’é€²æ—ç®¡ç†æ©Ÿèƒ½
        function initProgressTracking() {
            const chapterNumber = getCurrentChapterNumber();
            const progressKey = 'vba-learning-progress';
            
            // é€²æ—çŠ¶æ³ã‚’èª­ã¿è¾¼ã¿
            const progress = JSON.parse(localStorage.getItem(progressKey) || '{}');
            
            // ç« å®Œäº†ãƒœã‚¿ãƒ³ã‚’è¿½åŠ 
            addCompletionButton(chapterNumber);
            
            // é€²æ—ã‚’ã‚µã‚¤ãƒ‰ãƒãƒ¼ã«è¡¨ç¤º
            updateProgressDisplay(progress);
        }
        
        function getCurrentChapterNumber() {
            const title = document.title;
            const match = title.match(/ç¬¬(\d+)ç« /);
            return match ? parseInt(match[1]) : 1;
        }
        
        function addCompletionButton(chapterNumber) {
            const mainContent = document.querySelector('main');
            const existingButton = document.querySelector('.completion-btn');
            
            if (!existingButton) {
                const buttonContainer = document.createElement('div');
                buttonContainer.className = 'text-center mt-4 mb-4';
                buttonContainer.innerHTML = `
                    <button class="btn btn-success completion-btn" onclick="markChapterComplete(${chapterNumber})">
                        <i class="fas fa-check"></i> ã“ã®ç« ã‚’å®Œäº†ã™ã‚‹
                    </button>
                `;
                
                const navigationButtons = document.querySelector('.d-flex.justify-content-between.mt-4');
                if (navigationButtons) {
                    navigationButtons.parentNode.insertBefore(buttonContainer, navigationButtons);
                }
            }
        }
        
        function markChapterComplete(chapterNumber) {
            const progressKey = 'vba-learning-progress';
            const progress = JSON.parse(localStorage.getItem(progressKey) || '{}');
            progress[chapterNumber] = true;
            localStorage.setItem(progressKey, JSON.stringify(progress));
            
            // å®Œäº†ãƒœã‚¿ãƒ³ã‚’æ›´æ–°
            const button = document.querySelector('.completion-btn');
            if (button) {
                button.innerHTML = '<i class="fas fa-check-circle"></i> å®Œäº†æ¸ˆã¿';
                button.disabled = true;
                button.classList.remove('btn-success');
                button.classList.add('btn-secondary');
            }
            
            updateProgressDisplay(progress);
            
            // å®Œäº†ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’è¡¨ç¤º
            showCompletionMessage(chapterNumber);
        }
        
        function updateProgressDisplay(progress) {
            const sidebar = document.querySelector('.sidebar ul');
            if (!sidebar) return;
            
            const totalChapters = 10;
            const completedChapters = Object.keys(progress).filter(key => progress[key]).length;
            
            // é€²æ—è¡¨ç¤ºã‚’è¿½åŠ ã¾ãŸã¯æ›´æ–°
            let progressDisplay = document.querySelector('.progress-display');
            if (!progressDisplay) {
                progressDisplay = document.createElement('div');
                progressDisplay.className = 'progress-display mt-3 mb-3';
                sidebar.parentNode.insertBefore(progressDisplay, sidebar);
            }
            
            progressDisplay.innerHTML = `
                <h6 class="text-muted">å­¦ç¿’é€²æ—</h6>
                <div class="progress mb-2">
                    <div class="progress-bar" role="progressbar" style="width: ${(completedChapters / totalChapters) * 100}%">
                        ${completedChapters}/${totalChapters}
                    </div>
                </div>
                <small class="text-muted">${Math.round((completedChapters / totalChapters) * 100)}% å®Œäº†</small>
            `;
            
            // å„ç« ã«ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’è¿½åŠ 
            const navLinks = sidebar.querySelectorAll('.nav-link');
            navLinks.forEach((link, index) => {
                const chapterNumber = index + 1;
                const isCompleted = progress[chapterNumber];
                
                // æ—¢å­˜ã®ãƒã‚§ãƒƒã‚¯ãƒãƒ¼ã‚¯ã‚’å‰Šé™¤
                const existingCheck = link.querySelector('.completion-check');
                if (existingCheck) {
                    existingCheck.remove();
                }
                
                if (isCompleted) {
                    const checkMark = document.createElement('span');
                    checkMark.className = 'completion-check text-success ms-2';
                    checkMark.innerHTML = '<i class="fas fa-check-circle"></i>';
                    link.appendChild(checkMark);
                }
            });
        }
        
        function showCompletionMessage(chapterNumber) {
            const alert = document.createElement('div');
            alert.className = 'alert alert-success alert-dismissible fade show';
            alert.innerHTML = `
                <strong>ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</strong> ç¬¬${chapterNumber}ç« ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚
                <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
            `;
            
            const mainContent = document.querySelector('main');
            mainContent.insertBefore(alert, mainContent.firstChild);
            
            // 5ç§’å¾Œã«è‡ªå‹•ã§é–‰ã˜ã‚‹
            setTimeout(() => {
                if (alert.parentNode) {
                    alert.remove();
                }
            }, 5000);
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«åˆæœŸåŒ–
        document.addEventListener('DOMContentLoaded', function() {
            initProgressTracking();
        });
    </script>
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <!-- Highlight.js åˆæœŸåŒ– -->
    <script>hljs.highlightAll();</script>
</body>
</html>