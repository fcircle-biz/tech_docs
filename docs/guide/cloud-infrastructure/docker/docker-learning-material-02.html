<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker学習教材 第2章 - Docker環境構築と基本操作</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
            line-height: 1.8;
        }

        /* ナビゲーション - Docker Blue */
        .navbar {
            background-color: #2496ED;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 1rem;
        }

        /* タイトル */
        .chapter-title {
            color: #2496ED;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #2496ED;
            padding-bottom: 0.5rem;
            font-weight: bold;
        }

        .section-title {
            color: #1D63ED;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e7f3ff;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #2496ED;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #fff9e6;
            border-radius: 8px;
            padding: 1.2rem;
            margin: 1.5rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #2496ED !important;
            color: white !important;
            border-radius: 5px;
        }

        .nav-link {
            color: #333;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background-color: #e7f3ff;
            border-radius: 5px;
        }

        /* 表スタイル */
        .table-custom {
            background-color: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .table-custom th {
            background-color: #2496ED;
            color: white;
            font-weight: 600;
        }

        /* Mermaid図のスタイル */
        .mermaid {
            text-align: center;
            margin: 2rem 0;
        }

        /* ステップボックス */
        .step-box {
            background-color: #f0f8ff;
            border-left: 4px solid #2496ED;
            padding: 1rem;
            margin: 1rem 0;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fab fa-docker"></i>
                <strong>Docker学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-01.html">
                                第1章: Dockerとは何か
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="docker-learning-material-02.html">
                                第2章: 環境構築と基本操作
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-03.html">
                                第3章: イメージの理解と管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-04.html">
                                第4章: Dockerfileによるイメージ作成
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-05.html">
                                第5章: Docker Compose
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-06.html">
                                第6章: ボリュームとデータ永続化
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-07.html">
                                第7章: ネットワークとコンテナ間通信
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-08.html">
                                第8章: マルチコンテナアプリケーション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-09.html">
                                第9章: ベストプラクティスとセキュリティ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="docker-learning-material-10.html">
                                第10章: 本番環境へのデプロイ
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第2章: Docker環境構築と基本操作</h1>
                </div>

                <div id="chapter2">
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5><i class="fas fa-lightbulb"></i> この章で学ぶこと</h5>
                        <ul>
                            <li>各OS（Windows、macOS、Linux）でのDocker環境のインストール手順を理解する</li>
                            <li>Docker のインストール確認方法とトラブルシューティングの基本を学ぶ</li>
                            <li>初めてのコンテナ実行を通じて、Dockerの動作を体感する</li>
                            <li>基本的なDockerコマンド（run、ps、stop、rm）の使い方を習得する</li>
                            <li>コンテナのライフサイクル（作成・起動・停止・削除）を理解する</li>
                            <li>インタラクティブモードとデタッチドモードの違いを学ぶ</li>
                        </ul>
                    </div>

                    <!-- 2.1 Docker環境の準備 -->
                    <h3 class="section-title">2.1 Docker環境の準備 - システム要件の確認</h3>

                    <p>
                        Dockerをインストールする前に、お使いのコンピューターがDockerの<strong>システム要件</strong>を満たしているか確認しましょう。Dockerは仮想化技術を使用するため、ハードウェアとOSの両方で特定の機能が必要です。
                    </p>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.1.1 ハードウェア要件</h4>
                    <ul>
                        <li><strong>CPU</strong>: 2コア以上（推奨4コア以上）</li>
                        <li><strong>メモリ</strong>: 最低4GB（推奨8GB以上） - 複数のコンテナを実行する場合はより多くが必要</li>
                        <li><strong>ディスク容量</strong>: 最低20GB以上の空き容量</li>
                        <li><strong>仮想化サポート</strong>: CPUが仮想化技術（Intel VT-x または AMD-V）をサポートしていること</li>
                    </ul>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.1.2 OS別要件</h4>
                    <table class="table table-custom table-hover">
                        <thead>
                            <tr>
                                <th>OS</th>
                                <th>要件</th>
                                <th>仮想化技術</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Windows</strong></td>
                                <td>Windows 10/11 Pro、Enterprise、Education（64bit）</td>
                                <td>Hyper-V または WSL2（Windows Subsystem for Linux 2）</td>
                            </tr>
                            <tr>
                                <td><strong>macOS</strong></td>
                                <td>macOS 10.15 Catalina以降</td>
                                <td>Hypervisor.framework（macOS標準）</td>
                            </tr>
                            <tr>
                                <td><strong>Linux</strong></td>
                                <td>Ubuntu 20.04以降、CentOS 7以降、Debian 10以降等</td>
                                <td>カーネル3.10以降（ほとんどの最新ディストリビューションで対応）</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning">
                        <strong><i class="fas fa-exclamation-triangle"></i> 注意: Windows Home エディションについて</strong><br>
                        Windows 10/11 Homeエディションでも、WSL2を有効にすることでDocker Desktopを使用できます。ただし、Hyper-Vは利用できません。
                    </div>

                    <!-- 2.2 インストール手順 -->
                    <h3 class="section-title">2.2 Docker環境のインストール</h3>

                    <p>
                        OS によってインストール方法が異なります。それぞれの環境に適した手順を確認しましょう。
                    </p>

                    <!-- インストールフロー図 -->
                    <div class="mermaid">
                        flowchart TD
                            Start([OSの種類を確認]) --> Check{どのOS?}
                            Check -->|Windows| Win["Windows:<br/>Docker Desktop for Windows"]
                            Check -->|macOS| Mac["macOS:<br/>Docker Desktop for Mac"]
                            Check -->|Linux| Linux["Linux:<br/>Docker Engine"]

                            Win --> WinStep1[1. WSL2 または Hyper-V 有効化]
                            WinStep1 --> WinStep2[2. Docker Desktop インストーラーダウンロード]
                            WinStep2 --> WinStep3[3. インストーラー実行]
                            WinStep3 --> Verify

                            Mac --> MacStep1[1. Docker Desktop for Mac ダウンロード]
                            MacStep1 --> MacStep2[2. DMGファイルマウント]
                            MacStep2 --> MacStep3[3. Applicationsフォルダにドラッグ]
                            MacStep3 --> Verify

                            Linux --> LinuxStep1[1. 古いDockerパッケージ削除]
                            LinuxStep1 --> LinuxStep2[2. Dockerリポジトリ追加]
                            LinuxStep2 --> LinuxStep3[3. Docker Engine インストール]
                            LinuxStep3 --> Verify

                            Verify[インストール確認:<br/>docker --version]
                    </div>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.2.1 Windows でのインストール</h4>

                    <div class="step-box">
                        <strong>ステップ1: WSL2の有効化（推奨）</strong>
                        <p>PowerShellを管理者として開き、以下のコマンドを実行します：</p>
                        <pre class="code-block"><code class="language-bash"># WSL2を有効化
wsl --install

# 再起動後、WSLのバージョンを確認
wsl --list --verbose
</code></pre>
                    </div>

                    <div class="step-box">
                        <strong>ステップ2: Docker Desktop for Windowsのダウンロード</strong>
                        <p>Docker公式サイト（<a href="https://www.docker.com/products/docker-desktop" target="_blank">https://www.docker.com/products/docker-desktop</a>）から、Windows版をダウンロードします。</p>
                    </div>

                    <div class="step-box">
                        <strong>ステップ3: インストールと設定</strong>
                        <ol>
                            <li>ダウンロードした <code>Docker Desktop Installer.exe</code> を実行</li>
                            <li>インストールウィザードに従って進む（WSL2使用を推奨）</li>
                            <li>インストール完了後、コンピューターを再起動</li>
                            <li>Docker Desktopを起動し、初期設定を完了</li>
                        </ol>
                    </div>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.2.2 macOS でのインストール</h4>

                    <div class="step-box">
                        <strong>ステップ1: Docker Desktop for Macのダウンロード</strong>
                        <p>Docker公式サイトから、使用しているMacのチップに応じたバージョンをダウンロードします：</p>
                        <ul>
                            <li><strong>Apple Silicon（M1/M2/M3チップ）</strong>: Docker Desktop for Mac (Apple Chip)</li>
                            <li><strong>Intel チップ</strong>: Docker Desktop for Mac (Intel Chip)</li>
                        </ul>
                    </div>

                    <div class="step-box">
                        <strong>ステップ2: インストール</strong>
                        <ol>
                            <li>ダウンロードした <code>Docker.dmg</code> ファイルをダブルクリック</li>
                            <li>Docker アイコンを Applications フォルダにドラッグ&ドロップ</li>
                            <li>Applicationsフォルダから Docker を起動</li>
                            <li>初回起動時は、セキュリティ確認とパスワード入力が必要</li>
                        </ol>
                    </div>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.2.3 Linux（Ubuntu）でのインストール</h4>

                    <p>
                        Linuxでは、Docker DesktopではなくDocker Engineを直接インストールします。ここではUbuntuを例に説明します。
                    </p>

                    <div class="step-box">
                        <strong>ステップ1: 古いDockerの削除と準備</strong>
                        <pre class="code-block"><code class="language-bash"># 古いバージョンのDockerを削除（存在する場合）
sudo apt-get remove docker docker-engine docker.io containerd runc

# 必要なパッケージをインストール
sudo apt-get update
sudo apt-get install ca-certificates curl gnupg lsb-release
</code></pre>
                    </div>

                    <div class="step-box">
                        <strong>ステップ2: DockerのGPGキーとリポジトリを追加</strong>
                        <pre class="code-block"><code class="language-bash"># DockerのGPGキーを追加
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

# Dockerリポジトリを追加
echo "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null
</code></pre>
                    </div>

                    <div class="step-box">
                        <strong>ステップ3: Docker Engineのインストール</strong>
                        <pre class="code-block"><code class="language-bash"># パッケージリストを更新
sudo apt-get update

# Docker Engine、CLI、containerdをインストール
sudo apt-get install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# 現在のユーザーをdockerグループに追加（sudo なしでdockerコマンドを実行可能に）
sudo usermod -aG docker $USER

# グループ変更を反映（ログアウト・ログインも可）
newgrp docker
</code></pre>
                    </div>

                    <!-- 2.3 インストール確認 -->
                    <h3 class="section-title">2.3 インストールの確認</h3>

                    <p>
                        Dockerが正しくインストールされているか確認しましょう。以下のコマンドを実行してバージョン情報が表示されれば成功です。
                    </p>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.3.1 Dockerバージョンの確認</h4>
                    <pre class="code-block"><code class="language-bash"># Dockerのバージョンを表示
docker --version

# 実行例の出力:
# Docker version 24.0.6, build ed223bc
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.3.2 Docker システム情報の確認</h4>
                    <pre class="code-block"><code class="language-bash"># Docker Engineの詳細情報を表示
docker info

# このコマンドで以下の情報が確認できます:
# - コンテナ数、イメージ数
# - ストレージドライバー
# - Docker Engineのバージョン
# - OSとカーネルのバージョン
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.3.3 Docker Composeのバージョン確認</h4>
                    <pre class="code-block"><code class="language-bash"># Docker Composeのバージョンを表示
docker compose version

# 実行例の出力:
# Docker Compose version v2.21.0
</code></pre>

                    <!-- 2.4 初めてのコンテナ実行 -->
                    <h3 class="section-title">2.4 初めてのコンテナ実行 - Hello World</h3>

                    <p>
                        Dockerの動作を確認するために、公式の<strong>hello-world</strong>イメージを実行してみましょう。このコマンド一つで、Dockerが自動的にイメージをダウンロードし、コンテナを作成・実行・停止します。
                    </p>

                    <pre class="code-block"><code class="language-bash"># hello-world コンテナを実行
docker run hello-world
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.4.1 何が起こっているのか？</h4>

                    <!-- Hello World実行フロー -->
                    <div class="mermaid">
                        sequenceDiagram
                            autonumber
                            participant User as あなた
                            participant CLI as Docker CLI
                            participant Daemon as Docker Daemon
                            participant Local as ローカルストレージ
                            participant Hub as Docker Hub

                            User->>CLI: docker run hello-world
                            CLI->>Daemon: hello-world イメージで<br/>コンテナを実行
                            Daemon->>Local: hello-world イメージを検索
                            Local-->>Daemon: イメージが見つからない
                            Daemon->>Hub: hello-world イメージを検索
                            Hub-->>Daemon: イメージをダウンロード
                            Daemon->>Local: イメージを保存
                            Daemon->>Daemon: コンテナを作成・起動
                            Daemon-->>CLI: メッセージ出力
                            CLI-->>User: "Hello from Docker!"<br/>成功メッセージ表示
                    </div>

                    <p>このコマンドを実行すると、以下の処理が自動的に行われます：</p>
                    <ol>
                        <li><strong>ローカルイメージの検索</strong>: Docker Daemonが、ローカルに <code>hello-world</code> イメージが存在するか確認</li>
                        <li><strong>イメージのダウンロード</strong>: ローカルにイメージがない場合、Docker Hubから自動的にダウンロード</li>
                        <li><strong>コンテナの作成</strong>: ダウンロードしたイメージからコンテナを作成</li>
                        <li><strong>コンテナの実行</strong>: コンテナ内のプログラムが実行され、メッセージが表示される</li>
                        <li><strong>コンテナの終了</strong>: プログラムが終了すると、コンテナも自動的に停止</li>
                    </ol>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.4.2 表示されるメッセージの意味</h4>
                    <pre class="code-block"><code class="language-bash">Hello from Docker!
This message shows that your installation appears to be working correctly.

To generate this message, Docker took the following steps:
 1. The Docker client contacted the Docker daemon.
 2. The Docker daemon pulled the "hello-world" image from the Docker Hub.
 3. The Docker daemon created a new container from that image which runs the
    executable that produces the output you are currently reading.
 4. The Docker daemon streamed that output to the Docker client, which sent it
    to your terminal.
</code></pre>

                    <p>
                        このメッセージは、Dockerが正しくインストールされ、Docker CLI → Docker Daemon → Docker Hubという一連の流れが正常に動作していることを示しています。
                    </p>

                    <!-- 2.5 基本的なDockerコマンド -->
                    <h3 class="section-title">2.5 基本的なDockerコマンド</h3>

                    <p>
                        ここからは、コンテナを管理するための基本的なコマンドを学びます。Dockerの日常的な操作はこれらのコマンドで行います。
                    </p>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.5.1 docker run - コンテナの作成と実行</h4>
                    <p>
                        <code>docker run</code>は、イメージからコンテナを<strong>作成して実行</strong>する最も基本的なコマンドです。
                    </p>

                    <pre class="code-block"><code class="language-bash"># 基本的な構文
docker run [オプション] イメージ名 [コマンド]

# 例: Nginx Webサーバーを起動
docker run nginx

# バックグラウンドで実行（デタッチドモード）
docker run -d nginx

# コンテナに名前を付けて実行
docker run --name my-nginx nginx

# ポートをマッピングして実行
docker run -d -p 8080:80 nginx
# ホストの8080番ポートをコンテナの80番ポートに転送
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.5.2 docker ps - 実行中のコンテナ一覧</h4>
                    <p>
                        現在実行中のコンテナを確認するコマンドです。
                    </p>

                    <pre class="code-block"><code class="language-bash"># 実行中のコンテナを表示
docker ps

# すべてのコンテナを表示（停止中も含む）
docker ps -a

# コンテナIDのみ表示
docker ps -q
</code></pre>

                    <p>出力例:</p>
                    <pre class="code-block"><code class="language-bash">CONTAINER ID   IMAGE     COMMAND                  CREATED         STATUS         PORTS     NAMES
a1b2c3d4e5f6   nginx     "/docker-entrypoint.…"   2 minutes ago   Up 2 minutes   80/tcp    my-nginx
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.5.3 docker stop - コンテナの停止</h4>
                    <pre class="code-block"><code class="language-bash"># コンテナIDまたは名前を指定して停止
docker stop my-nginx

# 複数のコンテナを同時に停止
docker stop container1 container2

# すべての実行中コンテナを停止
docker stop $(docker ps -q)
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.5.4 docker start - 停止中のコンテナを再起動</h4>
                    <pre class="code-block"><code class="language-bash"># 停止中のコンテナを再開
docker start my-nginx

# 複数のコンテナを同時に起動
docker start container1 container2
</code></pre>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.5.5 docker rm - コンテナの削除</h4>
                    <pre class="code-block"><code class="language-bash"># 停止中のコンテナを削除
docker rm my-nginx

# 強制的に削除（実行中でも削除）
docker rm -f my-nginx

# 停止中のすべてのコンテナを削除
docker container prune
</code></pre>

                    <!-- 2.6 コンテナのライフサイクル -->
                    <h3 class="section-title">2.6 コンテナのライフサイクル</h3>

                    <p>
                        コンテナは、<strong>作成 → 実行 → 停止 → 削除</strong>というライフサイクルを持ちます。このサイクルを理解することで、Dockerの操作がより明確になります。
                    </p>

                    <!-- ライフサイクル図 -->
                    <div class="mermaid">
                        stateDiagram-v2
                            [*] --> Created: docker run / docker create
                            Created --> Running: docker start
                            Running --> Paused: docker pause
                            Paused --> Running: docker unpause
                            Running --> Stopped: docker stop
                            Stopped --> Running: docker start
                            Stopped --> Deleted: docker rm
                            Running --> Deleted: docker rm -f
                            Deleted --> [*]

                            note right of Created
                                コンテナは作成されたが
                                まだ実行されていない状態
                            end note

                            note right of Running
                                コンテナが実行中
                                プロセスが動作している
                            end note

                            note right of Stopped
                                コンテナは停止しているが
                                ファイルシステムは保持
                            end note
                    </div>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.6.1 各状態の説明</h4>
                    <ul>
                        <li><strong>Created（作成済み）</strong>: コンテナは作成されましたが、まだ起動していない状態</li>
                        <li><strong>Running（実行中）</strong>: コンテナ内のプロセスが実行されている状態</li>
                        <li><strong>Paused（一時停止）</strong>: コンテナのプロセスが一時停止している状態（メモリは保持）</li>
                        <li><strong>Stopped（停止）</strong>: コンテナが停止しているが、ファイルシステムやメタデータは保持されている</li>
                        <li><strong>Deleted（削除）</strong>: コンテナが完全に削除され、すべてのデータが破棄された状態</li>
                    </ul>

                    <!-- 2.7 インタラクティブモードとデタッチドモード -->
                    <h3 class="section-title">2.7 インタラクティブモードとデタッチドモード</h3>

                    <p>
                        Dockerコンテナは、2つの主要な実行モードがあります。用途に応じて使い分けることが重要です。
                    </p>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.7.1 インタラクティブモード（フォアグラウンド実行）</h4>
                    <p>
                        ターミナルとコンテナが<strong>対話的に接続</strong>される実行モードです。コンテナの出力がターミナルに表示され、入力もコンテナに送られます。
                    </p>

                    <pre class="code-block"><code class="language-bash"># -i: 標準入力を開いたまま保持（interactive）
# -t: 疑似ターミナルを割り当て（tty）
docker run -it ubuntu bash

# 実行すると、Ubuntuコンテナ内のbashシェルが起動し、
# コマンドを入力できるようになります
</code></pre>

                    <p><strong>用途:</strong></p>
                    <ul>
                        <li>コンテナ内で対話的にコマンドを実行したい場合</li>
                        <li>デバッグやトラブルシューティング</li>
                        <li>学習目的でコンテナ内部を探索したい場合</li>
                    </ul>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.7.2 デタッチドモード（バックグラウンド実行）</h4>
                    <p>
                        コンテナを<strong>バックグラウンドで実行</strong>するモードです。ターミナルから切り離され、独立して動作します。
                    </p>

                    <pre class="code-block"><code class="language-bash"># -d: デタッチドモード（detached）
docker run -d nginx

# 実行すると、コンテナIDが表示され、
# ターミナルは即座に制御を返します
</code></pre>

                    <p><strong>用途:</strong></p>
                    <ul>
                        <li>Webサーバーやデータベースなど、継続的に動作するサービス</li>
                        <li>複数のコンテナを同時に実行する場合</li>
                        <li>本番環境やCI/CD環境での実行</li>
                    </ul>

                    <h4 style="color: #1D63ED; margin-top: 1.5rem;">2.7.3 実行中コンテナへの接続</h4>
                    <p>
                        デタッチドモードで実行しているコンテナに、後からアクセスすることもできます。
                    </p>

                    <pre class="code-block"><code class="language-bash"># 実行中のコンテナでコマンドを実行
docker exec -it my-nginx bash

# ログを表示
docker logs my-nginx

# ログをリアルタイムで表示（-fはfollow）
docker logs -f my-nginx
</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5><i class="fas fa-pencil-alt"></i> 実習 2-1: 基本コマンドの練習</h5>
                        <p>
                            この実習では、実際にコマンドを実行して、Dockerの基本操作に慣れましょう。
                        </p>

                        <h6>手順</h6>
                        <ol>
                            <li>
                                <strong>Nginxコンテナの起動</strong>
                                <pre class="code-block"><code class="language-bash">docker run -d -p 8080:80 --name web-server nginx</code></pre>
                                <p>ブラウザで <code>http://localhost:8080</code> にアクセスし、Nginxのウェルカムページが表示されることを確認</p>
                            </li>
                            <li>
                                <strong>実行中のコンテナ確認</strong>
                                <pre class="code-block"><code class="language-bash">docker ps</code></pre>
                                <p>web-serverという名前のコンテナが実行中であることを確認</p>
                            </li>
                            <li>
                                <strong>コンテナのログ確認</strong>
                                <pre class="code-block"><code class="language-bash">docker logs web-server</code></pre>
                                <p>Nginxのアクセスログが表示されます</p>
                            </li>
                            <li>
                                <strong>コンテナの停止と再起動</strong>
                                <pre class="code-block"><code class="language-bash">docker stop web-server
docker ps -a
docker start web-server
docker ps</code></pre>
                            </li>
                            <li>
                                <strong>コンテナの削除</strong>
                                <pre class="code-block"><code class="language-bash">docker stop web-server
docker rm web-server
docker ps -a</code></pre>
                            </li>
                        </ol>

                        <h6>理解すべきポイント</h6>
                        <ul>
                            <li><code>-p 8080:80</code>でホストの8080番ポートとコンテナの80番ポートを接続</li>
                            <li><code>--name</code>でコンテナに覚えやすい名前を付けられる</li>
                            <li>停止したコンテナは<code>docker ps -a</code>で確認できる</li>
                            <li>停止中のコンテナは削除するまでディスク容量を占有する</li>
                        </ul>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5><i class="fas fa-check-circle"></i> 理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>Dockerをインストールするために必要なハードウェア要件として誤っているものはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>A) CPUが仮想化技術をサポートしていること</li>
                                    <li>B) 最低4GBのメモリ</li>
                                    <li>C) 最低100GBのディスク容量</li>
                                    <li>D) 2コア以上のCPU</li>
                                </ul>
                            </li>
                            <li>
                                <strong>docker runコマンドで何が行われますか？（複数選択）</strong>
                                <ul style="list-style-type: none;">
                                    <li>A) イメージのダウンロード（ローカルにない場合）</li>
                                    <li>B) コンテナの作成</li>
                                    <li>C) コンテナの起動</li>
                                    <li>D) イメージの削除</li>
                                </ul>
                            </li>
                            <li>
                                <strong>実行中のコンテナを停止するコマンドはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>A) docker pause</li>
                                    <li>B) docker stop</li>
                                    <li>C) docker kill</li>
                                    <li>D) docker rm</li>
                                </ul>
                            </li>
                            <li>
                                <strong>デタッチドモードでコンテナを実行するオプションはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>A) -i</li>
                                    <li>B) -t</li>
                                    <li>C) -d</li>
                                    <li>D) -p</li>
                                </ul>
                            </li>
                            <li>
                                <strong>停止中も含めてすべてのコンテナを表示するコマンドはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>A) docker ps</li>
                                    <li>B) docker ps -a</li>
                                    <li>C) docker ps -all</li>
                                    <li>D) docker list</li>
                                </ul>
                            </li>
                        </ol>
                        <details style="margin-top: 1rem;">
                            <summary style="cursor: pointer; color: #2496ED; font-weight: 600;">解答を見る</summary>
                            <div style="margin-top: 1rem; padding: 1rem; background-color: white; border-radius: 5px;">
                                <p><strong>1. C)</strong> 最低100GBは不要です。20GB以上の空き容量があれば十分です。</p>
                                <p><strong>2. A, B, C)</strong> docker runはイメージのダウンロード、コンテナの作成、起動をすべて行います。</p>
                                <p><strong>3. B)</strong> docker stopが正解です。docker pauseは一時停止、docker killは強制終了、docker rmは削除です。</p>
                                <p><strong>4. C)</strong> -dオプションでデタッチドモード（バックグラウンド実行）になります。</p>
                                <p><strong>5. B)</strong> docker ps -a で停止中も含めてすべてのコンテナを表示します。</p>
                            </div>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">2.8 本章のまとめ</h3>
                    <div class="highlight">
                        <h5>重要ポイント</h5>
                        <ul>
                            <li>Dockerのインストールには、OS に応じた<strong>仮想化技術</strong>（Hyper-V、WSL2、Hypervisor.framework）が必要です。</li>
                            <li><code>docker --version</code>と<code>docker info</code>でインストールを確認できます。</li>
                            <li><code>docker run</code>コマンドで、イメージの取得からコンテナの起動まで一度に実行できます。</li>
                            <li>コンテナは<strong>作成 → 実行 → 停止 → 削除</strong>というライフサイクルを持ちます。</li>
                            <li><strong>インタラクティブモード</strong>（-it）は対話的な操作、<strong>デタッチドモード</strong>（-d）はバックグラウンド実行に使用します。</li>
                            <li><code>docker ps</code>で実行中のコンテナ、<code>docker ps -a</code>ですべてのコンテナを確認できます。</li>
                            <li>基本コマンド: <code>run</code>, <code>ps</code>, <code>stop</code>, <code>start</code>, <code>rm</code>, <code>logs</code>, <code>exec</code></li>
                        </ul>
                    </div>

                    <!-- 次章へのリンク -->
                    <div class="d-flex justify-content-between mt-5 mb-5">
                        <a href="docker-learning-material-01.html" class="btn btn-secondary">← 前の章: Dockerとは何か</a>
                        <a href="docker-learning-material-03.html" class="btn btn-primary">次の章: イメージの理解と管理 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
