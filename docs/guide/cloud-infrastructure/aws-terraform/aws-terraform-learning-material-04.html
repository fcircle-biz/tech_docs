<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Terraform学習教材 第4章 - EC2インスタンスとコンピューティングリソース</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/hcl.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムCSS -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
            background-color: #f8f9fa;
        }

        .navbar {
            background-color: #FF9900;
            box-shadow: 0 2px 4px rgba(0,0,0,.1);
        }

        .navbar-brand {
            display: flex;
            align-items: center;
            font-weight: 700;
        }

        .navbar-brand i {
            margin-right: 10px;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: white;
            border-right: 1px solid #dee2e6;
        }

        .chapter-title {
            color: #FF9900;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #FF9900;
            padding-bottom: 0.5rem;
            font-weight: 600;
        }

        .section-title {
            color: #FF6600;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
            font-weight: 500;
        }

        .quiz-container {
            background-color: #FFF3E0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #FF9900;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info-box {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #2196f3;
        }

        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        .nav-link.active {
            background-color: #FF9900 !important;
            color: white !important;
            font-weight: 500;
        }

        .nav-link {
            color: #333;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            margin: 2px 0;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background-color: #FFF3E0;
            color: #FF6600;
        }

        .concept-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .concept-card h4 {
            color: #FF6600;
            margin-bottom: 15px;
        }

        .term-definition {
            background-color: #f0f8ff;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            border-left: 4px solid #4169e1;
        }

        .term-definition dt {
            font-weight: bold;
            color: #4169e1;
            margin-bottom: 8px;
        }

        .term-definition dd {
            margin-left: 20px;
            color: #333;
        }

        .footer {
            background-color: #333;
            color: white;
            padding: 2rem 0;
            margin-top: 4rem;
        }

        .mermaid {
            margin: 20px 0;
            text-align: center;
        }

        pre.code-block code {
            display: block;
            padding: 0 !important;
            background: transparent !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fab fa-aws"></i>
                AWS Terraform 学習教材
            </a>
        </div>
    </nav>

    <!-- メインコンテンツ -->
    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-01.html">
                                第1章: Terraform入門とAWS環境設定
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-02.html">
                                第2章: HCL構文とTerraformの基本操作
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-03.html">
                                第3章: VPCとネットワークインフラの構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="aws-terraform-learning-material-04.html">
                                第4章: EC2インスタンスとコンピューティングリソース
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-05.html">
                                第5章: ストレージとデータベースサービス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-06.html">
                                第6章: IAMとセキュリティ管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-07.html">
                                第7章: Terraformステート管理とバックエンド
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-08.html">
                                第8章: Terraformモジュールとコードの再利用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-09.html">
                                第9章: CI/CDパイプラインとの統合
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aws-terraform-learning-material-10.html">
                                第10章: 実践プロジェクトとベストプラクティス
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第4章: EC2インスタンスとコンピューティングリソース</h1>
                </div>

                <div id="chapter4">
                    <h2 class="chapter-title">AWSコンピューティングサービスの活用</h2>

                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5><i class="fas fa-graduation-cap"></i> この章で学ぶこと</h5>
                        <ul>
                            <li>TerraformでEC2インスタンスを作成・管理する方法を習得する</li>
                            <li>Auto Scalingグループによる自動スケーリングを実装する</li>
                            <li>Application Load Balancer（ALB）の設定と運用を理解する</li>
                            <li>Launch Templateによるインスタンス設定のテンプレート化</li>
                            <li>ユーザーデータスクリプトによる初期設定の自動化</li>
                        </ul>
                    </div>

                    <!-- Section 4.1 -->
                    <h3 class="section-title">4.1 EC2インスタンスの基本構成</h3>

                    <div class="concept-card">
                        <h4>EC2インスタンスの理解</h4>
                        <p>
                            EC2（Elastic Compute Cloud）は、AWSが提供する仮想サーバーサービスです。
                            必要な時に必要な分だけコンピューティングリソースを利用できる、クラウドの代表的なサービスです。
                        </p>

                        <div class="mermaid">
                            flowchart LR
                                A[EC2インスタンス] --> B[CPU・メモリ]
                                A --> C[ストレージ<br/>（EBS/Instance Store）]
                                A --> D[ネットワーク<br/>（ENI）]
                                A --> E[セキュリティ<br/>（Security Group）]
                                A --> F[メタデータ<br/>（Tags/User Data）]
                                B --> G[インスタンスタイプ<br/>（t3.micro, m5.large等）]
                                C --> H[ルートボリューム]
                                C --> I[追加ボリューム]
                                D --> J[プライベートIP]
                                D --> K[パブリックIP/EIP]
                        </div>
                    </div>

                    <div class="term-definition">
                        <dt>インスタンスタイプの選択基準</dt>
                        <dd>
                            EC2インスタンスタイプは用途に応じて選択します：
                            <ul>
                                <li><strong>汎用（T/M系）</strong>：バランスの取れた構成、開発環境やWebサーバー向け</li>
                                <li><strong>コンピュート最適化（C系）</strong>：CPU性能重視、計算処理やバッチ処理向け</li>
                                <li><strong>メモリ最適化（R/X系）</strong>：大容量メモリ、データベースやインメモリ処理向け</li>
                                <li><strong>ストレージ最適化（I/D系）</strong>：高速I/O、ビッグデータ処理向け</li>
                            </ul>
                        </dd>
                    </div>

                    <div class="concept-card">
                        <h4>基本的なEC2インスタンスの作成</h4>

                        <pre class="code-block"><code class="language-hcl"># ec2_instance.tf - 単一のEC2インスタンス

# 最新のAmazon Linux 2 AMIを取得
data "aws_ami" "amazon_linux_2" {
  most_recent = true
  owners      = ["amazon"]

  filter {
    name   = "name"
    values = ["amzn2-ami-hvm-*-x86_64-gp2"]
  }

  filter {
    name   = "state"
    values = ["available"]
  }
}

# EC2インスタンスの作成
resource "aws_instance" "web_server" {
  # AMIとインスタンスタイプ
  ami           = data.aws_ami.amazon_linux_2.id
  instance_type = var.instance_type

  # ネットワーク設定
  subnet_id                   = aws_subnet.public[0].id
  vpc_security_group_ids      = [aws_security_group.web.id]
  associate_public_ip_address = true

  # ストレージ設定
  root_block_device {
    volume_type = "gp3"      # 最新のGP3タイプを使用
    volume_size = 20          # 20GB
    encrypted   = true        # 暗号化を有効化

    tags = {
      Name = "${var.project_name}-web-root-volume"
    }
  }

  # キーペア（SSH接続用）
  key_name = aws_key_pair.main.key_name

  # ユーザーデータ（初期設定スクリプト）
  user_data = base64encode(templatefile("${path.module}/user_data.sh", {
    app_name = var.app_name
    region   = var.aws_region
  }))

  # メタデータオプション（IMDSv2を強制）
  metadata_options {
    http_endpoint               = "enabled"
    http_tokens                = "required"  # IMDSv2を必須に
    http_put_response_hop_limit = 1
  }

  # タグ
  tags = {
    Name        = "${var.project_name}-web-server"
    Environment = var.environment
    ManagedBy   = "Terraform"
  }
}</code></pre>
                    </div>

                    <!-- Section 4.2 -->
                    <h3 class="section-title">4.2 Launch Templateの活用</h3>

                    <div class="concept-card">
                        <h4>Launch Templateとは</h4>
                        <p>
                            Launch Templateは、EC2インスタンスの設定をテンプレート化したものです。
                            Auto ScalingやEC2 Fleet、スポットインスタンスなどで再利用可能な設定を定義できます。
                        </p>

                        <div class="info-box">
                            <h6><i class="fas fa-info-circle"></i> Launch Templateのメリット</h6>
                            <ul>
                                <li>設定の再利用性と一貫性の確保</li>
                                <li>バージョン管理による設定変更の追跡</li>
                                <li>複数のインスタンスタイプの指定が可能</li>
                                <li>スポットインスタンスとオンデマンドの混在が可能</li>
                            </ul>
                        </div>

                        <pre class="code-block"><code class="language-hcl"># launch_template.tf

# Launch Templateの作成
resource "aws_launch_template" "app" {
  name_prefix   = "${var.project_name}-app-"
  description   = "Launch template for application servers"

  # AMI設定
  image_id = data.aws_ami.amazon_linux_2.id

  # インスタンスタイプ（複数指定可能）
  instance_type = var.instance_type

  # インスタンス起動時の詳細設定
  instance_initiated_shutdown_behavior = "terminate"

  # キーペア
  key_name = aws_key_pair.main.key_name

  # ネットワークインターフェース設定
  network_interfaces {
    associate_public_ip_address = false
    security_groups            = [aws_security_group.app.id]
    delete_on_termination      = true
  }

  # ブロックデバイスマッピング
  block_device_mappings {
    device_name = "/dev/xvda"

    ebs {
      volume_size           = 30
      volume_type          = "gp3"
      iops                 = 3000      # GP3のIOPS設定
      throughput           = 125       # GP3のスループット設定
      encrypted            = true
      kms_key_id           = aws_kms_key.ebs.arn
      delete_on_termination = true
    }
  }

  # モニタリング設定
  monitoring {
    enabled = true  # 詳細モニタリングを有効化
  }

  # IAMインスタンスプロファイル
  iam_instance_profile {
    name = aws_iam_instance_profile.app.name
  }

  # ユーザーデータ
  user_data = base64encode(templatefile("${path.module}/templates/user_data.sh", {
    cluster_name = var.cluster_name
    region       = var.aws_region
    s3_bucket    = aws_s3_bucket.config.id
  }))

  # メタデータオプション
  metadata_options {
    http_endpoint               = "enabled"
    http_tokens                = "required"
    http_put_response_hop_limit = 2
    instance_metadata_tags      = "enabled"
  }

  # タグ仕様
  tag_specifications {
    resource_type = "instance"
    tags = {
      Name        = "${var.project_name}-app-instance"
      Environment = var.environment
      ManagedBy   = "Terraform"
    }
  }

  tag_specifications {
    resource_type = "volume"
    tags = {
      Name        = "${var.project_name}-app-volume"
      Environment = var.environment
    }
  }

  # Launch Template自体のタグ
  tags = {
    Name        = "${var.project_name}-app-template"
    Environment = var.environment
  }
}</code></pre>
                    </div>

                    <!-- Section 4.3 -->
                    <h3 class="section-title">4.3 Auto Scalingの実装</h3>

                    <div class="concept-card">
                        <h4>Auto Scalingの仕組み</h4>
                        <p>
                            Auto Scalingは、需要に応じてEC2インスタンスを自動的に増減させる仕組みです。
                            負荷が高い時はインスタンスを追加し、低い時は削減することで、コストを最適化しながら可用性を維持します。
                        </p>

                        <div class="mermaid">
                            flowchart TD
                                A[Auto Scaling Group] --> B[最小キャパシティ<br/>Min: 2]
                                A --> C[希望キャパシティ<br/>Desired: 4]
                                A --> D[最大キャパシティ<br/>Max: 10]
                                E[CloudWatch<br/>メトリクス] --> F{スケーリング<br/>ポリシー}
                                F -->|CPU > 70%| G[スケールアウト<br/>インスタンス追加]
                                F -->|CPU < 30%| H[スケールイン<br/>インスタンス削減]
                                G --> A
                                H --> A
                        </div>

                        <pre class="code-block"><code class="language-hcl"># auto_scaling.tf

# Auto Scalingグループ
resource "aws_autoscaling_group" "app" {
  name                = "${var.project_name}-app-asg"
  vpc_zone_identifier = aws_subnet.private_app[*].id

  # キャパシティ設定
  min_size         = var.asg_min_size
  max_size         = var.asg_max_size
  desired_capacity = var.asg_desired_capacity

  # Launch Template設定
  launch_template {
    id      = aws_launch_template.app.id
    version = "$Latest"
  }

  # ヘルスチェック設定
  health_check_type         = "ELB"
  health_check_grace_period = 300  # 5分間の猶予期間

  # インスタンス保護
  protect_from_scale_in = false

  # ターゲットグループへの登録
  target_group_arns = [aws_lb_target_group.app.arn]

  # 終了ポリシー
  termination_policies = ["OldestInstance"]

  # メトリクス収集
  enabled_metrics = [
    "GroupMinSize",
    "GroupMaxSize",
    "GroupDesiredCapacity",
    "GroupInServiceInstances",
    "GroupTotalInstances"
  ]

  # ウォームアップ設定
  warm_pool {
    pool_state                  = "Warmed:Stopped"
    min_size                   = 1
    max_group_prepared_capacity = 3
  }

  tag {
    key                 = "Name"
    value               = "${var.project_name}-app-asg-instance"
    propagate_at_launch = true
  }

  tag {
    key                 = "Environment"
    value               = var.environment
    propagate_at_launch = true
  }

  depends_on = [aws_lb.app]
}

# ターゲットトラッキングスケーリングポリシー
resource "aws_autoscaling_policy" "cpu_target" {
  name                   = "${var.project_name}-cpu-target-tracking"
  autoscaling_group_name = aws_autoscaling_group.app.name
  policy_type            = "TargetTrackingScaling"

  target_tracking_configuration {
    predefined_metric_specification {
      predefined_metric_type = "ASGAverageCPUUtilization"
    }
    target_value = 50.0  # CPU使用率50%を目標
  }
}

# 予測スケーリング
resource "aws_autoscaling_policy" "predictive" {
  name                   = "${var.project_name}-predictive-scaling"
  autoscaling_group_name = aws_autoscaling_group.app.name
  policy_type            = "PredictiveScaling"

  predictive_scaling_configuration {
    metric_specification {
      target_value = 50

      predefined_load_metric_specification {
        predefined_metric_type = "ASGTotalCPUUtilization"
        resource_label         = "${var.project_name}-app"
      }

      predefined_scaling_metric_specification {
        predefined_metric_type = "ASGAverageCPUUtilization"
        resource_label         = "${var.project_name}-app"
      }
    }
  }
}</code></pre>
                    </div>

                    <!-- Section 4.4 -->
                    <h3 class="section-title">4.4 Application Load Balancerの設定</h3>

                    <div class="concept-card">
                        <h4>ALBの役割と機能</h4>
                        <p>
                            Application Load Balancer（ALB）は、HTTP/HTTPSトラフィックを複数のEC2インスタンスに
                            分散させるLayer 7（アプリケーション層）のロードバランサーです。
                        </p>

                        <div class="term-definition">
                            <dt>ALBの主要機能</dt>
                            <dd>
                                <ul>
                                    <li><strong>パスベースルーティング</strong>：URLパスに基づいてトラフィックを振り分け</li>
                                    <li><strong>ホストベースルーティング</strong>：ドメイン名に基づいてトラフィックを振り分け</li>
                                    <li><strong>WebSocket対応</strong>：双方向通信のサポート</li>
                                    <li><strong>SSL/TLS終端</strong>：HTTPSの処理をALBで実行</li>
                                    <li><strong>ヘルスチェック</strong>：正常なインスタンスにのみトラフィックを送信</li>
                                </ul>
                            </dd>
                        </div>

                        <pre class="code-block"><code class="language-hcl"># alb.tf

# Application Load Balancer
resource "aws_lb" "app" {
  name               = "${var.project_name}-alb"
  internal           = false
  load_balancer_type = "application"
  security_groups    = [aws_security_group.alb.id]
  subnets           = aws_subnet.public[*].id

  # 削除保護
  enable_deletion_protection = var.environment == "production" ? true : false

  # アクセスログ
  access_logs {
    bucket  = aws_s3_bucket.alb_logs.id
    prefix  = "alb"
    enabled = true
  }

  # HTTP/2サポート
  enable_http2 = true

  # クロスゾーン負荷分散
  enable_cross_zone_load_balancing = true

  tags = {
    Name        = "${var.project_name}-alb"
    Environment = var.environment
  }
}

# ターゲットグループ
resource "aws_lb_target_group" "app" {
  name     = "${var.project_name}-app-tg"
  port     = 80
  protocol = "HTTP"
  vpc_id   = aws_vpc.main.id

  # ターゲットタイプ
  target_type = "instance"

  # ヘルスチェック設定
  health_check {
    enabled             = true
    healthy_threshold   = 2
    unhealthy_threshold = 2
    timeout            = 5
    interval           = 30
    path               = "/health"
    matcher            = "200-299"
  }

  # スティッキーセッション
  stickiness {
    type            = "app_cookie"
    cookie_duration = 86400  # 1日
    cookie_name     = "AWSALB"
  }

  # Connection Draining
  deregistration_delay = 300  # 5分

  tags = {
    Name = "${var.project_name}-app-tg"
  }
}

# HTTPリスナー（HTTPSへのリダイレクト）
resource "aws_lb_listener" "http" {
  load_balancer_arn = aws_lb.app.arn
  port              = "80"
  protocol          = "HTTP"

  default_action {
    type = "redirect"

    redirect {
      port        = "443"
      protocol    = "HTTPS"
      status_code = "HTTP_301"
    }
  }
}

# HTTPSリスナー
resource "aws_lb_listener" "https" {
  load_balancer_arn = aws_lb.app.arn
  port              = "443"
  protocol          = "HTTPS"
  ssl_policy        = "ELBSecurityPolicy-TLS-1-2-2017-01"
  certificate_arn   = aws_acm_certificate.main.arn

  default_action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.app.arn
  }
}

# パスベースルーティングルール
resource "aws_lb_listener_rule" "api" {
  listener_arn = aws_lb_listener.https.arn
  priority     = 100

  action {
    type             = "forward"
    target_group_arn = aws_lb_target_group.api.arn
  }

  condition {
    path_pattern {
      values = ["/api/*"]
    }
  }
}</code></pre>
                    </div>

                    <div class="warning">
                        <h6><i class="fas fa-exclamation-triangle"></i> セキュリティの注意点</h6>
                        <ul>
                            <li>ALBには必ず最新のSSL/TLSポリシーを適用する</li>
                            <li>HTTPトラフィックは必ずHTTPSへリダイレクトする</li>
                            <li>セキュリティグループで必要なポートのみを開放する</li>
                            <li>アクセスログを有効にして監査証跡を残す</li>
                        </ul>
                    </div>

                    <!-- 実習課題 -->
                    <div class="exercise-container">
                        <h5><i class="fas fa-laptop-code"></i> 実習課題：高可用性Webアプリケーションの構築</h5>

                        <h6>課題内容</h6>
                        <p>以下の要件を満たすWebアプリケーション環境を構築してください：</p>
                        <ol>
                            <li>マルチAZに配置されたAuto Scalingグループ</li>
                            <li>ALBによる負荷分散</li>
                            <li>CPU使用率に基づく自動スケーリング</li>
                            <li>HTTPSの有効化とHTTPからのリダイレクト</li>
                            <li>ヘルスチェックによる異常インスタンスの自動置換</li>
                        </ol>

                        <h6>実装のポイント</h6>
                        <ul>
                            <li>Launch Templateで一貫性のあるインスタンス設定</li>
                            <li>Auto Scalingの最小・希望・最大キャパシティの適切な設定</li>
                            <li>ALBとAuto Scalingグループの統合</li>
                            <li>CloudWatchメトリクスによる監視</li>
                        </ul>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5><i class="fas fa-question-circle"></i> 理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>Launch TemplateとLaunch Configurationの違いは？</strong>
                                <ul>
                                    <li>Launch Template：バージョン管理可能、複数インスタンスタイプ対応、最新機能サポート</li>
                                    <li>Launch Configuration：レガシー、変更不可、単一インスタンスタイプ</li>
                                    <li>新規作成時はLaunch Templateを推奨</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Auto Scalingのヘルスチェックタイプの違いは？</strong>
                                <ul>
                                    <li>EC2：インスタンスの状態のみチェック</li>
                                    <li>ELB：ロードバランサーのヘルスチェックも考慮</li>
                                    <li>Webアプリケーションの場合はELBタイプを推奨</li>
                                </ul>
                            </li>
                            <li>
                                <strong>ALBとNLBの使い分けは？</strong>
                                <ul>
                                    <li>ALB：HTTP/HTTPS、パスベースルーティング、Webアプリケーション向け</li>
                                    <li>NLB：TCP/UDP、超低レイテンシ、静的IP、ゲームサーバーやVoIP向け</li>
                                </ul>
                            </li>
                            <li>
                                <strong>スポットインスタンスを使用する際の注意点は？</strong>
                                <ul>
                                    <li>最大90%のコスト削減が可能</li>
                                    <li>2分前の通知で中断される可能性</li>
                                    <li>ステートレスなワークロードに適している</li>
                                    <li>Auto Scalingで複数の購入オプションを混在可能</li>
                                </ul>
                            </li>
                        </ol>
                    </div>

                    <!-- 章のまとめ -->
                    <div class="concept-card">
                        <h4><i class="fas fa-bookmark"></i> この章のまとめ</h4>
                        <p>
                            第4章では、TerraformでAWSのコンピューティングリソースを管理する方法を学びました。
                            EC2インスタンスの基本的な作成から、Launch Templateによる設定のテンプレート化、
                            Auto Scalingによる自動スケーリング、そしてALBによる負荷分散まで、
                            本番環境で必要となる高可用性アーキテクチャの構築方法を習得しました。
                        </p>
                        <p>
                            特に重要なのは、Launch TemplateとAuto Scalingグループの組み合わせによる
                            弾力性のあるインフラストラクチャの実現と、ALBを使用した
                            インテリジェントなトラフィック分散です。
                        </p>
                        <p>
                            次章では、このコンピューティング基盤で使用するストレージサービスと
                            データベースサービスの構築方法を学習します。
                        </p>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aws-terraform-learning-material-03.html" class="btn btn-secondary">← 前の章</a>
                        <a href="aws-terraform-learning-material-05.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>