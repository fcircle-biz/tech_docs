<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クラウドコンピューティング学習教材 第7章 - クラウドアーキテクチャパターンと設計原則</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; line-height: 1.8; }
        .navbar { background: linear-gradient(135deg, #0d6efd 0%, #0dcaf0 100%); }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #f8f9fa; border-right: 1px solid #dee2e6; }
        .sidebar .nav-link { color: #495057; padding: 0.75rem 1rem; transition: all 0.3s; }
        .sidebar .nav-link:hover { background-color: #e9ecef; color: #0d6efd; }
        .sidebar .nav-link.active { background-color: #0d6efd !important; color: white !important; }
        .chapter-title { color: #0d6efd; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 3px solid #0d6efd; padding-bottom: 0.5rem; font-weight: 700; }
        .section-title { color: #0dcaf0; margin-top: 2rem; margin-bottom: 1rem; font-weight: 600; }
        .quiz-container { background-color: #e7f3ff; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #0d6efd; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #fff8e1; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .info-box { background-color: #e8f5e9; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #4caf50; }
        .table { margin: 1.5rem 0; }
        .table thead { background-color: #0d6efd; color: white; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><strong>クラウドコンピューティング学習教材</strong></a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>学習章</span></h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-01.html">第1章: クラウドコンピューティングの基礎概念</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-02.html">第2章: 主要クラウドプロバイダーの比較とアカウント作成</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-03.html">第3章: AWS基礎サービス</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-04.html">第4章: Azure基礎サービス</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-05.html">第5章: GCP基礎サービス</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-06.html">第6章: クラウドネットワーキングとセキュリティ</a></li>
                        <li class="nav-item"><a class="nav-link active" href="cloud-computing-learning-material-07.html">第7章: クラウドアーキテクチャパターンと設計原則</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-08.html">第8章: サーバーレスコンピューティングとコンテナサービス</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-09.html">第9章: クラウドコスト管理とモニタリング</a></li>
                        <li class="nav-item"><a class="nav-link" href="cloud-computing-learning-material-10.html">第10章: クラウドベストプラクティスと実践プロジェクト</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: クラウドアーキテクチャパターンと設計原則</h1>
                </div>

                <div id="chapter7">
                    <h2 class="chapter-title">実践的なクラウドアーキテクチャを設計する</h2>

                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Well-Architectedフレームワークの5つの柱を理解する</li>
                            <li>高可用性アーキテクチャの設計方法を習得する</li>
                            <li>自動スケーリングの設定と戦略を学ぶ</li>
                            <li>災害復旧（DR）戦略とRTO・RPOの概念を理解する</li>
                            <li>3層アーキテクチャの実装方法を習得する</li>
                            <li>マイクロサービスアーキテクチャの基礎を学ぶ</li>
                            <li>キャッシュ戦略とデータベース設計パターンを理解する</li>
                        </ul>
                    </div>

                    <h3 class="section-title">7.1 Well-Architectedフレームワーク</h3>

                    <h4>5つの柱</h4>
                    <p><strong>Well-Architectedフレームワーク</strong>は、クラウドアーキテクチャを設計・評価するためのベストプラクティス集です。</p>

                    <table class="table table-bordered">
                        <thead>
                            <tr><th>柱</th><th>焦点</th><th>主要な質問</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>運用性<br/>(Operational Excellence)</strong></td>
                                <td>システムの運用と監視</td>
                                <td>運用手順は文書化されているか？自動化されているか？</td>
                            </tr>
                            <tr>
                                <td><strong>セキュリティ<br/>(Security)</strong></td>
                                <td>データ保護とアクセス制御</td>
                                <td>データは暗号化されているか？最小権限の原則を適用しているか？</td>
                            </tr>
                            <tr>
                                <td><strong>信頼性<br/>(Reliability)</strong></td>
                                <td>障害からの回復とスケーラビリティ</td>
                                <td>単一障害点はないか？自動復旧できるか？</td>
                            </tr>
                            <tr>
                                <td><strong>パフォーマンス効率<br/>(Performance Efficiency)</strong></td>
                                <td>適切なリソース選択と最適化</td>
                                <td>ワークロードに適したリソースタイプを選択しているか？</td>
                            </tr>
                            <tr>
                                <td><strong>コスト最適化<br/>(Cost Optimization)</strong></td>
                                <td>無駄の削減とコスト管理</td>
                                <td>未使用リソースはないか？適切な価格モデルを選択しているか？</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="section-title">7.2 高可用性アーキテクチャ</h3>

                    <h4>マルチAZ配置</h4>
                    <p><strong>マルチAZ（Multi-Availability Zone）</strong>は、複数のデータセンター（AZ）にリソースを分散配置し、単一障害点を排除します。</p>

                    <div class="mermaid">
                        graph TB
                            subgraph Region["リージョン: 東京"]
                                subgraph AZ1["AZ-1a"]
                                    Web1[Webサーバー1]
                                    App1[アプリサーバー1]
                                    DB1[DBマスター]
                                end
                                subgraph AZ2["AZ-1c"]
                                    Web2[Webサーバー2]
                                    App2[アプリサーバー2]
                                    DB2[DBスタンバイ]
                                end
                            end

                            LB[ロードバランサー]
                            User[ユーザー]

                            User --> LB
                            LB --> Web1
                            LB --> Web2
                            Web1 --> App1
                            Web2 --> App2
                            App1 --> DB1
                            App2 --> DB1
                            DB1 -.同期レプリケーション.-> DB2
                    </div>

                    <h4>マルチリージョン配置</h4>
                    <p><strong>マルチリージョン</strong>は、地理的に離れた複数のリージョンにシステムを配置し、災害対策と低レイテンシを実現します。</p>

                    <table class="table table-bordered">
                        <thead>
                            <tr><th>配置戦略</th><th>可用性</th><th>コスト</th><th>複雑性</th><th>用途</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>単一AZ</strong></td>
                                <td>低</td>
                                <td>低</td>
                                <td>低</td>
                                <td>開発・テスト環境</td>
                            </tr>
                            <tr>
                                <td><strong>マルチAZ</strong></td>
                                <td>高（99.95%）</td>
                                <td>中</td>
                                <td>中</td>
                                <td>本番環境（標準）</td>
                            </tr>
                            <tr>
                                <td><strong>マルチリージョン</strong></td>
                                <td>非常に高（99.99%+）</td>
                                <td>高</td>
                                <td>高</td>
                                <td>ミッションクリティカル、グローバル展開</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="section-title">7.3 自動スケーリング</h3>

                    <h4>スケーリングの種類</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr><th>種類</th><th>説明</th><th>メリット</th><th>デメリット</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>垂直スケーリング<br/>(Scale Up)</strong></td>
                                <td>サーバーのスペックを上げる（CPU・メモリ増強）</td>
                                <td>シンプル、アプリ変更不要</td>
                                <td>上限あり、ダウンタイム発生</td>
                            </tr>
                            <tr>
                                <td><strong>水平スケーリング<br/>(Scale Out)</strong></td>
                                <td>サーバー台数を増やす</td>
                                <td>ほぼ無限にスケール可能、高可用性</td>
                                <td>アプリ設計が必要、複雑</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>自動スケーリングポリシー</h4>
                    <ul>
                        <li><strong>ターゲット追跡</strong>: CPU使用率50%を維持するように自動調整</li>
                        <li><strong>ステップスケーリング</strong>: CPU 60%で+1台、80%で+2台のように段階的に増減</li>
                        <li><strong>スケジュールベース</strong>: 平日9-18時は5台、夜間は2台のように時間指定</li>
                        <li><strong>予測スケーリング</strong>: 機械学習で負荷を予測し、事前にスケール</li>
                    </ul>

                    <div class="exercise-container">
                        <h5>実習 7-1: AWS Auto Scalingの設定</h5>
                        <pre><code class="language-bash"># 起動テンプレートの作成
aws ec2 create-launch-template \
    --launch-template-name my-template \
    --version-description "v1" \
    --launch-template-data '{
        "ImageId": "ami-0d52744d6551d851e",
        "InstanceType": "t3.micro",
        "SecurityGroupIds": ["sg-xxxxx"]
    }'

# Auto Scaling グループの作成
aws autoscaling create-auto-scaling-group \
    --auto-scaling-group-name my-asg \
    --launch-template LaunchTemplateName=my-template,Version='$Latest' \
    --min-size 2 \
    --max-size 10 \
    --desired-capacity 2 \
    --vpc-zone-identifier "subnet-xxxxx,subnet-yyyyy"

# ターゲット追跡スケーリングポリシー
aws autoscaling put-scaling-policy \
    --auto-scaling-group-name my-asg \
    --policy-name cpu-target-tracking \
    --policy-type TargetTrackingScaling \
    --target-tracking-configuration '{
        "PredefinedMetricSpecification": {
            "PredefinedMetricType": "ASGAverageCPUUtilization"
        },
        "TargetValue": 50.0
    }'</code></pre>
                    </div>

                    <h3 class="section-title">7.4 災害復旧（DR）戦略</h3>

                    <h4>RTO と RPO</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr><th>指標</th><th>説明</th><th>例</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>RTO<br/>(Recovery Time Objective)</strong></td>
                                <td>システムが停止してから復旧するまでの目標時間</td>
                                <td>RTO=1時間 → 障害発生から1時間以内に復旧</td>
                            </tr>
                            <tr>
                                <td><strong>RPO<br/>(Recovery Point Objective)</strong></td>
                                <td>データ損失の許容範囲（どの時点まで戻せるか）</td>
                                <td>RPO=5分 → 最大5分分のデータ損失を許容</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>DR戦略の4つのパターン</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr><th>戦略</th><th>RTO</th><th>RPO</th><th>コスト</th><th>説明</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>バックアップ&リストア</strong></td>
                                <td>数時間〜数日</td>
                                <td>1時間〜1日</td>
                                <td>最小</td>
                                <td>定期的にバックアップを取得。障害時にリストア</td>
                            </tr>
                            <tr>
                                <td><strong>パイロットライト</strong></td>
                                <td>数時間</td>
                                <td>数分〜1時間</td>
                                <td>低</td>
                                <td>最小限のコアシステムを常時稼働。障害時にスケールアップ</td>
                            </tr>
                            <tr>
                                <td><strong>ウォームスタンバイ</strong></td>
                                <td>数分</td>
                                <td>数分</td>
                                <td>中</td>
                                <td>縮小版の本番環境を常時稼働。障害時にフルスケール</td>
                            </tr>
                            <tr>
                                <td><strong>マルチサイト（アクティブ-アクティブ）</strong></td>
                                <td>即座〜数秒</td>
                                <td>ほぼゼロ</td>
                                <td>最大</td>
                                <td>複数リージョンで完全な本番環境を稼働</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="section-title">7.5 3層アーキテクチャ</h3>

                    <h4>3層アーキテクチャの概念</h4>
                    <div class="mermaid">
                        graph TB
                            subgraph "プレゼンテーション層"
                                Web[Webサーバー<br/>Nginx/Apache]
                            end

                            subgraph "アプリケーション層"
                                App[アプリケーションサーバー<br/>Node.js/Python/Java]
                            end

                            subgraph "データ層"
                                DB[(データベース<br/>RDS/SQL Database)]
                                Cache[(キャッシュ<br/>Redis/Memcached)]
                            end

                            User[ユーザー] --> Web
                            Web --> App
                            App --> Cache
                            App --> DB
                    </div>

                    <table class="table table-bordered">
                        <thead>
                            <tr><th>層</th><th>役割</th><th>技術例</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>プレゼンテーション層</strong></td>
                                <td>UI表示、静的コンテンツ配信</td>
                                <td>Nginx、Apache、S3+CloudFront</td>
                            </tr>
                            <tr>
                                <td><strong>アプリケーション層</strong></td>
                                <td>ビジネスロジック処理</td>
                                <td>Node.js、Python/Django、Java/Spring Boot</td>
                            </tr>
                            <tr>
                                <td><strong>データ層</strong></td>
                                <td>データの永続化と管理</td>
                                <td>MySQL、PostgreSQL、DynamoDB、Redis</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="section-title">7.6 マイクロサービスアーキテクチャ</h3>

                    <h4>モノリシック vs マイクロサービス</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr><th>観点</th><th>モノリシック</th><th>マイクロサービス</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>構造</strong></td>
                                <td>1つの大きなアプリケーション</td>
                                <td>小さな独立したサービスの集合</td>
                            </tr>
                            <tr>
                                <td><strong>デプロイ</strong></td>
                                <td>全体を一括デプロイ</td>
                                <td>サービスごとに独立デプロイ</td>
                            </tr>
                            <tr>
                                <td><strong>スケーリング</strong></td>
                                <td>アプリ全体をスケール</td>
                                <td>必要なサービスのみスケール</td>
                            </tr>
                            <tr>
                                <td><strong>障害の影響</strong></td>
                                <td>1箇所の障害で全体停止</td>
                                <td>他サービスは継続稼働</td>
                            </tr>
                            <tr>
                                <td><strong>技術選択</strong></td>
                                <td>統一された技術スタック</td>
                                <td>サービスごとに最適な技術選択可能</td>
                            </tr>
                        </tbody>
                    </table>

                    <h3 class="section-title">7.7 キャッシュ戦略</h3>

                    <h4>キャッシュパターン</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr><th>パターン</th><th>動作</th><th>用途</th></tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Cache-Aside</strong></td>
                                <td>アプリがキャッシュを確認→なければDBから取得しキャッシュに保存</td>
                                <td>読み取り頻度が高いデータ</td>
                            </tr>
                            <tr>
                                <td><strong>Write-Through</strong></td>
                                <td>書き込み時にキャッシュとDBの両方を更新</td>
                                <td>データ整合性が重要な場合</td>
                            </tr>
                            <tr>
                                <td><strong>Write-Behind</strong></td>
                                <td>キャッシュに書き込み、後でDBに非同期反映</td>
                                <td>書き込み性能が重要な場合</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>Well-Architectedフレームワークの5つの柱を挙げてください。</li>
                            <li>マルチAZとマルチリージョンの違いは何ですか？</li>
                            <li>垂直スケーリングと水平スケーリングの違いを説明してください。</li>
                            <li>RTOとRPOの違いを説明してください。</li>
                            <li>3層アーキテクチャの各層の役割を説明してください。</li>
                            <li>モノリシックアーキテクチャとマイクロサービスアーキテクチャの主な違いを3つ挙げてください。</li>
                        </ol>
                    </div>

                    <h3 class="section-title">7.8 本章のまとめ</h3>
                    <div class="info-box">
                        <h6>重要ポイント</h6>
                        <ul>
                            <li>Well-Architectedフレームワークの5つの柱（運用性、セキュリティ、信頼性、パフォーマンス効率、コスト最適化）</li>
                            <li>マルチAZ・マルチリージョン配置で高可用性を実現</li>
                            <li>自動スケーリングで需要に応じた柔軟なリソース管理</li>
                            <li>DR戦略でRTO・RPOを考慮した災害対策</li>
                            <li>3層アーキテクチャで責任の分離と保守性向上</li>
                            <li>マイクロサービスで独立したデプロイとスケーリング</li>
                            <li>キャッシュ戦略でパフォーマンス向上</li>
                        </ul>
                    </div>

                    <div class="d-flex justify-content-between mt-5 mb-4">
                        <a href="cloud-computing-learning-material-06.html" class="btn btn-secondary">← 前の章へ</a>
                        <a href="cloud-computing-learning-material-08.html" class="btn btn-primary">次の章へ →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
</body>
</html>
