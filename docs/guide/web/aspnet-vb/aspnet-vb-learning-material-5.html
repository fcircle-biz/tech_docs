<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET(VB.NET)学習教材 第5章 - データベース連携（ADO.NET）</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #1976d2;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #1976d2;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1976d2;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #1976d2 !important;
            color: white !important;
        }

        /* プリフォーマット */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.875em;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET(VB.NET)学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../README.md">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">ASP.NET VBガイド</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">第1章: ASP.NET基礎とセットアップ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">第2章: VB.NET言語基礎復習</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">第3章: Web Forms基本</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">第4章: サーバーコントロールとイベント処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter5">第5章: データベース連携（ADO.NET）</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">第6章: セッション管理と状態管理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">第7章: 認証とセキュリティ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">第8章: エラーハンドリングとデバッグ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第5章: データベース連携（ADO.NET）</h1>
                </div>

                <div id="chapter5">
                    <h2 class="chapter-title">ADO.NETを使用したデータベース操作</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>ADO.NETの基本概念とアーキテクチャ</li>
                            <li>データベース接続の確立と管理</li>
                            <li>Connectionオブジェクトとその適切な使用方法</li>
                            <li>Commandオブジェクトを使用したSQL実行</li>
                            <li>DataReaderによる効率的なデータ読み取り</li>
                            <li>DataSetとDataTableを使用したデータ操作</li>
                            <li>CRUD操作（作成・読み取り・更新・削除）の実装</li>
                            <li>SQLインジェクション対策とパラメータ化クエリ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">5.1 ADO.NETの基本概念</h3>
                    <p>ADO.NET（ActiveX Data Objects for .NET）は、.NET Frameworkが提供するデータアクセス技術です。リレーショナルデータベース、XML、OLEDBデータソースとの接続を提供します。</p>
                    
                    <h4>ADO.NETの主要コンポーネント</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>コンポーネント</th>
                                <th>説明</th>
                                <th>主な用途</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Connection</td>
                                <td>データソースへの接続</td>
                                <td>データベース接続の確立・管理</td>
                            </tr>
                            <tr>
                                <td>Command</td>
                                <td>SQL文やストアドプロシージャの実行</td>
                                <td>データ操作の実行</td>
                            </tr>
                            <tr>
                                <td>DataReader</td>
                                <td>読み取り専用の高速なデータ読み取り</td>
                                <td>大量データの効率的な取得</td>
                            </tr>
                            <tr>
                                <td>DataAdapter</td>
                                <td>DataSetとデータソースの橋渡し</td>
                                <td>データの取得と更新</td>
                            </tr>
                            <tr>
                                <td>DataSet</td>
                                <td>メモリ内データベース</td>
                                <td>オフライン操作、複雑なデータ関係</td>
                            </tr>
                            <tr>
                                <td>DataTable</td>
                                <td>単一テーブルのデータ表現</td>
                                <td>データバインディング、データ操作</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 5-1: 基本的なデータベース接続とデータ読み取り</h5>
                        <p>SQL Server LocalDBを使用して、基本的な接続とデータ読み取りを実装します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいWebフォーム「DatabaseBasics.aspx」を作成</li>
                            <li>接続文字列の設定</li>
                            <li>DataReaderを使用したデータ読み取りの実装</li>
                        </ol>
                        <h6>実行例</h6>
                        <p><strong>Web.config（接続文字列の設定）</strong></p>
                        <pre><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DefaultConnection" 
         connectionString="Data Source=(LocalDB)\MSSQLLocalDB;AttachDbFilename=|DataDirectory|\SampleDB.mdf;Integrated Security=True" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
  
  &lt;!-- 他の設定... --&gt;
&lt;/configuration&gt;</code></pre>
                        <p><strong>DatabaseBasics.aspx.vb</strong></p>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Configuration

Public Class DatabaseBasics
    Inherits System.Web.UI.Page

    Private ReadOnly connectionString As String = ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            CreateSampleTables()
            InsertSampleData()
            LoadCustomerData()
        End If
    End Sub

    Private Sub CreateSampleTables()
        Dim createTableSQL As String = "
            IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='Customers' AND xtype='U')
            CREATE TABLE Customers (
                CustomerID int IDENTITY(1,1) PRIMARY KEY,
                FirstName nvarchar(50) NOT NULL,
                LastName nvarchar(50) NOT NULL,
                Email nvarchar(100) UNIQUE,
                Phone nvarchar(20),
                City nvarchar(50),
                CreatedDate datetime DEFAULT GETDATE(),
                IsActive bit DEFAULT 1
            )
            
            IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='Orders' AND xtype='U')
            CREATE TABLE Orders (
                OrderID int IDENTITY(1,1) PRIMARY KEY,
                CustomerID int FOREIGN KEY REFERENCES Customers(CustomerID),
                OrderDate datetime DEFAULT GETDATE(),
                TotalAmount decimal(10,2),
                Status nvarchar(20) DEFAULT 'Pending'
            )"

        ExecuteNonQuery(createTableSQL)
    End Sub

    Private Sub InsertSampleData()
        ' 既存データの確認
        Dim checkSQL As String = "SELECT COUNT(*) FROM Customers"
        Dim count As Integer = CInt(ExecuteScalar(checkSQL))

        If count = 0 Then
            Dim insertSQL As String = "
                INSERT INTO Customers (FirstName, LastName, Email, Phone, City) VALUES
                ('太郎', '田中', 'tanaka@example.com', '090-1234-5678', '東京'),
                ('花子', '佐藤', 'sato@example.com', '080-2345-6789', '大阪'),
                ('一郎', '鈴木', 'suzuki@example.com', '070-3456-7890', '名古屋'),
                ('美子', '高橋', 'takahashi@example.com', '090-4567-8901', '福岡'),
                ('健二', '渡辺', 'watanabe@example.com', '080-5678-9012', '札幌')
                
                INSERT INTO Orders (CustomerID, TotalAmount, Status) VALUES
                (1, 15000.00, 'Completed'),
                (1, 8500.00, 'Pending'),
                (2, 25000.00, 'Completed'),
                (3, 12000.00, 'Shipped'),
                (4, 5500.00, 'Pending')"

            ExecuteNonQuery(insertSQL)
        End If
    End Sub

    Private Sub LoadCustomerData()
        Try
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                lblConnectionStatus.Text = $"データベース接続成功 - {DateTime.Now:HH:mm:ss}"
                lblConnectionStatus.CssClass = "alert alert-success"

                ' DataReaderを使用したデータ読み取り
                Dim sql As String = "
                    SELECT c.CustomerID, c.FirstName, c.LastName, c.Email, c.Phone, c.City, 
                           c.CreatedDate, c.IsActive,
                           COUNT(o.OrderID) as OrderCount,
                           ISNULL(SUM(o.TotalAmount), 0) as TotalPurchase
                    FROM Customers c
                    LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
                    GROUP BY c.CustomerID, c.FirstName, c.LastName, c.Email, c.Phone, c.City, c.CreatedDate, c.IsActive
                    ORDER BY c.LastName, c.FirstName"

                Using command As New SqlCommand(sql, connection)
                    Using reader As SqlDataReader = command.ExecuteReader()
                        Dim customerData As New System.Text.StringBuilder()
                        customerData.AppendLine("<div class='table-responsive'>")
                        customerData.AppendLine("<table class='table table-striped table-hover'>")
                        customerData.AppendLine("<thead class='table-dark'>")
                        customerData.AppendLine("<tr>")
                        customerData.AppendLine("<th>ID</th><th>氏名</th><th>メール</th><th>電話</th><th>都市</th>")
                        customerData.AppendLine("<th>登録日</th><th>注文数</th><th>購入総額</th><th>ステータス</th>")
                        customerData.AppendLine("</tr></thead><tbody>")

                        While reader.Read()
                            Dim customerId As Integer = reader.GetInt32("CustomerID")
                            Dim fullName As String = $"{reader.GetString("LastName")} {reader.GetString("FirstName")}"
                            Dim email As String = If(reader.IsDBNull("Email"), "未登録", reader.GetString("Email"))
                            Dim phone As String = If(reader.IsDBNull("Phone"), "未登録", reader.GetString("Phone"))
                            Dim city As String = If(reader.IsDBNull("City"), "未登録", reader.GetString("City"))
                            Dim createdDate As DateTime = reader.GetDateTime("CreatedDate")
                            Dim isActive As Boolean = reader.GetBoolean("IsActive")
                            Dim orderCount As Integer = reader.GetInt32("OrderCount")
                            Dim totalPurchase As Decimal = reader.GetDecimal("TotalPurchase")

                            Dim statusClass As String = If(isActive, "text-success", "text-danger")
                            Dim statusText As String = If(isActive, "アクティブ", "非アクティブ")

                            customerData.AppendLine("<tr>")
                            customerData.AppendLine($"<td>{customerId}</td>")
                            customerData.AppendLine($"<td><strong>{fullName}</strong></td>")
                            customerData.AppendLine($"<td>{email}</td>")
                            customerData.AppendLine($"<td>{phone}</td>")
                            customerData.AppendLine($"<td>{city}</td>")
                            customerData.AppendLine($"<td>{createdDate:yyyy/MM/dd}</td>")
                            customerData.AppendLine($"<td><span class='badge bg-primary'>{orderCount}</span></td>")
                            customerData.AppendLine($"<td><strong>{totalPurchase:C}</strong></td>")
                            customerData.AppendLine($"<td><span class='{statusClass}'>{statusText}</span></td>")
                            customerData.AppendLine("</tr>")
                        End While

                        customerData.AppendLine("</tbody></table></div>")
                        lblCustomerData.Text = customerData.ToString()
                    End Using
                End Using
            End Using

        Catch ex As Exception
            lblConnectionStatus.Text = $"エラー: {ex.Message}"
            lblConnectionStatus.CssClass = "alert alert-danger"
            System.Diagnostics.Debug.WriteLine($"データベースエラー: {ex}")
        End Try
    End Sub

    ' ヘルパーメソッド：NonQueryの実行
    Private Sub ExecuteNonQuery(sql As String)
        Try
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                Using command As New SqlCommand(sql, connection)
                    command.ExecuteNonQuery()
                End Using
            End Using
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"SQL実行エラー: {ex.Message}")
            Throw
        End Try
    End Sub

    ' ヘルパーメソッド：スカラー値の取得
    Private Function ExecuteScalar(sql As String) As Object
        Try
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                Using command As New SqlCommand(sql, connection)
                    Return command.ExecuteScalar()
                End Using
            End Using
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"SQL実行エラー: {ex.Message}")
            Throw
        End Try
    End Function

    Protected Sub btnRefresh_Click(sender As Object, e As EventArgs) Handles btnRefresh.Click
        LoadCustomerData()
        lblStatus.Text = $"データを更新しました - {DateTime.Now:HH:mm:ss}"
        lblStatus.CssClass = "alert alert-info"
    End Sub

    Protected Sub btnTestConnection_Click(sender As Object, e As EventArgs) Handles btnTestConnection.Click
        Try
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                Dim serverVersion As String = connection.ServerVersion
                Dim database As String = connection.Database
                
                lblStatus.Text = $"接続テスト成功<br/>サーバーバージョン: {serverVersion}<br/>データベース: {database}"
                lblStatus.CssClass = "alert alert-success"
            End Using
        Catch ex As Exception
            lblStatus.Text = $"接続テスト失敗: {ex.Message}"
            lblStatus.CssClass = "alert alert-danger"
        End Try
    End Sub
End Class</code></pre>
                        <h6>期待される結果</h6>
                        <p>データベース接続が確立され、顧客データが一覧表示されます。DataReaderによる効率的なデータ読み取りが実装されます。</p>
                    </div>

                    <h3 class="section-title">5.2 CRUD操作の実装</h3>
                    <p>Create（作成）、Read（読み取り）、Update（更新）、Delete（削除）の基本的なデータベース操作を実装します。</p>

                    <div class="warning">
                        <h6>SQLインジェクション対策</h6>
                        <ul>
                            <li>パラメータ化クエリを必ず使用する</li>
                            <li>ユーザー入力を直接SQL文に埋め込まない</li>
                            <li>入力値の検証とサニタイズを実装</li>
                            <li>データベースユーザーの権限を最小限に制限</li>
                        </ul>
                    </div>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 5-2: 完全なCRUD操作システムの実装</h5>
                        <p>顧客管理システムで、安全なCRUD操作を実装します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいWebフォーム「CustomerCRUD.aspx」を作成</li>
                            <li>パラメータ化クエリを使用したCRUD操作の実装</li>
                            <li>エラーハンドリングとトランザクション処理の追加</li>
                        </ol>
                        <h6>実行例</h6>
                        <p><strong>CustomerCRUD.aspx.vb</strong></p>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Configuration
Imports System.Transactions

Public Class CustomerCRUD
    Inherits System.Web.UI.Page

    Private ReadOnly connectionString As String = ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadCustomers()
            ClearForm()
        End If
    End Sub

    ' CREATE: 新規顧客の作成
    Protected Sub btnCreate_Click(sender As Object, e As EventArgs) Handles btnCreate.Click
        If ValidateInput() Then
            Try
                Dim sql As String = "
                    INSERT INTO Customers (FirstName, LastName, Email, Phone, City, IsActive) 
                    VALUES (@FirstName, @LastName, @Email, @Phone, @City, @IsActive);
                    SELECT SCOPE_IDENTITY();"

                Using connection As New SqlConnection(connectionString)
                    connection.Open()
                    Using command As New SqlCommand(sql, connection)
                        AddCustomerParameters(command)
                        
                        Dim newCustomerId As Integer = Convert.ToInt32(command.ExecuteScalar())
                        
                        ShowMessage($"顧客ID {newCustomerId} で新規登録しました", "success")
                        LoadCustomers()
                        ClearForm()
                        
                        ' ログ記録
                        LogActivity("CREATE", newCustomerId, $"新規顧客登録: {txtLastName.Text} {txtFirstName.Text}")
                    End Using
                End Using
                
            Catch ex As SqlException
                HandleSqlException(ex, "顧客登録")
            Catch ex As Exception
                ShowMessage($"予期しないエラーが発生しました: {ex.Message}", "danger")
            End Try
        End If
    End Sub

    ' READ: 顧客データの読み取り（検索機能付き）
    Private Sub LoadCustomers(Optional searchTerm As String = "")
        Try
            Dim sql As String = "
                SELECT CustomerID, FirstName, LastName, Email, Phone, City, CreatedDate, IsActive
                FROM Customers 
                WHERE (@SearchTerm = '' OR 
                       FirstName LIKE '%' + @SearchTerm + '%' OR 
                       LastName LIKE '%' + @SearchTerm + '%' OR 
                       Email LIKE '%' + @SearchTerm + '%' OR 
                       City LIKE '%' + @SearchTerm + '%')
                ORDER BY LastName, FirstName"

            Using connection As New SqlConnection(connectionString)
                connection.Open()
                Using command As New SqlCommand(sql, connection)
                    command.Parameters.AddWithValue("@SearchTerm", searchTerm)
                    
                    Using adapter As New SqlDataAdapter(command)
                        Dim dataTable As New DataTable()
                        adapter.Fill(dataTable)
                        
                        GridViewCustomers.DataSource = dataTable
                        GridViewCustomers.DataBind()
                        
                        lblRecordCount.Text = $"検索結果: {dataTable.Rows.Count}件"
                    End Using
                End Using
            End Using
            
        Catch ex As Exception
            ShowMessage($"データ読み込みエラー: {ex.Message}", "danger")
        End Try
    End Sub

    ' UPDATE: 顧客データの更新
    Protected Sub btnUpdate_Click(sender As Object, e As EventArgs) Handles btnUpdate.Click
        If ValidateInput() AndAlso Not String.IsNullOrEmpty(hfCustomerID.Value) Then
            Try
                Dim sql As String = "
                    UPDATE Customers 
                    SET FirstName = @FirstName, LastName = @LastName, Email = @Email, 
                        Phone = @Phone, City = @City, IsActive = @IsActive
                    WHERE CustomerID = @CustomerID"

                Using connection As New SqlConnection(connectionString)
                    connection.Open()
                    Using command As New SqlCommand(sql, connection)
                        AddCustomerParameters(command)
                        command.Parameters.AddWithValue("@CustomerID", Integer.Parse(hfCustomerID.Value))
                        
                        Dim affectedRows As Integer = command.ExecuteNonQuery()
                        
                        If affectedRows > 0 Then
                            ShowMessage($"顧客ID {hfCustomerID.Value} の情報を更新しました", "success")
                            LoadCustomers()
                            ClearForm()
                            
                            LogActivity("UPDATE", Integer.Parse(hfCustomerID.Value), 
                                      $"顧客情報更新: {txtLastName.Text} {txtFirstName.Text}")
                        Else
                            ShowMessage("更新対象の顧客が見つかりませんでした", "warning")
                        End If
                    End Using
                End Using
                
            Catch ex As SqlException
                HandleSqlException(ex, "顧客更新")
            Catch ex As Exception
                ShowMessage($"更新エラー: {ex.Message}", "danger")
            End Try
        End If
    End Sub

    ' DELETE: 顧客データの削除（論理削除）
    Protected Sub btnDelete_Click(sender As Object, e As EventArgs) Handles btnDelete.Click
        If Not String.IsNullOrEmpty(hfCustomerID.Value) Then
            Try
                ' 関連注文の確認
                Dim checkOrdersSQL As String = "SELECT COUNT(*) FROM Orders WHERE CustomerID = @CustomerID"
                Dim orderCount As Integer = 0
                
                Using connection As New SqlConnection(connectionString)
                    connection.Open()
                    Using command As New SqlCommand(checkOrdersSQL, connection)
                        command.Parameters.AddWithValue("@CustomerID", Integer.Parse(hfCustomerID.Value))
                        orderCount = Convert.ToInt32(command.ExecuteScalar())
                    End Using
                End Using

                If orderCount > 0 Then
                    ' 関連データがある場合は論理削除
                    Dim updateSQL As String = "UPDATE Customers SET IsActive = 0 WHERE CustomerID = @CustomerID"
                    
                    Using connection As New SqlConnection(connectionString)
                        connection.Open()
                        Using command As New SqlCommand(updateSQL, connection)
                            command.Parameters.AddWithValue("@CustomerID", Integer.Parse(hfCustomerID.Value))
                            command.ExecuteNonQuery()
                        End Using
                    End Using
                    
                    ShowMessage($"顧客ID {hfCustomerID.Value} を非アクティブにしました（関連注文: {orderCount}件）", "warning")
                    LogActivity("DEACTIVATE", Integer.Parse(hfCustomerID.Value), "顧客非アクティブ化")
                Else
                    ' 関連データがない場合は物理削除
                    Dim deleteSQL As String = "DELETE FROM Customers WHERE CustomerID = @CustomerID"
                    
                    Using connection As New SqlConnection(connectionString)
                        connection.Open()
                        Using command As New SqlCommand(deleteSQL, connection)
                            command.Parameters.AddWithValue("@CustomerID", Integer.Parse(hfCustomerID.Value))
                            Dim affectedRows As Integer = command.ExecuteNonQuery()
                            
                            If affectedRows > 0 Then
                                ShowMessage($"顧客ID {hfCustomerID.Value} を削除しました", "success")
                                LogActivity("DELETE", Integer.Parse(hfCustomerID.Value), "顧客物理削除")
                            Else
                                ShowMessage("削除対象の顧客が見つかりませんでした", "warning")
                            End If
                        End Using
                    End Using
                End If
                
                LoadCustomers()
                ClearForm()
                
            Catch ex As SqlException
                HandleSqlException(ex, "顧客削除")
            Catch ex As Exception
                ShowMessage($"削除エラー: {ex.Message}", "danger")
            End Try
        End If
    End Sub

    ' 検索機能
    Protected Sub btnSearch_Click(sender As Object, e As EventArgs) Handles btnSearch.Click
        LoadCustomers(txtSearch.Text.Trim())
    End Sub

    Protected Sub btnClearSearch_Click(sender As Object, e As EventArgs) Handles btnClearSearch.Click
        txtSearch.Text = ""
        LoadCustomers()
    End Sub

    ' GridViewのイベント処理
    Protected Sub GridViewCustomers_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GridViewCustomers.SelectedIndexChanged
        Dim selectedRow As GridViewRow = GridViewCustomers.SelectedRow
        
        If selectedRow IsNot Nothing Then
            hfCustomerID.Value = selectedRow.Cells(0).Text
            txtFirstName.Text = selectedRow.Cells(1).Text
            txtLastName.Text = selectedRow.Cells(2).Text
            txtEmail.Text = selectedRow.Cells(3).Text
            txtPhone.Text = selectedRow.Cells(4).Text
            txtCity.Text = selectedRow.Cells(5).Text
            chkIsActive.Checked = selectedRow.Cells(7).Text = "True"
            
            btnUpdate.Enabled = True
            btnDelete.Enabled = True
            btnCreate.Text = "新規登録"
            
            ShowMessage($"顧客ID {hfCustomerID.Value} を選択しました", "info")
        End If
    End Sub

    ' パラメータ設定のヘルパーメソッド
    Private Sub AddCustomerParameters(command As SqlCommand)
        command.Parameters.AddWithValue("@FirstName", txtFirstName.Text.Trim())
        command.Parameters.AddWithValue("@LastName", txtLastName.Text.Trim())
        command.Parameters.AddWithValue("@Email", If(String.IsNullOrWhiteSpace(txtEmail.Text), DBNull.Value, txtEmail.Text.Trim()))
        command.Parameters.AddWithValue("@Phone", If(String.IsNullOrWhiteSpace(txtPhone.Text), DBNull.Value, txtPhone.Text.Trim()))
        command.Parameters.AddWithValue("@City", If(String.IsNullOrWhiteSpace(txtCity.Text), DBNull.Value, txtCity.Text.Trim()))
        command.Parameters.AddWithValue("@IsActive", chkIsActive.Checked)
    End Sub

    ' 入力検証
    Private Function ValidateInput() As Boolean
        Dim errors As New List(Of String)()
        
        If String.IsNullOrWhiteSpace(txtFirstName.Text) Then
            errors.Add("名前は必須です")
        End If
        
        If String.IsNullOrWhiteSpace(txtLastName.Text) Then
            errors.Add("姓は必須です")
        End If
        
        If Not String.IsNullOrWhiteSpace(txtEmail.Text) Then
            Try
                Dim addr As New System.Net.Mail.MailAddress(txtEmail.Text)
            Catch
                errors.Add("有効なメールアドレスを入力してください")
            End Try
        End If
        
        If errors.Count > 0 Then
            ShowMessage("入力エラー: " & String.Join(", ", errors), "danger")
            Return False
        End If
        
        Return True
    End Function

    ' フォームクリア
    Private Sub ClearForm()
        hfCustomerID.Value = ""
        txtFirstName.Text = ""
        txtLastName.Text = ""
        txtEmail.Text = ""
        txtPhone.Text = ""
        txtCity.Text = ""
        chkIsActive.Checked = True
        
        btnUpdate.Enabled = False
        btnDelete.Enabled = False
        btnCreate.Text = "新規登録"
    End Sub

    ' メッセージ表示
    Private Sub ShowMessage(message As String, type As String)
        lblMessage.Text = message
        lblMessage.CssClass = $"alert alert-{type}"
        lblMessage.Visible = True
    End Sub

    ' SQL例外処理
    Private Sub HandleSqlException(ex As SqlException, operation As String)
        Select Case ex.Number
            Case 2 ' 接続エラー
                ShowMessage($"{operation}失敗: データベースに接続できません", "danger")
            Case 2627 ' 一意制約違反
                ShowMessage($"{operation}失敗: このメールアドレスは既に登録されています", "warning")
            Case 547 ' 外部キー制約違反
                ShowMessage($"{operation}失敗: 関連データが存在するため操作できません", "warning")
            Case Else
                ShowMessage($"{operation}エラー: {ex.Message}", "danger")
        End Select
        
        System.Diagnostics.Debug.WriteLine($"SQL Error {ex.Number}: {ex.Message}")
    End Sub

    ' アクティビティログ
    Private Sub LogActivity(action As String, customerId As Integer, description As String)
        Try
            Dim logSQL As String = "
                IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='ActivityLog' AND xtype='U')
                CREATE TABLE ActivityLog (
                    LogID int IDENTITY(1,1) PRIMARY KEY,
                    Action nvarchar(20),
                    CustomerID int,
                    Description nvarchar(200),
                    Timestamp datetime DEFAULT GETDATE(),
                    UserName nvarchar(50)
                )
                
                INSERT INTO ActivityLog (Action, CustomerID, Description, UserName) 
                VALUES (@Action, @CustomerID, @Description, @UserName)"

            Using connection As New SqlConnection(connectionString)
                connection.Open()
                Using command As New SqlCommand(logSQL, connection)
                    command.Parameters.AddWithValue("@Action", action)
                    command.Parameters.AddWithValue("@CustomerID", customerId)
                    command.Parameters.AddWithValue("@Description", description)
                    command.Parameters.AddWithValue("@UserName", Environment.UserName)
                    command.ExecuteNonQuery()
                End Using
            End Using
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ログ記録エラー: {ex.Message}")
        End Try
    End Sub

    Protected Sub btnClear_Click(sender As Object, e As EventArgs) Handles btnClear.Click
        ClearForm()
        ShowMessage("フォームをクリアしました", "info")
    End Sub
End Class</code></pre>
                        <h6>期待される結果</h6>
                        <p>安全で完全なCRUD操作システムが実装され、SQLインジェクション対策とエラーハンドリングが適切に動作します。</p>
                    </div>

                    <h3 class="section-title">5.3 DataSetとDataTableの活用</h3>
                    <p>DataSetとDataTableを使用したオフライン操作とデータバインディングについて学習します。</p>

                    <h4>DataSetとDataReaderの比較</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>項目</th>
                                <th>DataReader</th>
                                <th>DataSet/DataTable</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>接続状態</td>
                                <td>接続型（Connected）</td>
                                <td>非接続型（Disconnected）</td>
                            </tr>
                            <tr>
                                <td>メモリ使用量</td>
                                <td>少ない</td>
                                <td>多い</td>
                            </tr>
                            <tr>
                                <td>パフォーマンス</td>
                                <td>高速</td>
                                <td>やや低速</td>
                            </tr>
                            <tr>
                                <td>データ操作</td>
                                <td>読み取り専用</td>
                                <td>読み書き可能</td>
                            </tr>
                            <tr>
                                <td>データバインディング</td>
                                <td>一方向のみ</td>
                                <td>双方向可能</td>
                            </tr>
                            <tr>
                                <td>適用場面</td>
                                <td>大量データの高速読み取り</td>
                                <td>データ操作、バインディング</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習3 -->
                    <div class="exercise-container">
                        <h5>実習 5-3: DataSetを使用したマスター・詳細データの操作</h5>
                        <p>顧客と注文の関連データをDataSetで管理し、マスター・詳細画面を実装します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいWebフォーム「MasterDetail.aspx」を作成</li>
                            <li>DataSetとDataRelationを使用したデータ構造の構築</li>
                            <li>GridViewとDetailsViewの連携実装</li>
                        </ol>
                        <h6>実行例</h6>
                        <p><strong>MasterDetail.aspx.vb（抜粋）</strong></p>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Configuration

Public Class MasterDetail
    Inherits System.Web.UI.Page

    Private ReadOnly connectionString As String = ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadMasterDetailData()
        End If
    End Sub

    Private Sub LoadMasterDetailData()
        Try
            ' DataSetを作成
            Dim dataSet As New DataSet("CustomerOrderData")
            
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                
                ' 顧客データの取得
                Dim customerSQL As String = "
                    SELECT CustomerID, FirstName, LastName, Email, Phone, City, CreatedDate, IsActive
                    FROM Customers 
                    WHERE IsActive = 1
                    ORDER BY LastName, FirstName"
                
                Using customerAdapter As New SqlDataAdapter(customerSQL, connection)
                    customerAdapter.Fill(dataSet, "Customers")
                End Using
                
                ' 注文データの取得
                Dim orderSQL As String = "
                    SELECT OrderID, CustomerID, OrderDate, TotalAmount, Status
                    FROM Orders 
                    ORDER BY OrderDate DESC"
                
                Using orderAdapter As New SqlDataAdapter(orderSQL, connection)
                    orderAdapter.Fill(dataSet, "Orders")
                End Using
                
                ' 注文詳細データの取得（サンプル）
                Dim orderDetailSQL As String = "
                    IF NOT EXISTS (SELECT * FROM sysobjects WHERE name='OrderDetails' AND xtype='U')
                    CREATE TABLE OrderDetails (
                        OrderDetailID int IDENTITY(1,1) PRIMARY KEY,
                        OrderID int,
                        ProductName nvarchar(100),
                        Quantity int,
                        UnitPrice decimal(10,2),
                        LineTotal AS (Quantity * UnitPrice)
                    )
                    
                    -- サンプルデータの挿入（存在しない場合）
                    IF NOT EXISTS (SELECT * FROM OrderDetails)
                    INSERT INTO OrderDetails (OrderID, ProductName, Quantity, UnitPrice) VALUES
                    (1, 'ノートパソコン', 1, 89800.00),
                    (1, 'マウス', 2, 2980.00),
                    (2, 'キーボード', 1, 5800.00),
                    (3, 'モニター', 1, 24800.00),
                    (4, 'プリンター', 1, 12800.00),
                    (5, 'USBメモリ', 3, 1800.00)
                    
                    SELECT OrderDetailID, OrderID, ProductName, Quantity, UnitPrice, 
                           (Quantity * UnitPrice) as LineTotal
                    FROM OrderDetails 
                    ORDER BY OrderID, OrderDetailID"
                
                Using orderDetailAdapter As New SqlDataAdapter(orderDetailSQL, connection)
                    orderDetailAdapter.Fill(dataSet, "OrderDetails")
                End Using
            End Using
            
            ' リレーションシップの設定
            SetupDataRelations(dataSet)
            
            ' データバインディング
            BindMasterDetailData(dataSet)
            
        Catch ex As Exception
            ShowMessage($"データ読み込みエラー: {ex.Message}", "danger")
        End Try
    End Sub

    Private Sub SetupDataRelations(dataSet As DataSet)
        Try
            ' 顧客-注文のリレーション
            Dim customerOrderRelation As New DataRelation("CustomerOrders",
                dataSet.Tables("Customers").Columns("CustomerID"),
                dataSet.Tables("Orders").Columns("CustomerID"))
            dataSet.Relations.Add(customerOrderRelation)
            
            ' 注文-注文詳細のリレーション
            Dim orderDetailRelation As New DataRelation("OrderDetails",
                dataSet.Tables("Orders").Columns("OrderID"),
                dataSet.Tables("OrderDetails").Columns("OrderID"))
            dataSet.Relations.Add(orderDetailRelation)
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"リレーション設定エラー: {ex.Message}")
        End Try
    End Sub

    Private Sub BindMasterDetailData(dataSet As DataSet)
        ' 顧客一覧のバインディング
        GridViewCustomers.DataSource = dataSet.Tables("Customers")
        GridViewCustomers.DataBind()
        
        ' ViewStateにDataSetを保存
        ViewState("MasterDetailDataSet") = dataSet
        
        lblCustomerCount.Text = $"顧客数: {dataSet.Tables("Customers").Rows.Count}名"
        lblOrderCount.Text = $"注文数: {dataSet.Tables("Orders").Rows.Count}件"
    End Sub

    Protected Sub GridViewCustomers_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GridViewCustomers.SelectedIndexChanged
        Try
            Dim dataSet As DataSet = DirectCast(ViewState("MasterDetailDataSet"), DataSet)
            Dim selectedCustomerId As Integer = Convert.ToInt32(GridViewCustomers.SelectedValue)
            
            ' 選択された顧客の詳細情報を表示
            ShowCustomerDetails(dataSet, selectedCustomerId)
            
            ' 関連する注文を表示
            ShowCustomerOrders(dataSet, selectedCustomerId)
            
        Catch ex As Exception
            ShowMessage($"詳細表示エラー: {ex.Message}", "danger")
        End Try
    End Sub

    Private Sub ShowCustomerDetails(dataSet As DataSet, customerId As Integer)
        ' DataViewを使用してフィルタリング
        Dim customerTable As DataTable = dataSet.Tables("Customers")
        Dim customerView As New DataView(customerTable)
        customerView.RowFilter = $"CustomerID = {customerId}"
        
        If customerView.Count > 0 Then
            Dim row As DataRowView = customerView(0)
            
            Dim details As New System.Text.StringBuilder()
            details.AppendLine("<div class='card'>")
            details.AppendLine("<div class='card-header'><h5>顧客詳細情報</h5></div>")
            details.AppendLine("<div class='card-body'>")
            details.AppendLine($"<p><strong>顧客ID:</strong> {row("CustomerID")}</p>")
            details.AppendLine($"<p><strong>氏名:</strong> {row("LastName")} {row("FirstName")}</p>")
            details.AppendLine($"<p><strong>メール:</strong> {row("Email")}</p>")
            details.AppendLine($"<p><strong>電話:</strong> {row("Phone")}</p>")
            details.AppendLine($"<p><strong>都市:</strong> {row("City")}</p>")
            details.AppendLine($"<p><strong>登録日:</strong> {Convert.ToDateTime(row("CreatedDate")):yyyy年MM月dd日}</p>")
            details.AppendLine("</div></div>")
            
            lblCustomerDetails.Text = details.ToString()
        End If
    End Sub

    Private Sub ShowCustomerOrders(dataSet As DataSet, customerId As Integer)
        ' リレーションを使用してデータを取得
        Dim customerRow As DataRow = dataSet.Tables("Customers").Rows.Find(customerId)
        
        If customerRow IsNot Nothing Then
            Dim orderRows() As DataRow = customerRow.GetChildRows("CustomerOrders")
            
            If orderRows.Length > 0 Then
                ' 注文データのバインディング
                Dim orderTable As New DataTable()
                orderTable.Columns.Add("OrderID", GetType(Integer))
                orderTable.Columns.Add("OrderDate", GetType(DateTime))
                orderTable.Columns.Add("TotalAmount", GetType(Decimal))
                orderTable.Columns.Add("Status", GetType(String))
                
                For Each orderRow In orderRows
                    orderTable.Rows.Add(
                        orderRow("OrderID"),
                        orderRow("OrderDate"),
                        orderRow("TotalAmount"),
                        orderRow("Status")
                    )
                Next
                
                GridViewOrders.DataSource = orderTable
                GridViewOrders.DataBind()
                
                ' 統計情報の計算
                Dim totalAmount As Decimal = orderRows.Sum(Function(row) Convert.ToDecimal(row("TotalAmount")))
                Dim orderCount As Integer = orderRows.Length
                
                lblOrderSummary.Text = $"注文件数: {orderCount}件、合計金額: {totalAmount:C}"
            Else
                GridViewOrders.DataSource = Nothing
                GridViewOrders.DataBind()
                lblOrderSummary.Text = "注文履歴はありません"
            End If
        End If
    End Sub

    Protected Sub GridViewOrders_SelectedIndexChanged(sender As Object, e As EventArgs) Handles GridViewOrders.SelectedIndexChanged
        Try
            Dim dataSet As DataSet = DirectCast(ViewState("MasterDetailDataSet"), DataSet)
            Dim selectedOrderId As Integer = Convert.ToInt32(GridViewOrders.SelectedValue)
            
            ShowOrderDetails(dataSet, selectedOrderId)
            
        Catch ex As Exception
            ShowMessage($"注文詳細表示エラー: {ex.Message}", "danger")
        End Try
    End Sub

    Private Sub ShowOrderDetails(dataSet As DataSet, orderId As Integer)
        ' 注文詳細の表示
        Dim detailTable As DataTable = dataSet.Tables("OrderDetails")
        Dim detailView As New DataView(detailTable)
        detailView.RowFilter = $"OrderID = {orderId}"
        
        If detailView.Count > 0 Then
            GridViewOrderDetails.DataSource = detailView
            GridViewOrderDetails.DataBind()
            
            ' 小計の計算
            Dim subtotal As Decimal = 0
            For Each rowView As DataRowView In detailView
                subtotal += Convert.ToDecimal(rowView("LineTotal"))
            Next
            
            lblOrderDetailSummary.Text = $"明細数: {detailView.Count}件、小計: {subtotal:C}"
        Else
            GridViewOrderDetails.DataSource = Nothing
            GridViewOrderDetails.DataBind()
            lblOrderDetailSummary.Text = "注文詳細データがありません"
        End If
    End Sub

    ' データの更新（DataSetからデータベースへの反映）
    Protected Sub btnSaveChanges_Click(sender As Object, e As EventArgs) Handles btnSaveChanges.Click
        Try
            Dim dataSet As DataSet = DirectCast(ViewState("MasterDetailDataSet"), DataSet)
            
            Using connection As New SqlConnection(connectionString)
                connection.Open()
                
                ' トランザクション開始
                Using transaction As SqlTransaction = connection.BeginTransaction()
                    Try
                        ' 変更された顧客データの更新
                        UpdateCustomerChanges(dataSet, connection, transaction)
                        
                        ' 変更された注文データの更新
                        UpdateOrderChanges(dataSet, connection, transaction)
                        
                        transaction.Commit()
                        ShowMessage("変更をデータベースに保存しました", "success")
                        
                    Catch ex As Exception
                        transaction.Rollback()
                        Throw
                    End Try
                End Using
            End Using
            
        Catch ex As Exception
            ShowMessage($"保存エラー: {ex.Message}", "danger")
        End Try
    End Sub

    Private Sub UpdateCustomerChanges(dataSet As DataSet, connection As SqlConnection, transaction As SqlTransaction)
        Dim customerTable As DataTable = dataSet.Tables("Customers")
        
        For Each row As DataRow In customerTable.Rows
            If row.RowState = DataRowState.Modified Then
                Dim sql As String = "
                    UPDATE Customers 
                    SET FirstName = @FirstName, LastName = @LastName, Email = @Email, 
                        Phone = @Phone, City = @City, IsActive = @IsActive
                    WHERE CustomerID = @CustomerID"
                
                Using command As New SqlCommand(sql, connection, transaction)
                    command.Parameters.AddWithValue("@CustomerID", row("CustomerID"))
                    command.Parameters.AddWithValue("@FirstName", row("FirstName"))
                    command.Parameters.AddWithValue("@LastName", row("LastName"))
                    command.Parameters.AddWithValue("@Email", If(row.IsNull("Email"), DBNull.Value, row("Email")))
                    command.Parameters.AddWithValue("@Phone", If(row.IsNull("Phone"), DBNull.Value, row("Phone")))
                    command.Parameters.AddWithValue("@City", If(row.IsNull("City"), DBNull.Value, row("City")))
                    command.Parameters.AddWithValue("@IsActive", row("IsActive"))
                    command.ExecuteNonQuery()
                End Using
            End If
        Next
    End Sub

    Private Sub UpdateOrderChanges(dataSet As DataSet, connection As SqlConnection, transaction As SqlTransaction)
        ' 注文データの更新処理（実装例）
        Dim orderTable As DataTable = dataSet.Tables("Orders")
        
        For Each row As DataRow In orderTable.Rows
            If row.RowState = DataRowState.Modified Then
                Dim sql As String = "
                    UPDATE Orders 
                    SET TotalAmount = @TotalAmount, Status = @Status
                    WHERE OrderID = @OrderID"
                
                Using command As New SqlCommand(sql, connection, transaction)
                    command.Parameters.AddWithValue("@OrderID", row("OrderID"))
                    command.Parameters.AddWithValue("@TotalAmount", row("TotalAmount"))
                    command.Parameters.AddWithValue("@Status", row("Status"))
                    command.ExecuteNonQuery()
                End Using
            End If
        Next
    End Sub

    Private Sub ShowMessage(message As String, type As String)
        lblMessage.Text = message
        lblMessage.CssClass = $"alert alert-{type}"
        lblMessage.Visible = True
    End Sub
End Class</code></pre>
                        <h6>期待される結果</h6>
                        <p>DataSetを使用したマスター・詳細データ管理システムが実装され、関連データの表示と操作が適切に動作します。</p>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>ADO.NETのConnectionオブジェクトを適切に管理する方法を説明してください。</li>
                            <li>SQLインジェクション攻撃を防ぐためのパラメータ化クエリの書き方を示してください。</li>
                            <li>DataReaderとDataSetの使い分けの基準を説明してください。</li>
                            <li>トランザクション処理を実装する理由と方法を説明してください。</li>
                            <li>DataRelationの役割とマスター・詳細データでの活用方法を説明してください。</li>
                            <li>データベース例外処理で考慮すべき主要なSqlException.Numberを3つ挙げてください。</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>Using文による自動リソース解放、接続プールの活用、必要時のみ接続を開く短時間接続</li>
                                <li>SqlParameter使用: command.Parameters.AddWithValue("@param", value) でユーザー入力を直接SQL文に埋め込まない</li>
                                <li>DataReader: 大量データの高速読み取り専用。DataSet: 少量データの操作・バインディング用</li>
                                <li>データ整合性保証のため。SqlTransaction使用、try-catch-finallyでCommit/Rollback制御</li>
                                <li>テーブル間の親子関係定義。GetChildRows()で関連データ取得、階層データ表示が可能</li>
                                <li>2(接続エラー)、2627(一意制約違反)、547(外部キー制約違反)など</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-4.html" class="btn btn-secondary">← 前の章</a>
                        <a href="aspnet-vb-learning-material-6.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>