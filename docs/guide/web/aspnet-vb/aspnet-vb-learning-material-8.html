<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET(VB.NET)学習教材 第8章 - エラーハンドリングとデバッグ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #1976d2;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #1976d2;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1976d2;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #1976d2 !important;
            color: white !important;
        }

        /* プリフォーマット */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.875em;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET(VB.NET)学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../README.md">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">ASP.NET VBガイド</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">第1章: ASP.NET基礎とセットアップ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">第2章: VB.NET言語基礎復習</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">第3章: Web Forms基本</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">第4章: サーバーコントロールとイベント処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">第5章: データベース連携（ADO.NET）</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">第6章: セッション管理と状態管理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">第7章: 認証とセキュリティ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter8">第8章: エラーハンドリングとデバッグ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第8章: エラーハンドリングとデバッグ</h1>
                </div>

                <div id="chapter8">
                    <h2 class="chapter-title">例外処理・ログ出力・デバッグ技法</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>VB.NETにおける例外処理の基本と応用</li>
                            <li>ASP.NETでのグローバルエラーハンドリング</li>
                            <li>カスタムエラーページの作成と設定</li>
                            <li>構造化ログ出力システムの実装</li>
                            <li>Visual Studioデバッグ機能の活用</li>
                            <li>パフォーマンス監視と最適化技法</li>
                            <li>プロダクション環境での問題診断</li>
                            <li>エラー追跡とログ分析のベストプラクティス</li>
                        </ul>
                    </div>

                    <h3 class="section-title">8.1 例外処理の基本と実装パターン</h3>
                    <p>VB.NETの例外処理は、Try-Catch-Finally文を使用して実装します。適切な例外処理により、アプリケーションの安定性と保守性が向上します。</p>
                    
                    <h4>例外処理の階層</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>レベル</th>
                                <th>実装場所</th>
                                <th>対象</th>
                                <th>処理内容</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>メソッドレベル</td>
                                <td>個別メソッド内</td>
                                <td>特定の処理</td>
                                <td>予期される例外の処理</td>
                            </tr>
                            <tr>
                                <td>ページレベル</td>
                                <td>Page_Error イベント</td>
                                <td>ページ全体</td>
                                <td>ページ固有のエラー処理</td>
                            </tr>
                            <tr>
                                <td>アプリケーションレベル</td>
                                <td>Application_Error イベント</td>
                                <td>アプリケーション全体</td>
                                <td>未処理例外の最終処理</td>
                            </tr>
                            <tr>
                                <td>カスタムエラーページ</td>
                                <td>Web.config 設定</td>
                                <td>HTTPエラー</td>
                                <td>ユーザーフレンドリーなエラー表示</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 8-1: 包括的なエラーハンドリングシステムの実装</h5>
                        <p>多層的なエラーハンドリング機能と詳細なログ出力を含むシステムを構築します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいWebフォーム「ErrorHandlingDemo.aspx」を作成</li>
                            <li>Global.asax でアプリケーションレベルのエラー処理を実装</li>
                            <li>カスタムエラーページとログシステムの実装</li>
                        </ol>
                        <h6>実行例</h6>
                        <p><strong>Global.asax.vb</strong></p>
                        <pre><code>Imports System.IO

Public Class Global_asax
    Inherits System.Web.HttpApplication

    Sub Application_Start(sender As Object, e As EventArgs)
        ' アプリケーション起動時の処理
        LogManager.WriteLog("Application Started", LogLevel.Info)
        InitializeApplication()
    End Sub

    Sub Application_Error(sender As Object, e As EventArgs)
        ' 未処理例外の処理
        Dim lastError As Exception = Server.GetLastError()
        If lastError IsNot Nothing Then
            ProcessUnhandledException(lastError)
        End If
    End Sub

    Sub Session_Start(sender As Object, e As EventArgs)
        ' セッション開始時の処理
        LogManager.WriteLog($"New session started: {Session.SessionID}", LogLevel.Info)
    End Sub

    Sub Session_End(sender As Object, e As EventArgs)
        ' セッション終了時の処理
        LogManager.WriteLog($"Session ended: {Session.SessionID}", LogLevel.Info)
    End Sub

    Sub Application_End(sender As Object, e As EventArgs)
        ' アプリケーション終了時の処理
        LogManager.WriteLog("Application Ended", LogLevel.Info)
    End Sub

    Private Sub InitializeApplication()
        Try
            ' アプリケーション初期化処理
            Application("AppStartTime") = DateTime.Now
            Application("ErrorCount") = 0
            
            ' ログディレクトリの作成
            LogManager.InitializeLogging()
            
        Catch ex As Exception
            ' 初期化エラーの場合、イベントログに記録
            Dim eventLog As New System.Diagnostics.EventLog("Application")
            eventLog.Source = "ASP.NET Application"
            eventLog.WriteEntry($"Application initialization error: {ex.Message}", 
                              System.Diagnostics.EventLogEntryType.Error)
        End Try
    End Sub

    Private Sub ProcessUnhandledException(ex As Exception)
        Try
            ' エラーカウントの増加
            Application.Lock()
            Application("ErrorCount") = CInt(Application("ErrorCount")) + 1
            Application.UnLock()
            
            ' 詳細なエラー情報の収集
            Dim errorInfo As New ErrorInfo() With {
                .Exception = ex,
                .RequestUrl = If(Request IsNot Nothing, Request.Url.ToString(), "N/A"),
                .UserAgent = If(Request IsNot Nothing, Request.UserAgent, "N/A"),
                .RemoteAddress = If(Request IsNot Nothing, Request.UserHostAddress, "N/A"),
                .SessionId = If(Session IsNot Nothing, Session.SessionID, "N/A"),
                .UserId = If(Session IsNot Nothing AndAlso Session("UserId") IsNot Nothing, 
                           Session("UserId").ToString(), "Anonymous"),
                .Timestamp = DateTime.Now
            }
            
            ' エラーログの記録
            LogManager.WriteErrorLog(errorInfo)
            
            ' 緊急度の高いエラーの場合、追加処理
            If IsCriticalError(ex) Then
                HandleCriticalError(errorInfo)
            End If
            
            ' デバッグモードでない場合、エラーをクリア
            If Not HttpContext.Current.IsDebuggingEnabled Then
                Server.ClearError()
                Response.Redirect("~/Error.aspx")
            End If
            
        Catch logEx As Exception
            ' ログ処理でエラーが発生した場合、イベントログに記録
            Try
                Dim eventLog As New System.Diagnostics.EventLog("Application")
                eventLog.Source = "ASP.NET Application"
                eventLog.WriteEntry($"Logging error: {logEx.Message}. Original error: {ex.Message}", 
                                  System.Diagnostics.EventLogEntryType.Error)
            Catch
                ' イベントログへの書き込みも失敗した場合は何もしない
            End Try
        End Try
    End Sub

    Private Function IsCriticalError(ex As Exception) As Boolean
        ' 緊急度の高いエラーを判定
        Return TypeOf ex Is OutOfMemoryException OrElse 
               TypeOf ex Is StackOverflowException OrElse 
               TypeOf ex Is System.Data.SqlClient.SqlException OrElse
               ex.Message.Contains("database") OrElse
               ex.Message.Contains("connection")
    End Function

    Private Sub HandleCriticalError(errorInfo As ErrorInfo)
        Try
            ' 緊急時の処理（例：管理者への通知、システム停止など）
            LogManager.WriteLog($"CRITICAL ERROR: {errorInfo.Exception.Message}", LogLevel.Critical)
            
            ' 実際の実装では、メール通知やSNS通知などを行う
            ' NotificationService.SendCriticalAlert(errorInfo)
            
        Catch ex As Exception
            ' 緊急時処理のエラーは無視（無限ループを防ぐ）
        End Try
    End Sub
End Class</code></pre>
                        <p><strong>LogManager.vb (App_Code)</strong></p>
                        <pre><code>Imports System.IO
Imports System.Text.Json

Public Enum LogLevel
    Debug = 0
    Info = 1
    Warning = 2
    [Error] = 3
    Critical = 4
End Enum

Public Class ErrorInfo
    Public Property Exception As Exception
    Public Property RequestUrl As String
    Public Property UserAgent As String
    Public Property RemoteAddress As String
    Public Property SessionId As String
    Public Property UserId As String
    Public Property Timestamp As DateTime
    Public Property AdditionalData As Dictionary(Of String, Object)
End Class

Public NotInheritable Class LogManager
    Private Shared ReadOnly logLock As New Object()
    Private Shared logDirectory As String = ""
    Private Shared ReadOnly maxLogFileSize As Long = 10 * 1024 * 1024 ' 10MB
    Private Shared ReadOnly maxLogFiles As Integer = 10

    Public Shared Sub InitializeLogging()
        Try
            logDirectory = HttpContext.Current.Server.MapPath("~/App_Data/Logs")
            If Not Directory.Exists(logDirectory) Then
                Directory.CreateDirectory(logDirectory)
            End If
            
            ' 古いログファイルのクリーンアップ
            CleanupOldLogFiles()
            
        Catch ex As Exception
            ' ログ初期化に失敗した場合、一時ディレクトリを使用
            logDirectory = Path.GetTempPath()
        End Try
    End Sub

    Public Shared Sub WriteLog(message As String, level As LogLevel, Optional additionalData As Dictionary(Of String, Object) = Nothing)
        Try
            SyncLock logLock
                Dim logEntry As New Dictionary(Of String, Object) From {
                    {"Timestamp", DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss.fff")},
                    {"Level", level.ToString()},
                    {"Message", message},
                    {"MachineName", Environment.MachineName},
                    {"ProcessId", Process.GetCurrentProcess().Id},
                    {"ThreadId", Threading.Thread.CurrentThread.ManagedThreadId}
                }
                
                If additionalData IsNot Nothing Then
                    logEntry("AdditionalData") = additionalData
                End If
                
                Dim logFileName As String = Path.Combine(logDirectory, $"app_{DateTime.Now:yyyyMMdd}.log")
                Dim jsonString As String = JsonSerializer.Serialize(logEntry, New JsonSerializerOptions With {.WriteIndented = False})
                
                File.AppendAllText(logFileName, jsonString + Environment.NewLine)
                
                ' ファイルサイズチェック
                Dim fileInfo As New FileInfo(logFileName)
                If fileInfo.Length > maxLogFileSize Then
                    RotateLogFile(logFileName)
                End If
            End SyncLock
            
        Catch ex As Exception
            ' ログ書き込みエラーの場合、デバッグ出力のみ
            System.Diagnostics.Debug.WriteLine($"Logging error: {ex.Message}")
        End Try
    End Sub

    Public Shared Sub WriteErrorLog(errorInfo As ErrorInfo)
        Try
            Dim errorData As New Dictionary(Of String, Object) From {
                {"ExceptionType", errorInfo.Exception.GetType().Name},
                {"ExceptionMessage", errorInfo.Exception.Message},
                {"StackTrace", errorInfo.Exception.StackTrace},
                {"RequestUrl", errorInfo.RequestUrl},
                {"UserAgent", errorInfo.UserAgent},
                {"RemoteAddress", errorInfo.RemoteAddress},
                {"SessionId", errorInfo.SessionId},
                {"UserId", errorInfo.UserId}
            }
            
            ' 内部例外も記録
            Dim innerEx As Exception = errorInfo.Exception.InnerException
            If innerEx IsNot Nothing Then
                errorData("InnerException") = New Dictionary(Of String, Object) From {
                    {"Type", innerEx.GetType().Name},
                    {"Message", innerEx.Message},
                    {"StackTrace", innerEx.StackTrace}
                }
            End If
            
            WriteLog($"Unhandled Exception: {errorInfo.Exception.Message}", LogLevel.Error, errorData)
            
        Catch ex As Exception
            ' エラーログ書き込みエラーの場合
            WriteLog($"Error logging failed: {ex.Message}", LogLevel.Critical)
        End Try
    End Sub

    Public Shared Sub WritePerformanceLog(operationName As String, duration As TimeSpan, Optional additionalData As Dictionary(Of String, Object) = Nothing)
        Try
            Dim perfData As New Dictionary(Of String, Object) From {
                {"Operation", operationName},
                {"Duration", duration.TotalMilliseconds},
                {"DurationFormatted", $"{duration.TotalMilliseconds:F2}ms"}
            }
            
            If additionalData IsNot Nothing Then
                For Each kvp In additionalData
                    perfData(kvp.Key) = kvp.Value
                Next
            End If
            
            WriteLog($"Performance: {operationName} completed in {duration.TotalMilliseconds:F2}ms", LogLevel.Info, perfData)
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"Performance logging error: {ex.Message}")
        End Try
    End Sub

    Private Shared Sub RotateLogFile(logFileName As String)
        Try
            Dim directory As String = Path.GetDirectoryName(logFileName)
            Dim fileName As String = Path.GetFileNameWithoutExtension(logFileName)
            Dim extension As String = Path.GetExtension(logFileName)
            
            ' 既存のローテーションファイルをシフト
            For i As Integer = maxLogFiles - 1 To 1 Step -1
                Dim oldFile As String = Path.Combine(directory, $"{fileName}_{i}{extension}")
                Dim newFile As String = Path.Combine(directory, $"{fileName}_{i + 1}{extension}")
                
                If File.Exists(oldFile) Then
                    If File.Exists(newFile) Then
                        File.Delete(newFile)
                    End If
                    File.Move(oldFile, newFile)
                End If
            Next
            
            ' 現在のファイルを最初のローテーションファイルに移動
            Dim rotatedFile As String = Path.Combine(directory, $"{fileName}_1{extension}")
            If File.Exists(rotatedFile) Then
                File.Delete(rotatedFile)
            End If
            File.Move(logFileName, rotatedFile)
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"Log rotation error: {ex.Message}")
        End Try
    End Sub

    Private Shared Sub CleanupOldLogFiles()
        Try
            Dim logFiles = Directory.GetFiles(logDirectory, "*.log").OrderByDescending(Function(f) File.GetCreationTime(f)).Skip(maxLogFiles * 2)
            
            For Each file In logFiles
                Try
                    File.Delete(file)
                Catch
                    ' 削除できないファイルは無視
                End Try
            Next
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"Log cleanup error: {ex.Message}")
        End Try
    End Sub
End Class</code></pre>
                        <p><strong>ErrorHandlingDemo.aspx.vb</strong></p>
                        <pre><code>Imports System.Diagnostics

Public Class ErrorHandlingDemo
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LogManager.WriteLog("ErrorHandlingDemo page loaded", LogLevel.Info)
        End If
    End Sub

    Protected Sub Page_Error(sender As Object, e As EventArgs) Handles Me.Error
        ' ページレベルのエラー処理
        Dim exception As Exception = Server.GetLastError()
        If exception IsNot Nothing Then
            LogManager.WriteLog($"Page-level error: {exception.Message}", LogLevel.Error)
            
            ' エラー詳細を隠してユーザーフレンドリーなメッセージを表示
            lblErrorMessage.Text = "申し訳ございませんが、処理中にエラーが発生しました。"
            lblErrorMessage.CssClass = "alert alert-danger"
            lblErrorMessage.Visible = True
            
            Server.ClearError()
        End If
    End Sub

    Protected Sub btnDivideByZero_Click(sender As Object, e As EventArgs) Handles btnDivideByZero.Click
        Try
            Dim stopwatch As Stopwatch = Stopwatch.StartNew()
            
            ' 意図的にゼロ除算エラーを発生
            Dim result As Integer = 10 \ 0
            lblResult.Text = result.ToString()
            
            stopwatch.Stop()
            LogManager.WritePerformanceLog("DivideByZero", stopwatch.Elapsed)
            
        Catch ex As DivideByZeroException
            ' 特定の例外タイプの処理
            LogManager.WriteLog($"Division by zero attempted by user", LogLevel.Warning)
            ShowMessage("ゼロで割ることはできません", "warning")
            
        Catch ex As Exception
            ' その他の予期しない例外
            LogManager.WriteLog($"Unexpected error in divide operation: {ex.Message}", LogLevel.Error)
            ShowMessage("計算中にエラーが発生しました", "danger")
        End Try
    End Sub

    Protected Sub btnDatabaseError_Click(sender As Object, e As EventArgs) Handles btnDatabaseError.Click
        Try
            Dim stopwatch As Stopwatch = Stopwatch.StartNew()
            
            ' 意図的にデータベースエラーを発生
            Using connection As New System.Data.SqlClient.SqlConnection("Invalid Connection String")
                connection.Open()
            End Using
            
            stopwatch.Stop()
            LogManager.WritePerformanceLog("DatabaseOperation", stopwatch.Elapsed)
            
        Catch ex As System.Data.SqlClient.SqlException
            ' SQLサーバー固有の例外処理
            Dim errorData As New Dictionary(Of String, Object) From {
                {"SqlErrorNumber", ex.Number},
                {"SqlErrorSeverity", ex.Class},
                {"SqlErrorState", ex.State}
            }
            
            LogManager.WriteLog($"Database error: {ex.Message}", LogLevel.Error, errorData)
            ShowMessage("データベース接続に失敗しました", "danger")
            
        Catch ex As Exception
            LogManager.WriteLog($"Database operation error: {ex.Message}", LogLevel.Error)
            ShowMessage("データベース操作中にエラーが発生しました", "danger")
        End Try
    End Sub

    Protected Sub btnNullReference_Click(sender As Object, e As EventArgs) Handles btnNullReference.Click
        Try
            Dim stopwatch As Stopwatch = Stopwatch.StartNew()
            
            ' 意図的にNull参照エラーを発生
            Dim nullString As String = Nothing
            Dim length As Integer = nullString.Length
            
            stopwatch.Stop()
            LogManager.WritePerformanceLog("NullReferenceOperation", stopwatch.Elapsed)
            
        Catch ex As NullReferenceException
            LogManager.WriteLog("Null reference exception occurred", LogLevel.Warning)
            ShowMessage("参照されたオブジェクトが存在しません", "warning")
            
        Catch ex As Exception
            LogManager.WriteLog($"Unexpected error: {ex.Message}", LogLevel.Error)
            ShowMessage("予期しないエラーが発生しました", "danger")
        End Try
    End Sub

    Protected Sub btnCustomException_Click(sender As Object, e As EventArgs) Handles btnCustomException.Click
        Try
            Dim stopwatch As Stopwatch = Stopwatch.StartNew()
            
            ' カスタム例外の発生
            Throw New BusinessLogicException("業務ロジックエラーが発生しました", "BUSINESS_001")
            
            stopwatch.Stop()
            LogManager.WritePerformanceLog("CustomExceptionOperation", stopwatch.Elapsed)
            
        Catch ex As BusinessLogicException
            ' カスタム例外の処理
            Dim errorData As New Dictionary(Of String, Object) From {
                {"ErrorCode", ex.ErrorCode},
                {"BusinessArea", "Customer Management"}
            }
            
            LogManager.WriteLog($"Business logic error: {ex.Message}", LogLevel.Warning, errorData)
            ShowMessage($"業務エラー: {ex.Message} (エラーコード: {ex.ErrorCode})", "warning")
            
        Catch ex As Exception
            LogManager.WriteLog($"Unexpected error: {ex.Message}", LogLevel.Error)
            ShowMessage("予期しないエラーが発生しました", "danger")
        End Try
    End Sub

    Protected Sub btnLoadTestData_Click(sender As Object, e As EventArgs) Handles btnLoadTestData.Click
        Try
            Dim stopwatch As Stopwatch = Stopwatch.StartNew()
            
            ' 重い処理のシミュレーション
            SimulateHeavyOperation()
            
            stopwatch.Stop()
            LogManager.WritePerformanceLog("LoadTestData", stopwatch.Elapsed, 
                New Dictionary(Of String, Object) From {{"RecordsProcessed", 10000}})
            
            ShowMessage($"テストデータを読み込みました ({stopwatch.ElapsedMilliseconds}ms)", "success")
            
        Catch ex As Exception
            LogManager.WriteLog($"Test data loading error: {ex.Message}", LogLevel.Error)
            ShowMessage("テストデータの読み込みに失敗しました", "danger")
        End Try
    End Sub

    Private Sub SimulateHeavyOperation()
        ' CPUを集約的に使用する処理のシミュレーション
        For i As Integer = 0 To 1000000
            Dim dummy As Double = Math.Sqrt(i)
        Next
        
        ' メモリを集約的に使用する処理のシミュレーション
        Dim largeArray(100000) As Integer
        For i As Integer = 0 To largeArray.Length - 1
            largeArray(i) = i
        Next
    End Sub

    Protected Sub btnViewLogs_Click(sender As Object, e As EventArgs) Handles btnViewLogs.Click
        Try
            DisplayRecentLogs()
        Catch ex As Exception
            LogManager.WriteLog($"Log viewing error: {ex.Message}", LogLevel.Error)
            ShowMessage("ログの表示に失敗しました", "danger")
        End Try
    End Sub

    Private Sub DisplayRecentLogs()
        Try
            Dim logDirectory As String = Server.MapPath("~/App_Data/Logs")
            If Not Directory.Exists(logDirectory) Then
                lblLogDisplay.Text = "<p class='text-muted'>ログディレクトリが存在しません</p>"
                Return
            End If
            
            Dim todayLogFile As String = Path.Combine(logDirectory, $"app_{DateTime.Now:yyyyMMdd}.log")
            If Not File.Exists(todayLogFile) Then
                lblLogDisplay.Text = "<p class='text-muted'>今日のログファイルは存在しません</p>"
                Return
            End If
            
            ' 最新の10行を表示
            Dim lines = File.ReadAllLines(todayLogFile).TakeLast(10).ToArray()
            
            Dim logHtml As New System.Text.StringBuilder()
            logHtml.AppendLine("<div class='card'>")
            logHtml.AppendLine("<div class='card-header'><h6>最新ログ (最新10件)</h6></div>")
            logHtml.AppendLine("<div class='card-body'>")
            logHtml.AppendLine("<div class='table-responsive'>")
            logHtml.AppendLine("<table class='table table-sm table-striped'>")
            logHtml.AppendLine("<thead><tr><th>時刻</th><th>レベル</th><th>メッセージ</th></tr></thead><tbody>")
            
            For Each line In lines.Reverse()
                Try
                    Dim logEntry = System.Text.Json.JsonSerializer.Deserialize(Of Dictionary(Of String, Object))(line)
                    Dim timestamp As String = logEntry("Timestamp").ToString()
                    Dim level As String = logEntry("Level").ToString()
                    Dim message As String = logEntry("Message").ToString()
                    
                    Dim levelClass As String = GetLogLevelCssClass(level)
                    
                    logHtml.AppendLine("<tr>")
                    logHtml.AppendLine($"<td><small>{timestamp}</small></td>")
                    logHtml.AppendLine($"<td><span class='badge {levelClass}'>{level}</span></td>")
                    logHtml.AppendLine($"<td>{HttpUtility.HtmlEncode(message)}</td>")
                    logHtml.AppendLine("</tr>")
                    
                Catch
                    ' JSON解析エラーの場合、生ログを表示
                    logHtml.AppendLine("<tr>")
                    logHtml.AppendLine("<td colspan='3'><code>" & HttpUtility.HtmlEncode(line) & "</code></td>")
                    logHtml.AppendLine("</tr>")
                End Try
            Next
            
            logHtml.AppendLine("</tbody></table>")
            logHtml.AppendLine("</div></div></div>")
            
            lblLogDisplay.Text = logHtml.ToString()
            
        Catch ex As Exception
            lblLogDisplay.Text = $"<p class='text-danger'>ログ表示エラー: {ex.Message}</p>"
        End Try
    End Sub

    Private Function GetLogLevelCssClass(level As String) As String
        Select Case level.ToUpper()
            Case "DEBUG"
                Return "bg-secondary"
            Case "INFO"
                Return "bg-primary"
            Case "WARNING"
                Return "bg-warning"
            Case "ERROR"
                Return "bg-danger"
            Case "CRITICAL"
                Return "bg-dark"
            Case Else
                Return "bg-light text-dark"
        End Select
    End Function

    Private Sub ShowMessage(message As String, type As String)
        Dim script As String = $"
            setTimeout(function() {{
                var alertDiv = document.createElement('div');
                alertDiv.className = 'alert alert-{type} alert-dismissible fade show';
                alertDiv.innerHTML = '{HttpUtility.JavaScriptStringEncode(message)}<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>';
                document.querySelector('.container').insertBefore(alertDiv, document.querySelector('.container').firstChild);
                setTimeout(function() {{ alertDiv.remove(); }}, 5000);
            }}, 100);"
        
        ClientScript.RegisterStartupScript(Me.GetType(), "ShowMessage", script, True)
    End Sub
End Class

' カスタム例外クラス
Public Class BusinessLogicException
    Inherits Exception
    
    Public Property ErrorCode As String
    
    Public Sub New(message As String, errorCode As String)
        MyBase.New(message)
        Me.ErrorCode = errorCode
    End Sub
    
    Public Sub New(message As String, errorCode As String, innerException As Exception)
        MyBase.New(message, innerException)
        Me.ErrorCode = errorCode
    End Sub
End Class</code></pre>
                        <h6>期待される結果</h6>
                        <p>包括的なエラーハンドリングシステムが動作し、構造化ログ、パフォーマンス監視、カスタム例外処理が適切に実装されます。</p>
                    </div>

                    <h3 class="section-title">8.2 Visual Studio デバッグ機能の活用</h3>
                    <p>Visual Studioの強力なデバッグ機能を活用して、効率的な問題診断とコード分析を行います。</p>

                    <h4>主要なデバッグ機能</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>機能</th>
                                <th>用途</th>
                                <th>使用方法</th>
                                <th>活用場面</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ブレークポイント</td>
                                <td>実行の一時停止</td>
                                <td>F9キー、行番号クリック</td>
                                <td>特定箇所での状態確認</td>
                            </tr>
                            <tr>
                                <td>ステップ実行</td>
                                <td>行単位の実行制御</td>
                                <td>F10(Over), F11(Into), Shift+F11(Out)</td>
                                <td>処理フローの詳細追跡</td>
                            </tr>
                            <tr>
                                <td>ウォッチウィンドウ</td>
                                <td>変数・式の監視</td>
                                <td>デバッグ→ウィンドウ→ウォッチ</td>
                                <td>値の変化追跡</td>
                            </tr>
                            <tr>
                                <td>即座ウィンドウ</td>
                                <td>式の動的評価</td>
                                <td>Ctrl+Alt+I</td>
                                <td>デバッグ中の検証</td>
                            </tr>
                            <tr>
                                <td>Call Stack</td>
                                <td>呼び出し履歴</td>
                                <td>Ctrl+Alt+C</td>
                                <td>実行パスの確認</td>
                            </tr>
                            <tr>
                                <td>Diagnostics Tools</td>
                                <td>パフォーマンス分析</td>
                                <td>デバッグ時自動表示</td>
                                <td>メモリ・CPU使用量監視</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="warning">
                        <h6>プロダクション環境での注意点</h6>
                        <ul>
                            <li>デバッグモードは無効にする（performance影響）</li>
                            <li>詳細なエラー情報の非表示（セキュリティ）</li>
                            <li>ログレベルの調整（不要な詳細ログの削減）</li>
                            <li>リモートデバッグは慎重に使用</li>
                        </ul>
                    </div>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 8-2: パフォーマンス監視と最適化</h5>
                        <p>パフォーマンス計測機能とメモリ使用量監視システムを実装します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいWebフォーム「PerformanceMonitor.aspx」を作成</li>
                            <li>処理時間計測とメモリ監視機能の実装</li>
                            <li>パフォーマンスカウンターとの連携</li>
                        </ol>
                        <h6>実行例</h6>
                        <p><strong>PerformanceMonitor.aspx.vb（抜粋）</strong></p>
                        <pre><code>Imports System.Diagnostics
Imports System.Threading

Public Class PerformanceMonitor
    Inherits System.Web.UI.Page

    Private Shared ReadOnly performanceCounters As New Dictionary(Of String, PerformanceCounter)()

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            InitializePerformanceCounters()
            DisplaySystemInfo()
        End If
        
        UpdatePerformanceMetrics()
    End Sub

    Private Sub InitializePerformanceCounters()
        Try
            If performanceCounters.Count = 0 Then
                ' CPUカウンター
                performanceCounters("CPU") = New PerformanceCounter("Processor", "% Processor Time", "_Total")
                
                ' メモリカウンター
                performanceCounters("AvailableMemory") = New PerformanceCounter("Memory", "Available MBytes")
                
                ' ASP.NETカウンター
                performanceCounters("RequestsPerSec") = New PerformanceCounter("ASP.NET Applications", "Requests/Sec", "__Total__")
                
                ' 初回読み取り（必要な場合がある）
                For Each counter In performanceCounters.Values
                    counter.NextValue()
                Next
            End If
        Catch ex As Exception
            LogManager.WriteLog($"Performance counter initialization error: {ex.Message}", LogLevel.Warning)
        End Try
    End Sub

    Private Sub DisplaySystemInfo()
        Try
            Dim systemInfo As New System.Text.StringBuilder()
            systemInfo.AppendLine("<div class='row'>")
            
            ' システム基本情報
            systemInfo.AppendLine("<div class='col-md-6'>")
            systemInfo.AppendLine("<h6>システム情報</h6>")
            systemInfo.AppendLine($"<p><strong>マシン名:</strong> {Environment.MachineName}</p>")
            systemInfo.AppendLine($"<p><strong>OS:</strong> {Environment.OSVersion}</p>")
            systemInfo.AppendLine($"<p><strong>プロセッサ数:</strong> {Environment.ProcessorCount}</p>")
            systemInfo.AppendLine($"<p><strong>.NET バージョン:</strong> {Environment.Version}</p>")
            systemInfo.AppendLine($"<p><strong>ワーキングセット:</strong> {Environment.WorkingSet / 1024 / 1024:F2} MB</p>")
            systemInfo.AppendLine("</div>")
            
            ' アプリケーション情報
            systemInfo.AppendLine("<div class='col-md-6'>")
            systemInfo.AppendLine("<h6>アプリケーション情報</h6>")
            systemInfo.AppendLine($"<p><strong>アプリケーション開始:</strong> {Application('AppStartTime'):yyyy/MM/dd HH:mm:ss}</p>")
            systemInfo.AppendLine($"<p><strong>現在セッション数:</strong> {GetActiveSessionCount()}</p>")
            systemInfo.AppendLine($"<p><strong>エラー発生回数:</strong> {Application('ErrorCount')}</p>")
            systemInfo.AppendLine($"<p><strong>現在のプロセスID:</strong> {Process.GetCurrentProcess().Id}</p>")
            systemInfo.AppendLine($"<p><strong>スレッド数:</strong> {Process.GetCurrentProcess().Threads.Count}</p>")
            systemInfo.AppendLine("</div>")
            
            systemInfo.AppendLine("</div>")
            lblSystemInfo.Text = systemInfo.ToString()
            
        Catch ex As Exception
            lblSystemInfo.Text = $"<p class='text-danger'>システム情報取得エラー: {ex.Message}</p>"
        End Try
    End Sub

    Private Sub UpdatePerformanceMetrics()
        Try
            Dim metrics As New System.Text.StringBuilder()
            metrics.AppendLine("<div class='row'>")
            
            ' CPU使用率
            If performanceCounters.ContainsKey("CPU") Then
                Dim cpuUsage As Single = performanceCounters("CPU").NextValue()
                Dim cpuClass As String = GetPerformanceClass(cpuUsage, 30, 70)
                metrics.AppendLine("<div class='col-md-3'>")
                metrics.AppendLine("<div class='card'>")
                metrics.AppendLine("<div class='card-body text-center'>")
                metrics.AppendLine("<h5 class='card-title'>CPU使用率</h5>")
                metrics.AppendLine($"<p class='card-text {cpuClass}'><strong>{cpuUsage:F1}%</strong></p>")
                metrics.AppendLine("</div></div></div>")
            End If
            
            ' メモリ使用量
            If performanceCounters.ContainsKey("AvailableMemory") Then
                Dim availableMemory As Single = performanceCounters("AvailableMemory").NextValue()
                Dim memoryClass As String = GetPerformanceClass(100 - availableMemory / 100, 30, 70)
                metrics.AppendLine("<div class='col-md-3'>")
                metrics.AppendLine("<div class='card'>")
                metrics.AppendLine("<div class='card-body text-center'>")
                metrics.AppendLine("<h5 class='card-title'>利用可能メモリ</h5>")
                metrics.AppendLine($"<p class='card-text {memoryClass}'><strong>{availableMemory:F0} MB</strong></p>")
                metrics.AppendLine("</div></div></div>")
            End If
            
            ' GC情報
            metrics.AppendLine("<div class='col-md-3'>")
            metrics.AppendLine("<div class='card'>")
            metrics.AppendLine("<div class='card-body text-center'>")
            metrics.AppendLine("<h5 class='card-title'>GC情報</h5>")
            metrics.AppendLine($"<p class='card-text'>Gen0: <strong>{GC.CollectionCount(0)}</strong></p>")
            metrics.AppendLine($"<p class='card-text'>Gen1: <strong>{GC.CollectionCount(1)}</strong></p>")
            metrics.AppendLine($"<p class='card-text'>Gen2: <strong>{GC.CollectionCount(2)}</strong></p>")
            metrics.AppendLine("</div></div></div>")
            
            ' アプリケーション固有メトリクス
            metrics.AppendLine("<div class='col-md-3'>")
            metrics.AppendLine("<div class='card'>")
            metrics.AppendLine("<div class='card-body text-center'>")
            metrics.AppendLine("<h5 class='card-title'>アプリ統計</h5>")
            metrics.AppendLine($"<p class='card-text'>稼働時間: <strong>{GetUptime()}</strong></p>")
            metrics.AppendLine($"<p class='card-text'>総リクエスト: <strong>{GetTotalRequests()}</strong></p>")
            metrics.AppendLine("</div></div></div>")
            
            metrics.AppendLine("</div>")
            lblPerformanceMetrics.Text = metrics.ToString()
            
        Catch ex As Exception
            lblPerformanceMetrics.Text = $"<p class='text-danger'>パフォーマンス情報取得エラー: {ex.Message}</p>"
        End Try
    End Sub

    Private Function GetPerformanceClass(value As Single, warningThreshold As Single, errorThreshold As Single) As String
        If value >= errorThreshold Then
            Return "text-danger"
        ElseIf value >= warningThreshold Then
            Return "text-warning"
        Else
            Return "text-success"
        End If
    End Function

    Private Function GetActiveSessionCount() As Integer
        ' セッション数の概算
        Return HttpContext.Current.Application.Count
    End Function

    Private Function GetUptime() As String
        If Application("AppStartTime") IsNot Nothing Then
            Dim uptime As TimeSpan = DateTime.Now - DirectCast(Application("AppStartTime"), DateTime)
            Return $"{uptime.Days}日 {uptime.Hours:D2}:{uptime.Minutes:D2}:{uptime.Seconds:D2}"
        End If
        Return "不明"
    End Function

    Private Function GetTotalRequests() As Integer
        ' アプリケーション開始からのリクエスト数の概算
        If Application("TotalRequests") Is Nothing Then
            Application("TotalRequests") = 0
        End If
        
        Application("TotalRequests") = CInt(Application("TotalRequests")) + 1
        Return CInt(Application("TotalRequests"))
    End Function

    Protected Sub btnRunPerformanceTest_Click(sender As Object, e As EventArgs) Handles btnRunPerformanceTest.Click
        Try
            Dim testResults As New System.Text.StringBuilder()
            testResults.AppendLine("<h6>パフォーマンステスト結果</h6>")
            
            ' CPU集約的処理のテスト
            Dim cpuTestResult = TestCPUPerformance()
            testResults.AppendLine($"<p>CPU集約処理: {cpuTestResult.Duration:F2}ms (結果: {cpuTestResult.Result})</p>")
            
            ' メモリ集約的処理のテスト
            Dim memoryTestResult = TestMemoryPerformance()
            testResults.AppendLine($"<p>メモリ集約処理: {memoryTestResult.Duration:F2}ms (使用メモリ: {memoryTestResult.MemoryUsed:F2}MB)</p>")
            
            ' IO集約的処理のテスト
            Dim ioTestResult = TestIOPerformance()
            testResults.AppendLine($"<p>IO集約処理: {ioTestResult.Duration:F2}ms (処理ファイル: {ioTestResult.FilesProcessed}個)</p>")
            
            lblTestResults.Text = testResults.ToString()
            
            ' パフォーマンス情報を更新
            UpdatePerformanceMetrics()
            
        Catch ex As Exception
            lblTestResults.Text = $"<p class='text-danger'>パフォーマンステストエラー: {ex.Message}</p>"
            LogManager.WriteLog($"Performance test error: {ex.Message}", LogLevel.Error)
        End Try
    End Sub

    Private Function TestCPUPerformance() As (Duration As Double, Result As Long)
        Dim stopwatch As Stopwatch = Stopwatch.StartNew()
        Dim result As Long = 0
        
        ' CPU集約的な計算
        For i As Integer = 0 To 1000000
            result += CLng(Math.Sqrt(i))
        Next
        
        stopwatch.Stop()
        LogManager.WritePerformanceLog("CPUPerformanceTest", stopwatch.Elapsed)
        
        Return (stopwatch.Elapsed.TotalMilliseconds, result)
    End Function

    Private Function TestMemoryPerformance() As (Duration As Double, MemoryUsed As Double)
        Dim stopwatch As Stopwatch = Stopwatch.StartNew()
        Dim initialMemory As Long = GC.GetTotalMemory(False)
        
        ' メモリ集約的な処理
        Dim largeList As New List(Of Byte())()
        For i As Integer = 0 To 100
            largeList.Add(New Byte(10000) {})
        Next
        
        Dim finalMemory As Long = GC.GetTotalMemory(False)
        stopwatch.Stop()
        
        ' メモリを解放
        largeList.Clear()
        GC.Collect()
        
        Dim memoryUsed As Double = (finalMemory - initialMemory) / 1024.0 / 1024.0
        LogManager.WritePerformanceLog("MemoryPerformanceTest", stopwatch.Elapsed, 
            New Dictionary(Of String, Object) From {{"MemoryUsedMB", memoryUsed}})
        
        Return (stopwatch.Elapsed.TotalMilliseconds, memoryUsed)
    End Function

    Private Function TestIOPerformance() As (Duration As Double, FilesProcessed As Integer)
        Dim stopwatch As Stopwatch = Stopwatch.StartNew()
        Dim filesProcessed As Integer = 0
        
        Try
            Dim tempPath As String = Path.GetTempPath()
            
            ' ファイル作成・読み取り・削除のテスト
            For i As Integer = 0 To 10
                Dim tempFile As String = Path.Combine(tempPath, $"perf_test_{i}.tmp")
                
                ' ファイル作成
                File.WriteAllText(tempFile, $"Test data {i} - {DateTime.Now}")
                
                ' ファイル読み取り
                Dim content As String = File.ReadAllText(tempFile)
                
                ' ファイル削除
                File.Delete(tempFile)
                
                filesProcessed += 1
            Next
            
        Catch ex As Exception
            LogManager.WriteLog($"IO performance test error: {ex.Message}", LogLevel.Warning)
        End Try
        
        stopwatch.Stop()
        LogManager.WritePerformanceLog("IOPerformanceTest", stopwatch.Elapsed, 
            New Dictionary(Of String, Object) From {{"FilesProcessed", filesProcessed}})
        
        Return (stopwatch.Elapsed.TotalMilliseconds, filesProcessed)
    End Function

    Protected Sub btnForceGC_Click(sender As Object, e As EventArgs) Handles btnForceGC.Click
        Try
            Dim beforeMemory As Long = GC.GetTotalMemory(False)
            
            ' ガベージコレクションを強制実行
            GC.Collect()
            GC.WaitForPendingFinalizers()
            GC.Collect()
            
            Dim afterMemory As Long = GC.GetTotalMemory(False)
            Dim freedMemory As Double = (beforeMemory - afterMemory) / 1024.0 / 1024.0
            
            LogManager.WriteLog($"Forced GC completed. Memory freed: {freedMemory:F2}MB", LogLevel.Info)
            ShowMessage($"ガベージコレクションを実行しました。解放メモリ: {freedMemory:F2}MB", "info")
            
            UpdatePerformanceMetrics()
            
        Catch ex As Exception
            LogManager.WriteLog($"Force GC error: {ex.Message}", LogLevel.Error)
            ShowMessage("ガベージコレクションの実行に失敗しました", "danger")
        End Try
    End Sub

    Private Sub ShowMessage(message As String, type As String)
        Dim script As String = $"
            setTimeout(function() {{
                var alertDiv = document.createElement('div');
                alertDiv.className = 'alert alert-{type} alert-dismissible fade show';
                alertDiv.innerHTML = '{HttpUtility.JavaScriptStringEncode(message)}<button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"alert\"></button>';
                document.querySelector('.container').insertBefore(alertDiv, document.querySelector('.container').firstChild);
                setTimeout(function() {{ alertDiv.remove(); }}, 5000);
            }}, 100);"
        
        ClientScript.RegisterStartupScript(Me.GetType(), "ShowMessage", script, True)
    End Sub
End Class</code></pre>
                        <h6>期待される結果</h6>
                        <p>パフォーマンス監視システムが正常に動作し、システムリソースの使用状況とアプリケーションの性能指標が適切に表示されます。</p>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>Try-Catch-Finally文の各ブロックの役割と使い分けを説明してください。</li>
                            <li>Application_Errorイベントでの適切なエラー処理手順を説明してください。</li>
                            <li>構造化ログの利点と実装時の考慮点を説明してください。</li>
                            <li>Visual Studioのブレークポイントの種類と使い分けを説明してください。</li>
                            <li>パフォーマンスカウンターで監視すべき主要な指標を3つ挙げてください。</li>
                            <li>プロダクション環境でのデバッグ設定で注意すべき点を説明してください。</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>Try: 例外が発生する可能性のあるコード、Catch: 例外処理、Finally: 必ず実行される後処理（リソース解放等）</li>
                                <li>例外情報のログ記録、ユーザーフレンドリーなエラーページへのリダイレクト、Server.ClearError()の実行</li>
                                <li>利点: 検索・分析容易、統一フォーマット。考慮点: パフォーマンス影響、ストレージ容量、セキュリティ</li>
                                <li>通常のブレークポイント、条件付きブレークポイント、アクションブレークポイント、一時的ブレークポイント</li>
                                <li>CPU使用率、メモリ使用量、リクエスト/秒、応答時間、エラー率など</li>
                                <li>debug="false"設定、カスタムエラーページ有効化、詳細エラー情報の非表示、ログレベル調整</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-7.html" class="btn btn-secondary">← 前の章</a>
                        <span class="btn btn-success disabled">完了 ✓</span>
                    </div>

                    <!-- 学習完了メッセージ -->
                    <div class="mt-5 p-4" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 10px; color: white;">
                        <h3 class="text-center mb-3">🎉 ASP.NET(VB.NET)学習完了おめでとうございます！</h3>
                        <p class="text-center mb-4">全8章の学習内容を通じて、ASP.NET Web Formsの基礎から応用まで幅広いスキルを身につけることができました。</p>
                        
                        <div class="row">
                            <div class="col-md-6">
                                <h5>習得したスキル</h5>
                                <ul>
                                    <li>ASP.NET Web Formsの基本概念</li>
                                    <li>VB.NETプログラミング</li>
                                    <li>データベース連携（ADO.NET）</li>
                                    <li>状態管理とセッション制御</li>
                                    <li>認証・認可システム</li>
                                    <li>セキュリティ対策</li>
                                    <li>エラーハンドリングとデバッグ</li>
                                </ul>
                            </div>
                            <div class="col-md-6">
                                <h5>次のステップ</h5>
                                <ul>
                                    <li><a href="../../microsoft/aspnet-core/README.md" class="text-white"><u>ASP.NET Core への移行</u></a></li>
                                    <li><a href="../../microsoft/entity-framework/README.md" class="text-white"><u>Entity Framework の学習</u></a></li>
                                    <li><a href="../../frontend/javascript-intermediate/README.md" class="text-white"><u>JavaScript 中級学習</u></a></li>
                                    <li>実際のプロジェクトでの実践</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>