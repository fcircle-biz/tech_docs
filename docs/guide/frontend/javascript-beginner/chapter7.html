<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript学習教材 第7章 - ToDoリストアプリを作ろう</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        code {
            display: block;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .highlight {
            background-color: #fff3e0;
            padding: 1rem;
            border-left: 4px solid #ff9800;
            margin: 1rem 0;
        }
        .project-container {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .demo-container {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">JavaScript学習ガイド</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../README.md">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">ガイド一覧</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading">学習内容</h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="chapter1.html">第1章: プログラミングって何？</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter2.html">第2章: 数字と文字を扱おう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter3.html">第3章: 条件によって処理を変えよう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter4.html">第4章: 繰り返し処理をマスターしよう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter5.html">第5章: 関数で処理をまとめよう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter6.html">第6章: Webページを操作しよう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter7">第7章: ToDoリストアプリを作ろう</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="chapter8.html">第8章: 電卓アプリを作ろう</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: ToDoリストアプリを作ろう</h1>
                </div>

                <div id="chapter7">
                    <div class="project-container">
                        <h5>🎯 この章の実践プロジェクト</h5>
                        <p><strong>本格的なToDoリストアプリケーション</strong>を作成します</p>
                        <p>これまで学んだ知識を総動員して、実用的なToDoリストアプリを作りましょう。データの永続化、状態管理など、実際のアプリ開発に必要なスキルを身につけます！</p>
                    </div>

                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>DOM操作の応用</li>
                            <li>動的な要素の追加・削除</li>
                            <li>ローカルストレージでのデータ保存</li>
                            <li>リスト操作の実践</li>
                            <li>完了・未完了の状態管理</li>
                        </ul>
                    </div>

                    <h2 class="chapter-title">ToDoリストアプリの設計</h2>
                    
                    <h3 class="section-title">7.1 必要な機能を整理しよう</h3>
                    <p>
                        まず、どんな機能が必要かを整理しましょう。実用的なToDoリストには以下の機能が必要です：
                    </p>
                    
                    <ul>
                        <li>📝 <strong>タスクの追加</strong>：新しいタスクを追加できる</li>
                        <li>✅ <strong>完了・未完了の切り替え</strong>：タスクの状態を変更できる</li>
                        <li>🗑️ <strong>タスクの削除</strong>：不要なタスクを削除できる</li>
                        <li>📊 <strong>進捗の表示</strong>：完了したタスクの数を表示</li>
                        <li>💾 <strong>データの保存</strong>：ページを更新しても内容が残る</li>
                        <li>🔍 <strong>フィルタリング</strong>：完了済み・未完了のタスクを絞り込める</li>
                    </ul>

                    <h3 class="section-title">7.2 データ構造を考える</h3>
                    <p>
                        ToDoリストのデータをどう管理するかを考えましょう。各タスクには以下の情報が必要です：
                    </p>
                    
                    <div class="exercise-container">
                        <h5>タスクデータの構造</h5>
                        <pre class="code-block"><code class="language-javascript">// タスクデータの例
const task = {
    id: 1,                    // 一意のID
    text: "JavaScript勉強",    // タスクの内容
    completed: false,         // 完了フラグ
    createdAt: new Date()     // 作成日時
};</code></pre>
                    </div>

                    <h2 class="chapter-title">ローカルストレージを使ってみよう</h2>

                    <h3 class="section-title">7.3 ローカルストレージとは</h3>
                    <p>
                        ローカルストレージは、<strong>ブラウザにデータを保存する機能</strong>です。
                        ページを更新したり、ブラウザを閉じたりしても、データが残り続けます。
                    </p>
                    
                    <div class="exercise-container">
                        <h5>実習 7-1: ローカルストレージの基本</h5>
                        <p>開発者ツールのコンソールで試してみましょう：</p>
                        <pre class="code-block"><code class="language-javascript">// データを保存
localStorage.setItem('myName', '太郎');
localStorage.setItem('myAge', '25');

// データを取得
let name = localStorage.getItem('myName');
let age = localStorage.getItem('myAge');

console.log('名前:', name);
console.log('年齢:', age);

// データを削除
localStorage.removeItem('myName');

// すべてのデータを削除
localStorage.clear();</code></pre>
                    </div>

                    <h3 class="section-title">7.4 配列データの保存</h3>
                    <p>
                        ローカルストレージは文字列しか保存できません。配列やオブジェクトを保存するには、JSONを使います。
                    </p>
                    
                    <div class="exercise-container">
                        <h5>実習 7-2: 配列をローカルストレージに保存</h5>
                        <pre class="code-block"><code class="language-javascript">// 配列を準備
let tasks = [
    { id: 1, text: "買い物", completed: false },
    { id: 2, text: "掃除", completed: true },
    { id: 3, text: "勉強", completed: false }
];

// JSON文字列に変換して保存
localStorage.setItem('tasks', JSON.stringify(tasks));

// 取得してJavaScriptオブジェクトに変換
let savedTasks = JSON.parse(localStorage.getItem('tasks'));
console.log(savedTasks);</code></pre>
                    </div>

                    <h2 class="chapter-title">動的な要素の追加・削除</h2>

                    <h3 class="section-title">7.5 DOM要素を動的に作成する</h3>
                    <p>
                        JavaScriptでHTML要素を動的に作成・削除する方法を学びましょう。
                    </p>
                    
                    <div class="exercise-container">
                        <h5>実習 7-3: 要素の動的作成</h5>
                        <pre class="code-block"><code class="language-javascript">// 新しい要素を作成
let newDiv = document.createElement('div');
newDiv.textContent = '新しい要素';
newDiv.className = 'my-class';

// 要素を追加
document.body.appendChild(newDiv);

// 要素を削除
newDiv.remove();</code></pre>
                    </div>

                    <h2 class="chapter-title">実践プロジェクト：ToDoリストアプリ</h2>

                    <div class="project-container">
                        <h5>🎯 プロジェクト: 本格的なToDoリストアプリを作ろう</h5>
                        <p>これまで学んだ知識を使って、実用的なToDoリストアプリを作成しましょう。</p>
                        
                        <h6>ステップ1: HTML構造を作成</h6>
                        <p>まずはアプリのHTML構造を作ります：</p>
                        <pre class="code-block"><code class="language-javascript">&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;ToDoリストアプリ&lt;/title&gt;
    &lt;style&gt;
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        .input-section {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .task-input {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        .add-button {
            padding: 12px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .add-button:hover {
            background-color: #0056b3;
        }
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .filter-button {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background-color: white;
            border-radius: 5px;
            cursor: pointer;
        }
        .filter-button.active {
            background-color: #007bff;
            color: white;
        }
        .task-list {
            list-style: none;
            padding: 0;
        }
        .task-item {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
        }
        .task-item.completed {
            opacity: 0.6;
        }
        .task-checkbox {
            margin-right: 15px;
        }
        .task-text {
            flex: 1;
            font-size: 16px;
        }
        .task-text.completed {
            text-decoration: line-through;
        }
        .delete-button {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 3px;
            cursor: pointer;
        }
        .delete-button:hover {
            background-color: #c82333;
        }
        .stats {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            background-color: #e9ecef;
            border-radius: 5px;
        }
        .empty-state {
            text-align: center;
            color: #6c757d;
            padding: 40px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container"&gt;
        &lt;div class="header"&gt;
            &lt;h1&gt;📝 ToDoリスト&lt;/h1&gt;
        &lt;/div&gt;
        
        &lt;div class="input-section"&gt;
            &lt;input type="text" class="task-input" id="taskInput" placeholder="新しいタスクを入力..."&gt;
            &lt;button class="add-button" id="addButton"&gt;追加&lt;/button&gt;
        &lt;/div&gt;
        
        &lt;div class="filters"&gt;
            &lt;button class="filter-button active" data-filter="all"&gt;すべて&lt;/button&gt;
            &lt;button class="filter-button" data-filter="active"&gt;未完了&lt;/button&gt;
            &lt;button class="filter-button" data-filter="completed"&gt;完了済み&lt;/button&gt;
        &lt;/div&gt;
        
        &lt;ul class="task-list" id="taskList"&gt;&lt;/ul&gt;
        
        &lt;div class="stats" id="stats"&gt;&lt;/div&gt;
    &lt;/div&gt;
    
    &lt;script&gt;
        // JavaScript コードをここに書きます
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

                        <h6>ステップ2: データ管理とローカルストレージ</h6>
                        <p>タスクデータの管理とローカルストレージの機能を実装します：</p>
                        <pre class="code-block"><code class="language-javascript">// アプリケーションの状態管理
class TodoApp {
    constructor() {
        this.tasks = [];
        this.currentFilter = 'all';
        this.nextId = 1;
        
        // DOM要素の取得
        this.taskInput = document.getElementById('taskInput');
        this.addButton = document.getElementById('addButton');
        this.taskList = document.getElementById('taskList');
        this.stats = document.getElementById('stats');
        this.filterButtons = document.querySelectorAll('.filter-button');
        
        // イベントリスナーの設定
        this.setupEventListeners();
        
        // 保存されたデータを読み込み
        this.loadTasks();
        
        // 初期表示
        this.render();
    }
    
    // ローカルストレージからタスクを読み込み
    loadTasks() {
        const savedTasks = localStorage.getItem('todoTasks');
        if (savedTasks) {
            this.tasks = JSON.parse(savedTasks);
            // 次のIDを計算
            this.nextId = Math.max(...this.tasks.map(task => task.id), 0) + 1;
        }
    }
    
    // ローカルストレージにタスクを保存
    saveTasks() {
        localStorage.setItem('todoTasks', JSON.stringify(this.tasks));
    }
    
    // イベントリスナーの設定
    setupEventListeners() {
        // 追加ボタンのクリック
        this.addButton.addEventListener('click', () => this.addTask());
        
        // Enterキーでの追加
        this.taskInput.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                this.addTask();
            }
        });
        
        // フィルターボタンのクリック
        this.filterButtons.forEach(button => {
            button.addEventListener('click', (e) => {
                this.setFilter(e.target.dataset.filter);
            });
        });
    }
}</code></pre>

                        <h6>ステップ3: タスクの追加・削除・更新機能</h6>
                        <p>タスクの基本的な操作機能を実装します：</p>
                        <pre class="code-block"><code class="language-javascript">    // タスクを追加
    addTask() {
        const text = this.taskInput.value.trim();
        
        if (text === '') {
            alert('タスクを入力してください');
            return;
        }
        
        const newTask = {
            id: this.nextId++,
            text: text,
            completed: false,
            createdAt: new Date().toISOString()
        };
        
        this.tasks.push(newTask);
        this.taskInput.value = '';
        this.saveTasks();
        this.render();
    }
    
    // タスクを削除
    deleteTask(id) {
        this.tasks = this.tasks.filter(task => task.id !== id);
        this.saveTasks();
        this.render();
    }
    
    // タスクの完了状態を切り替え
    toggleTask(id) {
        const task = this.tasks.find(task => task.id === id);
        if (task) {
            task.completed = !task.completed;
            this.saveTasks();
            this.render();
        }
    }
    
    // フィルターを設定
    setFilter(filter) {
        this.currentFilter = filter;
        
        // フィルターボタンの状態を更新
        this.filterButtons.forEach(button => {
            button.classList.toggle('active', button.dataset.filter === filter);
        });
        
        this.render();
    }
    
    // 表示するタスクをフィルター
    getFilteredTasks() {
        switch (this.currentFilter) {
            case 'active':
                return this.tasks.filter(task => !task.completed);
            case 'completed':
                return this.tasks.filter(task => task.completed);
            default:
                return this.tasks;
        }
    }</code></pre>

                        <h6>ステップ4: 画面表示とユーザーインターフェース</h6>
                        <p>最後に、画面表示とユーザーインターフェースを実装します：</p>
                        <pre class="code-block"><code class="language-javascript">    // 画面を更新
    render() {
        this.renderTasks();
        this.renderStats();
    }
    
    // タスクリストを表示
    renderTasks() {
        const filteredTasks = this.getFilteredTasks();
        
        if (filteredTasks.length === 0) {
            this.taskList.innerHTML = `
                &lt;div class="empty-state"&gt;
                    ${this.tasks.length === 0 ? '📝 最初のタスクを追加してみましょう！' : '該当するタスクがありません'}
                &lt;/div&gt;
            `;
            return;
        }
        
        this.taskList.innerHTML = filteredTasks.map(task => `
            &lt;li class="task-item ${task.completed ? 'completed' : ''}"&gt;
                &lt;input 
                    type="checkbox" 
                    class="task-checkbox" 
                    ${task.completed ? 'checked' : ''} 
                    onclick="app.toggleTask(${task.id})"
                &gt;
                &lt;span class="task-text ${task.completed ? 'completed' : ''}"&gt;
                    ${this.escapeHtml(task.text)}
                &lt;/span&gt;
                &lt;button class="delete-button" onclick="app.deleteTask(${task.id})"&gt;
                    削除
                &lt;/button&gt;
            &lt;/li&gt;
        `).join('');
    }
    
    // 統計情報を表示
    renderStats() {
        const total = this.tasks.length;
        const completed = this.tasks.filter(task => task.completed).length;
        const active = total - completed;
        
        this.stats.innerHTML = `
            📊 統計: 全体 ${total}件 | 完了 ${completed}件 | 未完了 ${active}件
        `;
    }
    
    // HTMLエスケープ（セキュリティ対策）
    escapeHtml(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
    }
    
    // 全ての完了済みタスクを削除
    clearCompleted() {
        this.tasks = this.tasks.filter(task => !task.completed);
        this.saveTasks();
        this.render();
    }
}

// アプリケーションを初期化
const app = new TodoApp();</code></pre>

                        <h6>ステップ5: 追加機能の実装</h6>
                        <p>さらに便利な機能を追加しましょう：</p>
                        <pre class="code-block"><code class="language-javascript">// 追加機能をTodoAppクラスに追加

    // 全選択/全解除の切り替え
    toggleAll() {
        const allCompleted = this.tasks.every(task => task.completed);
        this.tasks.forEach(task => {
            task.completed = !allCompleted;
        });
        this.saveTasks();
        this.render();
    }
    
    // タスクの編集
    editTask(id, newText) {
        const task = this.tasks.find(task => task.id === id);
        if (task && newText.trim() !== '') {
            task.text = newText.trim();
            this.saveTasks();
            this.render();
        }
    }
    
    // データのエクスポート
    exportTasks() {
        const data = {
            tasks: this.tasks,
            exportDate: new Date().toISOString()
        };
        
        const dataStr = JSON.stringify(data, null, 2);
        const blob = new Blob([dataStr], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        
        const a = document.createElement('a');
        a.href = url;
        a.download = 'todo-tasks.json';
        a.click();
        
        URL.revokeObjectURL(url);
    }
    
    // 統計情報の詳細表示
    getDetailedStats() {
        const now = new Date();
        const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
        
        const todayTasks = this.tasks.filter(task => {
            const taskDate = new Date(task.createdAt);
            return taskDate >= today;
        });
        
        return {
            total: this.tasks.length,
            completed: this.tasks.filter(task => task.completed).length,
            active: this.tasks.filter(task => !task.completed).length,
            todayAdded: todayTasks.length,
            todayCompleted: todayTasks.filter(task => task.completed).length
        };
    }
}</code></pre>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>ローカルストレージにデータを保存するメソッドは何ですか？</li>
                            <li>ローカルストレージからデータを取得するメソッドは何ですか？</li>
                            <li>配列をローカルストレージに保存するときに使う変換方法は何ですか？</li>
                            <li>HTML要素を動的に作成するメソッドは何ですか？</li>
                            <li>作成した要素をDOMに追加するメソッドは何ですか？</li>
                        </ol>
                        
                        <h6>答え</h6>
                        <ol>
                            <li>localStorage.setItem()</li>
                            <li>localStorage.getItem()</li>
                            <li>JSON.stringify() / JSON.parse()</li>
                            <li>document.createElement()</li>
                            <li>appendChild()</li>
                        </ol>
                    </div>

                    <h2 class="chapter-title">章のまとめ</h2>
                    <p>この章では以下のことを学びました：</p>
                    <ul>
                        <li>ローカルストレージを使ったデータの永続化</li>
                        <li>DOM操作による動的な要素の追加・削除</li>
                        <li>配列を使ったデータの管理</li>
                        <li>フィルタリング機能の実装</li>
                        <li>実用的なWebアプリケーションの構築</li>
                    </ul>

                    <div class="highlight">
                        <h5>第7章クリア条件</h5>
                        <p>次の章に進む前に、以下ができるようになったか確認してください：</p>
                        <ul>
                            <li>☐ ToDoの追加・削除ができる</li>
                            <li>☐ ローカルストレージにデータを保存できる</li>
                            <li>☐ 完了・未完了の状態を切り替えられる</li>
                            <li>☐ ToDoリストアプリが完成している</li>
                        </ul>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="chapter6.html" class="btn btn-secondary">← 前の章</a>
                        <a href="chapter8.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
</body>
</html>