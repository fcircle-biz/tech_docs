<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計解析学習教材 第6章 - 分散分析とカイ二乗検定</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; background-color: #f8f9fa; }
        .navbar { background-color: #1e88e5; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #ffffff; border-right: 1px solid #dee2e6; padding: 1rem; }
        .sidebar .nav-link { color: #495057; padding: 0.5rem 1rem; border-radius: 5px; margin-bottom: 0.25rem; }
        .sidebar .nav-link:hover { background-color: #e3f2fd; }
        .sidebar .nav-link.active { background-color: #1e88e5 !important; color: white !important; }
        .chapter-title { color: #1e88e5; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 3px solid #1e88e5; padding-bottom: 0.5rem; }
        .section-title { color: #42a5f5; margin-top: 2rem; margin-bottom: 1rem; border-left: 4px solid #42a5f5; padding-left: 0.75rem; }
        .highlight { background-color: #fff3e0; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #ff9800; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #1e88e5; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .code-block { background-color: #1e1e1e; color: white; border-radius: 5px; padding: 1rem; margin: 1rem 0; overflow-x: auto; }
        main { background-color: #ffffff; min-height: calc(100vh - 56px); padding: 2rem; }
        footer { margin-top: 3rem; background-color: #1e88e5; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid"><a class="navbar-brand" href="#"><strong>統計解析学習教材</strong></a></div>
    </nav>
    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>学習章</span></h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-01.html">第1章: 統計解析入門と環境構築</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-02.html">第2章: 記述統計学の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-03.html">第3章: 確率の基礎と確率分布</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-04.html">第4章: 推測統計の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-05.html">第5章: 仮説検定の基礎</a></li>
                        <li class="nav-item"><a class="nav-link active" href="statistical-analysis-learning-material-06.html">第6章: 分散分析とカイ二乗検定</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-07.html">第7章: 相関と回帰分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-08.html">第8章: 多変量解析入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-09.html">第9章: ベイズ統計と時系列分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-10.html">第10章: ノンパラメトリック検定と実践プロジェクト</a></li>
                    </ul>
                </div>
            </nav>
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第6章: 分散分析とカイ二乗検定</h1>
                </div>
                <div id="chapter6">
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>分散分析（ANOVA）の目的と実行方法を理解する</li>
                            <li>多重比較法を使って群間の差を特定できる</li>
                            <li>カイ二乗検定を使ってカテゴリカルデータを分析できる</li>
                            <li>効果量の概念と重要性を理解する</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.1 一元配置分散分析（One-way ANOVA）</h3>
                    <h4>ANOVAとは</h4>
                    <p>
                        分散分析（Analysis of Variance, ANOVA）は、3つ以上のグループの平均値を同時に比較する手法です。
                        t検定を繰り返すと第1種の誤りが増加するため、複数グループの比較にはANOVAを使います。
                    </p>

                    <h4>ANOVAの基本原理</h4>
                    <p>
                        ANOVAは、全体の変動を「群間変動」と「群内変動」に分解し、F統計量を計算します：<br>
                        F = 群間変動 / 群内変動
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 一元配置分散分析
# 3つの肥料の効果を比較
fertilizer_A <- c(20, 22, 19, 21, 23)
fertilizer_B <- c(28, 30, 27, 29, 31)
fertilizer_C <- c(18, 20, 17, 19, 21)

# データフレームの作成
data <- data.frame(
  yield = c(fertilizer_A, fertilizer_B, fertilizer_C),
  group = factor(rep(c("A", "B", "C"), each=5))
)

# 一元配置分散分析
result <- aov(yield ~ group, data=data)
summary(result)

# F値とp値を確認
print(summary(result))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 一元配置分散分析
from scipy import stats

fertilizer_A = [20, 22, 19, 21, 23]
fertilizer_B = [28, 30, 27, 29, 31]
fertilizer_C = [18, 20, 17, 19, 21]

# 一元配置分散分析
f_stat, p_value = stats.f_oneway(fertilizer_A,
                                   fertilizer_B,
                                   fertilizer_C)

print(f"F統計量: {f_stat}")
print(f"p値: {p_value}")</code></pre>

                    <h3 class="section-title">6.2 多重比較法</h3>
                    <h4>多重比較の必要性</h4>
                    <p>
                        ANOVAで有意差が認められた場合、どの群間に差があるかを特定するために多重比較を行います。
                        TukeyのHSD法やBonferroni法が一般的です。
                    </p>

                    <pre class="code-block"><code class="language-r"># R: TukeyのHSD法による多重比較
# 上記のANOVA結果に対して
tukey_result <- TukeyHSD(result)
print(tukey_result)

# 可視化
plot(tukey_result)</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 多重比較（statsmodels使用）
import pandas as pd
from statsmodels.stats.multicomp import pairwise_tukeyhsd

# データフレームの作成
data = pd.DataFrame({
    'yield': [20,22,19,21,23,28,30,27,29,31,18,20,17,19,21],
    'group': ['A']*5 + ['B']*5 + ['C']*5
})

# TukeyのHSD法
tukey = pairwise_tukeyhsd(data['yield'], data['group'])
print(tukey)</code></pre>

                    <h3 class="section-title">6.3 カイ二乗検定</h3>
                    <h4>カイ二乗検定とは</h4>
                    <p>
                        カイ二乗検定は、カテゴリカルデータの分析に使われます。
                        観測度数と期待度数の差を評価し、変数間の独立性や適合度を検定します。
                    </p>

                    <h4>独立性の検定</h4>
                    <p>2つのカテゴリカル変数が独立かどうかを検定します（クロス集計表の分析）。</p>

                    <pre class="code-block"><code class="language-r"># R: カイ二乗独立性検定
# 性別と商品嗜好の関連性を調査
data_matrix <- matrix(c(30, 20, 15, 35), nrow=2,
                       dimnames = list(
                         c("男性", "女性"),
                         c("商品A", "商品B")
                       ))

# カイ二乗検定
chi_result <- chisq.test(data_matrix)
print(chi_result)

# 期待度数の確認
print(chi_result$expected)</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: カイ二乗独立性検定
from scipy.stats import chi2_contingency
import numpy as np

# クロス集計表
observed = np.array([[30, 20],
                     [15, 35]])

# カイ二乗検定
chi2, p_value, dof, expected = chi2_contingency(observed)

print(f"カイ二乗統計量: {chi2}")
print(f"p値: {p_value}")
print(f"自由度: {dof}")
print(f"期待度数:\n{expected}")</code></pre>

                    <h4>適合度検定</h4>
                    <p>観測されたデータが特定の理論分布に従うかを検定します。</p>

                    <pre class="code-block"><code class="language-r"># R: カイ二乗適合度検定
# サイコロの出目が均等かを検定
observed <- c(48, 52, 50, 47, 53, 50)  # 各目の出現回数
expected <- rep(50, 6)  # 期待度数（均等なら各50回）

# 適合度検定
chi_result <- chisq.test(observed, p=rep(1/6, 6))
print(chi_result)</code></pre>

                    <h3 class="section-title">6.4 効果量</h3>
                    <h4>効果量の重要性</h4>
                    <p>
                        統計的有意性（p値）だけでは効果の大きさはわかりません。
                        効果量は、実質的な差の大きさを評価する指標です。
                    </p>

                    <h4>Cohen's d（効果量の指標）</h4>
                    <p>2群間の平均差を標準偏差で標準化した指標：</p>
                    <ul>
                        <li>小さい効果: d = 0.2</li>
                        <li>中程度の効果: d = 0.5</li>
                        <li>大きい効果: d = 0.8</li>
                    </ul>

                    <pre class="code-block"><code class="language-r"># R: Cohen's dの計算（effsize パッケージ）
# install.packages("effsize")
library(effsize)

group1 <- c(75, 82, 78, 85, 80)
group2 <- c(68, 72, 70, 75, 71)

# Cohen's dの計算
cohen_d <- cohen.d(group1, group2)
print(cohen_d)</code></pre>

                    <div class="exercise-container">
                        <h5>実習 6-1: 分散分析とカイ二乗検定の実践</h5>
                        <p><strong>課題1: 一元配置ANOVA</strong></p>
                        <p>
                            3つの異なる教育方法（A, B, C）で学生の成績に差があるかを調べます：<br>
                            方法A: 78, 82, 80, 85, 79<br>
                            方法B: 85, 88, 90, 87, 89<br>
                            方法C: 75, 77, 76, 78, 74
                        </p>
                        <ol>
                            <li>一元配置分散分析を実行</li>
                            <li>有意差がある場合、TukeyのHSD法で群間比較</li>
                        </ol>

                        <p><strong>課題2: カイ二乗検定</strong></p>
                        <p>
                            性別と運動習慣の関連を調査したクロス集計表：<br>
                            運動する（男性40人、女性30人）<br>
                            運動しない（男性20人、女性50人）
                        </p>
                        <p>性別と運動習慣に関連があるかを検定してください。</p>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>3つ以上のグループを比較する際、t検定を繰り返すのではなくANOVAを使う理由は？</li>
                            <li>多重比較法が必要になるのはどのような場合ですか？</li>
                            <li>カイ二乗検定で使用する「期待度数」とは何ですか？</li>
                            <li>統計的有意性と効果量の違いを説明してください。</li>
                            <li>Cohen's d = 0.3 の場合、効果の大きさをどう評価しますか？</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4 mb-4">
                        <a href="statistical-analysis-learning-material-05.html" class="btn btn-secondary">← 前の章</a>
                        <a href="statistical-analysis-learning-material-07.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    <footer class="text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>本資料はAIツールを活用し、人間による編集・監修のもと作成されています。</p>
                </div>
            </div>
        </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
</body>
</html>