<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計解析学習教材 第3章 - 確率の基礎と確率分布</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
            background-color: #f8f9fa;
        }

        .navbar {
            background-color: #1e88e5;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #ffffff;
            border-right: 1px solid #dee2e6;
            padding: 1rem;
        }

        .sidebar .nav-link {
            color: #495057;
            padding: 0.5rem 1rem;
            border-radius: 5px;
            margin-bottom: 0.25rem;
        }

        .sidebar .nav-link:hover {
            background-color: #e3f2fd;
        }

        .sidebar .nav-link.active {
            background-color: #1e88e5 !important;
            color: white !important;
        }

        .chapter-title {
            color: #1e88e5;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #1e88e5;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-left: 4px solid #42a5f5;
            padding-left: 0.75rem;
        }

        .highlight {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #ff9800;
        }

        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1e88e5;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        main {
            background-color: #ffffff;
            min-height: calc(100vh - 56px);
            padding: 2rem;
        }

        footer {
            margin-top: 3rem;
            background-color: #1e88e5;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fas fa-chart-bar"></i>
                <strong>統計解析学習教材</strong>
            </a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-01.html">第1章: 統計解析入門と環境構築</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-02.html">第2章: 記述統計学の基礎</a></li>
                        <li class="nav-item"><a class="nav-link active" href="statistical-analysis-learning-material-03.html">第3章: 確率の基礎と確率分布</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-04.html">第4章: 推測統計の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-05.html">第5章: 仮説検定の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-06.html">第6章: 分散分析とカイ二乗検定</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-07.html">第7章: 相関と回帰分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-08.html">第8章: 多変量解析入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-09.html">第9章: ベイズ統計と時系列分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-10.html">第10章: ノンパラメトリック検定と実践プロジェクト</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: 確率の基礎と確率分布</h1>
                </div>

                <div id="chapter3">
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>確率の基本概念と確率変数を理解する</li>
                            <li>正規分布の性質と標準化を理解し活用できる</li>
                            <li>二項分布とポアソン分布の適用場面を理解する</li>
                            <li>確率分布のパラメータ推定ができる</li>
                        </ul>
                    </div>

                    <h3 class="section-title">3.1 確率の基礎</h3>

                    <h4>確率とは</h4>
                    <p>
                        確率は、ある事象が起こる可能性を0から1の数値で表したものです。
                        0は絶対に起こらない、1は必ず起こることを意味し、0.5は50%の確率で起こることを意味します。
                    </p>

                    <div class="mermaid">
                        flowchart TB
                            A[確率の基礎概念] --> B[確率変数]
                            A --> C[確率分布]

                            B --> B1["離散型確率変数<br/>(コイン投げ、サイコロ)"]
                            B --> B2["連続型確率変数<br/>(身長、体重)"]

                            C --> C1["離散型分布<br/>(二項分布、ポアソン分布)"]
                            C --> C2["連続型分布<br/>(正規分布、指数分布)"]

                            style A fill:#e3f2fd
                            style B fill:#fff3e0
                            style C fill:#fff3e0
                    </div>

                    <h4>確率の基本性質</h4>
                    <ul>
                        <li><strong>非負性</strong>: すべての事象Aについて、P(A) ≥ 0</li>
                        <li><strong>全体性</strong>: すべての事象の確率の和は1（P(全体) = 1）</li>
                        <li><strong>加法性</strong>: 排反事象（同時に起こらない事象）では P(A∪B) = P(A) + P(B)</li>
                    </ul>

                    <h4>条件付き確率</h4>
                    <p>
                        事象Bが起こったという条件のもとで事象Aが起こる確率を条件付き確率といい、P(A|B)と表記します。
                        条件付き確率は、P(A|B) = P(A∩B) / P(B) で計算されます。
                    </p>

                    <h3 class="section-title">3.2 正規分布（ガウス分布）</h3>

                    <h4>正規分布の特徴</h4>
                    <p>
                        正規分布は自然界や社会現象で最も頻繁に現れる分布で、左右対称の釣鐘型（ベル型）をしています。
                        平均μと標準偏差σの2つのパラメータで特徴づけられます。
                    </p>

                    <h4>68-95-99.7ルール</h4>
                    <p>正規分布に従うデータは、以下の範囲に含まれます：</p>
                    <ul>
                        <li>約68%のデータが平均±1標準偏差の範囲に含まれる</li>
                        <li>約95%のデータが平均±2標準偏差の範囲に含まれる</li>
                        <li>約99.7%のデータが平均±3標準偏差の範囲に含まれる</li>
                    </ul>

                    <h4>正規分布の計算（R）</h4>
                    <pre class="code-block"><code class="language-r"># 正規分布の確率密度（PDF）
x <- seq(-4, 4, length=100)
y <- dnorm(x, mean=0, sd=1)  # 標準正規分布
plot(x, y, type="l", main="標準正規分布",
     xlab="値", ylab="確率密度")

# 累積分布関数（CDF）：P(X ≤ x)
prob <- pnorm(1.96)  # P(X ≤ 1.96)
print(paste("P(X ≤ 1.96):", prob))

# 分位点：上側5%点
quantile_95 <- qnorm(0.95)
print(paste("上側5%点:", quantile_95))

# 乱数生成
random_samples <- rnorm(100, mean=50, sd=10)</code></pre>

                    <h4>正規分布の計算（Python）</h4>
                    <pre class="code-block"><code class="language-python">from scipy import stats
import numpy as np
import matplotlib.pyplot as plt

# 標準正規分布の可視化
x = np.linspace(-4, 4, 100)
y = stats.norm.pdf(x, loc=0, scale=1)
plt.plot(x, y)
plt.title('標準正規分布')
plt.xlabel('値')
plt.ylabel('確率密度')
plt.show()

# 累積分布関数：P(X ≤ x)
prob = stats.norm.cdf(1.96)
print(f"P(X ≤ 1.96): {prob}")

# 分位点
quantile_95 = stats.norm.ppf(0.95)
print(f"上側5%点: {quantile_95}")</code></pre>

                    <h4>標準化（z得点）</h4>
                    <p>
                        任意の正規分布を標準正規分布（平均0、標準偏差1）に変換する操作を標準化といいます。
                        z = (x - μ) / σ で計算され、これをz得点（z-score）と呼びます。
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 標準化の例
scores <- c(75, 82, 90, 68, 95)
z_scores <- scale(scores)  # 標準化
print(z_scores)</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 標準化の例
from scipy import stats
scores = [75, 82, 90, 68, 95]
z_scores = stats.zscore(scores)
print(z_scores)</code></pre>

                    <h3 class="section-title">3.3 二項分布</h3>

                    <h4>二項分布とは</h4>
                    <p>
                        二項分布は、成功確率pの試行をn回繰り返したときに、成功する回数の分布を表します。
                        コイン投げ、不良品の検査、アンケートの「はい/いいえ」などに適用されます。
                    </p>

                    <h4>二項分布のパラメータ</h4>
                    <ul>
                        <li><strong>n</strong>: 試行回数</li>
                        <li><strong>p</strong>: 各試行の成功確率</li>
                        <li><strong>期待値</strong>: E(X) = n × p</li>
                        <li><strong>分散</strong>: Var(X) = n × p × (1-p)</li>
                    </ul>

                    <pre class="code-block"><code class="language-r"># R: 二項分布の計算
n <- 10      # 試行回数
p <- 0.3     # 成功確率

# 確率質量関数：ちょうどk回成功する確率
k <- 3
prob_k <- dbinom(k, size=n, prob=p)
print(paste("ちょうど3回成功する確率:", prob_k))

# 累積分布：k回以下成功する確率
prob_less_equal <- pbinom(3, size=n, prob=p)
print(paste("3回以下成功する確率:", prob_less_equal))

# 二項分布の可視化
x <- 0:n
y <- dbinom(x, size=n, prob=p)
barplot(y, names.arg=x, main="二項分布(n=10, p=0.3)")</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 二項分布の計算
from scipy import stats

n = 10  # 試行回数
p = 0.3 # 成功確率

# ちょうどk回成功する確率
k = 3
prob_k = stats.binom.pmf(k, n, p)
print(f"ちょうど3回成功する確率: {prob_k}")

# k回以下成功する確率
prob_less_equal = stats.binom.cdf(3, n, p)
print(f"3回以下成功する確率: {prob_less_equal}")

# 二項分布の可視化
import matplotlib.pyplot as plt
x = range(0, n+1)
y = [stats.binom.pmf(i, n, p) for i in x]
plt.bar(x, y)
plt.title('二項分布 (n=10, p=0.3)')
plt.show()</code></pre>

                    <h3 class="section-title">3.4 ポアソン分布</h3>

                    <h4>ポアソン分布とは</h4>
                    <p>
                        ポアソン分布は、一定時間や一定区間内に稀な事象が発生する回数をモデル化します。
                        交通事故の発生数、電話の着信数、ウェブサイトの訪問者数などに適用されます。
                    </p>

                    <h4>ポアソン分布のパラメータ</h4>
                    <ul>
                        <li><strong>λ（ラムダ）</strong>: 単位時間あたりの平均発生率</li>
                        <li><strong>期待値</strong>: E(X) = λ</li>
                        <li><strong>分散</strong>: Var(X) = λ</li>
                    </ul>

                    <pre class="code-block"><code class="language-r"># R: ポアソン分布の計算
lambda <- 4  # 平均発生率

# ちょうどk回発生する確率
k <- 3
prob_k <- dpois(k, lambda=lambda)
print(paste("ちょうど3回発生する確率:", prob_k))

# k回以下発生する確率
prob_less_equal <- ppois(3, lambda=lambda)
print(paste("3回以下発生する確率:", prob_less_equal))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: ポアソン分布の計算
from scipy import stats

lambda_val = 4  # 平均発生率

# ちょうどk回発生する確率
k = 3
prob_k = stats.poisson.pmf(k, lambda_val)
print(f"ちょうど3回発生する確率: {prob_k}")

# k回以下発生する確率
prob_less_equal = stats.poisson.cdf(3, lambda_val)
print(f"3回以下発生する確率: {prob_less_equal}")</code></pre>

                    <div class="exercise-container">
                        <h5>実習 3-1: 確率分布を使った実践問題</h5>
                        <p><strong>問題1: 製品の品質管理（正規分布）</strong></p>
                        <p>
                            ある製品の重量は平均500g、標準偏差10gの正規分布に従います。
                            480g以下の製品は規格外とします。規格外となる確率を計算してください。
                        </p>

                        <h6>解答例（R）</h6>
                        <pre class="code-block"><code class="language-r"># 規格外となる確率 P(X ≤ 480)
prob_defect <- pnorm(480, mean=500, sd=10)
print(paste("規格外率:", prob_defect * 100, "%"))</code></pre>

                        <p><strong>問題2: 不良品の検査（二項分布）</strong></p>
                        <p>
                            不良率5%の製品から10個を無作為に抽出します。
                            不良品が2個以上含まれる確率を計算してください。
                        </p>

                        <h6>解答例（Python）</h6>
                        <pre class="code-block"><code class="language-python">from scipy import stats

# P(X ≥ 2) = 1 - P(X ≤ 1)
prob = 1 - stats.binom.cdf(1, n=10, p=0.05)
print(f"不良品が2個以上含まれる確率: {prob}")</code></pre>

                        <p><strong>問題3: 顧客の来店数（ポアソン分布）</strong></p>
                        <p>
                            店舗への1時間あたりの平均来店数は8人です。
                            次の1時間に10人以上来店する確率を計算してください。
                        </p>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>標準正規分布の平均と標準偏差はそれぞれいくつですか？</li>
                            <li>二項分布のパラメータnとpは何を表しますか？</li>
                            <li>ポアソン分布が適用される具体的な例を3つ挙げてください。</li>
                            <li>z得点が2.0の場合、その値は平均から標準偏差何個分離れていますか？</li>
                            <li>正規分布において、平均±2標準偏差の範囲にデータが含まれる確率は約何%ですか？</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4 mb-4">
                        <a href="statistical-analysis-learning-material-02.html" class="btn btn-secondary">← 前の章</a>
                        <a href="statistical-analysis-learning-material-04.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <footer class="text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>