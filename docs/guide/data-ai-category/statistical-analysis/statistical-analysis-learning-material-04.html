<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>統計解析学習教材 第4章 - 推測統計の基礎</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; background-color: #f8f9fa; }
        .navbar { background-color: #1e88e5; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #ffffff; border-right: 1px solid #dee2e6; padding: 1rem; }
        .sidebar .nav-link { color: #495057; padding: 0.5rem 1rem; border-radius: 5px; margin-bottom: 0.25rem; }
        .sidebar .nav-link:hover { background-color: #e3f2fd; }
        .sidebar .nav-link.active { background-color: #1e88e5 !important; color: white !important; }
        .chapter-title { color: #1e88e5; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 3px solid #1e88e5; padding-bottom: 0.5rem; }
        .section-title { color: #42a5f5; margin-top: 2rem; margin-bottom: 1rem; border-left: 4px solid #42a5f5; padding-left: 0.75rem; }
        .highlight { background-color: #fff3e0; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #ff9800; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #1e88e5; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .code-block { background-color: #1e1e1e; color: white; border-radius: 5px; padding: 1rem; margin: 1rem 0; overflow-x: auto; }
        main { background-color: #ffffff; min-height: calc(100vh - 56px); padding: 2rem; }
        footer { margin-top: 3rem; background-color: #1e88e5; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><i class="fas fa-chart-bar"></i><strong>統計解析学習教材</strong></a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"><span>学習章</span></h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-01.html">第1章: 統計解析入門と環境構築</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-02.html">第2章: 記述統計学の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-03.html">第3章: 確率の基礎と確率分布</a></li>
                        <li class="nav-item"><a class="nav-link active" href="statistical-analysis-learning-material-04.html">第4章: 推測統計の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-05.html">第5章: 仮説検定の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-06.html">第6章: 分散分析とカイ二乗検定</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-07.html">第7章: 相関と回帰分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-08.html">第8章: 多変量解析入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-09.html">第9章: ベイズ統計と時系列分析</a></li>
                        <li class="nav-item"><a class="nav-link" href="statistical-analysis-learning-material-10.html">第10章: ノンパラメトリック検定と実践プロジェクト</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第4章: 推測統計の基礎</h1>
                </div>

                <div id="chapter4">
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>標本と母集団の関係を理解する</li>
                            <li>標本分布と中心極限定理の重要性を理解する</li>
                            <li>点推定と区間推定の違いを理解する</li>
                            <li>信頼区間を計算し、適切に解釈できる</li>
                        </ul>
                    </div>

                    <h3 class="section-title">4.1 標本と母集団</h3>

                    <h4>母集団と標本の関係</h4>
                    <p>
                        <strong>母集団</strong>とは、調査対象となる全体の集合です。<strong>標本</strong>は母集団から抽出された一部のデータです。
                        統計解析では、標本から得られた情報をもとに、母集団全体の特性を推測します。
                    </p>

                    <div class="mermaid">
                        flowchart TB
                            A["母集団<br/>(全体)"] -->|無作為抽出| B["標本<br/>(一部)"]
                            B --> C["標本統計量<br/>(平均、分散など)"]
                            C -->|推測| D["母数<br/>(μ, σなど)"]

                            style A fill:#e3f2fd
                            style B fill:#fff3e0
                            style C fill:#f3e5f5
                            style D fill:#e3f2fd
                    </div>

                    <h4>無作為標本抽出の重要性</h4>
                    <p>
                        推測統計では、標本が母集団を代表していることが前提となります。
                        そのため、すべての個体が等しい確率で選ばれる<strong>無作為抽出</strong>が重要です。
                    </p>

                    <h4>標本サイズと推定精度</h4>
                    <p>
                        標本サイズ（n）が大きいほど、推定の精度は向上します。
                        一般的に、標本サイズが大きくなると標準誤差は√nに反比例して小さくなります。
                    </p>

                    <h3 class="section-title">4.2 中心極限定理</h3>

                    <h4>中心極限定理とは</h4>
                    <p>
                        中心極限定理は、推測統計の基礎となる重要な定理です。
                        「母集団の分布に関わらず、標本サイズが十分大きければ、標本平均の分布は正規分布に近づく」という性質を示します。
                    </p>

                    <div class="warning">
                        <h6>中心極限定理の重要性</h6>
                        <p>
                            この定理により、母集団が正規分布でなくても、標本平均に基づく推測統計の手法（信頼区間、仮説検定）が使えるようになります。
                            一般的には、n ≥ 30 であれば十分大きいと見なされます。
                        </p>
                    </div>

                    <h4>中心極限定理のシミュレーション（R）</h4>
                    <pre class="code-block"><code class="language-r"># 一様分布からのサンプリング（非正規分布）
n_samples <- 1000
sample_size <- 30
sample_means <- numeric(n_samples)

for(i in 1:n_samples) {
  sample <- runif(sample_size, min=0, max=1)
  sample_means[i] <- mean(sample)
}

# 標本平均の分布をヒストグラムで表示
hist(sample_means, breaks=30, main="標本平均の分布",
     xlab="標本平均", col="lightblue")

# 正規分布に近づくことを確認
shapiro.test(sample_means)  # 正規性の検定</code></pre>

                    <h4>中心極限定理のシミュレーション（Python）</h4>
                    <pre class="code-block"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# 一様分布からのサンプリング
n_samples = 1000
sample_size = 30
sample_means = []

for _ in range(n_samples):
    sample = np.random.uniform(0, 1, sample_size)
    sample_means.append(np.mean(sample))

# ヒストグラムで可視化
plt.hist(sample_means, bins=30, edgecolor='black')
plt.title('標本平均の分布')
plt.xlabel('標本平均')
plt.ylabel('度数')
plt.show()</code></pre>

                    <h3 class="section-title">4.3 点推定と区間推定</h3>

                    <h4>点推定</h4>
                    <p>
                        点推定は、標本データから母数（母平均μや母分散σ²）を1つの値で推定する方法です。
                        標本平均は母平均の<strong>不偏推定量</strong>です。
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 点推定
data <- c(52, 48, 55, 53, 50)
mean_estimate <- mean(data)  # 母平均の点推定
var_estimate <- var(data)    # 母分散の不偏推定
print(paste("母平均の推定値:", mean_estimate))
print(paste("母分散の推定値:", var_estimate))</code></pre>

                    <h4>区間推定（信頼区間）</h4>
                    <p>
                        区間推定は、母数が含まれる範囲を推定する方法です。
                        「真の母平均が〇〇から△△の間にある」という形で表現され、その信頼度を<strong>信頼水準</strong>（通常95%）で示します。
                    </p>

                    <h4>母平均の信頼区間（母分散未知）</h4>
                    <p>
                        母分散が未知の場合、t分布を使って信頼区間を計算します：<br>
                        信頼区間 = 標本平均 ± t値 × (標本標準偏差 / √n)
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 信頼区間の計算
data <- c(52, 48, 55, 53, 50, 49, 54, 51)

# t検定による信頼区間
result <- t.test(data, conf.level=0.95)
print(result$conf.int)

# 手動計算
n <- length(data)
mean_val <- mean(data)
sd_val <- sd(data)
se <- sd_val / sqrt(n)  # 標準誤差
t_val <- qt(0.975, df=n-1)  # t値（両側95%）
lower <- mean_val - t_val * se
upper <- mean_val + t_val * se
print(paste("95%信頼区間: [", lower, ",", upper, "]"))</code></pre>

                    <pre class="code-block"><code class="language-python"># Python: 信頼区間の計算
from scipy import stats
import numpy as np

data = [52, 48, 55, 53, 50, 49, 54, 51]

# 信頼区間の計算
n = len(data)
mean_val = np.mean(data)
se = stats.sem(data)  # 標準誤差
confidence = 0.95

# t分布による信頼区間
ci = stats.t.interval(confidence, df=n-1,
                       loc=mean_val, scale=se)
print(f"95%信頼区間: {ci}")</code></pre>

                    <h4>信頼区間の解釈</h4>
                    <div class="warning">
                        <h6>信頼区間の正しい解釈</h6>
                        <p>
                            <strong>正しい解釈:</strong> 「同じ方法で標本抽出を100回繰り返した場合、約95回は真の母平均が信頼区間に含まれる」<br>
                            <strong>誤った解釈:</strong> 「母平均が95%の確率でこの区間に入る」（母平均は固定値であり、確率変数ではありません）
                        </p>
                    </div>

                    <h3 class="section-title">4.4 標本サイズの決定</h3>

                    <h4>必要標本サイズの計算</h4>
                    <p>
                        推定精度を確保するために必要な標本サイズを事前に計算できます。
                        許容誤差（E）と信頼水準を指定して計算します。
                    </p>

                    <pre class="code-block"><code class="language-r"># R: 必要標本サイズの計算
# 母平均の推定で誤差±2以内にしたい場合
sigma <- 10       # 母標準偏差（事前情報から）
E <- 2            # 許容誤差
z <- qnorm(0.975) # z値（95%信頼水準）

n <- (z * sigma / E)^2
print(paste("必要標本サイズ:", ceiling(n)))</code></pre>

                    <div class="exercise-container">
                        <h5>実習 4-1: 信頼区間の計算と解釈</h5>
                        <p><strong>目的:</strong> 実際のデータを使って信頼区間を計算し、その意味を理解します。</p>

                        <h6>課題</h6>
                        <p>
                            ある企業の従業員10人の残業時間（時間/月）は以下の通りです：<br>
                            25, 30, 22, 28, 35, 20, 32, 27, 29, 26
                        </p>
                        <ol>
                            <li>標本平均を計算してください</li>
                            <li>母平均の95%信頼区間を計算してください</li>
                            <li>信頼区間の意味を説明してください</li>
                        </ol>

                        <h6>解答例（R）</h6>
                        <pre class="code-block"><code class="language-r">overtime <- c(25, 30, 22, 28, 35, 20, 32, 27, 29, 26)
result <- t.test(overtime, conf.level=0.95)
print(paste("標本平均:", mean(overtime)))
print("95%信頼区間:")
print(result$conf.int)</code></pre>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>中心極限定理が成り立つための一般的な標本サイズの目安は？</li>
                            <li>信頼水準95%の意味を正しく説明してください。</li>
                            <li>標本サイズが大きくなると、信頼区間の幅はどうなりますか？</li>
                            <li>点推定と区間推定の違いを説明してください。</li>
                            <li>標準誤差（SE）は何を表す指標ですか？</li>
                        </ol>
                    </div>

                    <div class="d-flex justify-content-between mt-4 mb-4">
                        <a href="statistical-analysis-learning-material-03.html" class="btn btn-secondary">← 前の章</a>
                        <a href="statistical-analysis-learning-material-05.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <footer class="text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({ startOnLoad: true, theme: 'default' });</script>
</body>
</html>