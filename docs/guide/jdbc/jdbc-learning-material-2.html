<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JDBC初心者向け学習教材 - データベース接続</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        code {
            display: block;
            background-color: #f5f5f5;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .quiz-question {
            font-weight: 500;
            margin-bottom: 1rem;
        }
        .diagram {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            text-align: center;
        }
        .exercise {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        #table-of-contents .list-group-item {
            border: none;
            padding: 0.5rem 1rem;
        }
        #table-of-contents .list-group-item-action {
            color: #1976d2;
        }
        /* 選択された目次項目のスタイル */
        #table-of-contents .list-group-item-action.active,
        .list-group-item.active {
            color: white !important; /* テキストを白色にして青い背景に対してコントラストをつける */
            background-color: #1976d2;
            border-color: #1976d2;
        }
        .section-nav {
            padding-left: 1rem;
        }
        .inline-code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            display: inline;
        }
        footer {
            background-color: #1565c0;
            color: white;
            padding: 1rem 0;
            margin-top: 3rem;
        }
        .table-example {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
        }
        .table-example th {
            background-color: #e3f2fd;
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .table-example td {
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .example-result {
            background-color: #f1f8e9;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#tableOfContents">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">JDBC初心者向け学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="jdbc-learning-material-1.html">第1章: JDBCの基礎</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="#">第2章: データベース接続</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <!-- Sidebar - Table of Contents -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">目次</h5>
                        </div>
                        <div id="table-of-contents" class="list-group list-group-flush">
                            <a href="#introduction" class="list-group-item list-group-item-action">はじめに</a>
                            <a href="#chapter2" class="list-group-item list-group-item-action">第2章: データベース接続</a>
                            <div class="section-nav">
                                <a href="#driver-manager" class="list-group-item list-group-item-action">2.1 DriverManagerクラスの使用方法</a>
                                <a href="#connection-concepts" class="list-group-item list-group-item-action">2.2 Connection, Statement, ResultSetの基本概念</a>
                                <a href="#connection-url" class="list-group-item list-group-item-action">2.3 データベース接続文字列（URL）の構成</a>
                                <a href="#connection-program" class="list-group-item list-group-item-action">2.4 データベース接続プログラム作成（実習）</a>
                                <a href="#chapter2-quiz" class="list-group-item list-group-item-action">2.5 理解度確認テスト</a>
                            </div>
                            <a href="#next-steps" class="list-group-item list-group-item-action">次のステップ</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <section id="introduction">
                    <h1 class="display-5 mb-4">JDBC初心者向け学習教材</h1>
                    <p class="lead">この第2章では、JDBCを使ったデータベース接続について学習します。DriverManagerクラスの使い方、Connection・Statement・ResultSetの基本概念、接続文字列の構成、そして実際の接続プログラムの作成方法を学びます。</p>

                    <div class="note">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>DriverManagerクラスを使用したデータベース接続の確立方法</li>
                            <li>Connection、Statement、ResultSetの役割と使い方</li>
                            <li>データベース接続文字列（JDBC URL）の構成と意味</li>
                            <li>トランザクション管理の基礎</li>
                            <li>効率的な接続クローズの方法</li>
                            <li>データベース接続エラーのハンドリング</li>
                        </ul>
                    </div>
                </section>

                <section id="chapter2">
                    <h2 class="chapter-title">第2章：データベース接続</h2>
                    <p>データベース接続はJDBCプログラミングの最初のステップであり、最も基本的な部分です。この章では、データベース接続を確立し、管理する方法について詳しく学んでいきます。</p>

                    <section id="driver-manager">
                        <h3 class="section-title">2.1 DriverManagerクラスの使用方法</h3>
                        <p>DriverManagerクラスは、JDBCドライバの管理とデータベース接続の確立を担当する中心的なクラスです。Java SE 6以降では、多くの場合、明示的なドライバの登録は不要になりましたが、完全な理解のために登録方法も含めて説明します。</p>

                        <h4>DriverManagerの主な役割</h4>
                        <ul>
                            <li><strong>JDBCドライバの登録と管理</strong>：アプリケーションで使用するJDBCドライバを登録し、管理します</li>
                            <li><strong>データベース接続の確立</strong>：適切なドライバを使用してデータベースへの接続を確立します</li>
                            <li><strong>データベース接続のプロパティ設定</strong>：タイムアウト値などの接続プロパティを設定します</li>
                            <li><strong>ログ出力の管理</strong>：JDBCドライバの動作ログを管理します</li>
                        </ul>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 250" width="600" height="250">
                                <!-- DriverManager -->
                                <rect x="200" y="20" width="200" height="60" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" rx="5" />
                                <text x="300" y="55" text-anchor="middle" font-size="16">DriverManager</text>
                                
                                <!-- ドライバ1 -->
                                <rect x="50" y="150" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="125" y="180" text-anchor="middle" font-size="14">PostgreSQLドライバ</text>
                                
                                <!-- ドライバ2 -->
                                <rect x="225" y="150" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="300" y="180" text-anchor="middle" font-size="14">MySQLドライバ</text>
                                
                                <!-- ドライバ3 -->
                                <rect x="400" y="150" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="475" y="180" text-anchor="middle" font-size="14">Oracleドライバ</text>
                                
                                <!-- 接続線 -->
                                <line x1="125" y1="100" x2="125" y2="150" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="300" y1="100" x2="300" y2="150" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="475" y1="100" x2="475" y2="150" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                
                                <line x1="125" y1="100" x2="300" y2="80" stroke="#000" stroke-width="1.5" />
                                <line x1="300" y1="100" x2="300" y2="80" stroke="#000" stroke-width="1.5" />
                                <line x1="475" y1="100" x2="300" y2="80" stroke="#000" stroke-width="1.5" />
                                
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#000" />
                                    </marker>
                                </defs>
                                
                                <text x="125" y="220" text-anchor="middle" font-size="12">PostgreSQLデータベース</text>
                                <text x="300" y="220" text-anchor="middle" font-size="12">MySQLデータベース</text>
                                <text x="475" y="220" text-anchor="middle" font-size="12">Oracleデータベース</text>
                            </svg>
                            <p class="text-center">図2.1: DriverManagerとJDBCドライバの関係</p>
                        </div>

                        <h4>JDBCドライバの登録方法</h4>
                        <p>JDBCドライバを登録する方法には主に2つあります：</p>

                        <h5>1. Class.forName()メソッドを使用する方法</h5>
                        <code>// PostgreSQLドライバを登録する例
try {
    Class.forName("org.postgresql.Driver");
    System.out.println("PostgreSQLドライバが正常に登録されました");
} catch (ClassNotFoundException e) {
    System.err.println("PostgreSQLドライバの登録に失敗しました: " + e.getMessage());
}</code>

                        <h5>2. java.sql.Driverクラスの実装を明示的に登録する方法</h5>
                        <code>// ドライバを明示的に登録する例
try {
    Driver driver = new org.postgresql.Driver();
    DriverManager.registerDriver(driver);
    System.out.println("PostgreSQLドライバが明示的に登録されました");
} catch (SQLException e) {
    System.err.println("PostgreSQLドライバの登録に失敗しました: " + e.getMessage());
}</code>

                        <div class="note">
                            <h5>Java 6以降のドライバ自動登録</h5>
                            <p>Java SE 6以降では、クラスパス上にあるJDBCドライバは自動的に検出・登録されるようになりました。これは、JDBC 4.0仕様の一部として導入されたもので、<code class="inline-code">META-INF/services/java.sql.Driver</code>ファイルを使用してドライバを自動検出します。このため、多くの場合、明示的なドライバ登録（<code class="inline-code">Class.forName()</code>）は不要になりました。</p>
                            <p>ただし、実行時に動的にクラスパスにドライバを追加する場合や、互換性を確保するために、従来の明示的登録方法を使用することもあります。</p>
                        </div>

                        <h4>DriverManagerを使った接続確立</h4>
                        <p>DriverManagerを使用してデータベース接続を確立する基本的な方法は以下のとおりです：</p>

                        <code>// DriverManagerを使用してPostgreSQLに接続する例
String url = "jdbc:postgresql://localhost:5432/mydb";
String user = "postgres";
String password = "password";

try {
    // Java 6以降は以下の行は省略可能
    Class.forName("org.postgresql.Driver");
    
    // 接続の確立
    Connection connection = DriverManager.getConnection(url, user, password);
    System.out.println("データベースに接続しました");
    
    // 接続を使用する処理...
    
    // 接続のクローズ
    connection.close();
    System.out.println("データベース接続を閉じました");
} catch (ClassNotFoundException e) {
    System.err.println("JDBCドライバが見つかりません: " + e.getMessage());
} catch (SQLException e) {
    System.err.println("データベース接続エラー: " + e.getMessage());
}</code>

                        <h4>接続のプロパティ設定</h4>
                        <p>DriverManagerでは、接続時に追加のプロパティを設定することができます：</p>

                        <code>// Propertiesオブジェクトを使用した接続プロパティの設定
import java.util.Properties;

String url = "jdbc:postgresql://localhost:5432/mydb";
Properties props = new Properties();
props.setProperty("user", "postgres");
props.setProperty("password", "password");
props.setProperty("connectTimeout", "5"); // 接続タイムアウト（秒）
props.setProperty("socketTimeout", "30"); // ソケットタイムアウト（秒）
props.setProperty("ssl", "true"); // SSL接続を有効化

try {
    Connection connection = DriverManager.getConnection(url, props);
    System.out.println("カスタムプロパティで接続しました");
    // 接続を使用...
    connection.close();
} catch (SQLException e) {
    System.err.println("接続エラー: " + e.getMessage());
}</code>

                        <h4>DriverManagerのログ設定</h4>
                        <p>DriverManagerには、JDBC操作のデバッグに役立つログ機能があります：</p>

                        <code>// DriverManagerのログ出力を有効にする
// java.util.logging.Loggerを使用
DriverManager.setLogWriter(new PrintWriter(System.out));

// または特定のストリームにログを出力する
FileOutputStream log = new FileOutputStream("jdbc-debug.log");
DriverManager.setLogWriter(new PrintWriter(log));</code>

                        <div class="exercise">
                            <h5>練習問題 2.1.1: DriverManagerのログを使ったデバッグ</h5>
                            <p>以下の課題に取り組んでみましょう：</p>
                            <ol>
                                <li>DriverManagerのログ出力を有効にして、PostgreSQLデータベースへの接続を試みるプログラムを作成してください。</li>
                                <li>故意に誤ったパスワードを使用して接続し、ログにどのようなエラーメッセージが出力されるかを確認してください。</li>
                                <li>正しいパスワードで再接続し、正常な接続時のログメッセージも確認してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="connection-concepts">
                        <h3 class="section-title">2.2 Connection, Statement, ResultSetの基本概念</h3>
                        <p>JDBCでデータベースを操作するには、主に3つの重要なインターフェース（Connection、Statement、ResultSet）を理解する必要があります。これらはJDBCプログラミングの基本構成要素です。</p>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- Connection -->
                                <rect x="50" y="20" width="500" height="60" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="300" y="55" text-anchor="middle" font-size="16">Connection</text>
                                <text x="300" y="75" text-anchor="middle" font-size="12">（データベースとの接続を表す）</text>
                                
                                <!-- Statement -->
                                <rect x="50" y="120" width="240" height="60" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" rx="5" />
                                <text x="170" y="155" text-anchor="middle" font-size="16">Statement</text>
                                <text x="170" y="175" text-anchor="middle" font-size="12">（SQLステートメントを表す）</text>
                                
                                <!-- PreparedStatement -->
                                <rect x="310" y="120" width="240" height="60" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" rx="5" />
                                <text x="430" y="155" text-anchor="middle" font-size="16">PreparedStatement</text>
                                <text x="430" y="175" text-anchor="middle" font-size="12">（事前コンパイル済みSQLを表す）</text>
                                
                                <!-- ResultSet -->
                                <rect x="50" y="220" width="500" height="60" fill="#ffecb3" stroke="#ffa000" stroke-width="2" rx="5" />
                                <text x="300" y="255" text-anchor="middle" font-size="16">ResultSet</text>
                                <text x="300" y="275" text-anchor="middle" font-size="12">（クエリ結果を表す）</text>
                                
                                <!-- 矢印 -->
                                <line x1="170" y1="80" x2="170" y2="120" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="430" y1="80" x2="430" y2="120" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="170" y1="180" x2="170" y2="220" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="430" y1="180" x2="430" y2="220" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#000" />
                                    </marker>
                                </defs>
                                
                                <text x="110" y="100" text-anchor="middle" font-size="12">createStatement()</text>
                                <text x="490" y="100" text-anchor="middle" font-size="12">prepareStatement()</text>
                                <text x="110" y="200" text-anchor="middle" font-size="12">executeQuery()</text>
                                <text x="490" y="200" text-anchor="middle" font-size="12">executeQuery()</text>
                            </svg>
                            <p class="text-center">図2.2: Connection、Statement、ResultSetの関係</p>
                        </div>

                        <h4>Connectionインターフェース</h4>
                        <p>Connectionはデータベースとの接続を表します。これはデータベースとのセッション全体を管理する基本的なオブジェクトです。</p>

                        <h5>Connectionの主な役割</h5>
                        <ul>
                            <li><strong>SQLステートメントの作成</strong>：各種SQLステートメントオブジェクトを作成</li>
                            <li><strong>トランザクション管理</strong>：コミットやロールバックなどのトランザクション制御</li>
                            <li><strong>メタデータへのアクセス</strong>：データベースに関する情報の取得</li>
                            <li><strong>接続状態の管理</strong>：接続のクローズや有効性の確認</li>
                        </ul>

                        <h5>Connectionの主なメソッド</h5>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td>createStatement()</td>
                                    <td>SQL文を実行するためのStatementオブジェクトを作成</td>
                                    <td><code class="inline-code">Statement stmt = conn.createStatement();</code></td>
                                </tr>
                                <tr>
                                    <td>prepareStatement(String sql)</td>
                                    <td>事前コンパイル済みのSQLを実行するPreparedStatementを作成</td>
                                    <td><code class="inline-code">PreparedStatement pstmt = conn.prepareStatement("SELECT * FROM users WHERE id = ?");</code></td>
                                </tr>
                                <tr>
                                    <td>setAutoCommit(boolean autoCommit)</td>
                                    <td>自動コミットモードの設定</td>
                                    <td><code class="inline-code">conn.setAutoCommit(false);</code></td>
                                </tr>
                                <tr>
                                    <td>commit()</td>
                                    <td>現在のトランザクションをコミット</td>
                                    <td><code class="inline-code">conn.commit();</code></td>
                                </tr>
                                <tr>
                                    <td>rollback()</td>
                                    <td>現在のトランザクションをロールバック</td>
                                    <td><code class="inline-code">conn.rollback();</code></td>
                                </tr>
                                <tr>
                                    <td>close()</td>
                                    <td>データベース接続を閉じる</td>
                                    <td><code class="inline-code">conn.close();</code></td>
                                </tr>
                                <tr>
                                    <td>isClosed()</td>
                                    <td>接続が閉じられているかを確認</td>
                                    <td><code class="inline-code">if (conn.isClosed()) { /* 処理 */ }</code></td>
                                </tr>
                                <tr>
                                    <td>getMetaData()</td>
                                    <td>データベースのメタデータを取得</td>
                                    <td><code class="inline-code">DatabaseMetaData meta = conn.getMetaData();</code></td>
                                </tr>
                            </table>
                        </div>

                        <h4>Statementインターフェース</h4>
                        <p>StatementはSQL文を実行するためのオブジェクトです。単純なSQLステートメントを実行する場合に使用します。</p>

                        <h5>Statementの主なメソッド</h5>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td>executeQuery(String sql)</td>
                                    <td>SELECT文を実行し、結果セットを返す</td>
                                    <td><code class="inline-code">ResultSet rs = stmt.executeQuery("SELECT * FROM users");</code></td>
                                </tr>
                                <tr>
                                    <td>executeUpdate(String sql)</td>
                                    <td>INSERT、UPDATE、DELETEなどを実行し、影響行数を返す</td>
                                    <td><code class="inline-code">int rows = stmt.executeUpdate("UPDATE users SET name='山田' WHERE id=1");</code></td>
                                </tr>
                                <tr>
                                    <td>execute(String sql)</td>
                                    <td>任意のSQL文を実行し、結果の有無をブール値で返す</td>
                                    <td><code class="inline-code">boolean hasResults = stmt.execute("DROP TABLE users");</code></td>
                                </tr>
                                <tr>
                                    <td>close()</td>
                                    <td>Statementをクローズし、関連リソースを解放</td>
                                    <td><code class="inline-code">stmt.close();</code></td>
                                </tr>
                            </table>
                        </div>

                        <h5>PreparedStatement</h5>
                        <p>PreparedStatementはStatementの拡張で、SQL文をあらかじめコンパイルし、パラメータ化されたクエリを実行できます。</p>

                        <div class="note">
                            <h5>PreparedStatementの利点</h5>
                            <ul>
                                <li><strong>パフォーマンス向上</strong>：SQLは一度だけパースされ、繰り返し実行が効率的</li>
                                <li><strong>SQLインジェクション防止</strong>：パラメータが適切にエスケープされ、安全に処理される</li>
                                <li><strong>バイナリデータの操作が容易</strong>：BLOBやCLOBなどのバイナリデータを扱いやすい</li>
                                <li><strong>バッチ処理に適している</strong>：複数の同様のステートメントをバッチで実行可能</li>
                            </ul>
                        </div>

                        <code>// PreparedStatementの使用例
String sql = "INSERT INTO users (name, email, age) VALUES (?, ?, ?)";
try (PreparedStatement pstmt = connection.prepareStatement(sql)) {
    // パラメータのセット
    pstmt.setString(1, "山田太郎");
    pstmt.setString(2, "yamada@example.com");
    pstmt.setInt(3, 30);
    
    // 実行
    int rowsAffected = pstmt.executeUpdate();
    System.out.println(rowsAffected + "行が挿入されました");
} catch (SQLException e) {
    System.err.println("エラー: " + e.getMessage());
}</code>

                        <h4>ResultSetインターフェース</h4>
                        <p>ResultSetはSELECT文の実行結果を表します。結果の行セットを一つずつ処理するためのカーソルを提供します。</p>

                        <h5>ResultSetの主な特徴</h5>
                        <ul>
                            <li><strong>カーソルベース</strong>：結果セット内を行単位で移動するカーソルを使用</li>
                            <li><strong>一方向イテレーション</strong>：デフォルトでは前方にのみ移動可能（タイプによっては双方向も可）</li>
                            <li><strong>列データへのアクセス</strong>：索引（1から始まる）または列名でデータにアクセス</li>
                            <li><strong>メタデータ</strong>：結果セットの構造を表すメタデータへのアクセスが可能</li>
                        </ul>

                        <h5>ResultSetの主なメソッド</h5>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td>next()</td>
                                    <td>次の行に移動し、行があればtrueを返す</td>
                                    <td><code class="inline-code">while (rs.next()) { /* 処理 */ }</code></td>
                                </tr>
                                <tr>
                                    <td>getXXX(int columnIndex)</td>
                                    <td>列インデックスを指定して値を取得（XXXは型）</td>
                                    <td><code class="inline-code">int id = rs.getInt(1);</code></td>
                                </tr>
                                <tr>
                                    <td>getXXX(String columnName)</td>
                                    <td>列名を指定して値を取得（XXXは型）</td>
                                    <td><code class="inline-code">String name = rs.getString("name");</code></td>
                                </tr>
                                <tr>
                                    <td>getMetaData()</td>
                                    <td>結果セットのメタデータを取得</td>
                                    <td><code class="inline-code">ResultSetMetaData meta = rs.getMetaData();</code></td>
                                </tr>
                                <tr>
                                    <td>close()</td>
                                    <td>結果セットを閉じて関連リソースを解放</td>
                                    <td><code class="inline-code">rs.close();</code></td>
                                </tr>
                            </table>
                        </div>

                        <code>// ResultSetの基本的な使用例
try (
    Statement stmt = connection.createStatement();
    ResultSet rs = stmt.executeQuery("SELECT id, name, email, age FROM users")
) {
    // ResultSetのメタデータを取得
    ResultSetMetaData metaData = rs.getMetaData();
    int columnCount = metaData.getColumnCount();
    
    // カラム名を表示
    for (int i = 1; i <= columnCount; i++) {
        System.out.print(metaData.getColumnName(i) + "\t");
    }
    System.out.println();
    
    // データを行ごとに処理
    while (rs.next()) {
        // 列インデックスでアクセスする方法
        int id = rs.getInt(1);
        
        // 列名でアクセスする方法（より明示的で読みやすい）
        String name = rs.getString("name");
        String email = rs.getString("email");
        
        // null値の処理
        int age = rs.getInt("age");
        if (rs.wasNull()) {
            age = -1; // null値の場合は-1を設定
        }
        
        System.out.println(id + "\t" + name + "\t" + email + "\t" + age);
    }
} catch (SQLException e) {
    System.err.println("データ取得エラー: " + e.getMessage());
}</code>

                        <div class="exercise">
                            <h5>練習問題 2.2.1: Connection、Statement、ResultSetの利用</h5>
                            <p>次の課題に取り組んでみましょう：</p>
                            <ol>
                                <li>PostgreSQLに接続し、PreparedStatementを使用して新しいユーザーテーブル（users）を作成するプログラムを書いてください。</li>
                                <li>作成したテーブルにいくつかのサンプルデータを挿入してください。</li>
                                <li>挿入したデータをSELECT文で取得し、ResultSetを使って全てのユーザー情報を表示してください。</li>
                                <li>ResultSetMetaDataを使用して、各列の型と名前も表示してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="connection-url">
                        <h3 class="section-title">2.3 データベース接続文字列（URL）の構成</h3>
                        <p>JDBC URLは、接続するデータベースを特定するために使用される文字列です。各データベースベンダーは独自のURL形式を持っていますが、基本的な構造は共通しています。</p>

                        <h4>JDBC URLの基本構造</h4>
                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 100" width="600" height="100">
                                <rect x="10" y="20" width="80" height="40" fill="#bbdefb" stroke="#1976d2" stroke-width="2" />
                                <text x="50" y="45" text-anchor="middle" font-size="14">jdbc:</text>
                                
                                <rect x="90" y="20" width="120" height="40" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" />
                                <text x="150" y="45" text-anchor="middle" font-size="14">サブプロトコル</text>
                                
                                <rect x="210" y="20" width="380" height="40" fill="#ffecb3" stroke="#ffa000" stroke-width="2" />
                                <text x="400" y="45" text-anchor="middle" font-size="14">サブネーム（データベース固有の接続情報）</text>
                                
                                <text x="50" y="80" text-anchor="middle" font-size="12">プレフィックス</text>
                                <text x="150" y="80" text-anchor="middle" font-size="12">DB種類を示す</text>
                                <text x="400" y="80" text-anchor="middle" font-size="12">ホスト、ポート、データベース名などを含む</text>
                            </svg>
                            <p class="text-center">図2.3: JDBC URLの基本構造</p>
                        </div>

                        <p>JDBC URLの基本的な形式は以下のとおりです：</p>
                        <code>jdbc:サブプロトコル:サブネーム</code>
                        <p>各部分の説明：</p>
                        <ul>
                            <li><strong>jdbc:</strong> - すべてのJDBC URLの共通プレフィックス</li>
                            <li><strong>サブプロトコル</strong> - 使用するデータベースドライバまたはデータベース接続メカニズムを特定（postgresql、mysql、oracleなど）</li>
                            <li><strong>サブネーム</strong> - データベースの場所と名前を特定するための情報（ホスト名、ポート番号、データベース名など）</li>
                        </ul>

                        <h4>主要データベースのURL形式</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>データベース</th>
                                    <th>URL形式</th>
                                    <th>例</th>
                                </tr>
                                <tr>
                                    <td>PostgreSQL</td>
                                    <td>jdbc:postgresql://ホスト:ポート/データベース名</td>
                                    <td>jdbc:postgresql://localhost:5432/mydb</td>
                                </tr>
                                <tr>
                                    <td>MySQL</td>
                                    <td>jdbc:mysql://ホスト:ポート/データベース名</td>
                                    <td>jdbc:mysql://localhost:3306/mydb</td>
                                </tr>
                                <tr>
                                    <td>Oracle</td>
                                    <td>jdbc:oracle:thin:@ホスト:ポート:SID</td>
                                    <td>jdbc:oracle:thin:@localhost:1521:orcl</td>
                                </tr>
                                <tr>
                                    <td>SQL Server</td>
                                    <td>jdbc:sqlserver://ホスト:ポート;databaseName=データベース名</td>
                                    <td>jdbc:sqlserver://localhost:1433;databaseName=mydb</td>
                                </tr>
                                <tr>
                                    <td>SQLite</td>
                                    <td>jdbc:sqlite:データベースファイルパス</td>
                                    <td>jdbc:sqlite:/path/to/database.db</td>
                                </tr>
                                <tr>
                                    <td>H2 Database</td>
                                    <td>jdbc:h2:ファイルパスまたはメモリ</td>
                                    <td>jdbc:h2:~/test または jdbc:h2:mem:testdb</td>
                                </tr>
                            </table>
                        </div>

                        <h4>URL内のパラメータ</h4>
                        <p>多くのJDBC URLでは、追加のパラメータを指定することができます。これらはデータベースの種類によって構文が異なります。</p>

                        <h5>PostgreSQLの場合：</h5>
                        <code>jdbc:postgresql://localhost:5432/mydb?user=postgres&password=secret&ssl=true</code>

                        <h5>MySQLの場合：</h5>
                        <code>jdbc:mysql://localhost:3306/mydb?user=root&password=secret&useSSL=true&serverTimezone=UTC</code>

                        <div class="note">
                            <h5>URL内のパスワードに関する注意点</h5>
                            <p>セキュリティ上の理由から、URL内にパスワードを直接記述することは一般的には推奨されません。代わりに、Properties オブジェクトや別の接続メカニズム（データソースなど）を使用してパスワードを提供することをお勧めします。</p>
                        </div>

                        <h4>PostgreSQL特有のURL設定</h4>
                        <p>PostgreSQLのJDBC URLには、以下のような追加パラメータを設定することができます：</p>

                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>パラメータ</th>
                                    <th>説明</th>
                                    <th>例</th>
                                </tr>
                                <tr>
                                    <td>ssl</td>
                                    <td>SSL接続を使用するかどうか</td>
                                    <td>ssl=true</td>
                                </tr>
                                <tr>
                                    <td>sslfactory</td>
                                    <td>SSLソケットファクトリの実装</td>
                                    <td>sslfactory=org.postgresql.ssl.NonValidatingFactory</td>
                                </tr>
                                <tr>
                                    <td>connectTimeout</td>
                                    <td>接続タイムアウト（秒）</td>
                                    <td>connectTimeout=10</td>
                                </tr>
                                <tr>
                                    <td>socketTimeout</td>
                                    <td>ソケット読み取りタイムアウト（秒）</td>
                                    <td>socketTimeout=20</td>
                                </tr>
                                <tr>
                                    <td>tcpKeepAlive</td>
                                    <td>TCP keepaliveを使用するかどうか</td>
                                    <td>tcpKeepAlive=true</td>
                                </tr>
                                <tr>
                                    <td>applicationName</td>
                                    <td>アプリケーション名（ログや統計で使用）</td>
                                    <td>applicationName=MyApp</td>
                                </tr>
                                <tr>
                                    <td>currentSchema</td>
                                    <td>デフォルトのスキーマ</td>
                                    <td>currentSchema=public</td>
                                </tr>
                                <tr>
                                    <td>binaryTransfer</td>
                                    <td>バイナリ転送モードを使用するかどうか</td>
                                    <td>binaryTransfer=true</td>
                                </tr>
                            </table>
                        </div>

                        <code>// PostgreSQLの詳細なURL設定例
String url = "jdbc:postgresql://localhost:5432/mydb"
    + "?ssl=true"
    + "&connectTimeout=5"
    + "&socketTimeout=30"
    + "&tcpKeepAlive=true"
    + "&applicationName=MyJdbcApp"
    + "&currentSchema=public";

try (Connection conn = DriverManager.getConnection(url, "postgres", "password")) {
    System.out.println("詳細設定で接続しました");
    // 処理...
} catch (SQLException e) {
    System.err.println("接続エラー: " + e.getMessage());
}</code>

                        <div class="exercise">
                            <h5>練習問題 2.3.1: 各種データベース接続URLの構成</h5>
                            <p>以下の要件に合ったJDBC URLを構築してください：</p>
                            <ol>
                                <li>ホスト「db.example.com」、ポート「5432」のPostgreSQLサーバー上の「customerdb」データベースに接続し、SSLを使用し、接続タイムアウトを10秒に設定するURL</li>
                                <li>ローカルのMySQLサーバー上の「inventory」データベースに接続し、UTF-8文字セットを使用し、自動再接続を有効にするURL</li>
                                <li>IP「192.168.1.100」、ポート「1521」のOracleサーバー上の「finance」データベースに接続するURL</li>
                                <li>オプション課題：PostgreSQLデータベースに接続する際に、複数のパラメータ（ssl、connectTimeout、applicationName）を設定するコードを書いてください。Propertiesオブジェクトを使用する場合と、URL内にパラメータを含める場合の両方を示してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="connection-program">
                        <h3 class="section-title">2.4 データベース接続プログラム作成（実習）</h3>
                        <p>ここでは、実際にPostgreSQLデータベースに接続するプログラムを作成し、基本的なJDBCの接続管理技術を学びます。</p>

                        <h4>基本的な接続プログラム</h4>
                        <p>まずは、最も基本的なデータベース接続プログラムを作成してみましょう。</p>

                        <code>import java.sql.*;

public class BasicConnectionExample {
    
    // データベース接続情報
    private static final String URL = "jdbc:postgresql://localhost:5432/jdbctest";
    private static final String USER = "postgres";
    private static final String PASSWORD = "password"; // 実際のパスワードに変更してください
    
    public static void main(String[] args) {
        // 接続オブジェクト
        Connection conn = null;
        
        try {
            // JDBCドライバの登録（Java 6以降では省略可）
            Class.forName("org.postgresql.Driver");
            
            // データベースへの接続
            System.out.println("データベースに接続しています...");
            conn = DriverManager.getConnection(URL, USER, PASSWORD);
            
            if (conn != null) {
                System.out.println("データベース接続成功!");
                
                // データベースメタデータの取得
                DatabaseMetaData metaData = conn.getMetaData();
                System.out.println("データベース製品名: " + metaData.getDatabaseProductName());
                System.out.println("データベースバージョン: " + metaData.getDatabaseProductVersion());
                System.out.println("JDBCドライバ名: " + metaData.getDriverName());
                System.out.println("JDBCドライババージョン: " + metaData.getDriverVersion());
            }
        } catch (ClassNotFoundException e) {
            System.err.println("JDBCドライバが見つかりません: " + e.getMessage());
        } catch (SQLException e) {
            System.err.println("データベース接続エラー: " + e.getMessage());
            System.err.println("SQLステート: " + e.getSQLState());
            System.err.println("ベンダーエラーコード: " + e.getErrorCode());
        } finally {
            // 接続のクローズ
            try {
                if (conn != null && !conn.isClosed()) {
                    conn.close();
                    System.out.println("データベース接続を閉じました");
                }
            } catch (SQLException e) {
                System.err.println("接続クローズエラー: " + e.getMessage());
            }
        }
    }
}</code>

                        <div class="note">
                            <h5>try-with-resourcesを使用した改善版</h5>
                            <p>Java 7以降では、try-with-resourcesステートメントを使用して、自動的にリソースをクローズできます。</p>
                        </div>

                        <code>import java.sql.*;

public class TryWithResourcesConnectionExample {
    
    private static final String URL = "jdbc:postgresql://localhost:5432/jdbctest";
    private static final String USER = "postgres";
    private static final String PASSWORD = "password"; // 実際のパスワードに変更してください
    
    public static void main(String[] args) {
        // Java 7以降のtry-with-resources構文
        try {
            // ドライバの登録（Java 6以降では省略可）
            Class.forName("org.postgresql.Driver");
            
            // try-with-resourcesを使用してConnection自動クローズ
            try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD)) {
                System.out.println("データベース接続成功!");
                
                // データベースメタデータの取得
                DatabaseMetaData metaData = conn.getMetaData();
                System.out.println("データベース製品名: " + metaData.getDatabaseProductName());
                System.out.println("JDBCドライバ: " + metaData.getDriverName() + " " + metaData.getDriverVersion());
                
                // 自動的にconnectionはcloseされます
            }
            System.out.println("リソースは自動的にクローズされました");
            
        } catch (ClassNotFoundException e) {
            System.err.println("JDBCドライバが見つかりません: " + e.getMessage());
        } catch (SQLException e) {
            System.err.println("データベース接続エラー: " + e.getMessage());
        }
    }
}</code>

                        <h4>トランザクション管理</h4>
                        <p>複数のSQLオペレーションを1つのトランザクションとして扱う方法を学びましょう。</p>

                        <code>import java.sql.*;

public class TransactionExample {
    
    private static final String URL = "jdbc:postgresql://localhost:5432/jdbctest";
    private static final String USER = "postgres";
    private static final String PASSWORD = "password"; // 実際のパスワードに変更してください
    
    public static void main(String[] args) {
        try {
            Class.forName("org.postgresql.Driver");
            
            try (Connection conn = DriverManager.getConnection(URL, USER, PASSWORD)) {
                // デフォルトでは自動コミットモードがONになっています
                // トランザクション管理のために自動コミットをOFFにします
                conn.setAutoCommit(false);
                
                try {
                    // 複数のSQLステートメントをトランザクションとして実行
                    try (
                        Statement stmt = conn.createStatement();
                    ) {
                        // 1つ目の操作 - 新しいテーブル作成
                        stmt.executeUpdate("CREATE TABLE IF NOT EXISTS accounts (" +
                                          "id SERIAL PRIMARY KEY, " +
                                          "name VARCHAR(100) NOT NULL, " +
                                          "balance DECIMAL(10,2) NOT NULL)");
                                          
                        // 2つ目の操作 - データ挿入
                        stmt.executeUpdate("INSERT INTO accounts (name, balance) VALUES " +
                                          "('Alice', 1000.00), " +
                                          "('Bob', 500.00)");
                        
                        // 3つ目の操作 - 残高更新（Aliceから100.00をBobに転送）
                        stmt.executeUpdate("UPDATE accounts SET balance = balance - 100.00 WHERE name = 'Alice'");
                        stmt.executeUpdate("UPDATE accounts SET balance = balance + 100.00 WHERE name = 'Bob'");
                        
                        // すべての操作が成功したら、トランザクションをコミット
                        conn.commit();
                        System.out.println("トランザクションが正常にコミットされました");
                        
                        // 結果を確認
                        try (ResultSet rs = stmt.executeQuery("SELECT * FROM accounts")) {
                            System.out.println("ID\t名前\t残高");
                            System.out.println("-----------------------");
                            while (rs.next()) {
                                System.out.println(rs.getInt("id") + "\t" + 
                                                  rs.getString("name") + "\t" + 
                                                  rs.getBigDecimal("balance"));
                            }
                        }
                    }
                } catch (SQLException e) {
                    // エラーが発生した場合は、トランザクションをロールバック
                    System.err.println("トランザクションエラー: " + e.getMessage());
                    try {
                        conn.rollback();
                        System.out.println("トランザクションがロールバックされました");
                    } catch (SQLException rollbackEx) {
                        System.err.println("ロールバックエラー: " + rollbackEx.getMessage());
                    }
                } finally {
                    // 自動コミットモードを元に戻す
                    try {
                        conn.setAutoCommit(true);
                    } catch (SQLException e) {
                        System.err.println("自動コミット設定エラー: " + e.getMessage());
                    }
                }
            }
        } catch (ClassNotFoundException e) {
            System.err.println("JDBCドライバが見つかりません: " + e.getMessage());
        } catch (SQLException e) {
            System.err.println("データベース接続エラー: " + e.getMessage());
        }
    }
}</code>

                        <h4>接続プールの基本</h4>
                        <p>実際のアプリケーションでは、接続プールを使用して効率的に接続を管理することが一般的です。ここでは、シンプルな接続プールの考え方を紹介します。</p>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- アプリケーション -->
                                <rect x="50" y="30" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="125" y="60" text-anchor="middle" font-size="14">アプリケーション</text>
                                
                                <!-- 接続プール -->
                                <rect x="250" y="20" width="200" height="150" fill="#c8e6c9" stroke="#388e3c" stroke-width="2" rx="5" />
                                <text x="350" y="45" text-anchor="middle" font-size="16">接続プール</text>
                                
                                <!-- 接続 -->
                                <rect x="270" y="60" width="160" height="30" fill="#e8f5e9" stroke="#1b5e20" stroke-width="1" rx="3" />
                                <text x="350" y="80" text-anchor="middle" font-size="12">接続 #1</text>
                                
                                <rect x="270" y="95" width="160" height="30" fill="#e8f5e9" stroke="#1b5e20" stroke-width="1" rx="3" />
                                <text x="350" y="115" text-anchor="middle" font-size="12">接続 #2</text>
                                
                                <rect x="270" y="130" width="160" height="30" fill="#e8f5e9" stroke="#1b5e20" stroke-width="1" rx="3" />
                                <text x="350" y="150" text-anchor="middle" font-size="12">接続 #3</text>
                                
                                <!-- データベース -->
                                <rect x="500" y="30" width="150" height="50" fill="#ffecb3" stroke="#ffa000" stroke-width="2" rx="5" />
                                <text x="575" y="60" text-anchor="middle" font-size="14">データベース</text>
                                
                                <!-- アプリケーション要求 -->
                                <rect x="50" y="110" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="125" y="140" text-anchor="middle" font-size="14">アプリケーション</text>
                                
                                <!-- アプリケーション要求 -->
                                <rect x="50" y="190" width="150" height="50" fill="#bbdefb" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="125" y="220" text-anchor="middle" font-size="14">アプリケーション</text>
                                
                                <!-- 矢印 -->
                                <line x1="200" y1="45" x2="250" y2="75" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="200" y1="125" x2="250" y2="110" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="200" y1="205" x2="250" y2="145" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                
                                <line x1="450" y1="75" x2="500" y2="45" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="450" y1="110" x2="500" y2="55" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                <line x1="450" y1="145" x2="500" y2="65" stroke="#000" stroke-width="1.5" marker-end="url(#arrow)" />
                                
                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#000" />
                                    </marker>
                                </defs>
                                
                                <text x="125" y="260" text-anchor="middle" font-size="12">複数のアプリケーションリクエスト</text>
                                <text x="350" y="260" text-anchor="middle" font-size="12">限られた数の接続を再利用</text>
                                <text x="575" y="100" text-anchor="middle" font-size="12">データベースリソース節約</text>
                            </svg>
                            <p class="text-center">図2.4: 接続プールの基本概念</p>
                        </div>

                        <div class="note">
                            <h5>接続プールのメリット</h5>
                            <ul>
                                <li><strong>パフォーマンス向上</strong>：接続の確立と破棄のオーバーヘッドを削減</li>
                                <li><strong>リソース管理</strong>：データベース接続数を制限し、リソースを保護</li>
                                <li><strong>スケーラビリティ</strong>：多数のクライアントに対して効率的に対応</li>
                                <li><strong>コネクション再利用</strong>：既存の接続を再利用することでアプリケーションの応答性を向上</li>
                            </ul>
                            <p>実際のアプリケーションでは、HikariCP、Apache DBCP、C3P0などの確立された接続プールライブラリを使用することが推奨されます。</p>
                        </div>

                        <code>// 簡易的な接続プールの基本的な使い方の例（実際のプロジェクトではHikariCPなどを使用します）
import java.sql.*;
import javax.sql.*;
import javax.sql.DataSource;
import org.postgresql.ds.PGSimpleDataSource;

public class SimpleDataSourceExample {
    
    private static DataSource setupDataSource() {
        // PostgreSQLのデータソースを設定
        PGSimpleDataSource ds = new PGSimpleDataSource();
        ds.setServerName("localhost");
        ds.setPortNumber(5432);
        ds.setDatabaseName("jdbctest");
        ds.setUser("postgres");
        ds.setPassword("password"); // 実際のパスワードに変更してください
        return ds;
    }
    
    public static void main(String[] args) {
        DataSource dataSource = setupDataSource();
        
        try (
            // データソースから接続を取得
            Connection conn = dataSource.getConnection();
            Statement stmt = conn.createStatement();
        ) {
            System.out.println("データソースから接続を取得しました");
            
            // データベースの操作を実行
            ResultSet rs = stmt.executeQuery("SELECT current_timestamp");
            if (rs.next()) {
                System.out.println("現在のデータベース時刻: " + rs.getTimestamp(1));
            }
            rs.close();
            
        } catch (SQLException e) {
            System.err.println("データベース操作エラー: " + e.getMessage());
        }
    }
}</code>

                        <div class="warning">
                            <h5>接続プール使用時の注意点</h5>
                            <p>接続プールを使用する際には、以下の点に注意してください：</p>
                            <ul>
                                <li>プールから取得した接続は、使用後に必ずclose()メソッドで返却する（実際には接続は閉じられず、プールに戻される）</li>
                                <li>トランザクション状態やセッション設定を変更した場合は、必ず元の状態に戻す</li>
                                <li>プール内の接続数やタイムアウト値は、アプリケーションの特性に合わせて適切に設定する</li>
                                <li>接続のリークを防ぐため、try-with-resourcesなどを使用して確実に接続を返却する</li>
                            </ul>
                        </div>

                        <h4>実習課題：複数のデータベースオペレーションを行うプログラム</h4>
                        <p>以下の要件を満たすプログラムを作成してみましょう：</p>

                        <div class="exercise">
                            <h5>実習課題 2.4.1: データベース操作プログラム</h5>
                            <ol>
                                <li>PostgreSQLデータベースに接続するプログラムを作成してください。</li>
                                <li>以下のテーブルを作成します：
                                    <pre>
products (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    price DECIMAL(10,2) NOT NULL,
    stock INT NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
)</pre>
                                </li>
                                <li>少なくとも5つの商品データをテーブルに挿入してください。</li>
                                <li>以下の操作を実装してください：
                                    <ul>
                                        <li>すべての商品を表示する機能</li>
                                        <li>特定の価格範囲内の商品を検索する機能</li>
                                        <li>商品の在庫を更新する機能（トランザクションを使用）</li>
                                        <li>商品情報をCSVファイルにエクスポートする機能（オプション）</li>
                                    </ul>
                                </li>
                                <li>適切な例外処理とリソース管理を実装してください。</li>
                                <li>各操作の実行結果をコンソールに表示してください。</li>
                            </ol>
                            <p>※この実習では、PreparedStatementを積極的に使用してください。</p>
                        </div>
                    </section>

                    <section id="chapter2-quiz">
                        <h3 class="section-title">2.5 理解度確認テスト</h3>
                        <div class="quiz-container">
                            <h4>第2章の理解度チェック</h4>
                            <p>以下の問題に答えて、第2章の内容の理解度を確認しましょう。</p>
                            
                            <div class="quiz-question">
                                <p><strong>問題1:</strong> DriverManagerクラスの主な役割として正しくないものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                                    <label class="form-check-label" for="q1a">
                                        JDBCドライバの登録と管理
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                    <label class="form-check-label" for="q1b">
                                        データベース接続の確立
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                                        <label class="form-check-label" for="q1c">
                                        SQLクエリの最適化
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                                        <label class="form-check-label" for="q1d">
                                        接続プロパティの設定
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題2:</strong> トランザクション管理に関する記述として正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                                    <label class="form-check-label" for="q2a">
                                        JDBCでは、デフォルトで自動コミットモードはOFFになっている
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                    <label class="form-check-label" for="q2b">
                                        トランザクションを開始するには、explicitTransaction()メソッドを呼び出す
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                                        <label class="form-check-label" for="q2c">
                                        自動コミットモードをOFFにするには、setAutoCommit(false)メソッドを使用する
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                                        <label class="form-check-label" for="q2d">
                                        一度トランザクションをコミットした後は、再度コミットできない
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題3:</strong> PreparedStatementの利点としてふさわしくないものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                                    <label class="form-check-label" for="q3a">
                                        SQLインジェクション攻撃の防止に役立つ
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                    <label class="form-check-label" for="q3b">
                                        SQL文を事前コンパイルすることでパフォーマンスが向上する
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                                        <label class="form-check-label" for="q3c">
                                        バイナリデータの処理が容易になる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                                        <label class="form-check-label" for="q3d">
                                        データベーススキーマを自動的に最適化する
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題4:</strong> JDBC URLの基本構造として正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
                                    <label class="form-check-label" for="q4a">
                                        jdbc-protocol://host:port/database
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                    <label class="form-check-label" for="q4b">
                                        jdbc:サブプロトコル:サブネーム
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
                                        <label class="form-check-label" for="q4c">
                                        database:jdbc:host:port
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
                                        <label class="form-check-label" for="q4d">
                                        jdbc-driver:url:credentials
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題5:</strong> ResultSetオブジェクトの操作に関する記述として正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
                                    <label class="form-check-label" for="q5a">
                                        next()メソッドは最初の行に移動する前に一度呼び出す必要がある
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                    <label class="form-check-label" for="q5b">
                                        列インデックスは0から始まる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
                                        <label class="form-check-label" for="q5c">
                                        getInt("columnName")のように列名を使って値を取得できる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
                                        <label class="form-check-label" for="q5d">
                                        ResultSetは自動的にクローズされるため、close()メソッドを呼び出す必要はない
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary mt-3" id="checkAnswers">回答を確認</button>
                            <div id="quizResults" class="mt-3 d-none">
                                <div class="alert alert-success">
                                    <h5>正解:</h5>
                                    <ol>
                                        <li>c（SQLクエリの最適化）</li>
                                        <li>c（自動コミットモードをOFFにするには、setAutoCommit(false)メソッドを使用する）</li>
                                        <li>d（データベーススキーマを自動的に最適化する）</li>
                                        <li>b（jdbc:サブプロトコル:サブネーム）</li>
                                        <li>c（getInt("columnName")のように列名を使って値を取得できる）</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="next-steps">
                        <h3 class="section-title">次のステップ</h3>
                        <p>この章では、JDBC接続の基本概念と使用方法について学びました。次の章では、JDBCを使った基本的なデータ操作（CRUD操作）について詳しく学んでいきます。</p>
                        <p>JDBC接続の概念を理解し、実際の接続プログラムを作成することで、この章の内容をしっかりと身につけましょう。</p>
                        <div class="note">
                            <h5>推奨される追加学習</h5>
                            <ul>
                                <li><strong>PostgreSQLの公式ドキュメント</strong>：<a href="https://www.postgresql.org/docs/" target="_blank">PostgreSQL Documentation</a></li>
                                <li><strong>PostgreSQL JDBCドライバ</strong>：<a href="https://jdbc.postgresql.org/documentation/head/" target="_blank">PostgreSQL JDBC Driver Documentation</a></li>
                                <li><strong>HikariCP接続プール</strong>：<a href="https://github.com/brettwooldridge/HikariCP" target="_blank">HikariCP - A High-performance JDBC Connection Pool</a></li>
                                <li><strong>トランザクション管理</strong>：データベースのACID特性と実際のアプリケーションでのトランザクション管理について調べてみましょう</li>
                            </ul>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">Copyright © 2025 F-Circle All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 理解度テストの回答確認ボタンの処理
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.getElementById('quizResults').classList.remove('d-none');
        });
    </script>
</body>
</html>