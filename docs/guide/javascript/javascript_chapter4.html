<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JavaScript初心者向け学習教材 - 第4章：ブラウザDOM入門</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        code {
            display: block;
            background-color: #f5f5f5;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .quiz-question {
            font-weight: 500;
            margin-bottom: 1rem;
        }
        .diagram {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            text-align: center;
        }
        .exercise {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        #table-of-contents .list-group-item {
            border: none;
            padding: 0.5rem 1rem;
        }
        #table-of-contents .list-group-item-action {
            color: #1976d2;
        }
        #table-of-contents .list-group-item-action.active,
        .list-group-item.active {
            color: white !important;
            background-color: #1976d2;
            border-color: #1976d2;
        }
        .section-nav {
            padding-left: 1rem;
        }
        .inline-code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            display: inline;
        }
        footer {
            background-color: #1565c0;
            color: white;
            padding: 1rem 0;
            margin-top: 3rem;
        }
        .table-example {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
        }
        .table-example th {
            background-color: #e3f2fd;
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .table-example td {
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: left;
        }
        .example-result {
            background-color: #f1f8e9;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .step-number {
            background-color: #1976d2;
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            font-weight: bold;
        }
        .demo-box {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            background-color: #fafafa;
        }
        .highlight {
            background-color: #ffeb3b;
            padding: 2px 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#tableOfContents">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">JavaScript初心者向け学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#introduction">はじめに</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#chapter4">第4章: ブラウザDOM入門</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <!-- Sidebar - Table of Contents -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">目次</h5>
                        </div>
                        <div id="table-of-contents" class="list-group list-group-flush">
                            <a href="#introduction" class="list-group-item list-group-item-action">はじめに</a>
                            <a href="#chapter4" class="list-group-item list-group-item-action">第4章: ブラウザDOM入門</a>
                            <div class="section-nav">
                                <a href="#window-object" class="list-group-item list-group-item-action">4.1 windowオブジェクト</a>
                                <a href="#dom-tree" class="list-group-item list-group-item-action">4.2 DOMツリーと要素取得</a>
                                <a href="#event-listeners" class="list-group-item list-group-item-action">4.3 イベントリスナ</a>
                                <a href="#class-operations" class="list-group-item list-group-item-action">4.4 クラス操作</a>
                                <a href="#form-validation" class="list-group-item list-group-item-action">4.5 フォームバリデーション</a>
                                <a href="#mini-project" class="list-group-item list-group-item-action">4.6 ミニプロジェクト</a>
                                <a href="#chapter4-quiz" class="list-group-item list-group-item-action">4.7 理解度確認テスト</a>
                            </div>
                            <a href="#next-steps" class="list-group-item list-group-item-action">次のステップ</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <section id="introduction">
                    <h1 class="display-5 mb-4">JavaScript初心者向け学習教材</h1>
                    <p class="lead">第4章では、ブラウザ上でJavaScriptを使ってWebページを動的に操作する方法を学習します。DOM（Document Object Model）を理解し、HTML要素の取得・操作・イベント処理を習得します。</p>

                    <div class="note">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>windowオブジェクトとブラウザAPIの基本</li>
                            <li>DOMツリーの構造とquerySelectorの使い方</li>
                            <li>click、input、submitイベントの処理</li>
                            <li>classListを使ったCSSクラスの操作</li>
                            <li>基本的なフォームバリデーション</li>
                            <li>ライト/ダークモード切り替え機能の実装</li>
                        </ul>
                    </div>
                </section>

                <section id="chapter4">
                    <h2 class="chapter-title">第4章：ブラウザDOM入門</h2>
                    <p>DOM（Document Object Model）は、HTMLドキュメントをJavaScriptで操作するためのAPIです。この章では、ブラウザ上でリアルタイムにWebページを変更する方法を学習します。</p>

                    <section id="window-object">
                        <h3 class="section-title">4.1 windowオブジェクト</h3>
                        <p>ブラウザ環境では、<span class="inline-code">window</span>オブジェクトがグローバルオブジェクトとして機能します。ブラウザのウィンドウやタブを表現し、多くの便利なメソッドとプロパティを提供します。</p>

                        <h4>windowオブジェクトの主要なプロパティ</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>プロパティ</th>
                                    <th>説明</th>
                                    <th>例</th>
                                </tr>
                                <tr>
                                    <td>window.document</td>
                                    <td>現在のHTMLドキュメント</td>
                                    <td>document.title</td>
                                </tr>
                                <tr>
                                    <td>window.location</td>
                                    <td>現在のURL情報</td>
                                    <td>location.href</td>
                                </tr>
                                <tr>
                                    <td>window.localStorage</td>
                                    <td>ブラウザの永続ストレージ</td>
                                    <td>localStorage.setItem()</td>
                                </tr>
                                <tr>
                                    <td>window.console</td>
                                    <td>開発者コンソール</td>
                                    <td>console.log()</td>
                                </tr>
                            </table>
                        </div>

                        <code>// windowオブジェクトの基本操作
// ページのタイトルを取得・変更
console.log(window.document.title);
window.document.title = '新しいタイトル';

// 現在のURLを取得
console.log(window.location.href);

// アラートダイアログを表示
window.alert('こんにちは！');

// 確認ダイアログを表示
const result = window.confirm('続行しますか？');
console.log(result); // true または false

// 入力ダイアログを表示
const name = window.prompt('お名前を入力してください');
console.log('入力された名前: ' + name);</code>

                        <div class="exercise">
                            <h5>実習 4.1.1: windowオブジェクトの操作</h5>
                            <ol>
                                <li>ブラウザの開発者ツールを開く</li>
                                <li>Consoleタブで以下のコードを実行：</li>
                            </ol>
                            <code>// ページタイトルを変更
document.title = 'DOM学習中';

// 現在時刻をアラートで表示
alert('現在時刻: ' + new Date().toLocaleTimeString());

// ユーザーに好きな色を聞いて表示
const color = prompt('好きな色を教えてください');
console.log('好きな色: ' + color);</code>
                        </div>
                    </section>

                    <section id="dom-tree">
                        <h3 class="section-title">4.2 DOMツリーと要素取得</h3>
                        <p>HTMLドキュメントは階層構造（ツリー構造）として表現されます。JavaScriptから特定の要素を取得し、操作するための方法を学習します。</p>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 400" width="600" height="400">
                                <!-- Document -->
                                <rect x="250" y="20" width="100" height="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="300" y="45" text-anchor="middle" font-size="14" font-weight="bold">document</text>
                                
                                <!-- HTML -->
                                <rect x="250" y="100" width="100" height="40" fill="#fff3e0" stroke="#f57c00" stroke-width="2" rx="5" />
                                <text x="300" y="125" text-anchor="middle" font-size="14" font-weight="bold">&lt;html&gt;</text>
                                
                                <!-- HEAD and BODY -->
                                <rect x="150" y="180" width="80" height="40" fill="#f3e5f5" stroke="#7b1fa2" stroke-width="2" rx="5" />
                                <text x="190" y="205" text-anchor="middle" font-size="12" font-weight="bold">&lt;head&gt;</text>
                                
                                <rect x="370" y="180" width="80" height="40" fill="#e8f5e9" stroke="#388e3c" stroke-width="2" rx="5" />
                                <text x="410" y="205" text-anchor="middle" font-size="12" font-weight="bold">&lt;body&gt;</text>
                                
                                <!-- TITLE -->
                                <rect x="130" y="260" width="60" height="30" fill="#fff8e1" stroke="#fbc02d" stroke-width="1" rx="3" />
                                <text x="160" y="280" text-anchor="middle" font-size="10">&lt;title&gt;</text>
                                
                                <!-- DIV, H1, P -->
                                <rect x="320" y="260" width="50" height="30" fill="#fce4ec" stroke="#c2185b" stroke-width="1" rx="3" />
                                <text x="345" y="280" text-anchor="middle" font-size="10">&lt;div&gt;</text>
                                
                                <rect x="390" y="260" width="50" height="30" fill="#e0f2f1" stroke="#00695c" stroke-width="1" rx="3" />
                                <text x="415" y="280" text-anchor="middle" font-size="10">&lt;h1&gt;</text>
                                
                                <rect x="460" y="260" width="50" height="30" fill="#f1f8e9" stroke="#689f38" stroke-width="1" rx="3" />
                                <text x="485" y="280" text-anchor="middle" font-size="10">&lt;p&gt;</text>
                                
                                <!-- Lines -->
                                <line x1="300" y1="60" x2="300" y2="100" stroke="#666" stroke-width="2" />
                                <line x1="300" y1="140" x2="190" y2="180" stroke="#666" stroke-width="2" />
                                <line x1="300" y1="140" x2="410" y2="180" stroke="#666" stroke-width="2" />
                                <line x1="190" y1="220" x2="160" y2="260" stroke="#666" stroke-width="1" />
                                <line x1="410" y1="220" x2="345" y2="260" stroke="#666" stroke-width="1" />
                                <line x1="410" y1="220" x2="415" y2="260" stroke="#666" stroke-width="1" />
                                <line x1="410" y1="220" x2="485" y2="260" stroke="#666" stroke-width="1" />
                                
                                <!-- Labels -->
                                <text x="300" y="350" text-anchor="middle" font-size="14" font-weight="bold">図4.1: DOMツリーの構造</text>
                            </svg>
                        </div>

                        <h4>要素取得メソッド</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>戻り値</th>
                                </tr>
                                <tr>
                                    <td>querySelector()</td>
                                    <td>CSSセレクタで最初の要素を取得</td>
                                    <td>Element または null</td>
                                </tr>
                                <tr>
                                    <td>querySelectorAll()</td>
                                    <td>CSSセレクタで全ての要素を取得</td>
                                    <td>NodeList</td>
                                </tr>
                                <tr>
                                    <td>getElementById()</td>
                                    <td>IDで要素を取得</td>
                                    <td>Element または null</td>
                                </tr>
                                <tr>
                                    <td>getElementsByClassName()</td>
                                    <td>クラス名で要素を取得</td>
                                    <td>HTMLCollection</td>
                                </tr>
                            </table>
                        </div>

                        <code>// HTML例
/*
&lt;div id="container"&gt;
    &lt;h1 class="title"&gt;タイトル&lt;/h1&gt;
    &lt;p class="text"&gt;段落1&lt;/p&gt;
    &lt;p class="text highlight"&gt;段落2&lt;/p&gt;
    &lt;button id="btn"&gt;クリック&lt;/button&gt;
&lt;/div&gt;
*/

// IDで要素を取得
const container = document.querySelector('#container');
const button = document.getElementById('btn');

// クラス名で要素を取得
const title = document.querySelector('.title');
const textElements = document.querySelectorAll('.text');

// タグ名で要素を取得
const paragraphs = document.querySelectorAll('p');

// 複合セレクタを使用
const highlightText = document.querySelector('p.highlight');
const firstChild = document.querySelector('#container > h1');

// 要素の存在確認
if (button) {
    console.log('ボタンが見つかりました');
} else {
    console.log('ボタンが見つかりません');
}</code>

                        <div class="exercise">
                            <h5>実習 4.2.1: 要素の取得と操作</h5>
                            <p>以下のHTMLを新しいファイル「dom-practice.html」として作成し、JavaScriptで要素を操作してみましょう：</p>
                            <code>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;DOM練習&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id="main"&gt;
        &lt;h1 id="page-title"&gt;DOM操作の練習&lt;/h1&gt;
        &lt;p class="message"&gt;最初のメッセージ&lt;/p&gt;
        &lt;p class="message highlight"&gt;重要なメッセージ&lt;/p&gt;
        &lt;button id="change-btn"&gt;テキストを変更&lt;/button&gt;
    &lt;/div&gt;
    
    &lt;script&gt;
        // ここにJavaScriptコードを書く
        const title = document.getElementById('page-title');
        const messages = document.querySelectorAll('.message');
        
        console.log('タイトル:', title.textContent);
        console.log('メッセージ数:', messages.length);
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
                        </div>
                    </section>

                    <section id="event-listeners">
                        <h3 class="section-title">4.3 イベントリスナ</h3>
                        <p>ユーザーの操作（クリック、入力、フォーム送信など）に反応するため、イベントリスナを設定します。これにより、インタラクティブなWebページを作成できます。</p>

                        <h4>主要なイベント</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>イベント</th>
                                    <th>発生タイミング</th>
                                    <th>よく使用する要素</th>
                                </tr>
                                <tr>
                                    <td>click</td>
                                    <td>要素がクリックされた時</td>
                                    <td>button, a, div</td>
                                </tr>
                                <tr>
                                    <td>input</td>
                                    <td>入力値が変更された時</td>
                                    <td>input, textarea</td>
                                </tr>
                                <tr>
                                    <td>submit</td>
                                    <td>フォームが送信された時</td>
                                    <td>form</td>
                                </tr>
                                <tr>
                                    <td>load</td>
                                    <td>ページの読み込み完了時</td>
                                    <td>window</td>
                                </tr>
                                <tr>
                                    <td>change</td>
                                    <td>要素の値が変更された時</td>
                                    <td>select, input</td>
                                </tr>
                            </table>
                        </div>

                        <code>// イベントリスナの基本的な設定方法
// ボタンクリックイベント
const button = document.getElementById('my-button');
button.addEventListener('click', function() {
    console.log('ボタンがクリックされました！');
});

// アロー関数を使用した書き方
button.addEventListener('click', () =&gt; {
    console.log('ボタンがクリックされました！');
});

// 入力フィールドの変更を監視
const textInput = document.getElementById('text-input');
textInput.addEventListener('input', (event) =&gt; {
    console.log('入力値:', event.target.value);
});

// フォーム送信を処理
const form = document.getElementById('my-form');
form.addEventListener('submit', (event) =&gt; {
    event.preventDefault(); // デフォルトの送信動作を防ぐ
    console.log('フォームが送信されました');
});</code>

                        <h4>イベントオブジェクト</h4>
                        <p>イベントリスナの関数には、イベントオブジェクトが渡されます。これには有用な情報が含まれています：</p>

                        <code>button.addEventListener('click', (event) =&gt; {
    console.log('イベントタイプ:', event.type); // 'click'
    console.log('クリックされた要素:', event.target);
    console.log('マウスX座標:', event.clientX);
    console.log('マウスY座標:', event.clientY);
});

// キーボードイベントの例
textInput.addEventListener('keydown', (event) =&gt; {
    console.log('押されたキー:', event.key);
    if (event.key === 'Enter') {
        console.log('Enterキーが押されました');
    }
});</code>

                        <div class="exercise">
                            <h5>実習 4.3.1: インタラクティブな計算機</h5>
                            <p>簡単な計算機を作成してイベント処理を学習しましょう：</p>
                            <code>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;簡単計算機&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;簡単計算機&lt;/h2&gt;
    &lt;input type="number" id="num1" placeholder="数値1"&gt;
    &lt;select id="operator"&gt;
        &lt;option value="+"&gt;+&lt;/option&gt;
        &lt;option value="-"&gt;-&lt;/option&gt;
        &lt;option value="*"&gt;×&lt;/option&gt;
        &lt;option value="/"&gt;÷&lt;/option&gt;
    &lt;/select&gt;
    &lt;input type="number" id="num2" placeholder="数値2"&gt;
    &lt;button id="calculate"&gt;計算&lt;/button&gt;
    &lt;p id="result"&gt;結果: &lt;/p&gt;

    &lt;script&gt;
        const num1Input = document.getElementById('num1');
        const num2Input = document.getElementById('num2');
        const operatorSelect = document.getElementById('operator');
        const calculateBtn = document.getElementById('calculate');
        const resultP = document.getElementById('result');

        calculateBtn.addEventListener('click', () =&gt; {
            const num1 = parseFloat(num1Input.value);
            const num2 = parseFloat(num2Input.value);
            const operator = operatorSelect.value;
            
            let result;
            switch (operator) {
                case '+':
                    result = num1 + num2;
                    break;
                case '-':
                    result = num1 - num2;
                    break;
                case '*':
                    result = num1 * num2;
                    break;
                case '/':
                    result = num1 / num2;
                    break;
            }
            
            resultP.textContent = `結果: ${result}`;
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
                        </div>
                    </section>

                    <section id="class-operations">
                        <h3 class="section-title">4.4 クラス操作</h3>
                        <p>CSSクラスの追加・削除・切り替えによって、要素の見た目や動作を動的に変更できます。classListプロパティを使用します。</p>

                        <h4>classListのメソッド</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>メソッド</th>
                                    <th>説明</th>
                                    <th>戻り値</th>
                                </tr>
                                <tr>
                                    <td>add(class)</td>
                                    <td>クラスを追加</td>
                                    <td>undefined</td>
                                </tr>
                                <tr>
                                    <td>remove(class)</td>
                                    <td>クラスを削除</td>
                                    <td>undefined</td>
                                </tr>
                                <tr>
                                    <td>toggle(class)</td>
                                    <td>クラスの切り替え</td>
                                    <td>boolean</td>
                                </tr>
                                <tr>
                                    <td>contains(class)</td>
                                    <td>クラスの存在確認</td>
                                    <td>boolean</td>
                                </tr>
                            </table>
                        </div>

                        <code>// CSS例
/*
.hidden { display: none; }
.highlight { background-color: yellow; }
.active { color: blue; font-weight: bold; }
.error { border: 2px solid red; }
*/

// 要素を取得
const element = document.getElementById('my-element');

// クラスを追加
element.classList.add('highlight');
element.classList.add('active');

// 複数のクラスを同時に追加
element.classList.add('highlight', 'active');

// クラスを削除
element.classList.remove('hidden');

// クラスの存在確認
if (element.classList.contains('active')) {
    console.log('activeクラスが設定されています');
}

// クラスの切り替え（toggleの活用）
element.classList.toggle('hidden'); // hiddenクラスがあれば削除、なければ追加

// toggleの戻り値を利用
const isActive = element.classList.toggle('active');
console.log('activeクラスが設定されている:', isActive);</code>

                        <div class="exercise">
                            <h5>実習 4.4.1: アコーディオンメニュー</h5>
                            <p>クラス操作を使ってアコーディオンメニューを作成しましょう：</p>
                            <code>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;アコーディオンメニュー&lt;/title&gt;
    &lt;style&gt;
        .accordion-header {
            background-color: #f0f0f0;
            padding: 10px;
            cursor: pointer;
            border: 1px solid #ccc;
            margin-bottom: 5px;
        }
        .accordion-content {
            padding: 10px;
            border: 1px solid #ccc;
            border-top: none;
            display: block;
        }
        .hidden {
            display: none;
        }
        .active {
            background-color: #007bff;
            color: white;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;アコーディオンメニュー&lt;/h2&gt;
    
    &lt;div class="accordion-header" data-target="content1"&gt;
        セクション1 ▼
    &lt;/div&gt;
    &lt;div id="content1" class="accordion-content"&gt;
        セクション1の内容です。ここにはいろいろな情報が含まれています。
    &lt;/div&gt;
    
    &lt;div class="accordion-header" data-target="content2"&gt;
        セクション2 ▼
    &lt;/div&gt;
    &lt;div id="content2" class="accordion-content hidden"&gt;
        セクション2の内容です。デフォルトでは非表示になっています。
    &lt;/div&gt;
    
    &lt;div class="accordion-header" data-target="content3"&gt;
        セクション3 ▼
    &lt;/div&gt;
    &lt;div id="content3" class="accordion-content hidden"&gt;
        セクション3の内容です。クリックで表示・非表示を切り替えられます。
    &lt;/div&gt;

    &lt;script&gt;
        const headers = document.querySelectorAll('.accordion-header');
        
        headers.forEach(header =&gt; {
            header.addEventListener('click', () =&gt; {
                const targetId = header.getAttribute('data-target');
                const content = document.getElementById(targetId);
                
                // コンテンツの表示・非表示を切り替え
                content.classList.toggle('hidden');
                
                // ヘッダーのアクティブ状態を切り替え
                header.classList.toggle('active');
            });
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
                        </div>
                    </section>

                    <section id="form-validation">
                        <h3 class="section-title">4.5 フォームバリデーション</h3>
                        <p>ユーザー入力の検証（バリデーション）は、データの品質を保つために重要です。JavaScriptを使って基本的なフォームバリデーションを実装します。</p>

                        <h4>バリデーションの基本パターン</h4>
                        <code>// フォームバリデーションの基本構造
function validateForm() {
    let isValid = true;
    const errors = [];

    // 名前の検証
    const name = document.getElementById('name').value.trim();
    if (name === '') {
        errors.push('名前は必須です');
        isValid = false;
    } else if (name.length &lt; 2) {
        errors.push('名前は2文字以上で入力してください');
        isValid = false;
    }

    // メールアドレスの検証
    const email = document.getElementById('email').value.trim();
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (email === '') {
        errors.push('メールアドレスは必須です');
        isValid = false;
    } else if (!emailRegex.test(email)) {
        errors.push('有効なメールアドレスを入力してください');
        isValid = false;
    }

    // 年齢の検証
    const age = parseInt(document.getElementById('age').value);
    if (isNaN(age)) {
        errors.push('年齢は数値で入力してください');
        isValid = false;
    } else if (age &lt; 0 || age &gt; 120) {
        errors.push('年齢は0〜120の範囲で入力してください');
        isValid = false;
    }

    return { isValid, errors };
}</code>

                        <h4>リアルタイムバリデーション</h4>
                        <code>// 入力中にリアルタイムでバリデーション
const emailInput = document.getElementById('email');
const emailError = document.getElementById('email-error');

emailInput.addEventListener('input', (event) =&gt; {
    const email = event.target.value;
    const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    
    if (email === '') {
        emailError.textContent = '';
        emailInput.classList.remove('error', 'valid');
    } else if (emailRegex.test(email)) {
        emailError.textContent = '';
        emailInput.classList.remove('error');
        emailInput.classList.add('valid');
    } else {
        emailError.textContent = '有効なメールアドレスを入力してください';
        emailInput.classList.remove('valid');
        emailInput.classList.add('error');
    }
});</code>

                        <div class="exercise">
                            <h5>実習 4.5.1: 登録フォームのバリデーション</h5>
                            <p>完全なフォームバリデーション機能を実装しましょう：</p>
                            <code>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;登録フォーム&lt;/title&gt;
    &lt;style&gt;
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; }
        .form-group input { width: 300px; padding: 8px; font-size: 14px; }
        .error { border: 2px solid red; }
        .valid { border: 2px solid green; }
        .error-message { color: red; font-size: 12px; margin-top: 5px; }
        .success-message { color: green; font-weight: bold; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;ユーザー登録フォーム&lt;/h2&gt;
    
    &lt;form id="registration-form"&gt;
        &lt;div class="form-group"&gt;
            &lt;label for="username"&gt;ユーザー名:&lt;/label&gt;
            &lt;input type="text" id="username" name="username" required&gt;
            &lt;div id="username-error" class="error-message"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="form-group"&gt;
            &lt;label for="email"&gt;メールアドレス:&lt;/label&gt;
            &lt;input type="email" id="email" name="email" required&gt;
            &lt;div id="email-error" class="error-message"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="form-group"&gt;
            &lt;label for="password"&gt;パスワード:&lt;/label&gt;
            &lt;input type="password" id="password" name="password" required&gt;
            &lt;div id="password-error" class="error-message"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;div class="form-group"&gt;
            &lt;label for="confirm-password"&gt;パスワード確認:&lt;/label&gt;
            &lt;input type="password" id="confirm-password" name="confirm-password" required&gt;
            &lt;div id="confirm-password-error" class="error-message"&gt;&lt;/div&gt;
        &lt;/div&gt;

        &lt;button type="submit"&gt;登録&lt;/button&gt;
    &lt;/form&gt;

    &lt;div id="result"&gt;&lt;/div&gt;

    &lt;script&gt;
        const form = document.getElementById('registration-form');
        
        // バリデーション関数
        function validateField(fieldId, validator) {
            const field = document.getElementById(fieldId);
            const errorDiv = document.getElementById(fieldId + '-error');
            const result = validator(field.value);
            
            if (result.isValid) {
                field.classList.remove('error');
                field.classList.add('valid');
                errorDiv.textContent = '';
            } else {
                field.classList.remove('valid');
                field.classList.add('error');
                errorDiv.textContent = result.message;
            }
            
            return result.isValid;
        }

        // 各フィールドのバリデーションルール
        const validators = {
            username: (value) =&gt; ({
                isValid: value.length &gt;= 3,
                message: value.length === 0 ? 'ユーザー名は必須です' : 'ユーザー名は3文字以上で入力してください'
            }),
            email: (value) =&gt; ({
                isValid: /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(value),
                message: value.length === 0 ? 'メールアドレスは必須です' : '有効なメールアドレスを入力してください'
            }),
            password: (value) =&gt; ({
                isValid: value.length &gt;= 6,
                message: value.length === 0 ? 'パスワードは必須です' : 'パスワードは6文字以上で入力してください'
            })
        };

        // リアルタイムバリデーション
        ['username', 'email', 'password'].forEach(fieldId =&gt; {
            document.getElementById(fieldId).addEventListener('input', () =&gt; {
                validateField(fieldId, validators[fieldId]);
            });
        });

        // パスワード確認の特別処理
        document.getElementById('confirm-password').addEventListener('input', () =&gt; {
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirm-password').value;
            validateField('confirm-password', (value) =&gt; ({
                isValid: value === password && value.length &gt; 0,
                message: value.length === 0 ? 'パスワード確認は必須です' : 'パスワードが一致しません'
            }));
        });

        // フォーム送信時の検証
        form.addEventListener('submit', (event) =&gt; {
            event.preventDefault();
            
            const isUsernameValid = validateField('username', validators.username);
            const isEmailValid = validateField('email', validators.email);
            const isPasswordValid = validateField('password', validators.password);
            const isConfirmPasswordValid = validateField('confirm-password', (value) =&gt; ({
                isValid: value === document.getElementById('password').value && value.length &gt; 0,
                message: value.length === 0 ? 'パスワード確認は必須です' : 'パスワードが一致しません'
            }));
            
            if (isUsernameValid && isEmailValid && isPasswordValid && isConfirmPasswordValid) {
                document.getElementById('result').innerHTML = '&lt;div class="success-message"&gt;登録が完了しました！&lt;/div&gt;';
            } else {
                document.getElementById('result').innerHTML = '&lt;div class="error-message"&gt;入力内容を確認してください。&lt;/div&gt;';
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
                        </div>
                    </section>

                    <section id="mini-project">
                        <h3 class="section-title">4.6 ミニプロジェクト：ライト/ダークモード切り替え</h3>
                        <p>この章で学習した内容を活用して、ライト/ダークモード切り替え機能を実装します。</p>

                        <div class="exercise">
                            <h5>プロジェクト 4.6.1: テーマ切り替え機能</h5>
                            <p>以下の機能を持つWebページを作成しましょう：</p>
                            <ul>
                                <li>ライト/ダークモードの切り替えボタン</li>
                                <li>テーマ設定をlocalStorageに保存</li>
                                <li>ページ読み込み時に保存されたテーマを適用</li>
                                <li>アニメーション効果付きの切り替え</li>
                            </ul>
                            <code>&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;テーマ切り替えデモ&lt;/title&gt;
    &lt;style&gt;
        * { transition: all 0.3s ease; }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
        }
        
        /* ライトモード（デフォルト） */
        body.light {
            background-color: #ffffff;
            color: #333333;
        }
        
        /* ダークモード */
        body.dark {
            background-color: #1a1a1a;
            color: #ffffff;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            border-radius: 10px;
        }
        
        .light .container {
            background-color: #f8f9fa;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .dark .container {
            background-color: #2d2d2d;
            box-shadow: 0 2px 10px rgba(255,255,255,0.1);
        }
        
        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
        }
        
        .light .theme-toggle {
            background-color: #333;
            color: #fff;
        }
        
        .dark .theme-toggle {
            background-color: #fff;
            color: #333;
        }
        
        .card {
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
        }
        
        .light .card {
            background-color: #fff;
            border: 1px solid #dee2e6;
        }
        
        .dark .card {
            background-color: #3a3a3a;
            border: 1px solid #555;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 10px 0;
            border-bottom: 1px solid;
        }
        
        .light .feature-list li {
            border-bottom-color: #dee2e6;
        }
        
        .dark .feature-list li {
            border-bottom-color: #555;
        }
        
        .status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 10px 15px;
            border-radius: 5px;
            font-weight: bold;
        }
        
        .light .status {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .dark .status {
            background-color: #383d41;
            color: #d1ecf1;
            border: 1px solid #bee5eb;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body class="light"&gt;
    &lt;button class="theme-toggle" id="themeToggle"&gt;🌙 ダークモード&lt;/button&gt;
    
    &lt;div class="container"&gt;
        &lt;h1&gt;テーマ切り替えデモ&lt;/h1&gt;
        
        &lt;div class="card"&gt;
            &lt;h2&gt;機能紹介&lt;/h2&gt;
            &lt;p&gt;このページでは、JavaScriptを使ったテーマ切り替え機能をデモしています。&lt;/p&gt;
            &lt;ul class="feature-list"&gt;
                &lt;li&gt;✨ スムーズなアニメーション効果&lt;/li&gt;
                &lt;li&gt;💾 テーマ設定の自動保存&lt;/li&gt;
                &lt;li&gt;🔄 ページリロード後も設定維持&lt;/li&gt;
                &lt;li&gt;🎨 完全なカラーパレット変更&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
        
        &lt;div class="card"&gt;
            &lt;h2&gt;使用技術&lt;/h2&gt;
            &lt;p&gt;このデモで使用している技術：&lt;/p&gt;
            &lt;ul&gt;
                &lt;li&gt;DOM操作（classList.toggle）&lt;/li&gt;
                &lt;li&gt;localStorage API&lt;/li&gt;
                &lt;li&gt;イベントリスナ&lt;/li&gt;
                &lt;li&gt;CSS変数とtransition&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
        
        &lt;div class="card"&gt;
            &lt;h2&gt;操作方法&lt;/h2&gt;
            &lt;p&gt;右上のボタンをクリックして、ライトモードとダークモードを切り替えてみてください。&lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;div class="status" id="status"&gt;現在のテーマ: ライトモード&lt;/div&gt;

    &lt;script&gt;
        // DOM要素の取得
        const body = document.body;
        const themeToggle = document.getElementById('themeToggle');
        const status = document.getElementById('status');
        
        // 現在のテーマを取得
        function getCurrentTheme() {
            return body.classList.contains('dark') ? 'dark' : 'light';
        }
        
        // テーマを設定
        function setTheme(theme) {
            if (theme === 'dark') {
                body.classList.remove('light');
                body.classList.add('dark');
                themeToggle.textContent = '☀️ ライトモード';
                status.textContent = '現在のテーマ: ダークモード';
            } else {
                body.classList.remove('dark');
                body.classList.add('light');
                themeToggle.textContent = '🌙 ダークモード';
                status.textContent = '現在のテーマ: ライトモード';
            }
            
            // localStorageに保存
            localStorage.setItem('theme', theme);
        }
        
        // テーマ切り替え
        function toggleTheme() {
            const currentTheme = getCurrentTheme();
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            setTheme(newTheme);
        }
        
        // ページ読み込み時にlocalStorageからテーマを復元
        function loadSavedTheme() {
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                setTheme(savedTheme);
            }
        }
        
        // イベントリスナの設定
        themeToggle.addEventListener('click', toggleTheme);
        
        // キーボードショートカット（Ctrl + D）
        document.addEventListener('keydown', (event) =&gt; {
            if (event.ctrlKey && event.key === 'd') {
                event.preventDefault();
                toggleTheme();
            }
        });
        
        // ページ読み込み時の初期化
        window.addEventListener('load', () =&gt; {
            loadSavedTheme();
            console.log('テーマ切り替え機能が初期化されました');
        });
        
        // システムのダークモード設定を検出（上級者向け）
        const prefersDarkScheme = window.matchMedia('(prefers-color-scheme: dark)');
        
        // システム設定が変更された場合の対応
        prefersDarkScheme.addEventListener('change', (event) =&gt; {
            // ユーザーが明示的にテーマを選択していない場合のみ、システム設定に従う
            if (!localStorage.getItem('theme')) {
                setTheme(event.matches ? 'dark' : 'light');
            }
        });
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code>
                        </div>
                    </section>

                    <section id="chapter4-quiz">
                        <h3 class="section-title">4.7 理解度確認テスト</h3>
                        <div class="quiz-container">
                            <h4>第4章の理解度チェック</h4>
                            <p>以下の問題に答えて、第4章の内容の理解度を確認しましょう。</p>
                            
                            <div class="quiz-question">
                                <p><strong>問題1:</strong> DOMで要素を取得するメソッドとして、適切でないものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                                    <label class="form-check-label" for="q1a">
                                        querySelector()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                    <label class="form-check-label" for="q1b">
                                        getElementById()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                                        <label class="form-check-label" for="q1c">
                                        getElementByAttribute()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                                        <label class="form-check-label" for="q1d">
                                        querySelectorAll()
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題2:</strong> CSSクラスを切り替える正しいメソッドはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                                    <label class="form-check-label" for="q2a">
                                        element.classList.switch()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                    <label class="form-check-label" for="q2b">
                                        element.classList.toggle()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                                        <label class="form-check-label" for="q2c">
                                        element.classList.change()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                                        <label class="form-check-label" for="q2d">
                                        element.classList.flip()
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題3:</strong> フォームのデフォルト送信動作を防ぐ正しい方法はどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                                    <label class="form-check-label" for="q3a">
                                        event.stop()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                    <label class="form-check-label" for="q3b">
                                        event.preventDefault()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                                        <label class="form-check-label" for="q3c">
                                        event.cancel()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                                        <label class="form-check-label" for="q3d">
                                        event.disable()
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題4:</strong> 入力フィールドの値をリアルタイムで監視するイベントはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
                                    <label class="form-check-label" for="q4a">
                                        change
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                    <label class="form-check-label" for="q4b">
                                        input
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
                                        <label class="form-check-label" for="q4c">
                                        keyup
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
                                        <label class="form-check-label" for="q4d">
                                        focus
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題5:</strong> localStorageの正しい使用方法はどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
                                    <label class="form-check-label" for="q5a">
                                        localStorage.save('key', 'value')
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                    <label class="form-check-label" for="q5b">
                                        localStorage.setItem('key', 'value')
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
                                        <label class="form-check-label" for="q5c">
                                        localStorage.store('key', 'value')
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
                                        <label class="form-check-label" for="q5d">
                                        localStorage.put('key', 'value')
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary mt-3" id="checkAnswers">回答を確認</button>
                            <div id="quizResults" class="mt-3 d-none">
                                <div class="alert alert-success">
                                    <h5>正解:</h5>
                                    <ol>
                                        <li>c（getElementByAttribute()は存在しません）</li>
                                        <li>b（element.classList.toggle()）</li>
                                        <li>b（event.preventDefault()）</li>
                                        <li>b（input）</li>
                                        <li>b（localStorage.setItem('key', 'value')）</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="next-steps">
                        <h3 class="section-title">次のステップ</h3>
                        <p>お疲れさまでした！第4章では、ブラウザDOM操作の基本をマスターしました。HTML要素の取得、イベント処理、クラス操作、フォームバリデーションを習得し、実際にライト/ダークモード切り替え機能を実装しました。</p>
                        
                        <div class="note">
                            <h5>第4章で習得したスキル</h5>
                            <ul>
                                <li>windowオブジェクトの基本的な使い方</li>
                                <li>DOMツリーの構造とquerySelectorの活用</li>
                                <li>click、input、submitイベントの処理</li>
                                <li>classListによるCSSクラスの動的操作</li>
                                <li>基本的なフォームバリデーションの実装</li>
                                <li>localStorageを使ったデータ保存</li>
                                <li>実用的なWebアプリケーション機能の構築</li>
                            </ul>
                        </div>

                        <p>次の第5章では、非同期処理（Promise・async/await）について学習します。外部APIからデータを取得し、非同期的に処理する方法を習得していきます。</p>
                        
                        <div class="exercise">
                            <h5>第5章に向けた準備</h5>
                            <p>第5章に進む前に、以下の点を確認してください：</p>
                            <ol>
                                <li>DOM要素を確実に取得できること</li>
                                <li>イベントリスナを適切に設定できること</li>
                                <li>classListでCSSクラスを操作できること</li>
                                <li>基本的なフォームバリデーションが実装できること</li>
                                <li>ライト/ダークモード切り替えプロジェクトが動作すること</li>
                            </ol>
                        </div>

                        <div class="warning">
                            <h5>復習のポイント</h5>
                            <p>DOM操作で重要なポイント：</p>
                            <ul>
                                <li>要素を取得する前に、その要素が存在することを確認する</li>
                                <li>イベントリスナは適切なタイミングで設定する</li>
                                <li>フォームバリデーションはサーバーサイドでも実装する（セキュリティのため）</li>
                                <li>パフォーマンスを考慮して、必要以上にDOM操作を行わない</li>
                            </ul>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">Copyright © 2025 F-Circle All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 理解度テストの回答確認ボタンの処理
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.getElementById('quizResults').classList.remove('d-none');
        });
    </script>
</body>
</html>