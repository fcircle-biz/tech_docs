<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第3章 - 制御構造とプロシージャ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #0078d4;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">VB.NET学習ガイド</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-1.html">第1章: VB.NET入門</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-2.html">第2章: 基本文法</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter3">第3章: 制御構造</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-4.html">第4章: 配列とコレクション</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-5.html">第5章: OOP基礎</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-6.html">第6章: OOP応用</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-7.html">第7章: 例外処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-8.html">第8章: ファイル操作</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-9.html">第9章: .NETライブラリ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-10.html">第10章: 実践開発</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: 制御構造とプロシージャ</h1>
                </div>

                <div id="chapter3">
                    <h2 class="chapter-title">制御構造とプロシージャ</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>If文を使用した条件分岐処理を理解する</li>
                            <li>Select Case文による多分岐処理を習得する</li>
                            <li>For文、While文、Do文を使った反復処理を学ぶ</li>
                            <li>Subプロシージャとファンクションの作成と使用方法を理解する</li>
                            <li>引数の渡し方とスコープの概念を習得する</li>
                        </ul>
                    </div>

                    <h3 class="section-title">3.1 条件分岐（If文）</h3>
                    <p>If文を使用して、条件に応じて異なる処理を実行できます。</p>

                    <h4>基本的なIf文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 基本的なIf文の構文
If 条件式 Then
    ' 条件がTrueの場合の処理
End If

' 具体例
Dim score As Integer = 85
If score >= 80 Then
    Console.WriteLine("優秀です")
End If</code></pre>

                    <h4>If...Else文</h4>
                    <pre class="code-block"><code class="language-vbnet">' If...Else文
Dim age As Integer = 18
If age >= 20 Then
    Console.WriteLine("成人です")
Else
    Console.WriteLine("未成年です")
End If</code></pre>

                    <h4>If...ElseIf...Else文</h4>
                    <pre class="code-block"><code class="language-vbnet">' 複数条件の分岐
Dim score As Integer = 75
If score >= 90 Then
    Console.WriteLine("A評価")
ElseIf score >= 80 Then
    Console.WriteLine("B評価")
ElseIf score >= 70 Then
    Console.WriteLine("C評価")
ElseIf score >= 60 Then
    Console.WriteLine("D評価")
Else
    Console.WriteLine("F評価")
End If</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 3-1: 成績判定プログラム</h5>
                        <p>学生の成績を入力し、評価を判定するプログラムを作成しましょう。</p>
                        <h6>プログラムコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Module1
    Sub Main()
        Console.Write("成績を入力してください（0-100）: ")
        Dim score As Integer = Integer.Parse(Console.ReadLine())
        
        ' 成績の妥当性チェック
        If score < 0 Or score > 100 Then
            Console.WriteLine("無効な成績です。0-100の範囲で入力してください。")
        Else
            ' 評価判定
            Dim grade As String
            If score >= 90 Then
                grade = "A"
            ElseIf score >= 80 Then
                grade = "B"
            ElseIf score >= 70 Then
                grade = "C"
            ElseIf score >= 60 Then
                grade = "D"
            Else
                grade = "F"
            End If
            
            Console.WriteLine("成績: " & score & "点")
            Console.WriteLine("評価: " & grade)
            
            ' 合否判定
            If score >= 60 Then
                Console.WriteLine("合格です！")
            Else
                Console.WriteLine("不合格です...")
            End If
        End If
        
        Console.ReadLine()
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">3.2 多分岐（Select Case文）</h3>
                    <p>多くの条件を判定する場合は、Select Case文が便利です。</p>

                    <pre class="code-block"><code class="language-vbnet">' Select Case文の基本構文
Select Case 変数
    Case 値1
        ' 値1の場合の処理
    Case 値2
        ' 値2の場合の処理
    Case Else
        ' どの値にも該当しない場合の処理
End Select

' 具体例
Dim dayOfWeek As Integer = 3
Select Case dayOfWeek
    Case 1
        Console.WriteLine("月曜日")
    Case 2
        Console.WriteLine("火曜日")
    Case 3
        Console.WriteLine("水曜日")
    Case 4
        Console.WriteLine("木曜日")
    Case 5
        Console.WriteLine("金曜日")
    Case 6, 7
        Console.WriteLine("週末")
    Case Else
        Console.WriteLine("無効な曜日です")
End Select</code></pre>

                    <h4>範囲指定とパターンマッチング</h4>
                    <pre class="code-block"><code class="language-vbnet">' 範囲を指定したSelect Case
Dim score As Integer = 85
Select Case score
    Case Is >= 90
        Console.WriteLine("優秀")
    Case 80 To 89
        Console.WriteLine("良好")
    Case 70 To 79
        Console.WriteLine("普通")
    Case 60 To 69
        Console.WriteLine("可")
    Case Else
        Console.WriteLine("不可")
End Select</code></pre>

                    <h3 class="section-title">3.3 反復処理（ループ）</h3>
                    <p>同じ処理を繰り返し実行するために、様々なループ構文を使用します。</p>

                    <h4>For...Next文</h4>
                    <pre class="code-block"><code class="language-vbnet">' For文の基本構文
For カウンタ変数 = 開始値 To 終了値 Step 増分
    ' 繰り返し処理
Next

' 具体例：1から10まで表示
For i As Integer = 1 To 10
    Console.WriteLine("数値: " & i)
Next

' Step指定（2つずつ増加）
For i As Integer = 0 To 20 Step 2
    Console.WriteLine("偶数: " & i)
Next

' 逆順（減少）
For i As Integer = 10 To 1 Step -1
    Console.WriteLine("カウントダウン: " & i)
Next</code></pre>

                    <h4>While文</h4>
                    <pre class="code-block"><code class="language-vbnet">' While文の基本構文
While 条件式
    ' 条件がTrueの間繰り返される処理
    ' 条件を変更する処理が必要
End While

' 具体例
Dim count As Integer = 1
While count <= 5
    Console.WriteLine("回数: " & count)
    count += 1  ' count = count + 1 と同じ
End While</code></pre>

                    <h4>Do...Loop文</h4>
                    <pre class="code-block"><code class="language-vbnet">' Do While...Loop（前判定）
Dim i As Integer = 1
Do While i <= 3
    Console.WriteLine("Do While: " & i)
    i += 1
Loop

' Do...Loop While（後判定）
Dim j As Integer = 1
Do
    Console.WriteLine("Do Loop While: " & j)
    j += 1
Loop While j <= 3

' Do Until...Loop（条件が偽の間実行）
Dim k As Integer = 1
Do Until k > 3
    Console.WriteLine("Do Until: " & k)
    k += 1
Loop</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 3-2: 九九表の作成</h5>
                        <p>For文を使用して九九表を作成するプログラムを作成しましょう。</p>
                        <h6>プログラムコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Module1
    Sub Main()
        Console.WriteLine("=== 九九表 ===")
        
        ' 外側のループ（1の段から9の段まで）
        For i As Integer = 1 To 9
            Console.WriteLine()
            Console.WriteLine(i & "の段:")
            
            ' 内側のループ（1から9まで掛ける）
            For j As Integer = 1 To 9
                Dim result As Integer = i * j
                Console.WriteLine(i & " × " & j & " = " & result)
            Next
        Next
        
        Console.ReadLine()
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">3.4 ループ制御文</h3>
                    <p>ループの実行を制御するための特殊な文があります。</p>

                    <pre class="code-block"><code class="language-vbnet">' Exit For（Forループを抜ける）
For i As Integer = 1 To 10
    If i = 5 Then
        Exit For  ' i=5でループを抜ける
    End If
    Console.WriteLine(i)
Next
' 結果: 1, 2, 3, 4 が表示される

' Continue For（次の繰り返しにスキップ）
For i As Integer = 1 To 10
    If i Mod 2 = 0 Then
        Continue For  ' 偶数をスキップ
    End If
    Console.WriteLine(i)
Next
' 結果: 1, 3, 5, 7, 9 が表示される</code></pre>

                    <h3 class="section-title">3.5 プロシージャ（Sub）</h3>
                    <p>処理をまとめて再利用可能にするために、プロシージャを作成します。</p>

                    <h4>基本的なSubプロシージャ</h4>
                    <pre class="code-block"><code class="language-vbnet">' Subプロシージャの定義
Sub プロシージャ名()
    ' 処理内容
End Sub

' 具体例
Sub ShowWelcomeMessage()
    Console.WriteLine("VB.NETプログラミングへようこそ！")
    Console.WriteLine("頑張って学習しましょう。")
End Sub

' プロシージャの呼び出し
Sub Main()
    ShowWelcomeMessage()  ' プロシージャを呼び出し
End Sub</code></pre>

                    <h4>引数を持つプロシージャ</h4>
                    <pre class="code-block"><code class="language-vbnet">' 引数を持つプロシージャ
Sub ShowPersonInfo(name As String, age As Integer)
    Console.WriteLine("名前: " & name)
    Console.WriteLine("年齢: " & age & "歳")
End Sub

' 複数引数のプロシージャ
Sub CalculateAndShow(num1 As Integer, num2 As Integer, operation As String)
    Dim result As Integer
    Select Case operation
        Case "+"
            result = num1 + num2
        Case "-"
            result = num1 - num2
        Case "*"
            result = num1 * num2
    End Select
    Console.WriteLine(num1 & " " & operation & " " & num2 & " = " & result)
End Sub

' 呼び出し例
Sub Main()
    ShowPersonInfo("田中太郎", 25)
    CalculateAndShow(10, 5, "+")
End Sub</code></pre>

                    <h3 class="section-title">3.6 ファンクション（Function）</h3>
                    <p>値を返すプロシージャとしてFunctionを使用します。</p>

                    <pre class="code-block"><code class="language-vbnet">' Functionの基本構文
Function 関数名(引数) As 戻り値の型
    ' 処理
    Return 戻り値
End Function

' 具体例
Function CalculateCircleArea(radius As Double) As Double
    Const PI As Double = 3.14159
    Return PI * radius * radius
End Function

Function GetGrade(score As Integer) As String
    If score >= 90 Then
        Return "A"
    ElseIf score >= 80 Then
        Return "B"
    ElseIf score >= 70 Then
        Return "C"
    ElseIf score >= 60 Then
        Return "D"
    Else
        Return "F"
    End If
End Function

' 使用例
Sub Main()
    Dim area As Double = CalculateCircleArea(5.0)
    Console.WriteLine("面積: " & area)
    
    Dim grade As String = GetGrade(85)
    Console.WriteLine("評価: " & grade)
End Sub</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 3-3: 電卓プログラム</h5>
                        <p>プロシージャとファンクションを使用した簡単な電卓プログラムを作成しましょう。</p>
                        <h6>プログラムコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Module1
    Sub Main()
        ShowTitle()
        
        Dim num1 As Double = GetNumber("1番目の数値")
        Dim num2 As Double = GetNumber("2番目の数値")
        Dim operation As String = GetOperation()
        
        Dim result As Double = Calculate(num1, num2, operation)
        ShowResult(num1, num2, operation, result)
        
        Console.ReadLine()
    End Sub
    
    Sub ShowTitle()
        Console.WriteLine("=== 簡単電卓プログラム ===")
        Console.WriteLine()
    End Sub
    
    Function GetNumber(prompt As String) As Double
        Console.Write(prompt & "を入力してください: ")
        Return Double.Parse(Console.ReadLine())
    End Function
    
    Function GetOperation() As String
        Console.Write("演算子を入力してください (+, -, *, /): ")
        Return Console.ReadLine()
    End Function
    
    Function Calculate(num1 As Double, num2 As Double, operation As String) As Double
        Select Case operation
            Case "+"
                Return num1 + num2
            Case "-"
                Return num1 - num2
            Case "*"
                Return num1 * num2
            Case "/"
                If num2 <> 0 Then
                    Return num1 / num2
                Else
                    Console.WriteLine("エラー: ゼロで割ることはできません")
                    Return 0
                End If
            Case Else
                Console.WriteLine("エラー: 無効な演算子です")
                Return 0
        End Select
    End Function
    
    Sub ShowResult(num1 As Double, num2 As Double, operation As String, result As Double)
        Console.WriteLine()
        Console.WriteLine("=== 計算結果 ===")
        Console.WriteLine(num1 & " " & operation & " " & num2 & " = " & result)
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">3.7 変数のスコープ</h3>
                    <p>変数が参照できる範囲（スコープ）について理解しましょう。</p>

                    <pre class="code-block"><code class="language-vbnet">Module Module1
    ' モジュールレベル変数（どこからでもアクセス可能）
    Dim moduleVariable As String = "モジュール変数"
    
    Sub Main()
        ' ローカル変数（このメソッド内でのみ有効）
        Dim localVariable As String = "ローカル変数"
        
        Console.WriteLine(moduleVariable)  ' アクセス可能
        Console.WriteLine(localVariable)   ' アクセス可能
        
        TestScope()
    End Sub
    
    Sub TestScope()
        Console.WriteLine(moduleVariable)  ' アクセス可能
        ' Console.WriteLine(localVariable) ' エラー: アクセスできない
        
        Dim anotherLocal As String = "別のローカル変数"
        Console.WriteLine(anotherLocal)    ' アクセス可能
    End Sub
End Module</code></pre>

                    <div class="warning">
                        <h6>スコープのベストプラクティス</h6>
                        <ul>
                            <li>変数のスコープは可能な限り狭く保つ</li>
                            <li>モジュールレベル変数の使用は最小限に</li>
                            <li>変数名の衝突を避けるため、意味のある名前を使用</li>
                        </ul>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>If文で複数の条件を判定する際に使用するキーワードは何ですか？</li>
                            <li>多分岐処理に適した制御構造は何ですか？</li>
                            <li>1から10まで繰り返すFor文の構文を書いてください。</li>
                            <li>Do...Loop文でループを終了するための条件判定は、前判定と後判定のどちらでしょうか？</li>
                            <li>値を返すプロシージャのキーワードは何ですか？</li>
                            <li>変数が参照できる範囲を何と呼びますか？</li>
                            <li>For文で現在の繰り返しをスキップするキーワードは何ですか？</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>ElseIf</li>
                                <li>Select Case文</li>
                                <li>For i As Integer = 1 To 10...Next</li>
                                <li>Do While（前判定）、Do...Loop While（後判定）の両方が可能</li>
                                <li>Function</li>
                                <li>スコープ</li>
                                <li>Continue For</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-2.html" class="btn btn-secondary">← 前の章</a>
                        <a href="vbnet-learning-material-4.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
</body>
</html>