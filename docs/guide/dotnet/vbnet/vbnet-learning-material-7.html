<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第7章 - 例外処理とデバッグ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #0078d4; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #0078d4; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #0078d4; padding-bottom: 0.5rem; }
        .section-title { color: #2196F3; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e1f5fe; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #0078d4; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .nav-link.active { background-color: #0078d4 !important; color: white !important; }
        pre { background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 1rem; margin: 1rem 0; }
        code { background-color: #f8f9fa; padding: 0.2rem 0.4rem; border-radius: 3px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="../README.md">VB.NET学習ガイド</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-1.html">第1章: VB.NET入門</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-2.html">第2章: 基本文法</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-3.html">第3章: 制御構造</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-4.html">第4章: 配列とコレクション</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-5.html">第5章: OOP基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-6.html">第6章: OOP応用</a></li>
                        <li class="nav-item"><a class="nav-link active" href="#chapter7">第7章: 例外処理</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-8.html">第8章: ファイル操作</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-9.html">第9章: .NETライブラリ</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-10.html">第10章: 実践開発</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: 例外処理とデバッグ</h1>
                </div>

                <div id="chapter7">
                    <h2 class="chapter-title">例外処理とデバッグ</h2>
                    
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Try-Catch-Finally文の使用方法を理解する</li>
                            <li>.NETの例外クラスの種類と特徴を学習する</li>
                            <li>カスタム例外クラスの作成方法を習得する</li>
                            <li>Visual Studioのデバッグ機能を活用する</li>
                            <li>ログ出力とエラーハンドリングのベストプラクティスを学ぶ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">7.1 Try-Catch-Finally文</h3>
                    <p>例外処理は、プログラム実行中に発生するエラーを適切に処理する仕組みです。</p>

                    <pre><code>' 基本的なTry-Catch文
Try
    ' 例外が発生する可能性のあるコード
    Dim result As Integer = 10 \ 0  ' ゼロ割りで例外発生
Catch ex As Exception
    ' 例外が発生した場合の処理
    Console.WriteLine("エラーが発生しました: " & ex.Message)
End Try</code></pre>

                    <h4>複数の例外をキャッチ</h4>
                    <pre><code>Try
    Console.Write("数値を入力してください: ")
    Dim input As String = Console.ReadLine()
    Dim number As Integer = Integer.Parse(input)
    Dim result As Integer = 100 \ number
    Console.WriteLine("結果: " & result)
    
Catch ex As FormatException
    Console.WriteLine("数値ではありません: " & ex.Message)
Catch ex As DivideByZeroException
    Console.WriteLine("ゼロで割ることはできません: " & ex.Message)
Catch ex As OverflowException
    Console.WriteLine("数値が範囲を超えています: " & ex.Message)
Catch ex As Exception
    Console.WriteLine("予期しないエラー: " & ex.Message)
Finally
    Console.WriteLine("処理が完了しました")
End Try</code></pre>

                    <div class="exercise-container">
                        <h5>実習 7-1: 安全な数値入力システム</h5>
                        <p>例外処理を使用して、ユーザーからの数値入力を安全に処理しましょう。</p>
                        <pre><code>Module Module1
    Sub Main()
        Dim validNumber As Integer = GetValidNumber("数値を入力してください (1-100): ", 1, 100)
        Console.WriteLine($"入力された数値: {validNumber}")
        Console.ReadLine()
    End Sub
    
    Function GetValidNumber(prompt As String, min As Integer, max As Integer) As Integer
        While True
            Try
                Console.Write(prompt)
                Dim input As String = Console.ReadLine()
                
                If String.IsNullOrEmpty(input) Then
                    Throw New ArgumentException("空の入力は無効です")
                End If
                
                Dim number As Integer = Integer.Parse(input)
                
                If number < min Or number > max Then
                    Throw New ArgumentOutOfRangeException($"{min}から{max}の範囲で入力してください")
                End If
                
                Return number
                
            Catch ex As FormatException
                Console.WriteLine("エラー: 数値を入力してください")
            Catch ex As OverflowException
                Console.WriteLine("エラー: 数値が大きすぎます")
            Catch ex As ArgumentOutOfRangeException
                Console.WriteLine("エラー: " & ex.Message)
            Catch ex As ArgumentException
                Console.WriteLine("エラー: " & ex.Message)
            Catch ex As Exception
                Console.WriteLine("予期しないエラー: " & ex.Message)
            End Try
            
            Console.WriteLine("もう一度試してください")
            Console.WriteLine()
        End While
    End Function
End Module</code></pre>
                    </div>

                    <h3 class="section-title">7.2 主要な.NET例外クラス</h3>
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead><tr><th>例外クラス</th><th>発生状況</th><th>例</th></tr></thead>
                            <tbody>
                                <tr><td><code>ArgumentException</code></td><td>無効な引数</td><td>空文字列、null引数</td></tr>
                                <tr><td><code>ArgumentNullException</code></td><td>nullの引数</td><td>必須パラメータがnull</td></tr>
                                <tr><td><code>FormatException</code></td><td>文字列変換エラー</td><td>"abc"を数値に変換</td></tr>
                                <tr><td><code>OverflowException</code></td><td>数値オーバーフロー</td><td>数値範囲超過</td></tr>
                                <tr><td><code>DivideByZeroException</code></td><td>ゼロ割り</td><td>10 / 0</td></tr>
                                <tr><td><code>IndexOutOfRangeException</code></td><td>配列インデックスエラー</td><td>array(100) にアクセス</td></tr>
                                <tr><td><code>NullReferenceException</code></td><td>null参照</td><td>Nothingオブジェクトのメソッド呼び出し</td></tr>
                                <tr><td><code>FileNotFoundException</code></td><td>ファイルが見つからない</td><td>存在しないファイルを開く</td></tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="section-title">7.3 カスタム例外クラス</h3>
                    <pre><code>Public Class CustomBusinessException
    Inherits Exception
    
    Public Property ErrorCode As String
    
    Public Sub New()
        MyBase.New()
    End Sub
    
    Public Sub New(message As String)
        MyBase.New(message)
    End Sub
    
    Public Sub New(message As String, errorCode As String)
        MyBase.New(message)
        Me.ErrorCode = errorCode
    End Sub
    
    Public Sub New(message As String, innerException As Exception)
        MyBase.New(message, innerException)
    End Sub
End Class

' 使用例
Public Class BankAccount
    Private balance As Decimal
    
    Public Sub Withdraw(amount As Decimal)
        If amount <= 0 Then
            Throw New CustomBusinessException("出金額は正の値でなければなりません", "INVALID_AMOUNT")
        End If
        
        If amount > balance Then
            Throw New CustomBusinessException("残高不足です", "INSUFFICIENT_FUNDS")
        End If
        
        balance -= amount
    End Sub
End Class</code></pre>

                    <h3 class="section-title">7.4 デバッグ機能</h3>
                    <p>Visual Studioの強力なデバッグ機能を活用して、効率的にバグを見つけましょう。</p>

                    <h4>主要なデバッグ機能</h4>
                    <ul>
                        <li><strong>ブレークポイント</strong>: F9キーで設定、実行を一時停止</li>
                        <li><strong>ステップ実行</strong>: F10(ステップオーバー)、F11(ステップイント)</li>
                        <li><strong>ウォッチウィンドウ</strong>: 変数の値を監視</li>
                        <li><strong>イミディエイトウィンドウ</strong>: 式を即座評価</li>
                        <li><strong>コールスタック</strong>: メソッド呼び出しの履歴を表示</li>
                    </ul>

                    <h4>Debugクラスの活用</h4>
                    <pre><code>Imports System.Diagnostics

Module Module1
    Sub Main()
        Debug.WriteLine("デバッグ開始")
        
        Dim numbers() As Integer = {1, 2, 3, 4, 5}
        
        For i As Integer = 0 To numbers.Length - 1
            Debug.WriteLine($"numbers({i}) = {numbers(i)}")
            
            ' 条件付きデバッグ出力
            Debug.WriteLineIf(numbers(i) > 3, $"大きな値: {numbers(i)}")
        Next
        
        ' アサーション
        Debug.Assert(numbers.Length = 5, "配列のサイズが不正です")
        
        Debug.WriteLine("デバッグ終了")
    End Sub
End Module</code></pre>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>例外処理で使用する3つのキーワードを答えてください。</li>
                            <li>null参照による例外のクラス名は何ですか？</li>
                            <li>カスタム例外クラスはどのクラスを継承しますか？</li>
                            <li>ブレークポイントを設定するショートカットキーは何ですか？</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>Try, Catch, Finally</li>
                                <li>NullReferenceException</li>
                                <li>Exception</li>
                                <li>F9</li>
                            </ol>
                        </details>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-6.html" class="btn btn-secondary">← 前の章</a>
                        <a href="vbnet-learning-material-8.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>