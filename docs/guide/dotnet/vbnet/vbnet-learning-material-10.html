<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NETå­¦ç¿’æ•™æ ç¬¬10ç«  - å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</title>
    
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #0078d4; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #0078d4; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #0078d4; padding-bottom: 0.5rem; }
        .section-title { color: #2196F3; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e1f5fe; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #0078d4; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .nav-link.active { background-color: #0078d4 !important; color: white !important; }
        pre { background-color: #f8f9fa; border: 1px solid #e9ecef; border-radius: 4px; padding: 1rem; margin: 1rem 0; }
        code { background-color: #f8f9fa; padding: 0.2rem 0.4rem; border-radius: 3px; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <div class="collapse navbar-collapse">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item"><a class="nav-link" href="../README.md">VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-1.html">ç¬¬1ç« : VB.NETå…¥é–€</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-2.html">ç¬¬2ç« : åŸºæœ¬æ–‡æ³•</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-3.html">ç¬¬3ç« : åˆ¶å¾¡æ§‹é€ </a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-4.html">ç¬¬4ç« : é…åˆ—ã¨ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-5.html">ç¬¬5ç« : OOPåŸºç¤</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-6.html">ç¬¬6ç« : OOPå¿œç”¨</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-7.html">ç¬¬7ç« : ä¾‹å¤–å‡¦ç†</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-8.html">ç¬¬8ç« : ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ</a></li>
                        <li class="nav-item"><a class="nav-link" href="vbnet-learning-material-9.html">ç¬¬9ç« : .NETãƒ©ã‚¤ãƒ–ãƒ©ãƒª</a></li>
                        <li class="nav-item"><a class="nav-link active" href="#chapter10">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬10ç« : å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</h1>
                </div>

                <div id="chapter10">
                    <h2 class="chapter-title">å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</h2>
                    
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>ä»Šã¾ã§å­¦ç¿’ã—ãŸçŸ¥è­˜ã‚’çµ±åˆã—ãŸå®Ÿè·µçš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ç™ºã™ã‚‹</li>
                            <li>è¨­è¨ˆãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®åŸºæœ¬æ¦‚å¿µã‚’ç†è§£ã™ã‚‹</li>
                            <li>ã‚³ãƒ¼ãƒ‰ã®å“è³ªå‘ä¸Šã¨ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°æŠ€è¡“ã‚’å­¦ç¿’ã™ã‚‹</li>
                            <li>ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°ã®å®Ÿè·µçš„æ‰‹æ³•ã‚’ç¿’å¾—ã™ã‚‹</li>
                            <li>å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’å«ã‚€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.1 å›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ</h3>
                    <p>ã“ã‚Œã¾ã§ã«å­¦ç¿’ã—ãŸå…¨ã¦ã®æ¦‚å¿µã‚’çµ±åˆã—ã¦ã€å®Ÿç”¨çš„ãªå›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

                    <h4>ã‚·ã‚¹ãƒ†ãƒ è¦ä»¶</h4>
                    <ul>
                        <li>å›³æ›¸ã®ç™»éŒ²ãƒ»æ¤œç´¢ãƒ»è²¸å‡ºãƒ»è¿”å´æ©Ÿèƒ½</li>
                        <li>ä¼šå“¡ã®ç™»éŒ²ãƒ»ç®¡ç†æ©Ÿèƒ½</li>
                        <li>è²¸å‡ºå±¥æ­´ã®ç®¡ç†ã¨ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</li>
                        <li>ãƒ‡ãƒ¼ã‚¿ã®æ°¸ç¶šåŒ–ï¼ˆãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜ï¼‰</li>
                        <li>ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°æ©Ÿèƒ½</li>
                    </ul>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-1: å›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å®Ÿè£…</h5>
                        <p>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨­è¨ˆã‚’æ´»ç”¨ã—ãŸå›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ®µéšçš„ã«æ§‹ç¯‰ã—ã¾ã—ã‚‡ã†ã€‚</p>
                        
                        <h6>ã‚¹ãƒ†ãƒƒãƒ—1: åŸºæœ¬ã‚¯ãƒ©ã‚¹ã®å®šç¾©</h6>
                        <pre><code>Imports System.IO
Imports System.Text.Json

' åŸºæœ¬ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¯ãƒ©ã‚¹
Public Class Book
    Public Property BookId As String
    Public Property Title As String
    Public Property Author As String
    Public Property ISBN As String
    Public Property PublishDate As DateTime
    Public Property Category As String
    Public Property IsAvailable As Boolean
    
    Public Sub New()
        BookId = Guid.NewGuid().ToString("N")(0..7).ToUpper()
        IsAvailable = True
    End Sub
    
    Public Sub New(title As String, author As String, isbn As String, publishDate As DateTime, category As String)
        Me.New()
        Me.Title = title
        Me.Author = author
        Me.ISBN = isbn
        Me.PublishDate = publishDate
        Me.Category = category
    End Sub
    
    Public Overrides Function ToString() As String
        Return $"[{BookId}] {Title} - {Author} ({Category})"
    End Function
End Class

Public Class Member
    Public Property MemberId As String
    Public Property Name As String
    Public Property Email As String
    Public Property PhoneNumber As String
    Public Property RegisterDate As DateTime
    Public Property IsActive As Boolean
    
    Public Sub New()
        MemberId = "M" & DateTime.Now.ToString("yyyyMMdd") & New Random().Next(1000, 9999).ToString()
        RegisterDate = DateTime.Now
        IsActive = True
    End Sub
    
    Public Sub New(name As String, email As String, phoneNumber As String)
        Me.New()
        Me.Name = name
        Me.Email = email
        Me.PhoneNumber = phoneNumber
    End Sub
    
    Public Overrides Function ToString() As String
        Return $"[{MemberId}] {Name} - {Email}"
    End Function
End Class

Public Class LoanRecord
    Public Property LoanId As String
    Public Property BookId As String
    Public Property MemberId As String
    Public Property LoanDate As DateTime
    Public Property DueDate As DateTime
    Public Property ReturnDate As DateTime?
    Public Property IsReturned As Boolean
    
    Public Sub New()
        LoanId = "L" & DateTime.Now.ToString("yyyyMMddHHmmss")
        LoanDate = DateTime.Now
        DueDate = DateTime.Now.AddDays(14) ' 2é€±é–“ã®è²¸å‡ºæœŸé–“
        IsReturned = False
    End Sub
    
    Public Sub New(bookId As String, memberId As String)
        Me.New()
        Me.BookId = bookId
        Me.MemberId = memberId
    End Sub
    
    Public ReadOnly Property IsOverdue As Boolean
        Get
            Return Not IsReturned AndAlso DateTime.Now > DueDate
        End Get
    End Property
End Class</code></pre>

                        <h6>ã‚¹ãƒ†ãƒƒãƒ—2: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤</h6>
                        <pre><code>Public Class LibraryManager
    Private books As List(Of Book)
    Private members As List(Of Member)
    Private loanRecords As List(Of LoanRecord)
    Private Const DATA_FILE_BOOKS As String = "books.json"
    Private Const DATA_FILE_MEMBERS As String = "members.json"
    Private Const DATA_FILE_LOANS As String = "loans.json"
    
    Public Sub New()
        books = New List(Of Book)()
        members = New List(Of Member)()
        loanRecords = New List(Of LoanRecord)()
        LoadData()
    End Sub
    
    ' å›³æ›¸ç®¡ç†
    Public Sub AddBook(book As Book)
        If book Is Nothing Then
            Throw New ArgumentNullException("book", "å›³æ›¸æƒ…å ±ãŒç©ºã§ã™")
        End If
        
        books.Add(book)
        SaveData()
        Console.WriteLine($"å›³æ›¸ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ: {book.Title}")
    End Sub
    
    Public Function SearchBooks(keyword As String) As List(Of Book)
        If String.IsNullOrWhiteSpace(keyword) Then
            Return books.ToList()
        End If
        
        Return books.Where(Function(b) 
            b.Title.Contains(keyword, StringComparison.OrdinalIgnoreCase) OrElse
            b.Author.Contains(keyword, StringComparison.OrdinalIgnoreCase) OrElse
            b.Category.Contains(keyword, StringComparison.OrdinalIgnoreCase)
        ).ToList()
    End Function
    
    Public Function GetAvailableBooks() As List(Of Book)
        Return books.Where(Function(b) b.IsAvailable).ToList()
    End Function
    
    ' ä¼šå“¡ç®¡ç†
    Public Sub AddMember(member As Member)
        If member Is Nothing Then
            Throw New ArgumentNullException("member", "ä¼šå“¡æƒ…å ±ãŒç©ºã§ã™")
        End If
        
        members.Add(member)
        SaveData()
        Console.WriteLine($"ä¼šå“¡ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ: {member.Name}")
    End Sub
    
    Public Function FindMember(memberId As String) As Member
        Return members.FirstOrDefault(Function(m) m.MemberId = memberId)
    End Function
    
    Public Function FindBook(bookId As String) As Book
        Return books.FirstOrDefault(Function(b) b.BookId = bookId)
    End Function
    
    ' è²¸å‡ºãƒ»è¿”å´ç®¡ç†
    Public Function LoanBook(bookId As String, memberId As String) As LoanRecord
        Dim book As Book = FindBook(bookId)
        Dim member As Member = FindMember(memberId)
        
        If book Is Nothing Then
            Throw New ArgumentException("æŒ‡å®šã•ã‚ŒãŸå›³æ›¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        End If
        
        If member Is Nothing Then
            Throw New ArgumentException("æŒ‡å®šã•ã‚ŒãŸä¼šå“¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        End If
        
        If Not book.IsAvailable Then
            Throw New InvalidOperationException("ã“ã®å›³æ›¸ã¯ç¾åœ¨è²¸å‡ºä¸­ã§ã™")
        End If
        
        If Not member.IsActive Then
            Throw New InvalidOperationException("ã“ã®ä¼šå“¡ã¯ç¾åœ¨ç„¡åŠ¹ã§ã™")
        End If
        
        ' è²¸å‡ºè¨˜éŒ²ã®ä½œæˆ
        Dim loanRecord As New LoanRecord(bookId, memberId)
        loanRecords.Add(loanRecord)
        book.IsAvailable = False
        
        SaveData()
        Console.WriteLine($"è²¸å‡ºå®Œäº†: {book.Title} â†’ {member.Name}")
        Return loanRecord
    End Function
    
    Public Function ReturnBook(bookId As String) As LoanRecord
        Dim book As Book = FindBook(bookId)
        If book Is Nothing Then
            Throw New ArgumentException("æŒ‡å®šã•ã‚ŒãŸå›³æ›¸ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        End If
        
        Dim activeLoan As LoanRecord = loanRecords.FirstOrDefault(
            Function(l) l.BookId = bookId AndAlso Not l.IsReturned)
        
        If activeLoan Is Nothing Then
            Throw New InvalidOperationException("ã“ã®å›³æ›¸ã®è²¸å‡ºè¨˜éŒ²ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“")
        End If
        
        activeLoan.ReturnDate = DateTime.Now
        activeLoan.IsReturned = True
        book.IsAvailable = True
        
        SaveData()
        Console.WriteLine($"è¿”å´å®Œäº†: {book.Title}")
        Return activeLoan
    End Function
    
    ' ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½
    Public Sub GenerateReport()
        Console.WriteLine()
        Console.WriteLine("=== å›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ¬ãƒãƒ¼ãƒˆ ===")
        Console.WriteLine($"ç”Ÿæˆæ—¥æ™‚: {DateTime.Now:yyyy-MM-dd HH:mm:ss}")
        Console.WriteLine()
        
        Console.WriteLine($"ç·å›³æ›¸æ•°: {books.Count}")
        Console.WriteLine($"è²¸å‡ºå¯èƒ½å›³æ›¸æ•°: {books.Count(Function(b) b.IsAvailable)}")
        Console.WriteLine($"è²¸å‡ºä¸­å›³æ›¸æ•°: {books.Count(Function(b) Not b.IsAvailable)}")
        Console.WriteLine()
        
        Console.WriteLine($"ç·ä¼šå“¡æ•°: {members.Count}")
        Console.WriteLine($"ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ä¼šå“¡æ•°: {members.Count(Function(m) m.IsActive)}")
        Console.WriteLine()
        
        Console.WriteLine($"ç·è²¸å‡ºè¨˜éŒ²æ•°: {loanRecords.Count}")
        Console.WriteLine($"ç¾åœ¨è²¸å‡ºä¸­: {loanRecords.Count(Function(l) Not l.IsReturned)}")
        Console.WriteLine($"å»¶æ»ä¸­: {loanRecords.Count(Function(l) l.IsOverdue)}")
        
        ' äººæ°—å›³æ›¸ãƒˆãƒƒãƒ—5
        Console.WriteLine()
        Console.WriteLine("=== äººæ°—å›³æ›¸ãƒˆãƒƒãƒ—5 ===")
        Dim popularBooks = loanRecords.GroupBy(Function(l) l.BookId) _
                                     .Select(Function(g) New With {
                                         .BookId = g.Key,
                                         .LoanCount = g.Count()
                                     }) _
                                     .OrderByDescending(Function(x) x.LoanCount) _
                                     .Take(5)
        
        For Each item In popularBooks
            Dim book As Book = FindBook(item.BookId)
            If book IsNot Nothing Then
                Console.WriteLine($"{item.LoanCount}å›: {book.Title}")
            End If
        Next
    End Sub
    
    ' ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
    Private Sub LoadData()
        Try
            If File.Exists(DATA_FILE_BOOKS) Then
                Dim jsonBooks As String = File.ReadAllText(DATA_FILE_BOOKS)
                books = JsonSerializer.Deserialize(Of List(Of Book))(jsonBooks) ?? New List(Of Book)()
            End If
            
            If File.Exists(DATA_FILE_MEMBERS) Then
                Dim jsonMembers As String = File.ReadAllText(DATA_FILE_MEMBERS)
                members = JsonSerializer.Deserialize(Of List(Of Member))(jsonMembers) ?? New List(Of Member)()
            End If
            
            If File.Exists(DATA_FILE_LOANS) Then
                Dim jsonLoans As String = File.ReadAllText(DATA_FILE_LOANS)
                loanRecords = JsonSerializer.Deserialize(Of List(Of LoanRecord))(jsonLoans) ?? New List(Of LoanRecord)()
            End If
            
        Catch ex As Exception
            Console.WriteLine($"ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {ex.Message}")
        End Try
    End Sub
    
    Private Sub SaveData()
        Try
            File.WriteAllText(DATA_FILE_BOOKS, JsonSerializer.Serialize(books, New JsonSerializerOptions With {.WriteIndented = True}))
            File.WriteAllText(DATA_FILE_MEMBERS, JsonSerializer.Serialize(members, New JsonSerializerOptions With {.WriteIndented = True}))
            File.WriteAllText(DATA_FILE_LOANS, JsonSerializer.Serialize(loanRecords, New JsonSerializerOptions With {.WriteIndented = True}))
        Catch ex As Exception
            Console.WriteLine($"ãƒ‡ãƒ¼ã‚¿ä¿å­˜ã‚¨ãƒ©ãƒ¼: {ex.Message}")
        End Try
    End Sub
End Class</code></pre>

                        <h6>ã‚¹ãƒ†ãƒƒãƒ—3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h6>
                        <pre><code>Module Module1
    Private libraryManager As LibraryManager

    Sub Main()
        libraryManager = New LibraryManager()
        
        Console.WriteLine("ğŸ›ï¸  å›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã¸ã‚ˆã†ã“ãï¼")
        Console.WriteLine()
        
        ' ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ï¼ˆåˆå›ã®ã¿ï¼‰
        InitializeSampleData()
        
        ' ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼
        Dim choice As String
        Do
            ShowMainMenu()
            choice = Console.ReadLine()
            
            Try
                Select Case choice
                    Case "1"
                        AddBookMenu()
                    Case "2"
                        SearchBooksMenu()
                    Case "3"
                        AddMemberMenu()
                    Case "4"
                        LoanBookMenu()
                    Case "5"
                        ReturnBookMenu()
                    Case "6"
                        libraryManager.GenerateReport()
                    Case "0"
                        Console.WriteLine("ã‚·ã‚¹ãƒ†ãƒ ã‚’çµ‚äº†ã—ã¾ã™ã€‚")
                    Case Else
                        Console.WriteLine("ç„¡åŠ¹ãªé¸æŠã§ã™ã€‚")
                End Select
                
            Catch ex As Exception
                Console.WriteLine($"ã‚¨ãƒ©ãƒ¼: {ex.Message}")
            End Try
            
            If choice <> "0" Then
                Console.WriteLine()
                Console.Write("ç¶šè¡Œã™ã‚‹ã«ã¯Enterã‚­ãƒ¼ã‚’æŠ¼ã—ã¦ãã ã•ã„...")
                Console.ReadLine()
            End If
            
        Loop Until choice = "0"
    End Sub
    
    Sub ShowMainMenu()
        Console.Clear()
        Console.WriteLine("=== å›³æ›¸é¤¨ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ  ãƒ¡ã‚¤ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ ===")
        Console.WriteLine("1. å›³æ›¸è¿½åŠ ")
        Console.WriteLine("2. å›³æ›¸æ¤œç´¢")
        Console.WriteLine("3. ä¼šå“¡è¿½åŠ ")
        Console.WriteLine("4. å›³æ›¸è²¸å‡º")
        Console.WriteLine("5. å›³æ›¸è¿”å´")
        Console.WriteLine("6. ãƒ¬ãƒãƒ¼ãƒˆè¡¨ç¤º")
        Console.WriteLine("0. çµ‚äº†")
        Console.WriteLine()
        Console.Write("é¸æŠã—ã¦ãã ã•ã„ (0-6): ")
    End Sub
    
    Sub AddBookMenu()
        Console.WriteLine()
        Console.WriteLine("=== å›³æ›¸è¿½åŠ  ===")
        
        Console.Write("æ›¸ç±å: ")
        Dim title As String = Console.ReadLine()
        
        Console.Write("è‘—è€…å: ")
        Dim author As String = Console.ReadLine()
        
        Console.Write("ISBN: ")
        Dim isbn As String = Console.ReadLine()
        
        Console.Write("å‡ºç‰ˆæ—¥ (yyyy-MM-dd): ")
        Dim publishDate As DateTime
        If Not DateTime.TryParse(Console.ReadLine(), publishDate) Then
            publishDate = DateTime.Now
        End If
        
        Console.Write("ã‚«ãƒ†ã‚´ãƒª: ")
        Dim category As String = Console.ReadLine()
        
        Dim book As New Book(title, author, isbn, publishDate, category)
        libraryManager.AddBook(book)
    End Sub
    
    Sub SearchBooksMenu()
        Console.WriteLine()
        Console.WriteLine("=== å›³æ›¸æ¤œç´¢ ===")
        Console.Write("æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ (ç©ºç™½ã§å…¨ä»¶è¡¨ç¤º): ")
        Dim keyword As String = Console.ReadLine()
        
        Dim results As List(Of Book) = libraryManager.SearchBooks(keyword)
        
        Console.WriteLine($"æ¤œç´¢çµæœ: {results.Count}ä»¶")
        For Each book As Book In results
            Dim status As String = If(book.IsAvailable, "è²¸å‡ºå¯èƒ½", "è²¸å‡ºä¸­")
            Console.WriteLine($"{book} - {status}")
        Next
    End Sub
    
    Sub AddMemberMenu()
        Console.WriteLine()
        Console.WriteLine("=== ä¼šå“¡è¿½åŠ  ===")
        
        Console.Write("æ°å: ")
        Dim name As String = Console.ReadLine()
        
        Console.Write("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: ")
        Dim email As String = Console.ReadLine()
        
        Console.Write("é›»è©±ç•ªå·: ")
        Dim phone As String = Console.ReadLine()
        
        Dim member As New Member(name, email, phone)
        libraryManager.AddMember(member)
    End Sub
    
    Sub LoanBookMenu()
        Console.WriteLine()
        Console.WriteLine("=== å›³æ›¸è²¸å‡º ===")
        
        Console.Write("å›³æ›¸ID: ")
        Dim bookId As String = Console.ReadLine()
        
        Console.Write("ä¼šå“¡ID: ")
        Dim memberId As String = Console.ReadLine()
        
        Dim loanRecord As LoanRecord = libraryManager.LoanBook(bookId, memberId)
        Console.WriteLine($"è¿”å´æœŸé™: {loanRecord.DueDate:yyyy-MM-dd}")
    End Sub
    
    Sub ReturnBookMenu()
        Console.WriteLine()
        Console.WriteLine("=== å›³æ›¸è¿”å´ ===")
        
        Console.Write("å›³æ›¸ID: ")
        Dim bookId As String = Console.ReadLine()
        
        Dim loanRecord As LoanRecord = libraryManager.ReturnBook(bookId)
        
        If loanRecord.IsOverdue Then
            Dim overdueDays As Integer = (DateTime.Now - loanRecord.DueDate).Days
            Console.WriteLine($"âš ï¸  å»¶æ»: {overdueDays}æ—¥é…ã‚Œ")
        End If
    End Sub
    
    Sub InitializeSampleData()
        ' ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒæ—¢ã«å­˜åœ¨ã™ã‚‹ã‹ãƒã‚§ãƒƒã‚¯
        If libraryManager.SearchBooks("").Count > 0 Then
            Return
        End If
        
        Console.WriteLine("ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’åˆæœŸåŒ–ä¸­...")
        
        ' ã‚µãƒ³ãƒ—ãƒ«å›³æ›¸
        libraryManager.AddBook(New Book("ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°å…¥é–€", "ç”°ä¸­å¤ªéƒ", "978-1234567890", New DateTime(2023, 1, 15), "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"))
        libraryManager.AddBook(New Book("VB.NETå®Œå…¨ã‚¬ã‚¤ãƒ‰", "ä½è—¤èŠ±å­", "978-0987654321", New DateTime(2023, 3, 20), "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"))
        libraryManager.AddBook(New Book("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ", "éˆ´æœ¨ä¸€éƒ", "978-1111222233", New DateTime(2022, 11, 10), "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"))
        
        ' ã‚µãƒ³ãƒ—ãƒ«ä¼šå“¡
        libraryManager.AddMember(New Member("å±±ç”°å¤ªéƒ", "yamada@example.com", "090-1234-5678"))
        libraryManager.AddMember(New Member("ä¼Šè—¤ç¾å’²", "ito@example.com", "080-9876-5432"))
        
        Console.WriteLine("ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®åˆæœŸåŒ–ãŒå®Œäº†ã—ã¾ã—ãŸã€‚")
        Console.WriteLine()
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">10.2 ã‚³ãƒ¼ãƒ‰å“è³ªã¨ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
                    <p>å®Ÿç”¨çš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã§ã¯ã€ã‚³ãƒ¼ãƒ‰ã®å“è³ªã¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹æ€§ãŒé‡è¦ã§ã™ã€‚</p>

                    <h4>ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°è¦ç´„</h4>
                    <ul>
                        <li><strong>å‘½åè¦å‰‡</strong>: æ„å‘³ã®ã‚ã‚‹åå‰ã‚’ä½¿ç”¨ã—ã€ä¸€è²«ã—ãŸå‘½åè¦å‰‡ã‚’é©ç”¨</li>
                        <li><strong>ãƒ¡ã‚½ãƒƒãƒ‰ã‚µã‚¤ã‚º</strong>: 1ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯1ã¤ã®è²¬ä»»ã‚’æŒã¡ã€é©åˆ‡ãªã‚µã‚¤ã‚ºã«ä¿ã¤</li>
                        <li><strong>ã‚³ãƒ¡ãƒ³ãƒˆ</strong>: å¿…è¦ãªç®‡æ‰€ã«ã®ã¿ã€æ„å‘³ã®ã‚ã‚‹ã‚³ãƒ¡ãƒ³ãƒˆã‚’è¨˜è¿°</li>
                        <li><strong>ä¾‹å¤–å‡¦ç†</strong>: é©åˆ‡ãªä¾‹å¤–å‡¦ç†ã¨ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®æä¾›</li>
                    </ul>

                    <h4>è¨­è¨ˆåŸå‰‡</h4>
                    <ul>
                        <li><strong>å˜ä¸€è²¬ä»»åŸå‰‡</strong>: 1ã¤ã®ã‚¯ãƒ©ã‚¹ã¯1ã¤ã®è²¬ä»»ã®ã¿ã‚’æŒã¤</li>
                        <li><strong>é–‹æ”¾é–‰é–åŸå‰‡</strong>: æ‹¡å¼µã«å¯¾ã—ã¦é–‹æ”¾çš„ã€ä¿®æ­£ã«å¯¾ã—ã¦é–‰é–çš„</li>
                        <li><strong>ä¾å­˜æ€§é€†è»¢åŸå‰‡</strong>: æŠ½è±¡ã«ä¾å­˜ã—ã€å…·è±¡ã«ä¾å­˜ã—ãªã„</li>
                    </ul>

                    <h3 class="section-title">10.3 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥</h3>
                    <p>å“è³ªã®é«˜ã„ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ä½œæˆã™ã‚‹ãŸã‚ã®ãƒ†ã‚¹ãƒˆæ‰‹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <pre><code>' ç°¡å˜ãªå˜ä½“ãƒ†ã‚¹ãƒˆã®ä¾‹
Public Class LibraryManagerTests
    Private libraryManager As LibraryManager
    
    Public Sub SetUp()
        libraryManager = New LibraryManager()
    End Sub
    
    Public Sub TestAddBook()
        ' Arrange
        Dim book As New Book("ãƒ†ã‚¹ãƒˆæ›¸ç±", "ãƒ†ã‚¹ãƒˆè‘—è€…", "123456789", DateTime.Now, "ãƒ†ã‚¹ãƒˆ")
        Dim initialCount As Integer = libraryManager.SearchBooks("").Count
        
        ' Act
        libraryManager.AddBook(book)
        
        ' Assert
        Dim newCount As Integer = libraryManager.SearchBooks("").Count
        Console.WriteLine($"å›³æ›¸è¿½åŠ ãƒ†ã‚¹ãƒˆ: {If(newCount = initialCount + 1, "æˆåŠŸ", "å¤±æ•—")}")
    End Sub
    
    Public Sub TestLoanBook()
        ' Arrange
        Dim book As New Book("è²¸å‡ºãƒ†ã‚¹ãƒˆ", "è‘—è€…", "987654321", DateTime.Now, "ãƒ†ã‚¹ãƒˆ")
        Dim member As New Member("ãƒ†ã‚¹ãƒˆä¼šå“¡", "test@example.com", "000-0000-0000")
        libraryManager.AddBook(book)
        libraryManager.AddMember(member)
        
        ' Act
        Try
            Dim loanRecord As LoanRecord = libraryManager.LoanBook(book.BookId, member.MemberId)
            Console.WriteLine("è²¸å‡ºãƒ†ã‚¹ãƒˆ: æˆåŠŸ")
        Catch ex As Exception
            Console.WriteLine($"è²¸å‡ºãƒ†ã‚¹ãƒˆ: å¤±æ•— - {ex.Message}")
        End Try
    End Sub
End Class</code></pre>

                    <h3 class="section-title">10.4 æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</h3>
                    <p>VB.NETå­¦ç¿’ã®æ¬¡ã®æ®µéšã§å–ã‚Šçµ„ã‚€ã¹ãæŠ€è¡“ã¨ãƒˆãƒ”ãƒƒã‚¯ã§ã™ã€‚</p>

                    <div class="highlight">
                        <h5>æ¨å¥¨å­¦ç¿’ãƒ‘ã‚¹</h5>
                        <ul>
                            <li><strong>ASP.NET Web Forms</strong>: Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã®åŸºç¤</li>
                            <li><strong>Windows Forms</strong>: ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</li>
                            <li><strong>ADO.NET/Entity Framework</strong>: æœ¬æ ¼çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹</li>
                            <li><strong>Web API</strong>: RESTful ã‚µãƒ¼ãƒ“ã‚¹ã®é–‹ç™º</li>
                            <li><strong>ASP.NET Core</strong>: æœ€æ–°ã®Webé–‹ç™ºãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯</li>
                        </ul>
                    </div>

                    <h4>ç¶™ç¶šçš„ãªå­¦ç¿’ã®ãŸã‚ã«</h4>
                    <ul>
                        <li>å®Ÿéš›ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«å‚åŠ ã™ã‚‹</li>
                        <li>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«è²¢çŒ®ã™ã‚‹</li>
                        <li>æŠ€è¡“ãƒ–ãƒ­ã‚°ã‚„æ›¸ç±ã§æœ€æ–°æƒ…å ±ã‚’ã‚­ãƒ£ãƒƒãƒã‚¢ãƒƒãƒ—ã™ã‚‹</li>
                        <li>ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã«å‚åŠ ã™ã‚‹</li>
                    </ul>

                    <div class="quiz-container">
                        <h5>æœ€çµ‚ç†è§£åº¦ç¢ºèª</h5>
                        <ol>
                            <li>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®3ã¤ã®ä¸»è¦ãªæ¦‚å¿µã‚’æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>ä¾‹å¤–å‡¦ç†ã§ä½¿ç”¨ã™ã‚‹3ã¤ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>ãƒ•ã‚¡ã‚¤ãƒ«ã®èª­ã¿æ›¸ãã«ä½¿ç”¨ã™ã‚‹ä¸»è¦ãªã‚¯ãƒ©ã‚¹ã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>LINQã§ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>ã‚³ãƒ¼ãƒ‰ã®å“è³ªã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã«é‡è¦ãªè¨­è¨ˆåŸå‰‡ã‚’1ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>ã‚«ãƒ—ã‚»ãƒ«åŒ–ã€ç¶™æ‰¿ã€ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ </li>
                                <li>Try, Catch, Finally</li>
                                <li>StreamReader, StreamWriter (ã¾ãŸã¯ File ã‚¯ãƒ©ã‚¹)</li>
                                <li>Where</li>
                                <li>å˜ä¸€è²¬ä»»åŸå‰‡ï¼ˆã¾ãŸã¯é–‹æ”¾é–‰é–åŸå‰‡ã€ä¾å­˜æ€§é€†è»¢åŸå‰‡ãªã©ï¼‰</li>
                            </ol>
                        </details>
                    </div>

                    <div class="highlight">
                        <h5>ğŸ‰ VB.NETå­¦ç¿’ã‚³ãƒ¼ã‚¹å®Œäº†ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</h5>
                        <p>ã“ã®å­¦ç¿’ã‚³ãƒ¼ã‚¹ã‚’é€šã˜ã¦ã€VB.NETãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®åŸºç¤ã‹ã‚‰å®Ÿè·µçš„ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã¾ã§å¹…åºƒã„ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã—ãŸã€‚ä»Šå¾Œã‚‚ç¶™ç¶šçš„ãªå­¦ç¿’ã¨å®Ÿè·µã‚’é€šã˜ã¦ã€ã•ã‚‰ãªã‚‹ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ã‚’ç›®æŒ‡ã—ã¦ãã ã•ã„ã€‚</p>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-9.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="../README.md" class="btn btn-success">ã‚³ãƒ¼ã‚¹å®Œäº† ğŸ“</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>