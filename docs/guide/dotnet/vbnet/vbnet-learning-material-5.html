<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第5章 - オブジェクト指向プログラミング基礎</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #0078d4;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">VB.NET学習ガイド</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-1.html">第1章: VB.NET入門</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-2.html">第2章: 基本文法</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-3.html">第3章: 制御構造</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-4.html">第4章: 配列とコレクション</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter5">第5章: OOP基礎</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-6.html">第6章: OOP応用</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-7.html">第7章: 例外処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-8.html">第8章: ファイル操作</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-9.html">第9章: .NETライブラリ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-10.html">第10章: 実践開発</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第5章: オブジェクト指向プログラミング基礎</h1>
                </div>

                <div id="chapter5">
                    <h2 class="chapter-title">オブジェクト指向プログラミング基礎</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>オブジェクト指向プログラミングの基本概念を理解する</li>
                            <li>クラスとオブジェクトの関係を学習する</li>
                            <li>プロパティとメソッドの作成と使用方法を習得する</li>
                            <li>コンストラクタの概念と実装方法を理解する</li>
                            <li>カプセル化の原則とアクセス修飾子を学ぶ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">5.1 オブジェクト指向プログラミングとは</h3>
                    <p>オブジェクト指向プログラミング（OOP）は、現実世界のモノ（オブジェクト）をプログラムで表現する開発手法です。</p>

                    <h4>オブジェクト指向の3つの柱</h4>
                    <ul>
                        <li><strong>カプセル化</strong>: データとメソッドを一つにまとめ、外部からの不正なアクセスを防ぐ</li>
                        <li><strong>継承</strong>: 既存のクラスの機能を受け継いで新しいクラスを作成する</li>
                        <li><strong>ポリモーフィズム</strong>: 同じインターフェースで異なる処理を実行する</li>
                    </ul>

                    <h4>クラスとオブジェクトの関係</h4>
                    <p>クラスは「設計図」、オブジェクトは「実際の製品」として理解できます。</p>
                    <ul>
                        <li><strong>クラス</strong>: オブジェクトの設計図（例：「車」のクラス）</li>
                        <li><strong>オブジェクト</strong>: クラスから作られる実際のインスタンス（例：「トヨタのプリウス」）</li>
                    </ul>

                    <h3 class="section-title">5.2 基本的なクラスの作成</h3>
                    <p>VB.NETでクラスを作成する基本的な方法を学びましょう。</p>

                    <pre><code>' 基本的なクラスの定義
Public Class Student
    ' フィールド（データメンバー）
    Private studentName As String
    Private studentAge As Integer
    Private studentGrade As String
    
    ' メソッド（動作）
    Public Sub ShowInfo()
        Console.WriteLine("名前: " & studentName)
        Console.WriteLine("年齢: " & studentAge)
        Console.WriteLine("学年: " & studentGrade)
    End Sub
    
    Public Sub SetStudentInfo(name As String, age As Integer, grade As String)
        studentName = name
        studentAge = age
        studentGrade = grade
    End Sub
End Class

' クラスの使用例
Module Module1
    Sub Main()
        ' オブジェクトの作成
        Dim student1 As New Student()
        
        ' メソッドの呼び出し
        student1.SetStudentInfo("田中太郎", 18, "高校3年")
        student1.ShowInfo()
        
        Console.ReadLine()
    End Sub
End Module</code></pre>

                    <h3 class="section-title">5.3 プロパティ</h3>
                    <p>プロパティは、フィールドへの安全なアクセスを提供する仕組みです。</p>

                    <h4>基本的なプロパティ</h4>
                    <pre><code>Public Class Person
    ' プライベートフィールド
    Private _name As String
    Private _age As Integer
    
    ' Nameプロパティ
    Public Property Name() As String
        Get
            Return _name
        End Get
        Set(value As String)
            If Not String.IsNullOrEmpty(value) Then
                _name = value
            End If
        End Set
    End Property
    
    ' Ageプロパティ
    Public Property Age() As Integer
        Get
            Return _age
        End Get
        Set(value As Integer)
            If value >= 0 And value <= 150 Then
                _age = value
            End If
        End Set
    End Property
    
    ' 読み取り専用プロパティ
    Public ReadOnly Property IsAdult() As Boolean
        Get
            Return _age >= 20
        End Get
    End Property
End Class</code></pre>

                    <h4>自動実装プロパティ</h4>
                    <pre><code>Public Class Product
    ' 自動実装プロパティ（簡潔な記述）
    Public Property ProductName As String
    Public Property Price As Decimal
    Public Property InStock As Boolean
    
    ' 初期値を設定した自動実装プロパティ
    Public Property Category As String = "未分類"
End Class</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 5-1: 銀行口座クラスの作成</h5>
                        <p>プロパティとメソッドを使用して、銀行口座を管理するクラスを作成しましょう。</p>
                        <h6>プログラムコード</h6>
                        <pre><code>Public Class BankAccount
    Private _accountNumber As String
    Private _accountHolder As String
    Private _balance As Decimal
    
    ' プロパティ
    Public Property AccountNumber() As String
        Get
            Return _accountNumber
        End Get
        Set(value As String)
            If Not String.IsNullOrEmpty(value) Then
                _accountNumber = value
            End If
        End Set
    End Property
    
    Public Property AccountHolder() As String
        Get
            Return _accountHolder
        End Get
        Set(value As String)
            If Not String.IsNullOrEmpty(value) Then
                _accountHolder = value
            End If
        End Set
    End Property
    
    Public ReadOnly Property Balance() As Decimal
        Get
            Return _balance
        End Get
    End Property
    
    ' メソッド
    Public Sub Deposit(amount As Decimal)
        If amount > 0 Then
            _balance += amount
            Console.WriteLine(amount.ToString("C") & "を入金しました。")
            Console.WriteLine("現在残高: " & _balance.ToString("C"))
        Else
            Console.WriteLine("入金額は0より大きい値を指定してください。")
        End If
    End Sub
    
    Public Function Withdraw(amount As Decimal) As Boolean
        If amount > 0 And amount <= _balance Then
            _balance -= amount
            Console.WriteLine(amount.ToString("C") & "を出金しました。")
            Console.WriteLine("現在残高: " & _balance.ToString("C"))
            Return True
        Else
            Console.WriteLine("出金できません。残高または金額を確認してください。")
            Return False
        End If
    End Function
    
    Public Sub ShowAccountInfo()
        Console.WriteLine("=== 口座情報 ===")
        Console.WriteLine("口座番号: " & _accountNumber)
        Console.WriteLine("口座名義: " & _accountHolder)
        Console.WriteLine("残高: " & _balance.ToString("C"))
    End Sub
End Class

' 使用例
Module Module1
    Sub Main()
        ' 銀行口座オブジェクトの作成
        Dim account As New BankAccount()
        account.AccountNumber = "123-456-789"
        account.AccountHolder = "田中太郎"
        
        ' 操作の実行
        account.ShowAccountInfo()
        Console.WriteLine()
        
        account.Deposit(50000)
        Console.WriteLine()
        
        account.Withdraw(15000)
        Console.WriteLine()
        
        account.ShowAccountInfo()
        
        Console.ReadLine()
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">5.4 コンストラクタ</h3>
                    <p>コンストラクタは、オブジェクトが作成される際に自動的に実行される特別なメソッドです。</p>

                    <h4>基本的なコンストラクタ</h4>
                    <pre><code>Public Class Car
    Private _make As String
    Private _model As String
    Private _year As Integer
    
    ' デフォルトコンストラクタ
    Public Sub New()
        _make = "不明"
        _model = "不明"
        _year = 0
        Console.WriteLine("デフォルトコンストラクタが呼ばれました")
    End Sub
    
    ' パラメータ付きコンストラクタ
    Public Sub New(make As String, model As String, year As Integer)
        _make = make
        _model = model
        _year = year
        Console.WriteLine("パラメータ付きコンストラクタが呼ばれました")
    End Sub
    
    ' プロパティ
    Public ReadOnly Property Make() As String
        Get
            Return _make
        End Get
    End Property
    
    Public ReadOnly Property Model() As String
        Get
            Return _model
        End Get
    End Property
    
    Public ReadOnly Property Year() As Integer
        Get
            Return _year
        End Get
    End Property
    
    Public Sub ShowCarInfo()
        Console.WriteLine($"車種: {_make} {_model} ({_year}年)")
    End Sub
End Class

' 使用例
Module Module1
    Sub Main()
        ' デフォルトコンストラクタを使用
        Dim car1 As New Car()
        car1.ShowCarInfo()
        
        ' パラメータ付きコンストラクタを使用
        Dim car2 As New Car("トヨタ", "プリウス", 2023)
        car2.ShowCarInfo()
        
        Console.ReadLine()
    End Sub
End Module</code></pre>

                    <h3 class="section-title">5.5 アクセス修飾子</h3>
                    <p>アクセス修飾子は、クラスのメンバーへのアクセスレベルを制御します。</p>

                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>修飾子</th>
                                    <th>アクセス範囲</th>
                                    <th>説明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>Public</code></td>
                                    <td>どこからでも</td>
                                    <td>制限なしでアクセス可能</td>
                                </tr>
                                <tr>
                                    <td><code>Private</code></td>
                                    <td>同じクラス内のみ</td>
                                    <td>外部からはアクセス不可</td>
                                </tr>
                                <tr>
                                    <td><code>Protected</code></td>
                                    <td>同じクラスと継承クラス</td>
                                    <td>継承関係にあるクラスからアクセス可能</td>
                                </tr>
                                <tr>
                                    <td><code>Friend</code></td>
                                    <td>同じアセンブリ内</td>
                                    <td>同一プロジェクト内からアクセス可能</td>
                                </tr>
                                <tr>
                                    <td><code>Protected Friend</code></td>
                                    <td>ProtectedまたはFriend</td>
                                    <td>ProtectedとFriendの組み合わせ</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <pre><code>Public Class Employee
    ' Publicフィールド（推奨されない）
    Public CompanyName As String = "ABC株式会社"
    
    ' Privateフィールド（推奨）
    Private _employeeId As Integer
    Private _name As String
    Private _salary As Decimal
    
    ' Protectedフィールド（継承で使用）
    Protected department As String
    
    ' Publicプロパティ
    Public Property EmployeeId() As Integer
        Get
            Return _employeeId
        End Get
        Set(value As Integer)
            _employeeId = value
        End Set
    End Property
    
    Public Property Name() As String
        Get
            Return _name
        End Get
        Set(value As String)
            _name = value
        End Set
    End Property
    
    ' Privateメソッド（内部処理用）
    Private Function CalculateBonus() As Decimal
        Return _salary * 0.1
    End Function
    
    ' Publicメソッド
    Public Sub ShowEmployeeInfo()
        Console.WriteLine("社員ID: " & _employeeId)
        Console.WriteLine("名前: " & _name)
        Console.WriteLine("部署: " & department)
        Console.WriteLine("ボーナス: " & CalculateBonus().ToString("C"))
    End Sub
End Class</code></pre>

                    <h3 class="section-title">5.6 静的メンバー（Shared）</h3>
                    <p>Sharedキーワードを使用して、クラスレベルのメンバーを定義できます。</p>

                    <pre><code>Public Class MathUtility
    ' 静的フィールド（クラス全体で共有）
    Public Shared ReadOnly PI As Double = 3.14159265359
    
    ' 静的プロパティ
    Private Shared _instanceCount As Integer = 0
    Public Shared ReadOnly Property InstanceCount() As Integer
        Get
            Return _instanceCount
        End Get
    End Property
    
    ' 静的メソッド
    Public Shared Function CalculateCircleArea(radius As Double) As Double
        Return PI * radius * radius
    End Function
    
    Public Shared Function Max(a As Integer, b As Integer) As Integer
        If a > b Then
            Return a
        Else
            Return b
        End If
    End Function
    
    ' インスタンスコンストラクタ
    Public Sub New()
        _instanceCount += 1
    End Sub
End Class

' 使用例
Module Module1
    Sub Main()
        ' 静的メンバーはクラス名で直接アクセス
        Console.WriteLine("円周率: " & MathUtility.PI)
        
        Dim area As Double = MathUtility.CalculateCircleArea(5.0)
        Console.WriteLine("半径5の円の面積: " & area)
        
        Dim maxValue As Integer = MathUtility.Max(10, 20)
        Console.WriteLine("最大値: " & maxValue)
        
        ' インスタンスを作成して静的プロパティを確認
        Dim util1 As New MathUtility()
        Dim util2 As New MathUtility()
        Console.WriteLine("作成されたインスタンス数: " & MathUtility.InstanceCount)
        
        Console.ReadLine()
    End Sub
End Module</code></pre>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 5-2: 図形計算クラスの作成</h5>
                        <p>オブジェクト指向の概念を使用して、図形の面積と周囲長を計算するクラスを作成しましょう。</p>
                        <h6>プログラムコード</h6>
                        <pre><code>Public Class Rectangle
    Private _width As Double
    Private _height As Double
    
    ' コンストラクタ
    Public Sub New(width As Double, height As Double)
        Me.Width = width
        Me.Height = height
    End Sub
    
    ' プロパティ
    Public Property Width() As Double
        Get
            Return _width
        End Get
        Set(value As Double)
            If value > 0 Then
                _width = value
            Else
                Throw New ArgumentException("幅は正の値である必要があります")
            End If
        End Set
    End Property
    
    Public Property Height() As Double
        Get
            Return _height
        End Get
        Set(value As Double)
            If value > 0 Then
                _height = value
            Else
                Throw New ArgumentException("高さは正の値である必要があります")
            End If
        End Set
    End Property
    
    ' 読み取り専用プロパティ
    Public ReadOnly Property Area() As Double
        Get
            Return _width * _height
        End Get
    End Property
    
    Public ReadOnly Property Perimeter() As Double
        Get
            Return 2 * (_width + _height)
        End Get
    End Property
    
    Public ReadOnly Property IsSquare() As Boolean
        Get
            Return _width = _height
        End Get
    End Property
    
    ' メソッド
    Public Sub ShowInfo()
        Console.WriteLine("=== 長方形情報 ===")
        Console.WriteLine("幅: " & _width)
        Console.WriteLine("高さ: " & _height)
        Console.WriteLine("面積: " & Area)
        Console.WriteLine("周囲長: " & Perimeter)
        Console.WriteLine("正方形: " & If(IsSquare, "はい", "いいえ"))
    End Sub
    
    Public Sub Scale(factor As Double)
        If factor > 0 Then
            _width *= factor
            _height *= factor
            Console.WriteLine(factor & "倍に拡大/縮小しました")
        End If
    End Sub
End Class

Public Class Circle
    Private _radius As Double
    Private Shared ReadOnly PI As Double = 3.14159265359
    
    Public Sub New(radius As Double)
        Me.Radius = radius
    End Sub
    
    Public Property Radius() As Double
        Get
            Return _radius
        End Get
        Set(value As Double)
            If value > 0 Then
                _radius = value
            Else
                Throw New ArgumentException("半径は正の値である必要があります")
            End If
        End Set
    End Property
    
    Public ReadOnly Property Area() As Double
        Get
            Return PI * _radius * _radius
        End Get
    End Property
    
    Public ReadOnly Property Circumference() As Double
        Get
            Return 2 * PI * _radius
        End Get
    End Property
    
    Public Sub ShowInfo()
        Console.WriteLine("=== 円情報 ===")
        Console.WriteLine("半径: " & _radius)
        Console.WriteLine("面積: " & Area.ToString("F2"))
        Console.WriteLine("円周: " & Circumference.ToString("F2"))
    End Sub
End Class

' 使用例
Module Module1
    Sub Main()
        Try
            ' 長方形の作成と操作
            Dim rect As New Rectangle(5.0, 3.0)
            rect.ShowInfo()
            Console.WriteLine()
            
            rect.Scale(2.0)
            rect.ShowInfo()
            Console.WriteLine()
            
            ' 正方形の作成
            Dim square As New Rectangle(4.0, 4.0)
            square.ShowInfo()
            Console.WriteLine()
            
            ' 円の作成と操作
            Dim circle As New Circle(3.0)
            circle.ShowInfo()
            
        Catch ex As ArgumentException
            Console.WriteLine("エラー: " & ex.Message)
        End Try
        
        Console.ReadLine()
    End Sub
End Module</code></pre>
                    </div>

                    <h3 class="section-title">5.7 Me キーワード</h3>
                    <p><code>Me</code>キーワードは、現在のオブジェクトインスタンスを参照します。</p>

                    <pre><code>Public Class Student
    Private name As String
    Private age As Integer
    
    Public Sub SetData(name As String, age As Integer)
        ' パラメータとフィールドの名前が同じ場合、Meで区別
        Me.name = name  ' Me.nameはフィールド、nameはパラメータ
        Me.age = age
    End Sub
    
    Public Sub ShowInfo()
        Console.WriteLine("名前: " & Me.name)
        Console.WriteLine("年齢: " & Me.age)
    End Sub
    
    Public Function IsSameAge(other As Student) As Boolean
        ' 自分の年齢と他の学生の年齢を比較
        Return Me.age = other.age
    End Function
    
    Public Sub CopyFrom(other As Student)
        ' 他のオブジェクトから自分にデータをコピー
        Me.name = other.name
        Me.age = other.age
    End Sub
End Class</code></pre>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>オブジェクト指向プログラミングの3つの柱を挙げてください。</li>
                            <li>クラスとオブジェクトの違いを説明してください。</li>
                            <li>プライベートフィールドへの安全なアクセスを提供する仕組みは何ですか？</li>
                            <li>オブジェクトが作成される際に自動的に実行される特別なメソッドは何ですか？</li>
                            <li>同じクラス内でのみアクセス可能にするアクセス修飾子は何ですか？</li>
                            <li>クラス全体で共有されるメンバーを定義するキーワードは何ですか？</li>
                            <li>現在のオブジェクトインスタンスを参照するキーワードは何ですか？</li>
                            <li>読み取り専用プロパティを定義するキーワードは何ですか？</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>カプセル化、継承、ポリモーフィズム</li>
                                <li>クラスは設計図、オブジェクトはクラスから作成される実際のインスタンス</li>
                                <li>プロパティ</li>
                                <li>コンストラクタ</li>
                                <li>Private</li>
                                <li>Shared</li>
                                <li>Me</li>
                                <li>ReadOnly</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-4.html" class="btn btn-secondary">← 前の章</a>
                        <a href="vbnet-learning-material-6.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>