<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET VB.NETå­¦ç¿’æ•™æ ç¬¬7ç«  - ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã¨GridView</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .navbar {
            background-color: #0078d4;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .control-comparison {
            background-color: #f8f9fa;
            border: 2px solid #0078d4;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">ASP.NET VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">ç¬¬1ç« : Web Formså…¥é–€</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">ç¬¬2ç« : Webã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">ç¬¬3ç« : ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">ç¬¬4ç« : ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">ç¬¬5ç« : çŠ¶æ…‹ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">ç¬¬6ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter7">ç¬¬7ç« : ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">ç¬¬8ç« : ãƒã‚¹ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-9.html">ç¬¬9ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬7ç« : ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã¨GridView</h1>
                </div>

                <div id="chapter7">
                    <h2 class="chapter-title">ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰ã¨GridView</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®æ¦‚å¿µã¨å®Ÿè£…æ–¹æ³•ã‚’ç¿’å¾—ã™ã‚‹</li>
                            <li>GridViewã€DataListã€Repeaterã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®ä½¿ã„åˆ†ã‘ã‚’å­¦ç¿’ã™ã‚‹</li>
                            <li>ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã€ã‚½ãƒ¼ãƒˆã€ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
                            <li>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‚’ä½¿ç”¨ã—ãŸã‚«ã‚¹ã‚¿ãƒ ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚’ä½œæˆã™ã‚‹</li>
                            <li>VB.NETã®ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œã‚’Web Formsã§å¿œç”¨ã™ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">7.1 ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ¦‚è¦</h3>
                    <p>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã¯ã€ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è‡ªå‹•çš„ã«é€£æºã•ã›ã‚‹ä»•çµ„ã¿ã§ã™ã€‚</p>

                    <div class="control-comparison">
                        <h5>ğŸ“Š ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®æ¯”è¼ƒ</h5>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</th>
                                        <th>ç”¨é€”</th>
                                        <th>æŸ”è»Ÿæ€§</th>
                                        <th>VB.NETã§ã®é¡ä¼¼æ¦‚å¿µ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>GridView</strong></td>
                                        <td>è¡¨å½¢å¼ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</td>
                                        <td>ä¸­ç¨‹åº¦</td>
                                        <td>DataGridView</td>
                                    </tr>
                                    <tr>
                                        <td><strong>DataList</strong></td>
                                        <td>ã‚«ãƒ¼ãƒ‰å½¢å¼ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</td>
                                        <td>é«˜ã„</td>
                                        <td>ListView</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Repeater</strong></td>
                                        <td>å®Œå…¨ã‚«ã‚¹ã‚¿ãƒ è¡¨ç¤º</td>
                                        <td>æœ€é«˜</td>
                                        <td>For Each ãƒ«ãƒ¼ãƒ—</td>
                                    </tr>
                                    <tr>
                                        <td><strong>DropDownList</strong></td>
                                        <td>é¸æŠãƒªã‚¹ãƒˆ</td>
                                        <td>ä½ã„</td>
                                        <td>ComboBox</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <h3 class="section-title">7.2 åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°</h3>
                    <p>ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã‚’æ¥ç¶šã™ã‚‹åŸºæœ¬çš„ãªæ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚</p>

                    <pre><code>' åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆVB.NETã® List ã‚’æ´»ç”¨ï¼‰
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    If Not IsPostBack Then
        BindCustomerData()
        BindCategoryDropDown()
    End If
End Sub

Private Sub BindCustomerData()
    ' VB.NETã§å­¦ç¿’ã—ãŸã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³æ“ä½œã®å¿œç”¨
    Dim customers As List(Of Customer) = GetCustomersFromDatabase()
    
    ' GridViewã«ãƒ‡ãƒ¼ã‚¿ã‚’ãƒã‚¤ãƒ³ãƒ‰
    gvCustomers.DataSource = customers
    gvCustomers.DataBind()
End Sub

Private Sub BindCategoryDropDown()
    ' DropDownListã®åŸºæœ¬ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
    Dim categories As New List(Of String) From {"ã™ã¹ã¦", "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹", "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"}
    
    ddlCategory.DataSource = categories
    ddlCategory.DataBind()
    
    ' ã¾ãŸã¯ã€è¾æ›¸ã‚’ä½¿ã£ãŸå€¤ã¨è¡¨ç¤ºåã®åˆ†é›¢
    Dim categoryDict As New Dictionary(Of String, String) From {
        {"", "ã™ã¹ã¦"},
        {"prog", "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"},
        {"db", "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"},
        {"net", "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"}
    }
    
    ddlCategory.DataSource = categoryDict
    ddlCategory.DataTextField = "Value"  ' è¡¨ç¤ºã•ã‚Œã‚‹æ–‡å­—
    ddlCategory.DataValueField = "Key"   ' å®Ÿéš›ã®å€¤
    ddlCategory.DataBind()
End Sub

' ã‚«ã‚¹ã‚¿ãƒ ã‚¯ãƒ©ã‚¹ã®ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¡¨ç¤º
Public Class Customer
    Public Property CustomerId As Integer
    Public Property CustomerName As String
    Public Property Email As String
    Public Property City As String
    Public Property TotalOrders As Integer
    
    ' è¨ˆç®—ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ï¼ˆVB.NETã® ReadOnly Propertyï¼‰
    Public ReadOnly Property DisplayName As String
        Get
            Return $"{CustomerName} ({City})"
        End Get
    End Property
    
    Public ReadOnly Property OrderStatus As String
        Get
            If TotalOrders = 0 Then
                Return "æ–°è¦é¡§å®¢"
            ElseIf TotalOrders < 5 Then
                Return "é€šå¸¸é¡§å®¢"
            Else
                Return "å„ªè‰¯é¡§å®¢"
            End If
        End Get
    End Property
End Class</code></pre>

                    <h3 class="section-title">7.3 GridViewã®é«˜åº¦ãªæ©Ÿèƒ½</h3>
                    <p>GridViewã®ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã€ã‚½ãƒ¼ãƒˆã€ç·¨é›†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚</p>

                    <!-- å®Ÿç¿’ -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 7-1: é«˜æ©Ÿèƒ½ãƒ‡ãƒ¼ã‚¿ã‚°ãƒªãƒƒãƒ‰ã‚·ã‚¹ãƒ†ãƒ </h5>
                        <p>ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã€ã‚½ãƒ¼ãƒˆã€ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ç·¨é›†æ©Ÿèƒ½ã‚’æŒã¤æœ¬æ ¼çš„ãªãƒ‡ãƒ¼ã‚¿ã‚°ãƒªãƒƒãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

                        <h6>AdvancedGridView.aspxï¼ˆãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ï¼‰</h6>
                        <pre><code>&lt;%@ Page Title="é«˜æ©Ÿèƒ½ãƒ‡ãƒ¼ã‚¿ã‚°ãƒªãƒƒãƒ‰" Language="VB" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="AdvancedGridView.aspx.vb" Inherits="HelloWorldWebApp.AdvancedGridView" %&gt;

&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="container mt-4"&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-12"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-primary text-white"&gt;
                        &lt;h3 class="card-title mb-0"&gt;è£½å“ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ &lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;!-- æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚° --&gt;
                        &lt;div class="row mb-3"&gt;
                            &lt;div class="col-md-3"&gt;
                                &lt;asp:Label ID="lblSearch" runat="server" Text="æ¤œç´¢:" CssClass="form-label" AssociatedControlID="txtSearch"&gt;&lt;/asp:Label&gt;
                                &lt;asp:TextBox ID="txtSearch" runat="server" CssClass="form-control" placeholder="è£½å“åã§æ¤œç´¢"&gt;&lt;/asp:TextBox&gt;
                            &lt;/div&gt;
                            &lt;div class="col-md-3"&gt;
                                &lt;asp:Label ID="lblCategoryFilter" runat="server" Text="ã‚«ãƒ†ã‚´ãƒª:" CssClass="form-label" AssociatedControlID="ddlCategoryFilter"&gt;&lt;/asp:Label&gt;
                                &lt;asp:DropDownList ID="ddlCategoryFilter" runat="server" CssClass="form-select"&gt;&lt;/asp:DropDownList&gt;
                            &lt;/div&gt;
                            &lt;div class="col-md-3"&gt;
                                &lt;asp:Label ID="lblPriceRange" runat="server" Text="ä¾¡æ ¼å¸¯:" CssClass="form-label" AssociatedControlID="ddlPriceRange"&gt;&lt;/asp:Label&gt;
                                &lt;asp:DropDownList ID="ddlPriceRange" runat="server" CssClass="form-select"&gt;
                                    &lt;asp:ListItem Value="" Text="ã™ã¹ã¦"&gt;&lt;/asp:ListItem&gt;
                                    &lt;asp:ListItem Value="0-1000" Text="Â¥1,000æœªæº€"&gt;&lt;/asp:ListItem&gt;
                                    &lt;asp:ListItem Value="1000-5000" Text="Â¥1,000-Â¥5,000"&gt;&lt;/asp:ListItem&gt;
                                    &lt;asp:ListItem Value="5000-10000" Text="Â¥5,000-Â¥10,000"&gt;&lt;/asp:ListItem&gt;
                                    &lt;asp:ListItem Value="10000-" Text="Â¥10,000ä»¥ä¸Š"&gt;&lt;/asp:ListItem&gt;
                                &lt;/asp:DropDownList&gt;
                            &lt;/div&gt;
                            &lt;div class="col-md-3 d-flex align-items-end"&gt;
                                &lt;asp:Button ID="btnFilter" runat="server" Text="ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨" CssClass="btn btn-info me-2" /&gt;
                                &lt;asp:Button ID="btnClearFilter" runat="server" Text="ã‚¯ãƒªã‚¢" CssClass="btn btn-outline-secondary" /&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- ãƒ‡ãƒ¼ã‚¿ä»¶æ•°è¡¨ç¤º --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;asp:Label ID="lblRecordCount" runat="server" Text="" CssClass="text-muted"&gt;&lt;/asp:Label&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- GridView --&gt;
                        &lt;asp:GridView ID="gvProducts" runat="server" 
                            CssClass="table table-striped table-hover"
                            AutoGenerateColumns="false"
                            AllowPaging="true" PageSize="10"
                            AllowSorting="true"
                            EmptyDataText="ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“"
                            DataKeyNames="ProductId"&gt;
                            
                            &lt;PagerSettings Mode="NumericFirstLast" FirstPageText="æœ€åˆ" LastPageText="æœ€å¾Œ" 
                                NextPageText="æ¬¡ã¸" PreviousPageText="å‰ã¸" PageButtonCount="5" /&gt;
                            &lt;PagerStyle CssClass="pagination justify-content-center" /&gt;
                            
                            &lt;Columns&gt;
                                &lt;!-- ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ --&gt;
                                &lt;asp:TemplateField HeaderText="æ“ä½œ" ItemStyle-Width="120px"&gt;
                                    &lt;ItemTemplate&gt;
                                        &lt;asp:Button ID="btnEdit" runat="server" Text="ç·¨é›†" CssClass="btn btn-sm btn-warning me-1"
                                            CommandName="Edit" /&gt;
                                        &lt;asp:Button ID="btnDelete" runat="server" Text="å‰Šé™¤" CssClass="btn btn-sm btn-danger"
                                            CommandName="Delete" 
                                            OnClientClick="return confirm('ã“ã®è£½å“ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');" /&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:Button ID="btnUpdate" runat="server" Text="æ›´æ–°" CssClass="btn btn-sm btn-success me-1"
                                            CommandName="Update" /&gt;
                                        &lt;asp:Button ID="btnCancel" runat="server" Text="å–æ¶ˆ" CssClass="btn btn-sm btn-secondary"
                                            CommandName="Cancel" /&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                                
                                &lt;!-- è£½å“ID --&gt;
                                &lt;asp:BoundField DataField="ProductId" HeaderText="ID" 
                                    SortExpression="ProductId" ItemStyle-Width="60px" ReadOnly="true" /&gt;
                                
                                &lt;!-- è£½å“å --&gt;
                                &lt;asp:TemplateField HeaderText="è£½å“å" SortExpression="ProductName"&gt;
                                    &lt;ItemTemplate&gt;
                                        &lt;strong&gt;&lt;%# Eval("ProductName") %&gt;&lt;/strong&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:TextBox ID="txtProductName" runat="server" Text='&lt;%# Bind("ProductName") %&gt;' 
                                            CssClass="form-control form-control-sm" /&gt;
                                        &lt;asp:RequiredFieldValidator ID="rfvProductName" runat="server" 
                                            ControlToValidate="txtProductName" ErrorMessage="*" Display="Dynamic" 
                                            CssClass="text-danger" /&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                                
                                &lt;!-- ã‚«ãƒ†ã‚´ãƒª --&gt;
                                &lt;asp:TemplateField HeaderText="ã‚«ãƒ†ã‚´ãƒª" SortExpression="Category"&gt;
                                    &lt;ItemTemplate&gt;
                                        &lt;span class="badge bg-secondary"&gt;&lt;%# Eval("Category") %&gt;&lt;/span&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:DropDownList ID="ddlCategory" runat="server" CssClass="form-select form-select-sm"
                                            SelectedValue='&lt;%# Bind("Category") %&gt;'&gt;
                                            &lt;asp:ListItem Value="ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°" Text="ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"&gt;&lt;/asp:ListItem&gt;
                                            &lt;asp:ListItem Value="ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹" Text="ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"&gt;&lt;/asp:ListItem&gt;
                                            &lt;asp:ListItem Value="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯" Text="ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"&gt;&lt;/asp:ListItem&gt;
                                            &lt;asp:ListItem Value="ãã®ä»–" Text="ãã®ä»–"&gt;&lt;/asp:ListItem&gt;
                                        &lt;/asp:DropDownList&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                                
                                &lt;!-- ä¾¡æ ¼ --&gt;
                                &lt;asp:TemplateField HeaderText="ä¾¡æ ¼" SortExpression="Price"&gt;
                                    &lt;ItemTemplate&gt;
                                        Â¥&lt;%# Eval("Price", "{0:N0}") %&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:TextBox ID="txtPrice" runat="server" Text='&lt;%# Bind("Price") %&gt;' 
                                            CssClass="form-control form-control-sm" TextMode="Number" /&gt;
                                        &lt;asp:RangeValidator ID="rvPrice" runat="server" 
                                            ControlToValidate="txtPrice" Type="Integer" MinimumValue="0" MaximumValue="1000000"
                                            ErrorMessage="*" Display="Dynamic" CssClass="text-danger" /&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                                
                                &lt;!-- åœ¨åº« --&gt;
                                &lt;asp:TemplateField HeaderText="åœ¨åº«" SortExpression="Stock"&gt;
                                    &lt;ItemTemplate&gt;
                                        &lt;%# GetStockDisplay(Eval("Stock")) %&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:TextBox ID="txtStock" runat="server" Text='&lt;%# Bind("Stock") %&gt;' 
                                            CssClass="form-control form-control-sm" TextMode="Number" /&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                                
                                &lt;!-- ç™»éŒ²æ—¥ --&gt;
                                &lt;asp:BoundField DataField="CreatedDate" HeaderText="ç™»éŒ²æ—¥" 
                                    SortExpression="CreatedDate" DataFormatString="{0:yyyy-MM-dd}" ReadOnly="true" /&gt;
                                
                                &lt;!-- ã‚¢ã‚¯ãƒ†ã‚£ãƒ–çŠ¶æ…‹ --&gt;
                                &lt;asp:TemplateField HeaderText="çŠ¶æ…‹" SortExpression="IsActive"&gt;
                                    &lt;ItemTemplate&gt;
                                        &lt;%# GetActiveStatusDisplay(Eval("IsActive")) %&gt;
                                    &lt;/ItemTemplate&gt;
                                    &lt;EditItemTemplate&gt;
                                        &lt;asp:CheckBox ID="chkIsActive" runat="server" Checked='&lt;%# Bind("IsActive") %&gt;' /&gt;
                                    &lt;/EditItemTemplate&gt;
                                &lt;/asp:TemplateField&gt;
                            &lt;/Columns&gt;
                        &lt;/asp:GridView&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º --&gt;
        &lt;div class="row mt-3"&gt;
            &lt;div class="col-12"&gt;
                &lt;asp:Label ID="lblMessage" runat="server" Text=""&gt;&lt;/asp:Label&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>AdvancedGridView.aspx.vbï¼ˆã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ï¼‰</h6>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Configuration

Public Class AdvancedGridView
    Inherits System.Web.UI.Page

    ' è£½å“ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
    Public Class Product
        Public Property ProductId As Integer
        Public Property ProductName As String
        Public Property Category As String
        Public Property Price As Decimal
        Public Property Stock As Integer
        Public Property IsActive As Boolean
        Public Property CreatedDate As DateTime
    End Class

    Private ReadOnly Property ConnectionString As String
        Get
            Return ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString
        End Get
    End Property

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadCategoryFilter()
            BindProductData()
        End If
    End Sub

    ' ãƒ•ã‚£ãƒ«ã‚¿ç”¨ã‚«ãƒ†ã‚´ãƒªã®èª­ã¿è¾¼ã¿
    Private Sub LoadCategoryFilter()
        ddlCategoryFilter.Items.Clear()
        ddlCategoryFilter.Items.Add(New ListItem("ã™ã¹ã¦", ""))
        ddlCategoryFilter.Items.Add(New ListItem("ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°", "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°"))
        ddlCategoryFilter.Items.Add(New ListItem("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹", "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹"))
        ddlCategoryFilter.Items.Add(New ListItem("ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯", "ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯"))
        ddlCategoryFilter.Items.Add(New ListItem("ãã®ä»–", "ãã®ä»–"))
    End Sub

    ' è£½å“ãƒ‡ãƒ¼ã‚¿ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°
    Private Sub BindProductData()
        Try
            Dim products As List(Of Product) = GetProducts()
            
            ' æ¤œç´¢ãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®é©ç”¨
            products = ApplyFilters(products)
            
            ' ã‚½ãƒ¼ãƒˆã®é©ç”¨
            If Not String.IsNullOrEmpty(ViewState("SortExpression")) Then
                products = ApplySort(products, ViewState("SortExpression"), ViewState("SortDirection"))
            End If
            
            gvProducts.DataSource = products
            gvProducts.DataBind()
            
            lblRecordCount.Text = $"è¡¨ç¤ºä»¶æ•°: {products.Count}ä»¶"
            
        Catch ex As Exception
            ShowMessage($"ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert alert-danger")
        End Try
    End Sub

    ' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰è£½å“ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—
    Private Function GetProducts() As List(Of Product)
        Dim products As New List(Of Product)()
        
        Using connection As New SqlConnection(ConnectionString)
            Dim sql As String = "SELECT ProductId, ProductName, Category, Price, Stock, IsActive, CreatedDate " &
                               "FROM Products ORDER BY ProductId"
            
            Using command As New SqlCommand(sql, connection)
                connection.Open()
                
                Using reader As SqlDataReader = command.ExecuteReader()
                    While reader.Read()
                        products.Add(New Product() With {
                            .ProductId = reader.GetInt32("ProductId"),
                            .ProductName = reader.GetString("ProductName"),
                            .Category = If(reader.IsDBNull("Category"), String.Empty, reader.GetString("Category")),
                            .Price = reader.GetDecimal("Price"),
                            .Stock = reader.GetInt32("Stock"),
                            .IsActive = reader.GetBoolean("IsActive"),
                            .CreatedDate = reader.GetDateTime("CreatedDate")
                        })
                    End While
                End Using
            End Using
        End Using
        
        Return products
    End Function

    ' ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®é©ç”¨ï¼ˆVB.NET LINQ ã®æ´»ç”¨ï¼‰
    Private Function ApplyFilters(products As List(Of Product)) As List(Of Product)
        Dim filteredProducts = products.AsEnumerable()
        
        ' ãƒ†ã‚­ã‚¹ãƒˆæ¤œç´¢
        If Not String.IsNullOrWhiteSpace(txtSearch.Text) Then
            Dim searchText As String = txtSearch.Text.Trim().ToLower()
            filteredProducts = filteredProducts.Where(Function(p) p.ProductName.ToLower().Contains(searchText))
        End If
        
        ' ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿
        If Not String.IsNullOrEmpty(ddlCategoryFilter.SelectedValue) Then
            Dim selectedCategory As String = ddlCategoryFilter.SelectedValue
            filteredProducts = filteredProducts.Where(Function(p) p.Category = selectedCategory)
        End If
        
        ' ä¾¡æ ¼å¸¯ãƒ•ã‚£ãƒ«ã‚¿
        If Not String.IsNullOrEmpty(ddlPriceRange.SelectedValue) Then
            Dim priceRange As String = ddlPriceRange.SelectedValue
            
            Select Case priceRange
                Case "0-1000"
                    filteredProducts = filteredProducts.Where(Function(p) p.Price < 1000)
                Case "1000-5000"
                    filteredProducts = filteredProducts.Where(Function(p) p.Price >= 1000 AndAlso p.Price < 5000)
                Case "5000-10000"
                    filteredProducts = filteredProducts.Where(Function(p) p.Price >= 5000 AndAlso p.Price < 10000)
                Case "10000-"
                    filteredProducts = filteredProducts.Where(Function(p) p.Price >= 10000)
            End Select
        End If
        
        Return filteredProducts.ToList()
    End Function

    ' ã‚½ãƒ¼ãƒˆã®é©ç”¨ï¼ˆVB.NET OrderBy ã®æ´»ç”¨ï¼‰
    Private Function ApplySort(products As List(Of Product), sortExpression As String, sortDirection As String) As List(Of Product)
        Select Case sortExpression.ToLower()
            Case "productid"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.ProductId).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.ProductId).ToList()
                End If
            Case "productname"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.ProductName).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.ProductName).ToList()
                End If
            Case "category"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.Category).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.Category).ToList()
                End If
            Case "price"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.Price).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.Price).ToList()
                End If
            Case "stock"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.Stock).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.Stock).ToList()
                End If
            Case "createddate"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.CreatedDate).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.CreatedDate).ToList()
                End If
            Case "isactive"
                If sortDirection = "ASC" Then
                    Return products.OrderBy(Function(p) p.IsActive).ToList()
                Else
                    Return products.OrderByDescending(Function(p) p.IsActive).ToList()
                End If
            Case Else
                Return products
        End Select
    End Function

    ' GridViewã‚¤ãƒ™ãƒ³ãƒˆãƒãƒ³ãƒ‰ãƒ©
    Protected Sub gvProducts_PageIndexChanging(sender As Object, e As GridViewPageEventArgs) Handles gvProducts.PageIndexChanging
        gvProducts.PageIndex = e.NewPageIndex
        BindProductData()
    End Sub

    Protected Sub gvProducts_Sorting(sender As Object, e As GridViewSortEventArgs) Handles gvProducts.Sorting
        Dim sortExpression As String = e.SortExpression
        Dim sortDirection As String = "ASC"
        
        ' ç¾åœ¨ã®ã‚½ãƒ¼ãƒˆæ–¹å‘ã‚’å–å¾—ãƒ»åè»¢
        If ViewState("SortExpression") IsNot Nothing AndAlso ViewState("SortExpression").ToString() = sortExpression Then
            sortDirection = If(ViewState("SortDirection").ToString() = "ASC", "DESC", "ASC")
        End If
        
        ViewState("SortExpression") = sortExpression
        ViewState("SortDirection") = sortDirection
        
        gvProducts.PageIndex = 0 ' ã‚½ãƒ¼ãƒˆæ™‚ã¯æœ€åˆã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
        BindProductData()
    End Sub

    Protected Sub gvProducts_RowEditing(sender As Object, e As GridViewEditEventArgs) Handles gvProducts.RowEditing
        gvProducts.EditIndex = e.NewEditIndex
        BindProductData()
    End Sub

    Protected Sub gvProducts_RowCancelingEdit(sender As Object, e As GridViewCancelEditEventArgs) Handles gvProducts.RowCancelingEdit
        gvProducts.EditIndex = -1
        BindProductData()
    End Sub

    Protected Sub gvProducts_RowUpdating(sender As Object, e As GridViewUpdateEventArgs) Handles gvProducts.RowUpdating
        Try
            Dim productId As Integer = CInt(gvProducts.DataKeys(e.RowIndex).Value)
            
            ' ç·¨é›†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‹ã‚‰å€¤ã‚’å–å¾—
            Dim txtProductName As TextBox = DirectCast(gvProducts.Rows(e.RowIndex).FindControl("txtProductName"), TextBox)
            Dim ddlCategory As DropDownList = DirectCast(gvProducts.Rows(e.RowIndex).FindControl("ddlCategory"), DropDownList)
            Dim txtPrice As TextBox = DirectCast(gvProducts.Rows(e.RowIndex).FindControl("txtPrice"), TextBox)
            Dim txtStock As TextBox = DirectCast(gvProducts.Rows(e.RowIndex).FindControl("txtStock"), TextBox)
            Dim chkIsActive As CheckBox = DirectCast(gvProducts.Rows(e.RowIndex).FindControl("chkIsActive"), CheckBox)
            
            ' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°
            UpdateProduct(productId, txtProductName.Text, ddlCategory.SelectedValue, 
                         Decimal.Parse(txtPrice.Text), Integer.Parse(txtStock.Text), chkIsActive.Checked)
            
            gvProducts.EditIndex = -1
            BindProductData()
            ShowMessage("è£½å“æƒ…å ±ã‚’æ›´æ–°ã—ã¾ã—ãŸ", "alert alert-success")
            
        Catch ex As Exception
            ShowMessage($"æ›´æ–°ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert alert-danger")
        End Try
    End Sub

    Protected Sub gvProducts_RowDeleting(sender As Object, e As GridViewDeleteEventArgs) Handles gvProducts.RowDeleting
        Try
            Dim productId As Integer = CInt(gvProducts.DataKeys(e.RowIndex).Value)
            
            DeleteProduct(productId)
            BindProductData()
            ShowMessage("è£½å“ã‚’å‰Šé™¤ã—ã¾ã—ãŸ", "alert alert-success")
            
        Catch ex As Exception
            ShowMessage($"å‰Šé™¤ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert alert-danger")
        End Try
    End Sub

    ' ãƒ•ã‚£ãƒ«ã‚¿é–¢é€£ã‚¤ãƒ™ãƒ³ãƒˆ
    Protected Sub btnFilter_Click(sender As Object, e As EventArgs) Handles btnFilter.Click
        gvProducts.PageIndex = 0 ' ãƒ•ã‚£ãƒ«ã‚¿æ™‚ã¯æœ€åˆã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹
        BindProductData()
    End Sub

    Protected Sub btnClearFilter_Click(sender As Object, e As EventArgs) Handles btnClearFilter.Click
        txtSearch.Text = ""
        ddlCategoryFilter.SelectedIndex = 0
        ddlPriceRange.SelectedIndex = 0
        BindProductData()
    End Sub

    ' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ›´æ–°ãƒ»å‰Šé™¤ãƒ¡ã‚½ãƒƒãƒ‰
    Private Sub UpdateProduct(productId As Integer, productName As String, category As String, 
                             price As Decimal, stock As Integer, isActive As Boolean)
        Using connection As New SqlConnection(ConnectionString)
            Dim sql As String = "UPDATE Products SET ProductName = @ProductName, Category = @Category, " &
                               "Price = @Price, Stock = @Stock, IsActive = @IsActive WHERE ProductId = @ProductId"
            
            Using command As New SqlCommand(sql, connection)
                command.Parameters.AddWithValue("@ProductId", productId)
                command.Parameters.AddWithValue("@ProductName", productName)
                command.Parameters.AddWithValue("@Category", category)
                command.Parameters.AddWithValue("@Price", price)
                command.Parameters.AddWithValue("@Stock", stock)
                command.Parameters.AddWithValue("@IsActive", isActive)
                
                connection.Open()
                command.ExecuteNonQuery()
            End Using
        End Using
    End Sub

    Private Sub DeleteProduct(productId As Integer)
        Using connection As New SqlConnection(ConnectionString)
            Dim sql As String = "DELETE FROM Products WHERE ProductId = @ProductId"
            
            Using command As New SqlCommand(sql, connection)
                command.Parameters.AddWithValue("@ProductId", productId)
                
                connection.Open()
                command.ExecuteNonQuery()
            End Using
        End Using
    End Sub

    ' è¡¨ç¤ºç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰
    Protected Function GetStockDisplay(stock As Object) As String
        Dim stockValue As Integer = CInt(stock)
        
        If stockValue = 0 Then
            Return "<span class='badge bg-danger'>åœ¨åº«åˆ‡ã‚Œ</span>"
        ElseIf stockValue < 10 Then
            Return $"<span class='badge bg-warning text-dark'>{stockValue}å€‹</span>"
        Else
            Return $"<span class='badge bg-success'>{stockValue}å€‹</span>"
        End If
    End Function

    Protected Function GetActiveStatusDisplay(isActive As Object) As String
        If CBool(isActive) Then
            Return "<span class='badge bg-success'>æœ‰åŠ¹</span>"
        Else
            Return "<span class='badge bg-secondary'>ç„¡åŠ¹</span>"
        End If
    End Function

    Private Sub ShowMessage(message As String, cssClass As String)
        lblMessage.Text = message
        lblMessage.CssClass = cssClass
    End Sub
End Class</code></pre>
                    </div>

                    <h3 class="section-title">7.4 DataListã¨Repeaterã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</h3>
                    <p>ã‚ˆã‚ŠæŸ”è»Ÿãªãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã®ãŸã‚ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚</p>

                    <pre><code>' DataList ã®ä½¿ç”¨ä¾‹
&lt;asp:DataList ID="dlProducts" runat="server" RepeatColumns="3" CssClass="row"&gt;
    &lt;ItemTemplate&gt;
        &lt;div class="col-md-4 mb-3"&gt;
            &lt;div class="card h-100"&gt;
                &lt;div class="card-body"&gt;
                    &lt;h5 class="card-title"&gt;&lt;%# Eval("ProductName") %&gt;&lt;/h5&gt;
                    &lt;p class="card-text"&gt;&lt;%# Eval("Category") %&gt;&lt;/p&gt;
                    &lt;p class="card-text"&gt;&lt;strong&gt;ä¾¡æ ¼: Â¥&lt;%# Eval("Price", "{0:N0}") %&gt;&lt;/strong&gt;&lt;/p&gt;
                    &lt;p class="card-text"&gt;&lt;small class="text-muted"&gt;åœ¨åº«: &lt;%# Eval("Stock") %&gt;å€‹&lt;/small&gt;&lt;/p&gt;
                &lt;/div&gt;
                &lt;div class="card-footer"&gt;
                    &lt;asp:Button ID="btnAddToCart" runat="server" Text="ã‚«ãƒ¼ãƒˆã«è¿½åŠ " CssClass="btn btn-primary"
                        CommandArgument='&lt;%# Eval("ProductId") %&gt;' OnCommand="btnAddToCart_Command" /&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ItemTemplate&gt;
&lt;/asp:DataList&gt;

' Repeater ã®ä½¿ç”¨ä¾‹ï¼ˆæœ€ã‚‚æŸ”è»Ÿï¼‰
&lt;asp:Repeater ID="rptProducts" runat="server"&gt;
    &lt;HeaderTemplate&gt;
        &lt;div class="row"&gt;
    &lt;/HeaderTemplate&gt;
    &lt;ItemTemplate&gt;
        &lt;div class="col-lg-3 col-md-4 col-sm-6 mb-4"&gt;
            &lt;div class="card product-card h-100"&gt;
                &lt;div class="card-img-top bg-light d-flex align-items-center justify-content-center" style="height: 200px;"&gt;
                    &lt;i class="fas fa-box fa-3x text-muted"&gt;&lt;/i&gt;
                &lt;/div&gt;
                &lt;div class="card-body d-flex flex-column"&gt;
                    &lt;h6 class="card-title"&gt;&lt;%# Eval("ProductName") %&gt;&lt;/h6&gt;
                    &lt;p class="card-text flex-grow-1"&gt;
                        &lt;small class="text-muted"&gt;&lt;%# Eval("Category") %&gt;&lt;/small&gt;
                    &lt;/p&gt;
                    &lt;div class="d-flex justify-content-between align-items-center"&gt;
                        &lt;strong class="text-primary"&gt;Â¥&lt;%# Eval("Price", "{0:N0}") %&gt;&lt;/strong&gt;
                        &lt;small class="text-muted"&gt;åœ¨åº«: &lt;%# Eval("Stock") %&gt;&lt;/small&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="card-footer p-2"&gt;
                    &lt;div class="btn-group w-100" role="group"&gt;
                        &lt;button type="button" class="btn btn-outline-primary btn-sm" 
                            onclick="viewProduct(&lt;%# Eval("ProductId") %&gt;)"&gt;è©³ç´°&lt;/button&gt;
                        &lt;asp:Button ID="btnQuickAdd" runat="server" Text="è¿½åŠ " CssClass="btn btn-primary btn-sm"
                            CommandName="AddToCart" CommandArgument='&lt;%# Eval("ProductId") %&gt;' /&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/ItemTemplate&gt;
    &lt;AlternatingItemTemplate&gt;
        &lt;div class="col-lg-3 col-md-4 col-sm-6 mb-4"&gt;
            &lt;div class="card product-card h-100 border-info"&gt;
                &lt;!-- AlternatingItemTemplate ã®å†…å®¹ --&gt;
                &lt;div class="card-img-top bg-info-light d-flex align-items-center justify-content-center" style="height: 200px;"&gt;
                    &lt;i class="fas fa-star fa-3x text-info"&gt;&lt;/i&gt;
                &lt;/div&gt;
                &lt;div class="card-body d-flex flex-column"&gt;
                    &lt;h6 class="card-title text-info"&gt;â­ &lt;%# Eval("ProductName") %&gt;&lt;/h6&gt;
                    &lt;p class="card-text flex-grow-1"&gt;
                        &lt;small class="text-muted"&gt;&lt;%# Eval("Category") %&gt;&lt;/small&gt;
                    &lt;/p&gt;
                    &lt;div class="d-flex justify-content-between align-items-center"&gt;
                        &lt;strong class="text-info"&gt;Â¥&lt;%# Eval("Price", "{0:N0}") %&gt;&lt;/strong&gt;
                        &lt;small class="text-muted"&gt;åœ¨åº«: &lt;%# Eval("Stock") %&gt;&lt;/small&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="card-footer p-2"&gt;
                    &lt;div class="btn-group w-100" role="group"&gt;
                        &lt;button type="button" class="btn btn-outline-info btn-sm" 
                            onclick="viewProduct(&lt;%# Eval("ProductId") %&gt;)"&gt;è©³ç´°&lt;/button&gt;
                        &lt;asp:Button ID="btnQuickAddAlt" runat="server" Text="è¿½åŠ " CssClass="btn btn-info btn-sm"
                            CommandName="AddToCart" CommandArgument='&lt;%# Eval("ProductId") %&gt;' /&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/AlternatingItemTemplate&gt;
    &lt;FooterTemplate&gt;
        &lt;/div&gt;
    &lt;/FooterTemplate&gt;
&lt;/asp:Repeater&gt;

' VB.NET ã‚³ãƒ¼ãƒ‰ã§ã®ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†
Protected Sub rptProducts_ItemCommand(source As Object, e As RepeaterCommandEventArgs) Handles rptProducts.ItemCommand
    If e.CommandName = "AddToCart" Then
        Dim productId As Integer = Integer.Parse(e.CommandArgument.ToString())
        AddToShoppingCart(productId)
    End If
End Sub

Private Sub AddToShoppingCart(productId As Integer)
    ' VB.NET Session çŠ¶æ…‹ç®¡ç†ã®æ´»ç”¨
    Dim cart As List(Of Integer) = TryCast(Session("ShoppingCart"), List(Of Integer))
    
    If cart Is Nothing Then
        cart = New List(Of Integer)()
    End If
    
    cart.Add(productId)
    Session("ShoppingCart") = cart
    
    ShowMessage($"å•†å“ã‚’ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸã€‚ã‚«ãƒ¼ãƒˆå†…å•†å“æ•°: {cart.Count}", "alert alert-success")
End Sub</code></pre>

                    <h3 class="section-title">7.5 ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã®æœ€é©åŒ–</h3>
                    <p>å¤§é‡ãƒ‡ãƒ¼ã‚¿ã‚’åŠ¹ç‡çš„ã«è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <div class="warning">
                        <h6>âš ï¸ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …</h6>
                        <ul>
                            <li><strong>å¤§é‡ãƒ‡ãƒ¼ã‚¿</strong>: é©åˆ‡ãªãƒšãƒ¼ã‚¸ãƒ³ã‚°ã‚µã‚¤ã‚ºã®è¨­å®š</li>
                            <li><strong>ViewState</strong>: ä¸è¦ãªå ´åˆã¯ EnableViewState="false" ã«è¨­å®š</li>
                            <li><strong>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</strong>: å¿…è¦ãªåˆ—ã®ã¿ã‚’å–å¾—</li>
                            <li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨</strong>: é »ç¹ã«ä½¿ç”¨ã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥</li>
                        </ul>
                    </div>

                    <pre><code>' ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ä¾‹
Protected Sub BindProductsOptimized()
    ' ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã€ãªã‘ã‚Œã°ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã¿
    Dim cacheKey As String = $"Products_{txtSearch.Text}_{ddlCategoryFilter.SelectedValue}"
    Dim products As List(Of Product) = TryCast(Cache(cacheKey), List(Of Product))
    
    If products Is Nothing Then
        products = GetProductsFromDatabase()
        
        ' 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
        Cache.Insert(cacheKey, products, Nothing, 
                    DateTime.Now.AddMinutes(5), 
                    TimeSpan.Zero)
    End If
    
    ' ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰ã§ã®ã‚½ãƒ¼ãƒˆãƒ»ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã®ãŸã‚ã®JavaScript
    RegisterClientScriptForSorting()
    
    gvProducts.DataSource = products
    gvProducts.DataBind()
End Sub

' ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚µã‚¤ãƒ‰æ©Ÿèƒ½ã®è¿½åŠ 
Private Sub RegisterClientScriptForSorting()
    Dim script As String = "
    function sortTable(columnIndex, dataType) {
        // JavaScript ã§ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚½ãƒ¼ãƒˆå®Ÿè£…
        var table = document.querySelector('#gvProducts');
        var rows = Array.from(table.querySelectorAll('tbody tr'));
        
        rows.sort(function(a, b) {
            var aVal = a.cells[columnIndex].textContent.trim();
            var bVal = b.cells[columnIndex].textContent.trim();
            
            if (dataType === 'number') {
                return parseFloat(aVal) - parseFloat(bVal);
            } else {
                return aVal.localeCompare(bVal);
            }
        });
        
        var tbody = table.querySelector('tbody');
        rows.forEach(function(row) {
            tbody.appendChild(row);
        });
    }
    
    function filterTable() {
        var searchText = document.getElementById('txtSearch').value.toLowerCase();
        var table = document.querySelector('#gvProducts');
        var rows = table.querySelectorAll('tbody tr');
        
        rows.forEach(function(row) {
            var text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchText) ? '' : 'none';
        });
    }"
    
    ClientScript.RegisterClientScriptBlock(Me.GetType(), "TableUtils", script, True)
End Sub</code></pre>

                    <!-- ç†è§£åº¦ç¢ºèª -->
                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>ãƒ‡ãƒ¼ã‚¿ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚’è‡ªå‹•çš„ã«é€£æºã•ã›ã‚‹ä»•çµ„ã¿ã‚’ä½•ã¨å‘¼ã³ã¾ã™ã‹ï¼Ÿ</li>
                            <li>è¡¨å½¢å¼ã§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹æœ€ã‚‚ä¸€èˆ¬çš„ãªã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>å®Œå…¨ã«ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºå¯èƒ½ãªãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>GridViewã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>GridViewã§ã‚½ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’æœ‰åŠ¹ã«ã™ã‚‹ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>GridViewã§ç·¨é›†ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚‹ãŸã‚ã®CommandNameã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>VB.NETã§ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã™ã‚‹LINQãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>å¤§é‡ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºæ™‚ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ä»•çµ„ã¿ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°</li>
                                <li>GridView</li>
                                <li>Repeater</li>
                                <li>AllowPaging</li>
                                <li>AllowSorting</li>
                                <li>Edit</li>
                                <li>Where</li>
                                <li>ã‚­ãƒ£ãƒƒã‚·ãƒ¥</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-6.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="aspnet-vb-learning-material-8.html" class="btn btn-primary">æ¬¡ã®ç«  â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>