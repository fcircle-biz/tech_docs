<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET VB.NET学習教材 第2章 - Web FormsとWebコントロール</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #0078d4;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .comparison-table {
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">ASP.NET VB.NET学習ガイド</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">第1章: Web Forms入門</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter2">第2章: Webコントロール</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">第3章: イベント処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">第4章: データ検証</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">第5章: 状態管理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">第6章: データベース連携</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">第7章: データバインド</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">第8章: マスターページ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-9.html">第9章: セキュリティ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-10.html">第10章: 実践開発</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第2章: Web FormsとWebコントロール</h1>
                </div>

                <div id="chapter2">
                    <h2 class="chapter-title">Web FormsとWebコントロール</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Web Formsの基本コントロール（Label、TextBox、Button等）の使用方法を習得する</li>
                            <li>サーバーコントロールとHTMLコントロールの違いを理解する</li>
                            <li>コントロールのプロパティとメソッドの活用方法を学ぶ</li>
                            <li>VB.NETコンソールアプリとの操作の違いを体験する</li>
                            <li>実用的なWebフォームを作成する</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.1 Web Formsの基本コントロール概要</h3>
                    <p>ASP.NET Web Formsには、Webページでユーザーインターフェースを構築するための様々なコントロールが用意されています。</p>

                    <h4>主要なWebコントロール</h4>
                    <div class="table-responsive comparison-table">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>コントロール</th>
                                    <th>用途</th>
                                    <th>VB.NETコンソールでの類似操作</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>&lt;asp:Label&gt;</code></td>
                                    <td>テキストの表示</td>
                                    <td><code>Console.WriteLine</code></td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:TextBox&gt;</code></td>
                                    <td>テキスト入力</td>
                                    <td><code>Console.ReadLine</code></td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:Button&gt;</code></td>
                                    <td>ボタンクリック</td>
                                    <td>メニュー選択処理</td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:DropDownList&gt;</code></td>
                                    <td>選択肢の提示</td>
                                    <td>Select Case文</td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:CheckBox&gt;</code></td>
                                    <td>チェック選択</td>
                                    <td>Boolean変数</td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:RadioButton&gt;</code></td>
                                    <td>排他選択</td>
                                    <td>Select Case文</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="section-title">2.2 Label・TextBox・Buttonの基本使用法</h3>
                    <p>最も基本的なコントロールの使用方法を実践的に学習しましょう。</p>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 2-1: 基本コントロールを使った計算機アプリ</h5>
                        <p>VB.NETで作成したような計算プログラムをWeb Formsで実装しましょう。</p>
                        
                        <h6>手順1: 新しいWebフォームページの作成</h6>
                        <ol>
                            <li>前章で作成したプロジェクトで「新しい項目の追加」</li>
                            <li>「Webフォーム」を選択し、名前を「Calculator.aspx」とする</li>
                            <li>以下のマークアップに置き換える</li>
                        </ol>

                        <h6>Calculator.aspx（マークアップ）</h6>
                        <pre><code>&lt;%@ Page Title="計算機" Language="VB" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="Calculator.aspx.vb" Inherits="HelloWorldWebApp.Calculator" %&gt;

&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="container mt-4"&gt;
        &lt;div class="row justify-content-center"&gt;
            &lt;div class="col-md-6"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-primary text-white"&gt;
                        &lt;h3 class="card-title mb-0"&gt;Web計算機&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;!-- 数値1 --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;asp:Label ID="lblNumber1" runat="server" Text="数値1:" CssClass="form-label" AssociatedControlID="txtNumber1"&gt;&lt;/asp:Label&gt;
                            &lt;asp:TextBox ID="txtNumber1" runat="server" CssClass="form-control" TextMode="Number" placeholder="最初の数値を入力"&gt;&lt;/asp:TextBox&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 演算子選択 --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;asp:Label ID="lblOperator" runat="server" Text="演算:" CssClass="form-label" AssociatedControlID="ddlOperator"&gt;&lt;/asp:Label&gt;
                            &lt;asp:DropDownList ID="ddlOperator" runat="server" CssClass="form-select"&gt;
                                &lt;asp:ListItem Value="+" Text="加算 (+)"&gt;&lt;/asp:ListItem&gt;
                                &lt;asp:ListItem Value="-" Text="減算 (-)"&gt;&lt;/asp:ListItem&gt;
                                &lt;asp:ListItem Value="*" Text="乗算 (×)"&gt;&lt;/asp:ListItem&gt;
                                &lt;asp:ListItem Value="/" Text="除算 (÷)"&gt;&lt;/asp:ListItem&gt;
                            &lt;/asp:DropDownList&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 数値2 --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;asp:Label ID="lblNumber2" runat="server" Text="数値2:" CssClass="form-label" AssociatedControlID="txtNumber2"&gt;&lt;/asp:Label&gt;
                            &lt;asp:TextBox ID="txtNumber2" runat="server" CssClass="form-control" TextMode="Number" placeholder="2番目の数値を入力"&gt;&lt;/asp:TextBox&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 計算ボタン --&gt;
                        &lt;div class="mb-3 text-center"&gt;
                            &lt;asp:Button ID="btnCalculate" runat="server" Text="計算実行" CssClass="btn btn-primary btn-lg" /&gt;
                            &lt;asp:Button ID="btnClear" runat="server" Text="クリア" CssClass="btn btn-secondary btn-lg ms-2" /&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 結果表示 --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;asp:Label ID="lblResult" runat="server" Text="" CssClass="alert alert-info d-block text-center h4"&gt;&lt;/asp:Label&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 計算履歴 --&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;h5&gt;計算履歴&lt;/h5&gt;
                            &lt;asp:ListBox ID="lstHistory" runat="server" CssClass="form-control" Rows="5"&gt;&lt;/asp:ListBox&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>Calculator.aspx.vb（コードビハインド）</h6>
                        <pre><code>Public Class Calculator
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            ' 初期化処理
            lblResult.Text = "計算結果がここに表示されます"
            lblResult.CssClass = "alert alert-info d-block text-center h4"
            
            ' ViewStateから履歴を復元（初回は空）
            If ViewState("History") Is Nothing Then
                ViewState("History") = New List(Of String)()
            End If
            LoadHistoryFromViewState()
        End If
    End Sub

    Protected Sub btnCalculate_Click(sender As Object, e As EventArgs) Handles btnCalculate.Click
        Try
            ' 入力値の取得と検証
            Dim number1 As Double
            Dim number2 As Double
            
            If Not Double.TryParse(txtNumber1.Text, number1) Then
                ShowError("数値1が正しくありません。")
                Return
            End If
            
            If Not Double.TryParse(txtNumber2.Text, number2) Then
                ShowError("数値2が正しくありません。")
                Return
            End If
            
            ' 演算子の取得
            Dim operator As String = ddlOperator.SelectedValue
            Dim result As Double
            Dim operatorText As String = ddlOperator.SelectedItem.Text
            
            ' 計算実行
            Select Case operator
                Case "+"
                    result = number1 + number2
                Case "-"
                    result = number1 - number2
                Case "*"
                    result = number1 * number2
                Case "/"
                    If number2 = 0 Then
                        ShowError("ゼロで割ることはできません。")
                        Return
                    End If
                    result = number1 / number2
                Case Else
                    ShowError("無効な演算子です。")
                    Return
            End Select
            
            ' 結果の表示
            Dim calculationText As String = $"{number1} {operator} {number2} = {result}"
            lblResult.Text = $"結果: {result}"
            lblResult.CssClass = "alert alert-success d-block text-center h4"
            
            ' 履歴に追加
            AddToHistory(calculationText)
            
        Catch ex As Exception
            ShowError($"計算エラー: {ex.Message}")
        End Try
    End Sub

    Protected Sub btnClear_Click(sender As Object, e As EventArgs) Handles btnClear.Click
        ' フォームをクリア
        txtNumber1.Text = ""
        txtNumber2.Text = ""
        ddlOperator.SelectedIndex = 0
        lblResult.Text = "計算結果がここに表示されます"
        lblResult.CssClass = "alert alert-info d-block text-center h4"
        txtNumber1.Focus()
    End Sub

    Private Sub ShowError(message As String)
        lblResult.Text = message
        lblResult.CssClass = "alert alert-danger d-block text-center h4"
    End Sub

    Private Sub AddToHistory(calculation As String)
        ' ViewStateから履歴を取得
        Dim history As List(Of String) = DirectCast(ViewState("History"), List(Of String))
        
        ' 新しい計算を履歴に追加（最新が先頭に来るように）
        history.Insert(0, $"{DateTime.Now:HH:mm:ss} - {calculation}")
        
        ' 履歴が10件を超えたら古いものを削除
        If history.Count > 10 Then
            history.RemoveAt(history.Count - 1)
        End If
        
        ' ViewStateを更新
        ViewState("History") = history
        
        ' 画面に反映
        LoadHistoryFromViewState()
    End Sub

    Private Sub LoadHistoryFromViewState()
        Dim history As List(Of String) = DirectCast(ViewState("History"), List(Of String))
        lstHistory.Items.Clear()
        
        For Each item As String In history
            lstHistory.Items.Add(item)
        Next
    End Sub
End Class</code></pre>

                        <h6>実行とテスト</h6>
                        <ol>
                            <li>プロジェクトをビルド（Ctrl+Shift+B）</li>
                            <li>Calculator.aspxを右クリック→「ブラウザーで表示」</li>
                            <li>様々な計算を実行してテスト</li>
                            <li>エラーケース（文字入力、ゼロ除算）も確認</li>
                            <li>履歴機能が正常に動作することを確認</li>
                        </ol>
                    </div>

                    <h3 class="section-title">2.3 CheckBox・RadioButton・DropDownListの活用</h3>
                    <p>選択系コントロールの使い方を実践的に学習します。</p>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 2-2: ユーザー情報登録フォーム</h5>
                        <p>様々なコントロールを組み合わせた実用的なフォームを作成しましょう。</p>

                        <h6>UserRegistration.aspx（マークアップ）</h6>
                        <pre><code>&lt;%@ Page Title="ユーザー登録" Language="VB" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="UserRegistration.aspx.vb" Inherits="HelloWorldWebApp.UserRegistration" %&gt;

&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="container mt-4"&gt;
        &lt;div class="row justify-content-center"&gt;
            &lt;div class="col-md-8"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-success text-white"&gt;
                        &lt;h3 class="card-title mb-0"&gt;ユーザー情報登録&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;div class="row"&gt;
                            &lt;div class="col-md-6"&gt;
                                &lt;!-- 基本情報 --&gt;
                                &lt;h5 class="text-primary"&gt;基本情報&lt;/h5&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblName" runat="server" Text="氏名 *:" CssClass="form-label" AssociatedControlID="txtName"&gt;&lt;/asp:Label&gt;
                                    &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" placeholder="山田太郎"&gt;&lt;/asp:TextBox&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblEmail" runat="server" Text="メールアドレス *:" CssClass="form-label" AssociatedControlID="txtEmail"&gt;&lt;/asp:Label&gt;
                                    &lt;asp:TextBox ID="txtEmail" runat="server" CssClass="form-control" TextMode="Email" placeholder="example@email.com"&gt;&lt;/asp:TextBox&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblAge" runat="server" Text="年齢:" CssClass="form-label" AssociatedControlID="txtAge"&gt;&lt;/asp:Label&gt;
                                    &lt;asp:TextBox ID="txtAge" runat="server" CssClass="form-control" TextMode="Number" placeholder="25"&gt;&lt;/asp:TextBox&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblGender" runat="server" Text="性別:" CssClass="form-label"&gt;&lt;/asp:Label&gt;
                                    &lt;div&gt;
                                        &lt;asp:RadioButton ID="rbMale" runat="server" Text="男性" GroupName="Gender" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="rbMale" CssClass="form-check-label me-3"&gt;男性&lt;/asp:Label&gt;
                                        &lt;asp:RadioButton ID="rbFemale" runat="server" Text="女性" GroupName="Gender" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="rbFemale" CssClass="form-check-label me-3"&gt;女性&lt;/asp:Label&gt;
                                        &lt;asp:RadioButton ID="rbOther" runat="server" Text="その他" GroupName="Gender" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="rbOther" CssClass="form-check-label"&gt;その他&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                            
                            &lt;div class="col-md-6"&gt;
                                &lt;!-- 詳細情報 --&gt;
                                &lt;h5 class="text-primary"&gt;詳細情報&lt;/h5&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblCountry" runat="server" Text="国/地域:" CssClass="form-label" AssociatedControlID="ddlCountry"&gt;&lt;/asp:Label&gt;
                                    &lt;asp:DropDownList ID="ddlCountry" runat="server" CssClass="form-select"&gt;
                                        &lt;asp:ListItem Value="" Text="選択してください"&gt;&lt;/asp:ListItem&gt;
                                        &lt;asp:ListItem Value="JP" Text="日本"&gt;&lt;/asp:ListItem&gt;
                                        &lt;asp:ListItem Value="US" Text="アメリカ"&gt;&lt;/asp:ListItem&gt;
                                        &lt;asp:ListItem Value="KR" Text="韓国"&gt;&lt;/asp:ListItem&gt;
                                        &lt;asp:ListItem Value="CN" Text="中国"&gt;&lt;/asp:ListItem&gt;
                                        &lt;asp:ListItem Value="OTHER" Text="その他"&gt;&lt;/asp:ListItem&gt;
                                    &lt;/asp:DropDownList&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:Label ID="lblProgrammingLanguages" runat="server" Text="使用可能なプログラミング言語:" CssClass="form-label"&gt;&lt;/asp:Label&gt;
                                    &lt;div&gt;
                                        &lt;asp:CheckBox ID="chkVBNet" runat="server" Text="VB.NET" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="chkVBNet" CssClass="form-check-label d-block"&gt;VB.NET&lt;/asp:Label&gt;
                                        
                                        &lt;asp:CheckBox ID="chkCSharp" runat="server" Text="C#" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="chkCSharp" CssClass="form-check-label d-block"&gt;C#&lt;/asp:Label&gt;
                                        
                                        &lt;asp:CheckBox ID="chkJava" runat="server" Text="Java" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="chkJava" CssClass="form-check-label d-block"&gt;Java&lt;/asp:Label&gt;
                                        
                                        &lt;asp:CheckBox ID="chkPython" runat="server" Text="Python" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="chkPython" CssClass="form-check-label d-block"&gt;Python&lt;/asp:Label&gt;
                                        
                                        &lt;asp:CheckBox ID="chkJavaScript" runat="server" Text="JavaScript" CssClass="form-check-input me-1" /&gt;
                                        &lt;asp:Label runat="server" AssociatedControlID="chkJavaScript" CssClass="form-check-label d-block"&gt;JavaScript&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;asp:CheckBox ID="chkNewsletter" runat="server" Text="ニュースレターを受信する" CssClass="form-check-input me-1" /&gt;
                                    &lt;asp:Label runat="server" AssociatedControlID="chkNewsletter" CssClass="form-check-label"&gt;ニュースレターを受信する&lt;/asp:Label&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- ボタン群 --&gt;
                        &lt;div class="text-center mt-4"&gt;
                            &lt;asp:Button ID="btnRegister" runat="server" Text="登録" CssClass="btn btn-success btn-lg me-2" /&gt;
                            &lt;asp:Button ID="btnClear" runat="server" Text="リセット" CssClass="btn btn-secondary btn-lg" /&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 結果表示 --&gt;
                        &lt;div class="mt-4"&gt;
                            &lt;asp:Label ID="lblMessage" runat="server" Text=""&gt;&lt;/asp:Label&gt;
                        &lt;/div&gt;
                        
                        &lt;!-- 登録情報表示 --&gt;
                        &lt;div class="mt-4"&gt;
                            &lt;asp:Panel ID="pnlResult" runat="server" Visible="false" CssClass="card"&gt;
                                &lt;div class="card-header bg-info text-white"&gt;
                                    &lt;h5 class="card-title mb-0"&gt;登録情報確認&lt;/h5&gt;
                                &lt;/div&gt;
                                &lt;div class="card-body"&gt;
                                    &lt;asp:Literal ID="litResult" runat="server"&gt;&lt;/asp:Literal&gt;
                                &lt;/div&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>UserRegistration.aspx.vb（コードビハインド）</h6>
                        <pre><code>Public Class UserRegistration
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            txtName.Focus()
        End If
    End Sub

    Protected Sub btnRegister_Click(sender As Object, e As EventArgs) Handles btnRegister.Click
        If ValidateForm() Then
            DisplayRegistrationInfo()
        End If
    End Sub

    Protected Sub btnClear_Click(sender As Object, e As EventArgs) Handles btnClear.Click
        ClearForm()
        lblMessage.Text = "フォームをクリアしました。"
        lblMessage.CssClass = "alert alert-info"
        pnlResult.Visible = False
    End Sub

    Private Function ValidateForm() As Boolean
        Dim isValid As Boolean = True
        Dim errorMessages As New List(Of String)()
        
        ' 必須項目チェック
        If String.IsNullOrWhiteSpace(txtName.Text) Then
            errorMessages.Add("氏名は必須です。")
            isValid = False
        End If
        
        If String.IsNullOrWhiteSpace(txtEmail.Text) Then
            errorMessages.Add("メールアドレスは必須です。")
            isValid = False
        ElseIf Not IsValidEmail(txtEmail.Text) Then
            errorMessages.Add("有効なメールアドレスを入力してください。")
            isValid = False
        End If
        
        ' 年齢チェック
        If Not String.IsNullOrWhiteSpace(txtAge.Text) Then
            Dim age As Integer
            If Not Integer.TryParse(txtAge.Text, age) OrElse age < 0 OrElse age > 150 Then
                errorMessages.Add("年齢は0-150の数値で入力してください。")
                isValid = False
            End If
        End If
        
        If Not isValid Then
            lblMessage.Text = "入力エラー:<br/>" & String.Join("<br/>", errorMessages)
            lblMessage.CssClass = "alert alert-danger"
            pnlResult.Visible = False
        End If
        
        Return isValid
    End Function

    Private Function IsValidEmail(email As String) As Boolean
        Try
            Dim addr As New System.Net.Mail.MailAddress(email)
            Return addr.Address = email
        Catch
            Return False
        End Try
    End Function

    Private Sub DisplayRegistrationInfo()
        Dim result As New System.Text.StringBuilder()
        
        result.AppendLine($"<strong>氏名:</strong> {Server.HtmlEncode(txtName.Text)}<br/>")
        result.AppendLine($"<strong>メールアドレス:</strong> {Server.HtmlEncode(txtEmail.Text)}<br/>")
        
        If Not String.IsNullOrWhiteSpace(txtAge.Text) Then
            result.AppendLine($"<strong>年齢:</strong> {Server.HtmlEncode(txtAge.Text)}歳<br/>")
        End If
        
        ' 性別
        Dim gender As String = ""
        If rbMale.Checked Then
            gender = "男性"
        ElseIf rbFemale.Checked Then
            gender = "女性"
        ElseIf rbOther.Checked Then
            gender = "その他"
        End If
        
        If Not String.IsNullOrEmpty(gender) Then
            result.AppendLine($"<strong>性別:</strong> {gender}<br/>")
        End If
        
        ' 国/地域
        If ddlCountry.SelectedIndex > 0 Then
            result.AppendLine($"<strong>国/地域:</strong> {ddlCountry.SelectedItem.Text}<br/>")
        End If
        
        ' プログラミング言語
        Dim languages As New List(Of String)()
        If chkVBNet.Checked Then languages.Add("VB.NET")
        If chkCSharp.Checked Then languages.Add("C#")
        If chkJava.Checked Then languages.Add("Java")
        If chkPython.Checked Then languages.Add("Python")
        If chkJavaScript.Checked Then languages.Add("JavaScript")
        
        If languages.Count > 0 Then
            result.AppendLine($"<strong>プログラミング言語:</strong> {String.Join(", ", languages)}<br/>")
        End If
        
        ' ニュースレター
        result.AppendLine($"<strong>ニュースレター受信:</strong> {If(chkNewsletter.Checked, "希望する", "希望しない")}<br/>")
        
        litResult.Text = result.ToString()
        pnlResult.Visible = True
        
        lblMessage.Text = "ユーザー情報の登録が完了しました。"
        lblMessage.CssClass = "alert alert-success"
    End Sub

    Private Sub ClearForm()
        txtName.Text = ""
        txtEmail.Text = ""
        txtAge.Text = ""
        rbMale.Checked = False
        rbFemale.Checked = False
        rbOther.Checked = False
        ddlCountry.SelectedIndex = 0
        chkVBNet.Checked = False
        chkCSharp.Checked = False
        chkJava.Checked = False
        chkPython.Checked = False
        chkJavaScript.Checked = False
        chkNewsletter.Checked = False
        txtName.Focus()
    End Sub
End Class</code></pre>
                    </div>

                    <h3 class="section-title">2.4 Web Formsコントロールの重要な特徴</h3>
                    <p>VB.NETコンソールアプリケーションとは異なる、Web Formsならではの特徴を理解しましょう。</p>

                    <h4>サーバーサイド処理</h4>
                    <ul>
                        <li><strong>runat="server"</strong>: コントロールがサーバーで処理されることを示す</li>
                        <li><strong>ViewState</strong>: コントロールの状態がPostBack間で保持される</li>
                        <li><strong>Event Handling</strong>: サーバーサイドでイベントが処理される</li>
                    </ul>

                    <h4>HTMLとの違い</h4>
                    <div class="table-responsive comparison-table">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>Webコントロール</th>
                                    <th>生成されるHTML</th>
                                    <th>利点</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>&lt;asp:TextBox ID="txt1" runat="server" /&gt;</code></td>
                                    <td><code>&lt;input type="text" id="txt1" name="txt1" /&gt;</code></td>
                                    <td>VB.NETで直接操作可能</td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:Button ID="btn1" Text="送信" runat="server" /&gt;</code></td>
                                    <td><code>&lt;input type="submit" id="btn1" value="送信" /&gt;</code></td>
                                    <td>サーバーサイドイベント処理</td>
                                </tr>
                                <tr>
                                    <td><code>&lt;asp:DropDownList ID="ddl1" runat="server" /&gt;</code></td>
                                    <td><code>&lt;select id="ddl1" name="ddl1"&gt;...&lt;/select&gt;</code></td>
                                    <td>アイテムの動的追加・削除</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="warning">
                        <h6>⚠️ Web Formsでの注意点</h6>
                        <ul>
                            <li><strong>PostBack</strong>: ボタンクリック等でページ全体が再読み込みされる</li>
                            <li><strong>ViewState</strong>: 大量のデータを保持するとページサイズが大きくなる</li>
                            <li><strong>ID生成</strong>: 実際のHTML IDは自動生成される（ClientIDを使用）</li>
                            <li><strong>エラー処理</strong>: サーバーサイドとクライアントサイド両方で考慮が必要</li>
                        </ul>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>ASP.NET Webコントロールがサーバーで処理されることを示す属性は何ですか？</li>
                            <li>DropDownListでアイテムを追加するためのオブジェクトは何ですか？</li>
                            <li>CheckBoxコントロールがチェックされているかを確認するプロパティは何ですか？</li>
                            <li>RadioButtonで同じグループを作るために使用するプロパティは何ですか？</li>
                            <li>コントロールの状態がPostBack間で保持される仕組みを何と呼びますか？</li>
                            <li>Web FormsでVB.NETのConsole.WriteLineに相当する表示用コントロールは何ですか？</li>
                            <li>Web FormsでVB.NETのConsole.ReadLineに相当する入力用コントロールは何ですか？</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>runat="server"</li>
                                <li>ListItem</li>
                                <li>Checked</li>
                                <li>GroupName</li>
                                <li>ViewState</li>
                                <li>Label</li>
                                <li>TextBox</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-1.html" class="btn btn-secondary">← 前の章</a>
                        <a href="aspnet-vb-learning-material-3.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>