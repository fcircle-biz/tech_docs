<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET VB.NETå­¦ç¿’æ•™æ ç¬¬5ç«  - çŠ¶æ…‹ç®¡ç†ï¼ˆSessionã€ViewStateã€Cacheï¼‰</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .navbar {
            background-color: #0078d4;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .state-diagram {
            background-color: #f8f9fa;
            border: 2px solid #0078d4;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">ASP.NET VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">ç¬¬1ç« : Web Formså…¥é–€</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">ç¬¬2ç« : Webã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">ç¬¬3ç« : ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">ç¬¬4ç« : ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter5">ç¬¬5ç« : çŠ¶æ…‹ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">ç¬¬6ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">ç¬¬7ç« : ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">ç¬¬8ç« : ãƒã‚¹ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-9.html">ç¬¬9ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬5ç« : çŠ¶æ…‹ç®¡ç†ï¼ˆSessionã€ViewStateã€Cacheï¼‰</h1>
                </div>

                <div id="chapter5">
                    <h2 class="chapter-title">çŠ¶æ…‹ç®¡ç†ï¼ˆSessionã€ViewStateã€Cacheï¼‰</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ã€ŒçŠ¶æ…‹ãªã—ã€ã®ç‰¹æ€§ã¨çŠ¶æ…‹ç®¡ç†ã®å¿…è¦æ€§ã‚’ç†è§£ã™ã‚‹</li>
                            <li>ViewStateã€Sessionã€ApplicationçŠ¶æ…‹ã®é•ã„ã¨ä½¿ã„åˆ†ã‘ã‚’ç¿’å¾—ã™ã‚‹</li>
                            <li>Cacheã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½¿ç”¨ã—ãŸãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šæ‰‹æ³•ã‚’å­¦ç¿’ã™ã‚‹</li>
                            <li>VB.NETã®å¤‰æ•°ã‚¹ã‚³ãƒ¼ãƒ—ã¨Web FormsçŠ¶æ…‹ç®¡ç†ã®é•ã„ã‚’ä½“é¨“ã™ã‚‹</li>
                            <li>å®Ÿç”¨çš„ãªã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">5.1 Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®çŠ¶æ…‹ç®¡ç†ã¨ã¯</h3>
                    <p>HTTPãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯ã€ŒçŠ¶æ…‹ãªã—ï¼ˆã‚¹ãƒ†ãƒ¼ãƒˆãƒ¬ã‚¹ï¼‰ã€ã®ãŸã‚ã€ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–“ã§æƒ…å ±ã‚’ä¿æŒã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ãŒå¿…è¦ã§ã™ã€‚</p>

                    <div class="state-diagram">
                        <h5>ğŸ“Š çŠ¶æ…‹ç®¡ç†ã®æ¯”è¼ƒ</h5>
                        <div class="table-responsive">
                            <table class="table table-sm">
                                <thead>
                                    <tr>
                                        <th>çŠ¶æ…‹ç®¡ç†æ–¹æ³•</th>
                                        <th>ã‚¹ã‚³ãƒ¼ãƒ—</th>
                                        <th>ç”Ÿå­˜æœŸé–“</th>
                                        <th>VB.NETã¨ã®é¡ä¼¼ç‚¹</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><strong>ViewState</strong></td>
                                        <td>ãƒšãƒ¼ã‚¸å†…ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</td>
                                        <td>ãã®ãƒšãƒ¼ã‚¸ã®ã¿</td>
                                        <td>ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Session</strong></td>
                                        <td>ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚»ãƒƒã‚·ãƒ§ãƒ³</td>
                                        <td>ã‚»ãƒƒã‚·ãƒ§ãƒ³çµ‚äº†ã¾ã§</td>
                                        <td>ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹å¤‰æ•°</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Application</strong></td>
                                        <td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“</td>
                                        <td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³çµ‚äº†ã¾ã§</td>
                                        <td>Sharedå¤‰æ•°</td>
                                    </tr>
                                    <tr>
                                        <td><strong>Cache</strong></td>
                                        <td>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å…¨ä½“</td>
                                        <td>è¨­å®šå¯èƒ½ï¼ˆæœŸé™ã€ä¾å­˜é–¢ä¿‚ï¼‰</td>
                                        <td>Staticå¤‰æ•° + æœŸé™ç®¡ç†</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <h3 class="section-title">5.2 ViewState</h3>
                    <p>ViewStateã¯ã€ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®çŠ¶æ…‹ã‚’PostBacké–“ã§ä¿æŒã™ã‚‹ä»•çµ„ã¿ã§ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' ViewStateã®åŸºæœ¬çš„ãªä½¿ç”¨
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    If Not IsPostBack Then
        ' åˆæœŸãƒ‡ãƒ¼ã‚¿ã®è¨­å®š
        ViewState("VisitCount") = 0
        ViewState("StartTime") = DateTime.Now
    End If
End Sub

Protected Sub btnIncrement_Click(sender As Object, e As EventArgs)
    ' ViewStateã‹ã‚‰å€¤ã‚’å–å¾—ã—ã¦æ›´æ–°
    Dim count As Integer = CInt(ViewState("VisitCount"))
    count += 1
    ViewState("VisitCount") = count
    
    lblCount.Text = $"ã‚¯ãƒªãƒƒã‚¯å›æ•°: {count}"
    
    ' è¤‡é›‘ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚‚ä¿å­˜å¯èƒ½
    Dim userData As New Dictionary(Of String, String)()
    userData.Add("LastAction", "Increment")
    userData.Add("Timestamp", DateTime.Now.ToString())
    ViewState("UserData") = userData
End Sub

' ViewStateã‚µã‚¤ã‚ºã®ç¢ºèª
Protected Sub btnCheckViewStateSize_Click(sender As Object, e As EventArgs)
    Dim viewStateSize As Integer = Page.ViewState.ToString().Length
    lblViewStateInfo.Text = $"ViewStateã‚µã‚¤ã‚º: {viewStateSize} æ–‡å­—"
End Sub</code></pre>

                    <h3 class="section-title">5.3 SessionçŠ¶æ…‹</h3>
                    <p>Sessionã¯ã€ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æœŸé–“ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã—ã¾ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' SessionçŠ¶æ…‹ã®ç®¡ç†
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    ' ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±ã®åˆæœŸåŒ–
    If Session("UserName") Is Nothing Then
        Session("UserName") = "ã‚²ã‚¹ãƒˆ"
        Session("LoginTime") = DateTime.Now
        Session("PageViews") = 0
    End If
    
    ' ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼æ•°ã®ã‚«ã‚¦ãƒ³ãƒˆ
    Dim pageViews As Integer = CInt(Session("PageViews"))
    pageViews += 1
    Session("PageViews") = pageViews
    
    UpdateSessionInfo()
End Sub

Private Sub UpdateSessionInfo()
    lblUserName.Text = Session("UserName").ToString()
    lblLoginTime.Text = $"ãƒ­ã‚°ã‚¤ãƒ³æ™‚åˆ»: {Session("LoginTime")}"
    lblPageViews.Text = $"ãƒšãƒ¼ã‚¸ãƒ“ãƒ¥ãƒ¼: {Session("PageViews")}"
    lblSessionId.Text = $"ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: {Session.SessionID}"
End Sub

Protected Sub btnSetUserName_Click(sender As Object, e As EventArgs)
    If Not String.IsNullOrWhiteSpace(txtUserName.Text) Then
        Session("UserName") = txtUserName.Text.Trim()
        UpdateSessionInfo()
        lblMessage.Text = "ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒè¨­å®šã•ã‚Œã¾ã—ãŸ"
    End If
End Sub

Protected Sub btnClearSession_Click(sender As Object, e As EventArgs)
    Session.Clear() ' ã™ã¹ã¦ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³å¤‰æ•°ã‚’ã‚¯ãƒªã‚¢
    ' ã¾ãŸã¯ Session.Abandon() ' ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å®Œå…¨ã«ç ´æ£„
    lblMessage.Text = "ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒã‚¯ãƒªã‚¢ã•ã‚Œã¾ã—ãŸ"
End Sub

' ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®è¨­å®šï¼ˆweb.configã¾ãŸã¯ã‚³ãƒ¼ãƒ‰ï¼‰
Protected Sub btnSetTimeout_Click(sender As Object, e As EventArgs)
    Session.Timeout = 30 ' 30åˆ†ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ
    lblMessage.Text = $"ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã‚’{Session.Timeout}åˆ†ã«è¨­å®šã—ã¾ã—ãŸ"
End Sub</code></pre>

                    <h3 class="section-title">5.4 ApplicationçŠ¶æ…‹</h3>
                    <p>ApplicationçŠ¶æ…‹ã¯ã€å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§å…±æœ‰ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¬ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' ApplicationçŠ¶æ…‹ã®ç®¡ç†
Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
    ' ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¬ãƒ™ãƒ«ã®ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼
    Application.Lock() ' åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡
    Try
        If Application("TotalVisitors") Is Nothing Then
            Application("TotalVisitors") = 0
        End If
        
        Dim totalVisitors As Integer = CInt(Application("TotalVisitors"))
        totalVisitors += 1
        Application("TotalVisitors") = totalVisitors
        
        lblTotalVisitors.Text = $"ç·è¨ªå•è€…æ•°: {totalVisitors}"
    Finally
        Application.UnLock()
    End Try
    
    ' ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹æ™‚åˆ»ã®è¡¨ç¤º
    If Application("StartTime") IsNot Nothing Then
        lblAppStartTime.Text = $"ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹æ™‚åˆ»: {Application("StartTime")}"
    End If
End Sub

' Global.asax.vbã§ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¬ãƒ™ãƒ«ã‚¤ãƒ™ãƒ³ãƒˆ
Sub Application_Start(ByVal sender As Object, ByVal e As EventArgs)
    ' ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹æ™‚ã«å®Ÿè¡Œ
    Application("StartTime") = DateTime.Now
    Application("TotalVisitors") = 0
    
    ' ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¬ãƒ™ãƒ«ã®è¨­å®š
    Application("Version") = "1.0.0"
    Application("SiteName") = "VB.NET Web Formså­¦ç¿’ã‚µã‚¤ãƒˆ"
End Sub

Protected Sub btnShowAppInfo_Click(sender As Object, e As EventArgs)
    Dim appInfo As New System.Text.StringBuilder()
    appInfo.AppendLine($"ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³å: {Application("SiteName")}")
    appInfo.AppendLine($"ãƒãƒ¼ã‚¸ãƒ§ãƒ³: {Application("Version")}")
    appInfo.AppendLine($"é–‹å§‹æ™‚åˆ»: {Application("StartTime")}")
    appInfo.AppendLine($"ç·è¨ªå•è€…æ•°: {Application("TotalVisitors")}")
    
    lblAppInfo.Text = appInfo.ToString().Replace(Environment.NewLine, "<br/>")
End Sub</code></pre>

                    <h3 class="section-title">5.5 Cacheã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ</h3>
                    <p>Cacheã¯ã€é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãªãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’æä¾›ã—ã€æœŸé™ã‚„ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ã‚’è¨­å®šã§ãã¾ã™ã€‚</p>

                    <pre class="code-block"><code class="language-vbnet">' Cacheã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®åŸºæœ¬ä½¿ç”¨
Protected Sub btnCacheData_Click(sender As Object, e As EventArgs)
    Dim expensiveData As String = GenerateExpensiveData()
    
    ' çµ¶å¯¾æœŸé™ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥ï¼ˆ10åˆ†å¾Œã«æœŸé™åˆ‡ã‚Œï¼‰
    Cache.Insert("ExpensiveData", expensiveData, Nothing, 
                DateTime.Now.AddMinutes(10), 
                TimeSpan.Zero)
    
    lblMessage.Text = "ãƒ‡ãƒ¼ã‚¿ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ã•ã‚Œã¾ã—ãŸï¼ˆ10åˆ†é–“æœ‰åŠ¹ï¼‰"
End Sub

Protected Sub btnGetCachedData_Click(sender As Object, e As EventArgs)
    Dim cachedData As String = TryCast(Cache("ExpensiveData"), String)
    
    If cachedData IsNot Nothing Then
        lblCachedData.Text = $"ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ã®ãƒ‡ãƒ¼ã‚¿: {cachedData}"
        lblMessage.Text = "ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã¾ã—ãŸ"
    Else
        ' ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ãªã„å ´åˆã¯å†ç”Ÿæˆ
        Dim newData As String = GenerateExpensiveData()
        Cache.Insert("ExpensiveData", newData, Nothing, 
                    DateTime.Now.AddMinutes(10), 
                    TimeSpan.Zero)
        
        lblCachedData.Text = $"æ–°è¦ç”Ÿæˆãƒ‡ãƒ¼ã‚¿: {newData}"
        lblMessage.Text = "ãƒ‡ãƒ¼ã‚¿ã‚’å†ç”Ÿæˆã—ã¦ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ã—ã¾ã—ãŸ"
    End If
End Sub

Private Function GenerateExpensiveData() As String
    ' é‡ã„å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
    System.Threading.Thread.Sleep(1000) ' 1ç§’å¾…æ©Ÿ
    Return $"å‡¦ç†æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ - ç”Ÿæˆæ™‚åˆ»: {DateTime.Now:HH:mm:ss}"
End Function

' ãƒ•ã‚¡ã‚¤ãƒ«ä¾å­˜é–¢ä¿‚ã®ã‚ã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ¥
Protected Sub btnCacheWithFileDependency_Click(sender As Object, e As EventArgs)
    Dim configFilePath As String = Server.MapPath("~/App_Data/config.txt")
    
    ' ãƒ•ã‚¡ã‚¤ãƒ«ãŒå¤‰æ›´ã•ã‚ŒãŸã‚‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ç„¡åŠ¹åŒ–
    Dim fileDependency As New System.Web.Caching.CacheDependency(configFilePath)
    
    Dim configData As String = File.ReadAllText(configFilePath)
    Cache.Insert("ConfigData", configData, fileDependency)
    
    lblMessage.Text = "è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹ãŒã‚­ãƒ£ãƒƒã‚·ãƒ¥ã•ã‚Œã¾ã—ãŸï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã§è‡ªå‹•æ›´æ–°ï¼‰"
End Sub

' ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°æœŸé™ï¼ˆæœ€å¾Œã®ã‚¢ã‚¯ã‚»ã‚¹ã‹ã‚‰æŒ‡å®šæ™‚é–“ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœŸé™åˆ‡ã‚Œï¼‰
Protected Sub btnSlidingCache_Click(sender As Object, e As EventArgs)
    Dim userData As String = "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿"
    
    ' æœ€å¾Œã®ã‚¢ã‚¯ã‚»ã‚¹ã‹ã‚‰5åˆ†å¾Œã«æœŸé™åˆ‡ã‚Œ
    Cache.Insert("UserData", userData, Nothing, 
                Cache.NoAbsoluteExpiration,
                TimeSpan.FromMinutes(5))
    
    lblMessage.Text = "ã‚¹ãƒ©ã‚¤ãƒ‡ã‚£ãƒ³ã‚°æœŸé™ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’è¨­å®šã—ã¾ã—ãŸï¼ˆæœ€çµ‚ã‚¢ã‚¯ã‚»ã‚¹ã‹ã‚‰5åˆ†ï¼‰"
End Sub</code></pre>

                    <!-- å®Ÿç¿’ -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 5-1: ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ </h5>
                        <p>SessionçŠ¶æ…‹ã‚’æ´»ç”¨ã—ã¦ã€æœ¬æ ¼çš„ãªã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆæ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã—ã‚‡ã†ã€‚</p>

                        <h6>ShoppingCart.aspxï¼ˆãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ï¼‰</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ Page Title="ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆ" Language="VB" MasterPageFile="~/Site.Master" AutoEventWireup="true" CodeBehind="ShoppingCart.aspx.vb" Inherits="HelloWorldWebApp.ShoppingCart" %&gt;

&lt;asp:Content ID="BodyContent" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="container mt-4"&gt;
        &lt;div class="row"&gt;
            &lt;div class="col-md-8"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-success text-white"&gt;
                        &lt;h3 class="card-title mb-0"&gt;å•†å“ä¸€è¦§&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;div class="row" id="productList"&gt;
                            &lt;asp:Repeater ID="rptProducts" runat="server"&gt;
                                &lt;ItemTemplate&gt;
                                    &lt;div class="col-md-6 mb-3"&gt;
                                        &lt;div class="card h-100"&gt;
                                            &lt;div class="card-body"&gt;
                                                &lt;h5 class="card-title"&gt;&lt;%# Eval("Name") %&gt;&lt;/h5&gt;
                                                &lt;p class="card-text"&gt;&lt;%# Eval("Description") %&gt;&lt;/p&gt;
                                                &lt;p class="card-text"&gt;&lt;strong&gt;ä¾¡æ ¼: Â¥&lt;%# Eval("Price", "{0:N0}") %&gt;&lt;/strong&gt;&lt;/p&gt;
                                                &lt;p class="card-text"&gt;&lt;small class="text-muted"&gt;åœ¨åº«: &lt;%# Eval("Stock") %&gt;å€‹&lt;/small&gt;&lt;/p&gt;
                                                &lt;div class="d-flex align-items-center"&gt;
                                                    &lt;asp:TextBox ID="txtQuantity" runat="server" Text="1" CssClass="form-control me-2" style="width: 80px;" TextMode="Number" min="1"&gt;&lt;/asp:TextBox&gt;
                                                    &lt;asp:Button ID="btnAddToCart" runat="server" Text="ã‚«ãƒ¼ãƒˆã«è¿½åŠ " CssClass="btn btn-primary" 
                                                        CommandName="AddToCart" CommandArgument='&lt;%# Eval("Id") %&gt;' /&gt;
                                                &lt;/div&gt;
                                            &lt;/div&gt;
                                        &lt;/div&gt;
                                    &lt;/div&gt;
                                &lt;/ItemTemplate&gt;
                            &lt;/asp:Repeater&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;div class="col-md-4"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-info text-white"&gt;
                        &lt;h4 class="card-title mb-0"&gt;ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ã‚«ãƒ¼ãƒˆ&lt;/h4&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;asp:UpdatePanel ID="UpdatePanel1" runat="server"&gt;
                            &lt;ContentTemplate&gt;
                                &lt;asp:GridView ID="gvCart" runat="server" CssClass="table table-sm" AutoGenerateColumns="false" EmptyDataText="ã‚«ãƒ¼ãƒˆã¯ç©ºã§ã™"&gt;
                                    &lt;Columns&gt;
                                        &lt;asp:BoundField DataField="Name" HeaderText="å•†å“å" /&gt;
                                        &lt;asp:BoundField DataField="Quantity" HeaderText="æ•°é‡" /&gt;
                                        &lt;asp:BoundField DataField="Price" HeaderText="å˜ä¾¡" DataFormatString="{0:C}" /&gt;
                                        &lt;asp:BoundField DataField="Total" HeaderText="å°è¨ˆ" DataFormatString="{0:C}" /&gt;
                                        &lt;asp:TemplateField&gt;
                                            &lt;ItemTemplate&gt;
                                                &lt;asp:Button ID="btnRemove" runat="server" Text="å‰Šé™¤" CssClass="btn btn-sm btn-outline-danger"
                                                    CommandName="Remove" CommandArgument='&lt;%# Eval("Id") %&gt;' /&gt;
                                            &lt;/ItemTemplate&gt;
                                        &lt;/asp:TemplateField&gt;
                                    &lt;/Columns&gt;
                                &lt;/asp:GridView&gt;
                                
                                &lt;hr&gt;
                                &lt;div class="d-flex justify-content-between"&gt;
                                    &lt;strong&gt;åˆè¨ˆ: &lt;/strong&gt;
                                    &lt;strong&gt;&lt;asp:Label ID="lblTotal" runat="server" Text="Â¥0"&gt;&lt;/asp:Label&gt;&lt;/strong&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mt-3"&gt;
                                    &lt;asp:Button ID="btnClearCart" runat="server" Text="ã‚«ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢" CssClass="btn btn-outline-secondary w-100 mb-2" /&gt;
                                    &lt;asp:Button ID="btnCheckout" runat="server" Text="è³¼å…¥æ‰‹ç¶šãã¸" CssClass="btn btn-success w-100" /&gt;
                                &lt;/div&gt;
                            &lt;/ContentTemplate&gt;
                        &lt;/asp:UpdatePanel&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;!-- ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ± --&gt;
                &lt;div class="card mt-3"&gt;
                    &lt;div class="card-header bg-secondary text-white"&gt;
                        &lt;h6 class="card-title mb-0"&gt;ã‚»ãƒƒã‚·ãƒ§ãƒ³æƒ…å ±&lt;/h6&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;small&gt;
                            &lt;asp:Label ID="lblSessionInfo" runat="server"&gt;&lt;/asp:Label&gt;
                        &lt;/small&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º --&gt;
        &lt;div class="row mt-3"&gt;
            &lt;div class="col-12"&gt;
                &lt;asp:Label ID="lblMessage" runat="server" Text=""&gt;&lt;/asp:Label&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>ShoppingCart.aspx.vbï¼ˆã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ï¼‰</h6>
                        <pre class="code-block"><code class="language-vbnet">Public Class ShoppingCart
    Inherits System.Web.UI.Page

    ' å•†å“ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
    Public Class Product
        Public Property Id As Integer
        Public Property Name As String
        Public Property Description As String
        Public Property Price As Decimal
        Public Property Stock As Integer
    End Class

    ' ã‚«ãƒ¼ãƒˆã‚¢ã‚¤ãƒ†ãƒ ã‚¯ãƒ©ã‚¹
    Public Class CartItem
        Public Property Id As Integer
        Public Property Name As String
        Public Property Price As Decimal
        Public Property Quantity As Integer
        Public ReadOnly Property Total As Decimal
            Get
                Return Price * Quantity
            End Get
        End Property
    End Class

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadProducts()
            InitializeSession()
        End If
        
        UpdateCartDisplay()
        UpdateSessionInfo()
    End Sub

    Private Sub LoadProducts()
        ' ã‚µãƒ³ãƒ—ãƒ«å•†å“ãƒ‡ãƒ¼ã‚¿ï¼ˆå®Ÿéš›ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰å–å¾—ï¼‰
        Dim products As New List(Of Product) From {
            New Product With {.Id = 1, .Name = "VB.NETå…¥é–€æ›¸", .Description = "åˆå¿ƒè€…å‘ã‘VB.NETãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°æœ¬", .Price = 3500, .Stock = 10},
            New Product With {.Id = 2, .Name = "ASP.NETå®Œå…¨ã‚¬ã‚¤ãƒ‰", .Description = "Webé–‹ç™ºã®æ±ºå®šç‰ˆ", .Price = 4200, .Stock = 8},
            New Product With {.Id = 3, .Name = "ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆæœ¬", .Description = "å®Ÿè·µçš„ãªDBè¨­è¨ˆæ‰‹æ³•", .Price = 3800, .Stock = 15},
            New Product With {.Id = 4, .Name = "ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° ãƒã‚¦ã‚¹", .Description = "ãƒ—ãƒ­ã‚°ãƒ©ãƒãƒ¼å°‚ç”¨ãƒã‚¦ã‚¹", .Price = 2800, .Stock = 20}
        }
        
        rptProducts.DataSource = products
        rptProducts.DataBind()
        
        ' å•†å“ãƒ‡ãƒ¼ã‚¿ã‚’Cacheã«ä¿å­˜ï¼ˆå®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯æœ‰åŠ¹æœŸé™ã‚’è¨­å®šï¼‰
        Cache("Products") = products
    End Sub

    Private Sub InitializeSession()
        If Session("Cart") Is Nothing Then
            Session("Cart") = New List(Of CartItem)()
        End If
        
        If Session("SessionStartTime") Is Nothing Then
            Session("SessionStartTime") = DateTime.Now
        End If
    End Sub

    Protected Sub rptProducts_ItemCommand(source As Object, e As RepeaterCommandEventArgs) Handles rptProducts.ItemCommand
        If e.CommandName = "AddToCart" Then
            Dim productId As Integer = Integer.Parse(e.CommandArgument.ToString())
            Dim quantityTextBox As TextBox = DirectCast(e.Item.FindControl("txtQuantity"), TextBox)
            Dim quantity As Integer = Integer.Parse(quantityTextBox.Text)
            
            AddToCart(productId, quantity)
        End If
    End Sub

    Protected Sub gvCart_RowCommand(sender As Object, e As GridViewCommandEventArgs) Handles gvCart.RowCommand
        If e.CommandName = "Remove" Then
            Dim productId As Integer = Integer.Parse(e.CommandArgument.ToString())
            RemoveFromCart(productId)
        End If
    End Sub

    Protected Sub btnClearCart_Click(sender As Object, e As EventArgs) Handles btnClearCart.Click
        Session("Cart") = New List(Of CartItem)()
        UpdateCartDisplay()
        ShowMessage("ã‚«ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ", "alert alert-info")
    End Sub

    Protected Sub btnCheckout_Click(sender As Object, e As EventArgs) Handles btnCheckout.Click
        Dim cart As List(Of CartItem) = GetCartFromSession()
        
        If cart.Count = 0 Then
            ShowMessage("ã‚«ãƒ¼ãƒˆãŒç©ºã§ã™", "alert alert-warning")
            Return
        End If
        
        ' è³¼å…¥å‡¦ç†ã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
        ProcessCheckout(cart)
    End Sub

    Private Sub AddToCart(productId As Integer, quantity As Integer)
        Try
            Dim products As List(Of Product) = GetProductsFromCache()
            Dim product As Product = products.FirstOrDefault(Function(p) p.Id = productId)
            
            If product Is Nothing Then
                ShowMessage("å•†å“ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“", "alert alert-danger")
                Return
            End If
            
            If quantity > product.Stock Then
                ShowMessage($"åœ¨åº«ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚åœ¨åº«æ•°: {product.Stock}", "alert alert-warning")
                Return
            End If
            
            Dim cart As List(Of CartItem) = GetCartFromSession()
            Dim existingItem As CartItem = cart.FirstOrDefault(Function(c) c.Id = productId)
            
            If existingItem IsNot Nothing Then
                ' æ—¢å­˜ã‚¢ã‚¤ãƒ†ãƒ ã®æ•°é‡ã‚’æ›´æ–°
                If existingItem.Quantity + quantity > product.Stock Then
                    ShowMessage($"åœ¨åº«ãŒä¸è¶³ã—ã¦ã„ã¾ã™ã€‚ç¾åœ¨ã®ã‚«ãƒ¼ãƒˆæ•°é‡: {existingItem.Quantity}, åœ¨åº«æ•°: {product.Stock}", "alert alert-warning")
                    Return
                End If
                existingItem.Quantity += quantity
            Else
                ' æ–°ã—ã„ã‚¢ã‚¤ãƒ†ãƒ ã‚’è¿½åŠ 
                cart.Add(New CartItem With {
                    .Id = product.Id,
                    .Name = product.Name,
                    .Price = product.Price,
                    .Quantity = quantity
                })
            End If
            
            Session("Cart") = cart
            UpdateCartDisplay()
            ShowMessage($"{product.Name} ã‚’ {quantity} å€‹ã‚«ãƒ¼ãƒˆã«è¿½åŠ ã—ã¾ã—ãŸ", "alert alert-success")
            
        Catch ex As Exception
            ShowMessage($"ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert alert-danger")
        End Try
    End Sub

    Private Sub RemoveFromCart(productId As Integer)
        Dim cart As List(Of CartItem) = GetCartFromSession()
        Dim item As CartItem = cart.FirstOrDefault(Function(c) c.Id = productId)
        
        If item IsNot Nothing Then
            cart.Remove(item)
            Session("Cart") = cart
            UpdateCartDisplay()
            ShowMessage($"{item.Name} ã‚’ã‚«ãƒ¼ãƒˆã‹ã‚‰å‰Šé™¤ã—ã¾ã—ãŸ", "alert alert-info")
        End If
    End Sub

    Private Sub ProcessCheckout(cart As List(Of CartItem))
        Try
            Dim total As Decimal = cart.Sum(Function(c) c.Total)
            
            ' å®Ÿéš›ã®ã‚·ã‚¹ãƒ†ãƒ ã§ã¯ã€ã“ã“ã§æ±ºæ¸ˆå‡¦ç†ã€åœ¨åº«æ›´æ–°ã€æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¿å­˜ç­‰ã‚’è¡Œã†
            Dim orderSummary As New System.Text.StringBuilder()
            orderSummary.AppendLine("<h5>æ³¨æ–‡å†…å®¹ç¢ºèª</h5>")
            orderSummary.AppendLine("<ul>")
            
            For Each item As CartItem In cart
                orderSummary.AppendLine($"<li>{item.Name} Ã— {item.Quantity} = Â¥{item.Total:N0}</li>")
            Next
            
            orderSummary.AppendLine("</ul>")
            orderSummary.AppendLine($"<strong>åˆè¨ˆé‡‘é¡: Â¥{total:N0}</strong>")
            
            ' ã‚«ãƒ¼ãƒˆã‚’ã‚¯ãƒªã‚¢
            Session("Cart") = New List(Of CartItem)()
            UpdateCartDisplay()
            
            ShowMessage($"è³¼å…¥æ‰‹ç¶šããŒå®Œäº†ã—ã¾ã—ãŸï¼<br/>{orderSummary.ToString()}", "alert alert-success")
            
        Catch ex As Exception
            ShowMessage($"è³¼å…¥å‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert alert-danger")
        End Try
    End Sub

    Private Function GetCartFromSession() As List(Of CartItem)
        If Session("Cart") Is Nothing Then
            Session("Cart") = New List(Of CartItem)()
        End If
        Return DirectCast(Session("Cart"), List(Of CartItem))
    End Function

    Private Function GetProductsFromCache() As List(Of Product)
        Dim products As List(Of Product) = TryCast(Cache("Products"), List(Of Product))
        If products Is Nothing Then
            ' Cacheã«ãªã„å ´åˆã¯å†èª­è¾¼
            LoadProducts()
            products = DirectCast(Cache("Products"), List(Of Product))
        End If
        Return products
    End Function

    Private Sub UpdateCartDisplay()
        Dim cart As List(Of CartItem) = GetCartFromSession()
        
        gvCart.DataSource = cart
        gvCart.DataBind()
        
        Dim total As Decimal = cart.Sum(Function(c) c.Total)
        lblTotal.Text = $"Â¥{total:N0}"
    End Sub

    Private Sub UpdateSessionInfo()
        Dim info As New System.Text.StringBuilder()
        info.AppendLine($"ã‚»ãƒƒã‚·ãƒ§ãƒ³ID: {Session.SessionID}<br/>")
        info.AppendLine($"é–‹å§‹æ™‚åˆ»: {Session("SessionStartTime"):HH:mm:ss}<br/>")
        info.AppendLine($"ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ: {Session.Timeout}åˆ†<br/>")
        
        Dim cart As List(Of CartItem) = GetCartFromSession()
        info.AppendLine($"ã‚«ãƒ¼ãƒˆå•†å“æ•°: {cart.Sum(Function(c) c.Quantity)}å€‹")
        
        lblSessionInfo.Text = info.ToString()
    End Sub

    Private Sub ShowMessage(message As String, cssClass As String)
        lblMessage.Text = message
        lblMessage.CssClass = cssClass
    End Sub
End Class</code></pre>
                    </div>

                    <h3 class="section-title">5.6 çŠ¶æ…‹ç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h3>
                    <p>åŠ¹æœçš„ãªçŠ¶æ…‹ç®¡ç†ã®ãŸã‚ã®æŒ‡é‡ã‚’å­¦ç¿’ã—ã¾ã—ã‚‡ã†ã€‚</p>

                    <div class="warning">
                        <h6>âš ï¸ çŠ¶æ…‹ç®¡ç†ã®æ³¨æ„ç‚¹</h6>
                        <ul>
                            <li><strong>ViewState</strong>: å¤§é‡ã®ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ã™ã‚‹ã¨ãƒšãƒ¼ã‚¸ã‚µã‚¤ã‚ºãŒå¢—å¤§</li>
                            <li><strong>Session</strong>: ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã«æ³¨æ„ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã®è¨­å®š</li>
                            <li><strong>Application</strong>: åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ï¼ˆLock/UnLockï¼‰ãŒå¿…è¦</li>
                            <li><strong>Cache</strong>: ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã‚’è€ƒæ…®ã—ãŸé©åˆ‡ãªæœŸé™è¨­å®š</li>
                        </ul>
                    </div>

                    <h4>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–</h4>
                    <pre class="code-block"><code class="language-vbnet">' ViewStateã®ç„¡åŠ¹åŒ–ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
&lt;asp:Label ID="lblStaticText" runat="server" EnableViewState="false" /&gt;

' Sessionã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆè¨­å®š
&lt;system.web&gt;
    &lt;sessionState timeout="20" /&gt; &lt;!-- 20åˆ†ã§ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ --&gt;
&lt;/system.web&gt;

' Cacheã®åŠ¹ç‡çš„ãªä½¿ç”¨
Private Function GetExpensiveData() As DataTable
    Dim cacheKey As String = "ExpensiveData"
    Dim data As DataTable = TryCast(Cache(cacheKey), DataTable)
    
    If data Is Nothing Then
        ' ãƒ‡ãƒ¼ã‚¿ãŒå­˜åœ¨ã—ãªã„å ´åˆã®ã¿é‡ã„å‡¦ç†ã‚’å®Ÿè¡Œ
        data = LoadDataFromDatabase()
        
        ' 30åˆ†ã§ã‚­ãƒ£ãƒƒã‚·ãƒ¥æœŸé™åˆ‡ã‚Œã€ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã§ç„¡åŠ¹åŒ–
        Dim dependency As New CacheDependency(Server.MapPath("~/App_Data/data.xml"))
        Cache.Insert(cacheKey, data, dependency, 
                    DateTime.Now.AddMinutes(30), 
                    TimeSpan.Zero)
    End If
    
    Return data
End Function</code></pre>

                    <!-- ç†è§£åº¦ç¢ºèª -->
                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>ãƒšãƒ¼ã‚¸å†…ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«çŠ¶æ…‹ã‚’PostBacké–“ã§ä¿æŒã™ã‚‹ä»•çµ„ã¿ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>ç‰¹å®šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚»ãƒƒã‚·ãƒ§ãƒ³æœŸé–“ä¸­ã«ãƒ‡ãƒ¼ã‚¿ã‚’ä¿æŒã™ã‚‹ä»•çµ„ã¿ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼é–“ã§å…±æœ‰ã•ã‚Œã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ ãƒ¬ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿ç®¡ç†ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>æœŸé™ã‚„ä¾å­˜é–¢ä¿‚ã‚’è¨­å®šã§ãã‚‹é«˜ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãªãƒ‡ãƒ¼ã‚¿ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>Sessionã®ãƒ‡ãƒ¼ã‚¿ã‚’ã™ã¹ã¦ã‚¯ãƒªã‚¢ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>Applicationã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«åŒæ™‚ã‚¢ã‚¯ã‚»ã‚¹ã‚’åˆ¶å¾¡ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã®ãƒšã‚¢ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>VB.NETã®ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ•°ã«ç›¸å½“ã™ã‚‹Web FormsçŠ¶æ…‹ç®¡ç†ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>Cacheã§ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›´ã‚’ç›£è¦–ã™ã‚‹ä¾å­˜é–¢ä¿‚ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>ViewState</li>
                                <li>Session</li>
                                <li>Application</li>
                                <li>Cache</li>
                                <li>Session.Clear() ã¾ãŸã¯ Session.Abandon()</li>
                                <li>Application.Lock() ã¨ Application.UnLock()</li>
                                <li>ViewState</li>
                                <li>CacheDependency</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-4.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="aspnet-vb-learning-material-6.html" class="btn btn-primary">æ¬¡ã®ç«  â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- Highlight.js åˆæœŸåŒ– -->
    <script>hljs.highlightAll();</script>
</body>
</html>