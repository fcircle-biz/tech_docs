<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET VB.NETå­¦ç¿’æ•™æ ç¬¬10ç«  - å®Ÿè·µçš„ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .navbar {
            background-color: #0078d4;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #0078d4;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #2196F3;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0078d4;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .architecture-note {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }

        .performance-tip {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ff9800;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #0078d4 !important;
            color: white !important;
        }

        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
        }

        .architecture-diagram {
            text-align: center;
            margin: 2rem 0;
            padding: 1rem;
            background-color: #f8f9fa;
            border-radius: 8px;
        }

        .feature-table {
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../README.md">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../README.md">ASP.NET VB.NETå­¦ç¿’ã‚¬ã‚¤ãƒ‰</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">ç¬¬1ç« : Web Formså…¥é–€</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">ç¬¬2ç« : Webã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">ç¬¬3ç« : ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">ç¬¬4ç« : ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">ç¬¬5ç« : çŠ¶æ…‹ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">ç¬¬6ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">ç¬¬7ç« : ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-8.html">ç¬¬8ç« : ãƒã‚¹ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-9.html">ç¬¬9ç« : ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter10">ç¬¬10ç« : å®Ÿè·µé–‹ç™º</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬10ç« : å®Ÿè·µçš„ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</h1>
                </div>

                <div id="chapter10">
                    <h2 class="chapter-title">çµ±åˆãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼šç¤¾å“¡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>ã“ã‚Œã¾ã§å­¦ç¿’ã—ãŸå…¨æŠ€è¡“ã‚’çµ±åˆã—ãŸå®Ÿè·µçš„ãªWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</li>
                            <li>3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹ä¿å®ˆæ€§ã®é«˜ã„ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆ</li>
                            <li>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æŠ€è¡“ã®å®Ÿè£…</li>
                            <li>å˜ä½“ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°æˆ¦ç•¥</li>
                            <li>æœ¬ç•ªç’°å¢ƒã¸ã®é…ç½®ï¼ˆãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆï¼‰</li>
                            <li>é‹ç”¨ä¿å®ˆã¨ãƒ­ã‚°ç®¡ç†</li>
                            <li>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã¨å“è³ªä¿è¨¼</li>
                        </ul>
                    </div>

                    <div class="architecture-note">
                        <h6>ğŸ—ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦ï¼šç¤¾å“¡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </h6>
                        <p>ã“ã®ç« ã§ã¯ã€ä¼æ¥­ã§ä½¿ç”¨ã•ã‚Œã‚‹ç¤¾å“¡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚èªè¨¼ãƒ»èªå¯ã€CRUDæ“ä½œã€ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ã€ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ãªã©ã€å®Ÿéš›ã®ãƒ“ã‚¸ãƒã‚¹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«å¿…è¦ãªæ©Ÿèƒ½ã‚’åŒ…æ‹¬çš„ã«å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <strong>ä¸»è¦æ©Ÿèƒ½ï¼š</strong>
                        <ul>
                            <li>ç¤¾å“¡æƒ…å ±ç®¡ç†ï¼ˆç™»éŒ²ã€æ›´æ–°ã€å‰Šé™¤ã€æ¤œç´¢ï¼‰</li>
                            <li>éƒ¨ç½²ãƒ»å½¹è·ç®¡ç†</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ãƒ»ãƒ­ãƒ¼ãƒ«ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</li>
                            <li>ãƒ¬ãƒãƒ¼ãƒˆæ©Ÿèƒ½ï¼ˆExcelå‡ºåŠ›ï¼‰</li>
                            <li>ç›£æŸ»ãƒ­ã‚°æ©Ÿèƒ½</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.1 ã‚·ã‚¹ãƒ†ãƒ è¨­è¨ˆã¨3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£</h3>
                    <p>ä¿å®ˆæ€§ã¨æ‹¡å¼µæ€§ã‚’è€ƒæ…®ã—ãŸ3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã§ã‚·ã‚¹ãƒ†ãƒ ã‚’è¨­è¨ˆã—ã¾ã™ã€‚</p>

                    <div class="architecture-diagram">
                        <h5>3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£æ§‹æˆ</h5>
                        <div class="row text-center">
                            <div class="col-md-4">
                                <div class="p-3 border rounded bg-primary text-white">
                                    <h6>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤</h6>
                                    <small>Web Forms, Master Pages<br>User Interface</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3 border rounded bg-success text-white">
                                    <h6>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤</h6>
                                    <small>Business Logic<br>Validation, Rules</small>
                                </div>
                            </div>
                            <div class="col-md-4">
                                <div class="p-3 border rounded bg-info text-white">
                                    <h6>ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤</h6>
                                    <small>ADO.NET<br>Database Operations</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-1: ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã®ä½œæˆ</h5>
                        <p>3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«åŸºã¥ããƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ ã‚’ä½œæˆã—ã€å„å±¤ã®åŸºæœ¬ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹é€ </h6>
                        <pre><code>EmployeeManagementSystem/
â”œâ”€â”€ App_Code/
â”‚   â”œâ”€â”€ DataAccessLayer/
â”‚   â”‚   â”œâ”€â”€ DatabaseHelper.vb
â”‚   â”‚   â”œâ”€â”€ EmployeeDAL.vb
â”‚   â”‚   â””â”€â”€ DepartmentDAL.vb
â”‚   â”œâ”€â”€ BusinessLogicLayer/
â”‚   â”‚   â”œâ”€â”€ EmployeeBLL.vb
â”‚   â”‚   â”œâ”€â”€ DepartmentBLL.vb
â”‚   â”‚   â””â”€â”€ ValidationHelper.vb
â”‚   â””â”€â”€ Common/
â”‚       â”œâ”€â”€ Employee.vb
â”‚       â””â”€â”€ Department.vb
â”œâ”€â”€ Pages/
â”‚   â”œâ”€â”€ Employee/
â”‚   â”œâ”€â”€ Department/
â”‚   â””â”€â”€ Reports/
â”œâ”€â”€ Master/
â”‚   â””â”€â”€ Site.master
â””â”€â”€ Web.config</code></pre>
                        
                        <h6>ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¯ãƒ©ã‚¹ï¼ˆEmployee.vbï¼‰</h6>
                        <pre><code>Public Class Employee
    Public Property EmployeeID As Integer
    Public Property FirstName As String
    Public Property LastName As String
    Public Property Email As String
    Public Property DepartmentID As Integer
    Public Property HireDate As DateTime
    Public Property Salary As Decimal
    Public Property IsActive As Boolean
    Public Property CreatedDate As DateTime
    Public Property ModifiedDate As DateTime
    
    ' ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    Public Sub New()
        Me.IsActive = True
        Me.CreatedDate = DateTime.Now
        Me.ModifiedDate = DateTime.Now
    End Sub
    
    ' ãƒ•ãƒ«ãƒãƒ¼ãƒ ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£
    Public ReadOnly Property FullName As String
        Get
            Return String.Format("{0} {1}", FirstName, LastName)
        End Get
    End Property
    
    ' å…¥åŠ›æ¤œè¨¼ãƒ¡ã‚½ãƒƒãƒ‰
    Public Function IsValid() As List(Of String)
        Dim errors As New List(Of String)
        
        If String.IsNullOrWhiteSpace(FirstName) Then
            errors.Add("åå‰ã¯å¿…é ˆå…¥åŠ›ã§ã™ã€‚")
        End If
        
        If String.IsNullOrWhiteSpace(LastName) Then
            errors.Add("è‹—å­—ã¯å¿…é ˆå…¥åŠ›ã§ã™ã€‚")
        End If
        
        If String.IsNullOrWhiteSpace(Email) Then
            errors.Add("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯å¿…é ˆå…¥åŠ›ã§ã™ã€‚")
        ElseIf Not Email.Contains("@") Then
            errors.Add("æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
        End If
        
        If Salary < 0 Then
            errors.Add("çµ¦ä¸ã¯0ä»¥ä¸Šã§å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
        End If
        
        Return errors
    End Function
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.2 ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®å®Ÿè£…</h3>
                    <p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚’åŠ¹ç‡çš„ã‹ã¤å®‰å…¨ã«è¡Œã†ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-2: ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®æ§‹ç¯‰</h5>
                        <p>ADO.NETã‚’ä½¿ç”¨ã—ãŸCRUDæ“ä½œã¨ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>DatabaseHelper.vbï¼ˆå…±é€šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ˜ãƒ«ãƒ‘ãƒ¼ï¼‰</h6>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Configuration

Public Class DatabaseHelper
    Private Shared ReadOnly ConnectionString As String = 
        ConfigurationManager.ConnectionStrings("EmployeeDB").ConnectionString
    
    ' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šå–å¾—
    Public Shared Function GetConnection() As SqlConnection
        Return New SqlConnection(ConnectionString)
    End Function
    
    ' ã‚¹ã‚«ãƒ©ãƒ¼å€¤å–å¾—
    Public Shared Function ExecuteScalar(query As String, parameters As SqlParameter()) As Object
        Using connection As SqlConnection = GetConnection()
            Using command As New SqlCommand(query, connection)
                If parameters IsNot Nothing Then
                    command.Parameters.AddRange(parameters)
                End If
                
                connection.Open()
                Return command.ExecuteScalar()
            End Using
        End Using
    End Function
    
    ' éã‚¯ã‚¨ãƒªå®Ÿè¡Œ
    Public Shared Function ExecuteNonQuery(query As String, parameters As SqlParameter()) As Integer
        Using connection As SqlConnection = GetConnection()
            Using command As New SqlCommand(query, connection)
                If parameters IsNot Nothing Then
                    command.Parameters.AddRange(parameters)
                End If
                
                connection.Open()
                Return command.ExecuteNonQuery()
            End Using
        End Using
    End Function
    
    ' DataReaderå–å¾—
    Public Shared Function ExecuteReader(query As String, parameters As SqlParameter()) As SqlDataReader
        Dim connection As SqlConnection = GetConnection()
        Dim command As New SqlCommand(query, connection)
        
        If parameters IsNot Nothing Then
            command.Parameters.AddRange(parameters)
        End If
        
        connection.Open()
        Return command.ExecuteReader(CommandBehavior.CloseConnection)
    End Function
End Class</code></pre>

                        <h6>EmployeeDAL.vbï¼ˆç¤¾å“¡ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ï¼‰</h6>
                        <pre><code>Imports System.Data.SqlClient

Public Class EmployeeDAL
    ' ç¤¾å“¡è¿½åŠ 
    Public Shared Function InsertEmployee(emp As Employee) As Boolean
        Try
            Dim query As String = "INSERT INTO Employees (FirstName, LastName, Email, DepartmentID, HireDate, Salary, IsActive, CreatedDate) " &
                                 "VALUES (@FirstName, @LastName, @Email, @DepartmentID, @HireDate, @Salary, @IsActive, @CreatedDate)"
            
            Dim parameters() As SqlParameter = {
                New SqlParameter("@FirstName", emp.FirstName),
                New SqlParameter("@LastName", emp.LastName),
                New SqlParameter("@Email", emp.Email),
                New SqlParameter("@DepartmentID", emp.DepartmentID),
                New SqlParameter("@HireDate", emp.HireDate),
                New SqlParameter("@Salary", emp.Salary),
                New SqlParameter("@IsActive", emp.IsActive),
                New SqlParameter("@CreatedDate", emp.CreatedDate)
            }
            
            Return DatabaseHelper.ExecuteNonQuery(query, parameters) > 0
        Catch ex As Exception
            Throw New Exception("ç¤¾å“¡ã®è¿½åŠ ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message)
        End Try
    End Function
    
    ' ç¤¾å“¡ä¸€è¦§å–å¾—
    Public Shared Function GetAllEmployees() As List(Of Employee)
        Dim employees As New List(Of Employee)
        
        Try
            Dim query As String = "SELECT e.*, d.DepartmentName FROM Employees e " &
                                 "LEFT JOIN Departments d ON e.DepartmentID = d.DepartmentID " &
                                 "WHERE e.IsActive = 1 ORDER BY e.LastName, e.FirstName"
            
            Using reader As SqlDataReader = DatabaseHelper.ExecuteReader(query, Nothing)
                While reader.Read()
                    Dim emp As New Employee With {
                        .EmployeeID = Convert.ToInt32(reader("EmployeeID")),
                        .FirstName = reader("FirstName").ToString(),
                        .LastName = reader("LastName").ToString(),
                        .Email = reader("Email").ToString(),
                        .DepartmentID = Convert.ToInt32(reader("DepartmentID")),
                        .HireDate = Convert.ToDateTime(reader("HireDate")),
                        .Salary = Convert.ToDecimal(reader("Salary")),
                        .IsActive = Convert.ToBoolean(reader("IsActive")),
                        .CreatedDate = Convert.ToDateTime(reader("CreatedDate"))
                    }
                    employees.Add(emp)
                End While
            End Using
        Catch ex As Exception
            Throw New Exception("ç¤¾å“¡ä¸€è¦§ã®å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message)
        End Try
        
        Return employees
    End Function
    
    ' ç¤¾å“¡æ¤œç´¢
    Public Shared Function SearchEmployees(searchTerm As String) As List(Of Employee)
        Dim employees As New List(Of Employee)
        
        Try
            Dim query As String = "SELECT * FROM Employees " &
                                 "WHERE (FirstName LIKE @search OR LastName LIKE @search OR Email LIKE @search) " &
                                 "AND IsActive = 1"
            
            Dim parameters() As SqlParameter = {
                New SqlParameter("@search", "%" & searchTerm & "%")
            }
            
            Using reader As SqlDataReader = DatabaseHelper.ExecuteReader(query, parameters)
                While reader.Read()
                    ' Employee ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆãƒ­ã‚¸ãƒƒã‚¯
                End While
            End Using
        Catch ex As Exception
            Throw New Exception("ç¤¾å“¡æ¤œç´¢ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message)
        End Try
        
        Return employees
    End Function
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.3 ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã®å®Ÿè£…</h3>
                    <p>ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’æ‹…å½“ã™ã‚‹ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-3: ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã®æ§‹ç¯‰</h5>
                        <p>ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã€ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã€ãƒ­ã‚°æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>EmployeeBLL.vbï¼ˆç¤¾å“¡ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ï¼‰</h6>
                        <pre><code>Public Class EmployeeBLL
    ' ç¤¾å“¡è¿½åŠ ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯è¾¼ã¿ï¼‰
    Public Shared Function AddEmployee(emp As Employee) As Result
        Dim result As New Result()
        
        Try
            ' å…¥åŠ›æ¤œè¨¼
            Dim validationErrors = emp.IsValid()
            If validationErrors.Count > 0 Then
                result.IsSuccess = False
                result.Message = String.Join(", ", validationErrors)
                Return result
            End If
            
            ' é‡è¤‡ãƒã‚§ãƒƒã‚¯
            If IsEmailExists(emp.Email) Then
                result.IsSuccess = False
                result.Message = "ã“ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯æ—¢ã«ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã™ã€‚"
                Return result
            End If
            
            ' ãƒ‡ãƒ¼ã‚¿ä¿å­˜
            Dim success = EmployeeDAL.InsertEmployee(emp)
            
            If success Then
                result.IsSuccess = True
                result.Message = "ç¤¾å“¡ãŒæ­£å¸¸ã«è¿½åŠ ã•ã‚Œã¾ã—ãŸã€‚"
                
                ' ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²
                AuditHelper.LogAction("ç¤¾å“¡è¿½åŠ ", emp.FullName, DateTime.Now)
            Else
                result.IsSuccess = False
                result.Message = "ç¤¾å“¡ã®è¿½åŠ ã«å¤±æ•—ã—ã¾ã—ãŸã€‚"
            End If
            
        Catch ex As Exception
            result.IsSuccess = False
            result.Message = "ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message
            
            ' ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²
            ErrorHelper.LogError(ex, "EmployeeBLL.AddEmployee")
        End Try
        
        Return result
    End Function
    
    ' ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹é‡è¤‡ãƒã‚§ãƒƒã‚¯
    Private Shared Function IsEmailExists(email As String) As Boolean
        Try
            Dim query As String = "SELECT COUNT(*) FROM Employees WHERE Email = @email AND IsActive = 1"
            Dim parameters() As SqlParameter = {New SqlParameter("@email", email)}
            
            Dim count = Convert.ToInt32(DatabaseHelper.ExecuteScalar(query, parameters))
            Return count > 0
        Catch ex As Exception
            Throw New Exception("ãƒ¡ãƒ¼ãƒ«é‡è¤‡ãƒã‚§ãƒƒã‚¯ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message)
        End Try
    End Function
    
    ' ç¤¾å“¡æ¤œç´¢ï¼ˆãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯è¾¼ã¿ï¼‰
    Public Shared Function SearchEmployees(searchTerm As String, departmentID As Integer?) As List(Of Employee)
        Try
            ' æ¤œç´¢æ¡ä»¶ã®æ¤œè¨¼
            If String.IsNullOrWhiteSpace(searchTerm) AndAlso Not departmentID.HasValue Then
                Return New List(Of Employee)()
            End If
            
            ' æ¤œç´¢å®Ÿè¡Œ
            Return EmployeeDAL.SearchEmployees(searchTerm)
        Catch ex As Exception
            ErrorHelper.LogError(ex, "EmployeeBLL.SearchEmployees")
            Throw
        End Try
    End Function
End Class

' çµæœã‚¯ãƒ©ã‚¹
Public Class Result
    Public Property IsSuccess As Boolean
    Public Property Message As String
    Public Property Data As Object
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.4 ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h3>
                    <p>ãƒ¦ãƒ¼ã‚¶ãƒ“ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã—ãŸWebãƒ•ã‚©ãƒ¼ãƒ ã¨ãƒã‚¹ã‚¿ãƒ¼ãƒšãƒ¼ã‚¸ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-4: ç¤¾å“¡ç®¡ç†ç”»é¢ã®å®Ÿè£…</h5>
                        <p>GridViewã‚’ä½¿ç”¨ã—ãŸç¤¾å“¡ä¸€è¦§ã¨CRUDæ“ä½œç”»é¢ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>EmployeeList.aspxï¼ˆç¤¾å“¡ä¸€è¦§ç”»é¢ï¼‰</h6>
                        <pre><code>&lt;%@ Page Title="ç¤¾å“¡ä¸€è¦§" Language="VB" MasterPageFile="~/Master/Site.Master" AutoEventWireup="false" CodeBehind="EmployeeList.aspx.vb" Inherits="EmployeeList" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-12"&gt;
            &lt;h2&gt;ç¤¾å“¡ä¸€è¦§ç®¡ç†&lt;/h2&gt;
            
            &lt;!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  --&gt;
            &lt;div class="card mb-3"&gt;
                &lt;div class="card-body"&gt;
                    &lt;div class="row"&gt;
                        &lt;div class="col-md-4"&gt;
                            &lt;asp:TextBox ID="txtSearch" runat="server" CssClass="form-control" placeholder="åå‰ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã§æ¤œç´¢"&gt;&lt;/asp:TextBox&gt;
                        &lt;/div&gt;
                        &lt;div class="col-md-3"&gt;
                            &lt;asp:DropDownList ID="ddlDepartment" runat="server" CssClass="form-select"&gt;
                                &lt;asp:ListItem Text="å…¨éƒ¨ç½²" Value=""&gt;&lt;/asp:ListItem&gt;
                            &lt;/asp:DropDownList&gt;
                        &lt;/div&gt;
                        &lt;div class="col-md-3"&gt;
                            &lt;asp:Button ID="btnSearch" runat="server" Text="æ¤œç´¢" CssClass="btn btn-primary" OnClick="btnSearch_Click" /&gt;
                            &lt;asp:Button ID="btnClear" runat="server" Text="ã‚¯ãƒªã‚¢" CssClass="btn btn-secondary" OnClick="btnClear_Click" /&gt;
                        &lt;/div&gt;
                        &lt;div class="col-md-2"&gt;
                            &lt;asp:Button ID="btnAddNew" runat="server" Text="æ–°è¦è¿½åŠ " CssClass="btn btn-success" OnClick="btnAddNew_Click" /&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;!-- ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º --&gt;
            &lt;asp:Panel ID="pnlMessage" runat="server" Visible="false"&gt;
                &lt;div class="alert alert-info"&gt;
                    &lt;asp:Label ID="lblMessage" runat="server"&gt;&lt;/asp:Label&gt;
                &lt;/div&gt;
            &lt;/asp:Panel&gt;
            
            &lt;!-- ç¤¾å“¡ä¸€è¦§GridView --&gt;
            &lt;asp:GridView ID="gvEmployees" runat="server" CssClass="table table-striped table-hover" 
                          AutoGenerateColumns="false" DataKeyNames="EmployeeID" 
                          OnRowCommand="gvEmployees_RowCommand" AllowPaging="true" PageSize="10"
                          OnPageIndexChanging="gvEmployees_PageIndexChanging"&gt;
                &lt;Columns&gt;
                    &lt;asp:BoundField DataField="EmployeeID" HeaderText="ID" ReadOnly="true" /&gt;
                    &lt;asp:BoundField DataField="FullName" HeaderText="æ°å" ReadOnly="true" /&gt;
                    &lt;asp:BoundField DataField="Email" HeaderText="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" ReadOnly="true" /&gt;
                    &lt;asp:BoundField DataField="DepartmentName" HeaderText="éƒ¨ç½²" ReadOnly="true" /&gt;
                    &lt;asp:BoundField DataField="HireDate" HeaderText="å…¥ç¤¾æ—¥" DataFormatString="{0:yyyy/MM/dd}" ReadOnly="true" /&gt;
                    &lt;asp:BoundField DataField="Salary" HeaderText="çµ¦ä¸" DataFormatString="{0:C}" ReadOnly="true" /&gt;
                    &lt;asp:TemplateField HeaderText="æ“ä½œ"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;asp:LinkButton ID="btnEdit" runat="server" CommandName="EditEmployee" 
                                          CommandArgument='&lt;%# Eval("EmployeeID") %&gt;' 
                                          CssClass="btn btn-sm btn-primary"&gt;ç·¨é›†&lt;/asp:LinkButton&gt;
                            &lt;asp:LinkButton ID="btnDelete" runat="server" CommandName="DeleteEmployee" 
                                          CommandArgument='&lt;%# Eval("EmployeeID") %&gt;' 
                                          CssClass="btn btn-sm btn-danger"
                                          OnClientClick="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ');"&gt;å‰Šé™¤&lt;/asp:LinkButton&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                &lt;/Columns&gt;
                &lt;EmptyDataTemplate&gt;
                    &lt;div class="text-center p-4"&gt;
                        &lt;p&gt;è©²å½“ã™ã‚‹ç¤¾å“¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚&lt;/p&gt;
                    &lt;/div&gt;
                &lt;/EmptyDataTemplate&gt;
            &lt;/asp:GridView&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>EmployeeList.aspx.vbï¼ˆã‚³ãƒ¼ãƒ‰ãƒ“ãƒã‚¤ãƒ³ãƒ‰ï¼‰</h6>
                        <pre><code>Public Partial Class EmployeeList
    Inherits System.Web.UI.Page
    
    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadDepartments()
            BindEmployeeGrid()
        End If
    End Sub
    
    Private Sub LoadDepartments()
        Try
            Dim departments = DepartmentBLL.GetAllDepartments()
            ddlDepartment.DataSource = departments
            ddlDepartment.DataTextField = "DepartmentName"
            ddlDepartment.DataValueField = "DepartmentID"
            ddlDepartment.DataBind()
            ddlDepartment.Items.Insert(0, New ListItem("å…¨éƒ¨ç½²", ""))
        Catch ex As Exception
            ShowMessage("éƒ¨ç½²ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: " & ex.Message, "danger")
        End Try
    End Sub
    
    Private Sub BindEmployeeGrid()
        Try
            Dim employees As List(Of Employee)
            
            If Not String.IsNullOrWhiteSpace(txtSearch.Text) Then
                employees = EmployeeBLL.SearchEmployees(txtSearch.Text.Trim(), Nothing)
            Else
                employees = EmployeeBLL.GetAllEmployees()
            End If
            
            gvEmployees.DataSource = employees
            gvEmployees.DataBind()
            
            If employees.Count = 0 Then
                ShowMessage("æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ç¤¾å“¡ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚", "info")
            End If
        Catch ex As Exception
            ShowMessage("ç¤¾å“¡ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: " & ex.Message, "danger")
        End Try
    End Sub
    
    Protected Sub btnSearch_Click(sender As Object, e As EventArgs) Handles btnSearch.Click
        BindEmployeeGrid()
    End Sub
    
    Protected Sub gvEmployees_RowCommand(sender As Object, e As GridViewCommandEventArgs) Handles gvEmployees.RowCommand
        Dim employeeID As Integer = Convert.ToInt32(e.CommandArgument)
        
        Select Case e.CommandName
            Case "EditEmployee"
                Response.Redirect(String.Format("EmployeeEdit.aspx?id={0}", employeeID))
            Case "DeleteEmployee"
                DeleteEmployee(employeeID)
        End Select
    End Sub
    
    Private Sub DeleteEmployee(employeeID As Integer)
        Try
            Dim result = EmployeeBLL.DeleteEmployee(employeeID)
            
            If result.IsSuccess Then
                ShowMessage(result.Message, "success")
                BindEmployeeGrid()
            Else
                ShowMessage(result.Message, "danger")
            End If
        Catch ex As Exception
            ShowMessage("ç¤¾å“¡ã®å‰Šé™¤ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message, "danger")
        End Try
    End Sub
    
    Private Sub ShowMessage(message As String, alertType As String)
        lblMessage.Text = message
        pnlMessage.CssClass = String.Format("alert alert-{0}", alertType)
        pnlMessage.Visible = True
    End Sub
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.5 ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–</h3>
                    <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã®ãŸã‚ã®æœ€é©åŒ–æŠ€è¡“ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="performance-tip">
                        <h6>âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–ã®ãƒã‚¤ãƒ³ãƒˆ</h6>
                        <ul>
                            <li><strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹æœ€é©åŒ–</strong>: æ¥ç¶šãƒ—ãƒ¼ãƒªãƒ³ã‚°ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹æ´»ç”¨</li>
                            <li><strong>ViewStateã®æœ€é©åŒ–</strong>: ä¸è¦ãªViewStateã®ç„¡åŠ¹åŒ–</li>
                            <li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨</strong>: ãƒ‡ãƒ¼ã‚¿ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã€å‡ºåŠ›ã‚­ãƒ£ãƒƒã‚·ãƒ¥</li>
                            <li><strong>ãƒšãƒ¼ã‚¸ãƒ³ã‚°å®Ÿè£…</strong>: å¤§é‡ãƒ‡ãƒ¼ã‚¿ã®åŠ¹ç‡çš„ãªè¡¨ç¤º</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-5: ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°æœ€é©åŒ–</h5>
                        <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç®¡ç†ã‚¯ãƒ©ã‚¹ï¼ˆCacheHelper.vbï¼‰</h6>
                        <pre><code>Public Class CacheHelper
    Private Const DEPARTMENT_CACHE_KEY As String = "DepartmentList"
    Private Const CACHE_DURATION_MINUTES As Integer = 30
    
    ' éƒ¨ç½²ãƒªã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥å–å¾—
    Public Shared Function GetDepartments() As List(Of Department)
        Dim departments As List(Of Department) = CType(HttpContext.Current.Cache(DEPARTMENT_CACHE_KEY), List(Of Department))
        
        If departments Is Nothing Then
            departments = DepartmentDAL.GetAllDepartments()
            SetDepartmentCache(departments)
        End If
        
        Return departments
    End Function
    
    ' éƒ¨ç½²ãƒªã‚¹ãƒˆã‚­ãƒ£ãƒƒã‚·ãƒ¥è¨­å®š
    Private Shared Sub SetDepartmentCache(departments As List(Of Department))
        HttpContext.Current.Cache.Insert(
            DEPARTMENT_CACHE_KEY,
            departments,
            Nothing,
            DateTime.Now.AddMinutes(CACHE_DURATION_MINUTES),
            TimeSpan.Zero
        )
    End Sub
    
    ' éƒ¨ç½²ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
    Public Shared Sub ClearDepartmentCache()
        HttpContext.Current.Cache.Remove(DEPARTMENT_CACHE_KEY)
    End Sub
End Class</code></pre>

                        <h6>ãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ããƒ‡ãƒ¼ã‚¿å–å¾—</h6>
                        <pre><code>Public Shared Function GetEmployeesPaged(pageIndex As Integer, pageSize As Integer, searchTerm As String) As PagedResult(Of Employee)
    Dim result As New PagedResult(Of Employee)
    
    Try
        ' ç·ä»¶æ•°å–å¾—
        Dim countQuery As String = "SELECT COUNT(*) FROM Employees WHERE IsActive = 1"
        Dim parameters As New List(Of SqlParameter)
        
        If Not String.IsNullOrWhiteSpace(searchTerm) Then
            countQuery &= " AND (FirstName LIKE @search OR LastName LIKE @search)"
            parameters.Add(New SqlParameter("@search", "%" & searchTerm & "%"))
        End If
        
        result.TotalCount = Convert.ToInt32(DatabaseHelper.ExecuteScalar(countQuery, parameters.ToArray()))
        result.PageIndex = pageIndex
        result.PageSize = pageSize
        result.TotalPages = Math.Ceiling(result.TotalCount / pageSize)
        
        ' ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿å–å¾—
        Dim dataQuery As String = "SELECT * FROM (" &
                                 "SELECT ROW_NUMBER() OVER (ORDER BY LastName, FirstName) AS RowNum, * " &
                                 "FROM Employees WHERE IsActive = 1"
        
        If Not String.IsNullOrWhiteSpace(searchTerm) Then
            dataQuery &= " AND (FirstName LIKE @search OR LastName LIKE @search)"
        End If
        
        dataQuery &= ") AS NumberedEmployees " &
                    "WHERE RowNum BETWEEN @startRow AND @endRow"
        
        Dim startRow As Integer = (pageIndex - 1) * pageSize + 1
        Dim endRow As Integer = pageIndex * pageSize
        
        parameters.Add(New SqlParameter("@startRow", startRow))
        parameters.Add(New SqlParameter("@endRow", endRow))
        
        result.Data = New List(Of Employee)()
        Using reader = DatabaseHelper.ExecuteReader(dataQuery, parameters.ToArray())
            While reader.Read()
                ' Employee ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
            End While
        End Using
        
    Catch ex As Exception
        Throw New Exception("ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿å–å¾—ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: " & ex.Message)
    End Try
    
    Return result
End Function

Public Class PagedResult(Of T)
    Public Property Data As List(Of T)
    Public Property TotalCount As Integer
    Public Property PageIndex As Integer
    Public Property PageSize As Integer
    Public Property TotalPages As Integer
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.6 ãƒ†ã‚¹ãƒˆæˆ¦ç•¥ã¨ãƒ‡ãƒãƒƒã‚°</h3>
                    <p>å“è³ªä¿è¨¼ã®ãŸã‚ã®å˜ä½“ãƒ†ã‚¹ãƒˆã¨ãƒ‡ãƒãƒƒã‚°æ‰‹æ³•ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-6: ãƒ­ã‚°æ©Ÿèƒ½ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</h5>
                        <p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ­ã‚°ã¨ã‚¨ãƒ©ãƒ¼å‡¦ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        <h6>ErrorHelper.vbï¼ˆã‚¨ãƒ©ãƒ¼ç®¡ç†ï¼‰</h6>
                        <pre><code>Imports System.IO

Public Class ErrorHelper
    Private Shared ReadOnly LOG_FILE_PATH As String = 
        HttpContext.Current.Server.MapPath("~/App_Data/Logs/")
    
    ' ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°è¨˜éŒ²
    Public Shared Sub LogError(ex As Exception, methodName As String)
        Try
            ' ãƒ­ã‚°ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
            If Not Directory.Exists(LOG_FILE_PATH) Then
                Directory.CreateDirectory(LOG_FILE_PATH)
            End If
            
            ' ãƒ­ã‚°ãƒ•ã‚¡ã‚¤ãƒ«åï¼ˆæ—¥ä»˜åˆ¥ï¼‰
            Dim logFileName As String = String.Format("Error_{0:yyyyMMdd}.log", DateTime.Now)
            Dim fullPath As String = Path.Combine(LOG_FILE_PATH, logFileName)
            
            ' ãƒ­ã‚°ã‚¨ãƒ³ãƒˆãƒªä½œæˆ
            Dim logEntry As String = String.Format(
                "[{0:yyyy-MM-dd HH:mm:ss}] ERROR in {1}: {2}" & vbCrLf & 
                "Stack Trace: {3}" & vbCrLf & 
                "----------------------------------------" & vbCrLf,
                DateTime.Now, methodName, ex.Message, ex.StackTrace
            )
            
            ' ãƒ•ã‚¡ã‚¤ãƒ«æ›¸ãè¾¼ã¿
            File.AppendAllText(fullPath, logEntry)
            
        Catch logEx As Exception
            ' ãƒ­ã‚°è¨˜éŒ²ã«å¤±æ•—ã—ãŸå ´åˆã¯ã‚¤ãƒ™ãƒ³ãƒˆãƒ­ã‚°ã«è¨˜éŒ²
            System.Diagnostics.EventLog.WriteEntry("EmployeeManagement", 
                "ãƒ­ã‚°è¨˜éŒ²ã‚¨ãƒ©ãƒ¼: " & logEx.Message, 
                System.Diagnostics.EventLogEntryType.Error)
        End Try
    End Sub
    
    ' ç›£æŸ»ãƒ­ã‚°è¨˜éŒ²
    Public Shared Sub LogAudit(action As String, userName As String, details As String)
        Try
            Dim logFileName As String = String.Format("Audit_{0:yyyyMMdd}.log", DateTime.Now)
            Dim fullPath As String = Path.Combine(LOG_FILE_PATH, logFileName)
            
            Dim logEntry As String = String.Format(
                "[{0:yyyy-MM-dd HH:mm:ss}] USER: {1} ACTION: {2} DETAILS: {3}" & vbCrLf,
                DateTime.Now, userName, action, details
            )
            
            File.AppendAllText(fullPath, logEntry)
        Catch ex As Exception
            LogError(ex, "ErrorHelper.LogAudit")
        End Try
    End Sub
End Class</code></pre>
                    </div>

                    <h3 class="section-title">10.7 ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¨é‹ç”¨</h3>
                    <p>æœ¬ç•ªç’°å¢ƒã¸ã®é…ç½®ã¨é‹ç”¨ä¿å®ˆã®ãŸã‚ã®è¨­å®šã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 10-7: æœ¬ç•ªç’°å¢ƒè¨­å®šã¨ãƒ‡ãƒ—ãƒ­ã‚¤æº–å‚™</h5>
                        <p>æœ¬ç•ªç’°å¢ƒç”¨ã®Web.configè¨­å®šã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        <h6>Web.configï¼ˆæœ¬ç•ªç’°å¢ƒç”¨ï¼‰</h6>
                        <pre><code>&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="EmployeeDB" connectionString="Server=PROD_SERVER;Database=EmployeeDB;Integrated Security=true" /&gt;
  &lt;/connectionStrings&gt;
  
  &lt;appSettings&gt;
    &lt;add key="Environment" value="Production" /&gt;
    &lt;add key="EnableLogging" value="true" /&gt;
    &lt;add key="LogLevel" value="Error" /&gt;
  &lt;/appSettings&gt;
  
  &lt;system.web&gt;
    &lt;compilation debug="false" targetFramework="4.8" /&gt;
    &lt;customErrors mode="On" defaultRedirect="~/Error.aspx" /&gt;
    
    &lt;!-- ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š --&gt;
    &lt;sessionState mode="StateServer" 
                  stateConnectionString="tcpip=SESSION_SERVER:42424" 
                  timeout="20" /&gt;
    
    &lt;!-- èªè¨¼è¨­å®š --&gt;
    &lt;authentication mode="Forms"&gt;
      &lt;forms loginUrl="~/Login.aspx" timeout="30" /&gt;
    &lt;/authentication&gt;
    
    &lt;!-- HTTPãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« --&gt;
    &lt;httpModules&gt;
      &lt;add name="PerformanceMonitor" type="EmployeeManagement.Modules.PerformanceModule" /&gt;
    &lt;/httpModules&gt;
  &lt;/system.web&gt;
  
  &lt;system.webServer&gt;
    &lt;!-- ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ˜ãƒƒãƒ€ãƒ¼ --&gt;
    &lt;httpProtocol&gt;
      &lt;customHeaders&gt;
        &lt;add name="X-Content-Type-Options" value="nosniff" /&gt;
        &lt;add name="X-Frame-Options" value="DENY" /&gt;
        &lt;add name="X-XSS-Protection" value="1; mode=block" /&gt;
      &lt;/customHeaders&gt;
    &lt;/httpProtocol&gt;
    
    &lt;!-- ã‚¨ãƒ©ãƒ¼ãƒšãƒ¼ã‚¸ --&gt;
    &lt;httpErrors errorMode="Custom"&gt;
      &lt;remove statusCode="404" /&gt;
      &lt;error statusCode="404" path="/Error/404.aspx" responseMode="ExecuteURL" /&gt;
      &lt;remove statusCode="500" /&gt;
      &lt;error statusCode="500" path="/Error/500.aspx" responseMode="ExecuteURL" /&gt;
    &lt;/httpErrors&gt;
  &lt;/system.webServer&gt;
&lt;/configuration&gt;</code></pre>
                    </div>

                    <div class="quiz-container">
                        <h5>ç·åˆç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã®å„å±¤ã®å½¹å‰²ã¨åˆ©ç‚¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã§SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã‚’é˜²ããŸã‚ã®å®Ÿè£…æ–¹æ³•ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤ã§ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã‚’è¡Œã†åˆ©ç‚¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã™ã‚‹å ´é¢ã¨æ³¨æ„ç‚¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>æœ¬ç•ªç’°å¢ƒã§ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã¨ãƒ­ã‚°ç®¡ç†ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã‚’3ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>GridViewã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°ã‚’å®Ÿè£…ã™ã‚‹éš›ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹è€ƒæ…®äº‹é …ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li><strong>ãƒ—ãƒ¬ã‚¼ãƒ³ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³å±¤</strong>ï¼šUIè¡¨ç¤ºã¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã€‚<strong>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯å±¤</strong>ï¼šæ¥­å‹™ãƒ«ãƒ¼ãƒ«ã¨ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼ã€‚<strong>ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤</strong>ï¼šãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã€‚åˆ©ç‚¹ï¼šä¿å®ˆæ€§å‘ä¸Šã€å½¹å‰²åˆ†é›¢ã€ãƒ†ã‚¹ãƒˆå®¹æ˜“æ€§ã€‚</li>
                                <li>SqlParameterã‚’ä½¿ç”¨ã—ãŸãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®å®Ÿè£…ã€‚æ–‡å­—åˆ—é€£çµã«ã‚ˆã‚‹ã‚¯ã‚¨ãƒªæ§‹ç¯‰ã‚’é¿ã‘ã‚‹ã€‚</li>
                                <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹å‰ã®æ¤œè¨¼ã«ã‚ˆã‚‹ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šã€ãƒ“ã‚¸ãƒã‚¹ãƒ«ãƒ¼ãƒ«ã®ä¸€å…ƒç®¡ç†ã€ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®çµ±ä¸€ã€‚</li>
                                <li>ä½¿ç”¨å ´é¢ï¼šé »ç¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹å‚ç…§ãƒ‡ãƒ¼ã‚¿ã€‚æ³¨æ„ç‚¹ï¼šãƒ‡ãƒ¼ã‚¿æ›´æ–°æ™‚ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã€ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç®¡ç†ã€‚</li>
                                <li>æ§‹é€ åŒ–ãƒ­ã‚°ã®å®Ÿè£…ã€ã‚¨ãƒ©ãƒ¼é€šçŸ¥ã‚·ã‚¹ãƒ†ãƒ ã€ãƒ­ã‚°ãƒ­ãƒ¼ãƒ†ãƒ¼ã‚·ãƒ§ãƒ³æ©Ÿèƒ½</li>
                                <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¬ãƒ™ãƒ«ã§ã®ãƒšãƒ¼ã‚¸ãƒ³ã‚°å®Ÿè£…ã€ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®æ´»ç”¨ã€ViewStateã®æœ€é©åŒ–</li>
                            </ol>
                        </details>
                    </div>

                    <div class="highlight">
                        <h6>ğŸ“ ãŠã‚ã§ã¨ã†ã”ã–ã„ã¾ã™ï¼</h6>
                        <p>ASP.NET VB.NET Web Formså­¦ç¿’ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’å®Œäº†ã—ã¾ã—ãŸã€‚ã“ã‚Œã§ä»¥ä¸‹ã®ã‚¹ã‚­ãƒ«ã‚’èº«ã«ã¤ã‘ã¾ã—ãŸï¼š</p>
                        <ul>
                            <li>ASP.NET Web Formsã®åŒ…æ‹¬çš„ãªé–‹ç™ºã‚¹ã‚­ãƒ«</li>
                            <li>3å±¤ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã«ã‚ˆã‚‹ã‚¨ãƒ³ã‚¿ãƒ¼ãƒ—ãƒ©ã‚¤ã‚ºã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³è¨­è¨ˆ</li>
                            <li>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’è€ƒæ…®ã—ãŸWebã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™º</li>
                            <li>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–æŠ€è¡“</li>
                            <li>å®Ÿè·µçš„ãªãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†æ‰‹æ³•</li>
                        </ul>
                        <p><strong>æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—</strong>ï¼šASP.NET MVCã€ASP.NET Coreã€Web APIé–‹ç™ºã¸ã®ç™ºå±•å­¦ç¿’ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚</p>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-9.html" class="btn btn-secondary">â† å‰ã®ç« </a>
                        <a href="../README.md" class="btn btn-success">å­¦ç¿’ã‚¬ã‚¤ãƒ‰ãƒˆãƒƒãƒ—ã¸</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>