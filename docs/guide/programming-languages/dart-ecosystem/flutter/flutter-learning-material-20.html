<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>Flutter学習教材 第20章 - 総合演習:ToDoアプリの作成</title>

    <!-- ダークモード早期適用(フラッシュ防止) -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Flutter - Cyan (Reactと同系統)
                        primary: {
                            50: '#ecfeff',
                            100: '#cffafe',
                            200: '#a5f3fc',
                            300: '#67e8f9',
                            400: '#22d3ee',
                            500: '#06b6d4',
                            600: '#0891b2',
                            700: '#0e7490',
                            800: '#155e75',
                            900: '#164e63',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-cyan-400/30 to-blue-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fas fa-mobile-alt text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">Flutter学習教材</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-code text-[9px]"></i>
                                <span>モバイルアプリ開発</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約40時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="../" class="hover:text-primary-600 transition-colors">Flutter</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第20章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                     bg-primary-100 text-primary-700">
                            第20章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 約4時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">総合演習:ToDoアプリの作成</h1>
                    <p class="text-slate-600">これまで学んだ知識を総動員して、実用的なToDoアプリを作成します。CRUD操作、状態管理、UIデザインを実践的に学びます。</p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200
                            rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>実用的なToDoアプリの設計と全体構造を理解する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>CRUD操作（作成・読取・更新・削除）を実装する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>StatefulWidgetとListViewを組み合わせた状態管理を実践する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ローカルストレージ（shared_preferences）でデータを永続化する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>Material Designを活用した美しいUIを構築する</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション1: ToDoアプリの概要 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.1 ToDoアプリの概要
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        この章では、これまでの学習を総動員して実用的な<strong>ToDoアプリ</strong>を作成します。ToDoアプリはシンプルながら、実際のアプリ開発に必要な要素（データ管理、状態管理、永続化、UI設計）がすべて含まれているため、学習教材として最適です。
                    </p>

                    <!-- アプリの機能一覧 -->
                    <div class="bg-blue-50 rounded-lg p-5 mb-4 border border-blue-200">
                        <h3 class="text-lg font-semibold text-blue-900 mb-3 flex items-center gap-2">
                            <i class="fas fa-list-check text-blue-500"></i>
                            実装する機能
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="bg-blue-100 rounded-lg p-3">
                                <h4 class="font-semibold text-blue-900 mb-1 text-sm">基本機能</h4>
                                <ul class="text-sm text-blue-800 space-y-1">
                                    <li><i class="fas fa-check text-blue-600"></i> ToDoの追加</li>
                                    <li><i class="fas fa-check text-blue-600"></i> ToDoの一覧表示</li>
                                    <li><i class="fas fa-check text-blue-600"></i> ToDoの完了/未完了切替</li>
                                    <li><i class="fas fa-check text-blue-600"></i> ToDoの削除</li>
                                </ul>
                            </div>
                            <div class="bg-blue-100 rounded-lg p-3">
                                <h4 class="font-semibold text-blue-900 mb-1 text-sm">拡張機能</h4>
                                <ul class="text-sm text-blue-800 space-y-1">
                                    <li><i class="fas fa-check text-blue-600"></i> データの永続化（ローカル保存）</li>
                                    <li><i class="fas fa-check text-blue-600"></i> フィルター機能（全て/未完了/完了）</li>
                                    <li><i class="fas fa-check text-blue-600"></i> 統計表示（完了数/未完了数）</li>
                                    <li><i class="fas fa-check text-blue-600"></i> 空状態の表示</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- アプリの画面構成図 -->
                    <div class="my-6">
                        <h3 class="text-lg font-semibold text-slate-800 mb-3">アプリの画面構成</h3>
                        <div class="mermaid bg-white p-4 rounded-lg border border-slate-200">
graph TD
    A["メイン画面"] --> B["AppBarエリア"]
    A --> C["入力エリア"]
    A --> D["フィルターボタンエリア"]
    A --> E["ToDoリストエリア"]
    A --> F["統計表示エリア"]

    B --> B1["タイトル<br/>アイコン"]
    C --> C1["TextField<br/>追加ボタン"]
    D --> D1["全て<br/>未完了<br/>完了"]
    E --> E1["ListViewBuilder<br/>チェックボックス<br/>削除ボタン"]
    F --> F1["完了数/総数<br/>プログレスバー"]
                        </div>
                    </div>
                </section>

                <!-- セクション2: プロジェクトのセットアップ -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.2 プロジェクトのセットアップ
                    </h2>

                    <!-- 実習カード -->
                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-4">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded-full flex items-center justify-center">
                                <i class="fas fa-laptop-code"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold text-purple-900 mb-2">ハンズオン: プロジェクト作成とパッケージ追加</h3>
                                <p class="text-sm text-purple-800 mb-3">新しいFlutterプロジェクトを作成し、必要なパッケージを追加します。</p>

                                <div class="code-block-wrapper">
                                    <div class="code-block-header">
                                        <span>ターミナル</span>
                                        <button class="code-copy-btn" onclick="copyCode(this)">
                                            <i class="fas fa-copy"></i>
                                        </button>
                                    </div>
                                    <pre><code class="language-bash"># プロジェクト作成
flutter create todo_app

# プロジェクトディレクトリに移動
cd todo_app

# shared_preferencesパッケージを追加
flutter pub add shared_preferences</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- pubspec.yaml確認 -->
                    <div class="bg-slate-50 rounded-lg p-4 border border-slate-200 mb-4">
                        <h3 class="text-sm font-semibold text-slate-700 mb-2 flex items-center gap-2">
                            <i class="fas fa-file-code text-slate-500"></i>
                            pubspec.yaml（依存関係の確認）
                        </h3>
                        <div class="code-block-wrapper">
                            <div class="code-block-header">
                                <span>pubspec.yaml</span>
                                <button class="code-copy-btn" onclick="copyCode(this)">
                                    <i class="fas fa-copy"></i>
                                </button>
                            </div>
                            <pre><code class="language-yaml">dependencies:
  flutter:
    sdk: flutter
  shared_preferences: ^2.2.2  # ローカルストレージ用パッケージ</code></pre>
                        </div>
                    </div>
                </section>

                <!-- セクション3: ToDoモデルの作成 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.3 ToDoモデルの作成
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        まず、ToDoデータを表現するための<strong>モデルクラス</strong>を作成します。モデルクラスは、データ構造を定義し、JSON形式への変換機能を持ちます。
                    </p>

                    <!-- ファイル構成 -->
                    <div class="bg-slate-100 rounded-lg p-4 mb-4">
                        <h3 class="text-sm font-semibold text-slate-700 mb-2">プロジェクト構成</h3>
                        <pre class="text-sm text-slate-800"><code>lib/
├── main.dart          # メイン画面
└── models/
    └── todo.dart      # ToDoモデル</code></pre>
                    </div>

                    <!-- ToDoモデルコード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>lib/models/todo.dart</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">class Todo {
  String id;          // 一意のID
  String title;       // ToDoのタイトル
  bool isCompleted;   // 完了フラグ

  // コンストラクタ
  Todo({
    required this.id,
    required this.title,
    this.isCompleted = false,  // デフォルトは未完了
  });

  // JSONからToDoオブジェクトを生成
  factory Todo.fromJson(Map<String, dynamic> json) {
    return Todo(
      id: json['id'],
      title: json['title'],
      isCompleted: json['isCompleted'],
    );
  }

  // ToDoオブジェクトをJSONに変換
  Map<String, dynamic> toJson() {
    return {
      'id': id,
      'title': title,
      'isCompleted': isCompleted,
    };
  }
}</code></pre>
                    </div>

                    <!-- 重要ポイント -->
                    <div class="bg-emerald-50 border-l-4 border-emerald-500 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-emerald-500 mt-1"></i>
                            <div>
                                <h3 class="font-semibold text-emerald-900 mb-2">重要ポイント</h3>
                                <ul class="text-sm text-emerald-800 space-y-1">
                                    <li><strong>id:</strong> 各ToDoを一意に識別するためのID（削除や更新時に使用）</li>
                                    <li><strong>fromJson/toJson:</strong> ローカルストレージへの保存・読込時にJSON形式に変換</li>
                                    <li><strong>isCompleted:</strong> チェックボックスの状態を管理</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション4: メイン画面の構築（基本UI） -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.4 メイン画面の構築（基本UI）
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        メイン画面のUIを構築します。AppBar、入力フィールド、ToDoリストの基本構造を作成します。
                    </p>

                    <!-- メイン画面コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>lib/main.dart（基本UI）</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">import 'package:flutter/material.dart';
import 'models/todo.dart';

void main() {
  runApp(const MyApp());
}

class MyApp extends StatelessWidget {
  const MyApp({Key? key}) : super(key: key);

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'ToDo App',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: const TodoListPage(),
    );
  }
}

class TodoListPage extends StatefulWidget {
  const TodoListPage({Key? key}) : super(key: key);

  @override
  State<TodoListPage> createState() => _TodoListPageState();
}

class _TodoListPageState extends State<TodoListPage> {
  final List<Todo> _todos = [];  // ToDoリスト
  final TextEditingController _controller = TextEditingController();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('My ToDo List'),
        centerTitle: true,
      ),
      body: Column(
        children: [
          // 入力エリア
          Padding(
            padding: const EdgeInsets.all(16.0),
            child: Row(
              children: [
                Expanded(
                  child: TextField(
                    controller: _controller,
                    decoration: const InputDecoration(
                      hintText: '新しいToDoを入力',
                      border: OutlineInputBorder(),
                    ),
                  ),
                ),
                const SizedBox(width: 8),
                ElevatedButton(
                  onPressed: _addTodo,
                  child: const Text('追加'),
                ),
              ],
            ),
          ),
          // ToDoリスト表示エリア
          Expanded(
            child: ListView.builder(
              itemCount: _todos.length,
              itemBuilder: (context, index) {
                final todo = _todos[index];
                return ListTile(
                  leading: Checkbox(
                    value: todo.isCompleted,
                    onChanged: (value) => _toggleTodo(index),
                  ),
                  title: Text(
                    todo.title,
                    style: TextStyle(
                      decoration: todo.isCompleted
                          ? TextDecoration.lineThrough
                          : null,
                    ),
                  ),
                  trailing: IconButton(
                    icon: const Icon(Icons.delete, color: Colors.red),
                    onPressed: () => _deleteTodo(index),
                  ),
                );
              },
            ),
          ),
        ],
      ),
    );
  }

  // ToDoを追加
  void _addTodo() {
    // 次のセクションで実装
  }

  // ToDoの完了/未完了を切替
  void _toggleTodo(int index) {
    // 次のセクションで実装
  }

  // ToDoを削除
  void _deleteTodo(int index) {
    // 次のセクションで実装
  }
}</code></pre>
                    </div>
                </section>

                <!-- セクション5: CRUD操作の実装 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.5 CRUD操作の実装
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ToDoの追加・更新・削除機能を実装します。CRUD（Create, Read, Update, Delete）は、データ操作の基本です。
                    </p>

                    <!-- CRUD操作の解説 -->
                    <div class="bg-blue-50 rounded-lg p-5 mb-4 border border-blue-200">
                        <h3 class="text-lg font-semibold text-blue-900 mb-3">CRUDとは</h3>
                        <div class="space-y-2 text-sm text-blue-800">
                            <div class="flex items-start gap-2">
                                <span class="font-semibold w-20">Create:</span>
                                <span>新しいデータを作成（ToDoの追加）</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="font-semibold w-20">Read:</span>
                                <span>データを読み取る（ToDoの一覧表示）</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="font-semibold w-20">Update:</span>
                                <span>データを更新（完了状態の変更）</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <span class="font-semibold w-20">Delete:</span>
                                <span>データを削除（ToDoの削除）</span>
                            </div>
                        </div>
                    </div>

                    <!-- CRUD操作コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>CRUD操作の実装</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">// ToDoを追加（Create）
void _addTodo() {
  if (_controller.text.isEmpty) {
    return;  // 空の場合は追加しない
  }

  setState(() {
    _todos.add(Todo(
      id: DateTime.now().toString(),  // タイムスタンプをIDとして使用
      title: _controller.text,
    ));
    _controller.clear();  // 入力フィールドをクリア
  });
}

// ToDoの完了/未完了を切替（Update）
void _toggleTodo(int index) {
  setState(() {
    _todos[index].isCompleted = !_todos[index].isCompleted;
  });
}

// ToDoを削除（Delete）
void _deleteTodo(int index) {
  setState(() {
    _todos.removeAt(index);
  });
}</code></pre>
                    </div>

                    <!-- ヒントカード -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-500 mt-1"></i>
                            <div>
                                <h3 class="font-semibold text-blue-900 mb-2">ポイント</h3>
                                <ul class="text-sm text-blue-800 space-y-1">
                                    <li><strong>setState():</strong> リスト変更時にsetStateを呼び出すことで画面が再描画される</li>
                                    <li><strong>ID生成:</strong> DateTime.now().toString()でユニークなIDを生成</li>
                                    <li><strong>_controller.clear():</strong> 追加後は入力フィールドをクリア</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション6: データの永続化 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.6 データの永続化
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <strong>shared_preferences</strong>パッケージを使って、ToDoデータをローカルストレージに保存します。これにより、アプリを閉じても再起動時にデータが復元されます。
                    </p>

                    <!-- データ永続化の流れ -->
                    <div class="my-6">
                        <h3 class="text-lg font-semibold text-slate-800 mb-3">データ永続化の流れ</h3>
                        <div class="mermaid bg-white p-4 rounded-lg border border-slate-200">
graph LR
    A["ToDoリスト<br/>（メモリ）"] -->|保存| B["JSON形式に変換"]
    B --> C["SharedPreferences<br/>に書き込み"]
    C --> D["ローカルストレージ"]

    D -->|読込| E["SharedPreferences<br/>から取得"]
    E --> F["JSON形式をパース"]
    F --> G["ToDoリスト<br/>（メモリ）"]
                        </div>
                    </div>

                    <!-- データ保存コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>データの保存と読込</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">import 'package:shared_preferences/shared_preferences.dart';
import 'dart:convert';  // JSON変換用

class _TodoListPageState extends State<TodoListPage> {
  // ... 前のコード ...

  @override
  void initState() {
    super.initState();
    _loadTodos();  // アプリ起動時にデータを読み込む
  }

  // ToDoリストをローカルストレージに保存
  Future<void> _saveTodos() async {
    final prefs = await SharedPreferences.getInstance();
    // ToDoリストをJSON文字列のリストに変換
    final todosJson = _todos.map((todo) => jsonEncode(todo.toJson())).toList();
    await prefs.setStringList('todos', todosJson);
  }

  // ローカルストレージからToDoリストを読み込み
  Future<void> _loadTodos() async {
    final prefs = await SharedPreferences.getInstance();
    final todosJson = prefs.getStringList('todos') ?? [];
    setState(() {
      _todos.clear();
      // JSON文字列をToDoオブジェクトに変換
      _todos.addAll(
        todosJson.map((json) => Todo.fromJson(jsonDecode(json))).toList(),
      );
    });
  }

  // CRUD操作後に保存を呼び出す
  void _addTodo() {
    if (_controller.text.isEmpty) return;

    setState(() {
      _todos.add(Todo(
        id: DateTime.now().toString(),
        title: _controller.text,
      ));
      _controller.clear();
    });
    _saveTodos();  // 追加後に保存
  }

  void _toggleTodo(int index) {
    setState(() {
      _todos[index].isCompleted = !_todos[index].isCompleted;
    });
    _saveTodos();  // 更新後に保存
  }

  void _deleteTodo(int index) {
    setState(() {
      _todos.removeAt(index);
    });
    _saveTodos();  // 削除後に保存
  }
}</code></pre>
                    </div>

                    <!-- 重要ポイント -->
                    <div class="bg-emerald-50 border-l-4 border-emerald-500 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-emerald-500 mt-1"></i>
                            <div>
                                <h3 class="font-semibold text-emerald-900 mb-2">重要ポイント</h3>
                                <ul class="text-sm text-emerald-800 space-y-1">
                                    <li><strong>initState():</strong> 画面表示時に自動的に呼ばれる。ここでデータを読み込む</li>
                                    <li><strong>async/await:</strong> ストレージ操作は非同期処理</li>
                                    <li><strong>jsonEncode/jsonDecode:</strong> DartオブジェクトとJSON文字列を相互変換</li>
                                    <li><strong>データ変更後に保存:</strong> 追加・更新・削除後に必ず_saveTodos()を呼ぶ</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション7: フィルター機能の追加 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.7 フィルター機能の追加
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        「全て」「未完了」「完了」の3つのフィルターを追加し、表示するToDoを切り替える機能を実装します。
                    </p>

                    <!-- フィルター機能コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>フィルター機能の実装</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">// フィルター種類の定義
enum TodoFilter { all, active, completed }

class _TodoListPageState extends State<TodoListPage> {
  final List<Todo> _todos = [];
  final TextEditingController _controller = TextEditingController();
  TodoFilter _currentFilter = TodoFilter.all;  // 現在のフィルター

  // フィルター済みToDoリストを取得
  List<Todo> get _filteredTodos {
    switch (_currentFilter) {
      case TodoFilter.active:
        return _todos.where((todo) => !todo.isCompleted).toList();
      case TodoFilter.completed:
        return _todos.where((todo) => todo.isCompleted).toList();
      case TodoFilter.all:
      default:
        return _todos;
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('My ToDo List'),
        centerTitle: true,
      ),
      body: Column(
        children: [
          // 入力エリア（前と同じ）
          // ...

          // フィルターボタンエリア
          Padding(
            padding: const EdgeInsets.symmetric(horizontal: 16.0),
            child: Row(
              children: [
                _buildFilterButton('全て', TodoFilter.all),
                const SizedBox(width: 8),
                _buildFilterButton('未完了', TodoFilter.active),
                const SizedBox(width: 8),
                _buildFilterButton('完了', TodoFilter.completed),
              ],
            ),
          ),

          // ToDoリスト表示（_todosではなく_filteredTodosを使用）
          Expanded(
            child: ListView.builder(
              itemCount: _filteredTodos.length,
              itemBuilder: (context, index) {
                final todo = _filteredTodos[index];
                final originalIndex = _todos.indexOf(todo);  // 元のインデックス
                return ListTile(
                  leading: Checkbox(
                    value: todo.isCompleted,
                    onChanged: (value) => _toggleTodo(originalIndex),
                  ),
                  title: Text(
                    todo.title,
                    style: TextStyle(
                      decoration: todo.isCompleted
                          ? TextDecoration.lineThrough
                          : null,
                    ),
                  ),
                  trailing: IconButton(
                    icon: const Icon(Icons.delete, color: Colors.red),
                    onPressed: () => _deleteTodo(originalIndex),
                  ),
                );
              },
            ),
          ),
        ],
      ),
    );
  }

  // フィルターボタンを生成
  Widget _buildFilterButton(String label, TodoFilter filter) {
    final isSelected = _currentFilter == filter;
    return Expanded(
      child: ElevatedButton(
        onPressed: () {
          setState(() {
            _currentFilter = filter;
          });
        },
        style: ElevatedButton.styleFrom(
          backgroundColor: isSelected ? Colors.blue : Colors.grey[300],
          foregroundColor: isSelected ? Colors.white : Colors.black87,
        ),
        child: Text(label),
      ),
    );
  }
}</code></pre>
                    </div>

                    <!-- ヒントカード -->
                    <div class="bg-blue-50 border-l-4 border-blue-500 rounded-lg p-4">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-500 mt-1"></i>
                            <div>
                                <h3 class="font-semibold text-blue-900 mb-2">ポイント</h3>
                                <ul class="text-sm text-blue-800 space-y-1">
                                    <li><strong>enum:</strong> フィルター種類を定義する列挙型</li>
                                    <li><strong>getter:</strong> _filteredTodosはgetterとして定義し、フィルター条件に応じたリストを返す</li>
                                    <li><strong>where():</strong> 条件に一致する要素だけを抽出</li>
                                    <li><strong>originalIndex:</strong> 削除や更新時は元のリストでのインデックスを使用</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション8: 統計表示の追加 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.8 統計表示の追加
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        完了数、未完了数、進捗率を表示する統計エリアを追加します。
                    </p>

                    <!-- 統計表示コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>統計表示の実装</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">// 統計情報を計算
int get _completedCount => _todos.where((todo) => todo.isCompleted).length;
int get _totalCount => _todos.length;
double get _progressRate => _totalCount > 0 ? _completedCount / _totalCount : 0.0;

// 統計表示ウィジェット
Widget _buildStatistics() {
  return Container(
    margin: const EdgeInsets.all(16.0),
    padding: const EdgeInsets.all(16.0),
    decoration: BoxDecoration(
      color: Colors.blue[50],
      borderRadius: BorderRadius.circular(12),
      border: Border.all(color: Colors.blue[200]!),
    ),
    child: Column(
      children: [
        Row(
          mainAxisAlignment: MainAxisAlignment.spaceAround,
          children: [
            _buildStatItem('完了', _completedCount, Colors.green),
            _buildStatItem('未完了', _totalCount - _completedCount, Colors.orange),
            _buildStatItem('合計', _totalCount, Colors.blue),
          ],
        ),
        const SizedBox(height: 12),
        // 進捗バー
        Column(
          crossAxisAlignment: CrossAxisAlignment.start,
          children: [
            Text(
              '進捗率: ${(_progressRate * 100).toStringAsFixed(1)}%',
              style: const TextStyle(fontSize: 12, fontWeight: FontWeight.bold),
            ),
            const SizedBox(height: 4),
            LinearProgressIndicator(
              value: _progressRate,
              backgroundColor: Colors.grey[300],
              color: Colors.blue,
              minHeight: 8,
            ),
          ],
        ),
      ],
    ),
  );
}

// 統計項目ウィジェット
Widget _buildStatItem(String label, int count, Color color) {
  return Column(
    children: [
      Text(
        label,
        style: const TextStyle(fontSize: 12, color: Colors.black54),
      ),
      Text(
        '$count',
        style: TextStyle(
          fontSize: 24,
          fontWeight: FontWeight.bold,
          color: color,
        ),
      ),
    ],
  );
}

// build()メソッド内で統計表示を追加
@override
Widget build(BuildContext context) {
  return Scaffold(
    // ...
    body: Column(
      children: [
        // 入力エリア
        // フィルターボタン
        // ToDoリスト
        // 統計表示（追加）
        _buildStatistics(),
      ],
    ),
  );
}</code></pre>
                    </div>
                </section>

                <!-- セクション9: 空状態の表示 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.9 空状態の表示
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ToDoが1つもない場合や、フィルター結果が空の場合に、ユーザーフレンドリーなメッセージを表示します。
                    </p>

                    <!-- 空状態表示コード -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>空状態の表示</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">// ToDoリスト表示エリア（空状態対応）
Expanded(
  child: _filteredTodos.isEmpty
      ? _buildEmptyState()  // 空状態表示
      : ListView.builder(
          itemCount: _filteredTodos.length,
          itemBuilder: (context, index) {
            // ... 前と同じ ...
          },
        ),
),

// 空状態ウィジェット
Widget _buildEmptyState() {
  String message;
  IconData icon;

  switch (_currentFilter) {
    case TodoFilter.active:
      message = '未完了のToDoはありません！';
      icon = Icons.check_circle_outline;
      break;
    case TodoFilter.completed:
      message = '完了したToDoはありません';
      icon = Icons.inbox_outlined;
      break;
    case TodoFilter.all:
    default:
      message = 'ToDoを追加してみましょう！';
      icon = Icons.add_circle_outline;
      break;
  }

  return Center(
    child: Column(
      mainAxisAlignment: MainAxisAlignment.center,
      children: [
        Icon(
          icon,
          size: 80,
          color: Colors.grey[400],
        ),
        const SizedBox(height: 16),
        Text(
          message,
          style: TextStyle(
            fontSize: 16,
            color: Colors.grey[600],
          ),
        ),
      ],
    ),
  );
}</code></pre>
                    </div>
                </section>

                <!-- セクション10: UIの改善 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        20.10 UIの改善
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        最後に、カードデザインやアイコン、色使いを工夫して、より美しいUIに仕上げます。
                    </p>

                    <!-- 改善されたListTile -->
                    <div class="code-block-wrapper mb-4">
                        <div class="code-block-header">
                            <span>改善されたToDoカード</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-dart">// ListTileの代わりにCardを使用
itemBuilder: (context, index) {
  final todo = _filteredTodos[index];
  final originalIndex = _todos.indexOf(todo);

  return Card(
    margin: const EdgeInsets.symmetric(horizontal: 16, vertical: 4),
    elevation: 2,
    shape: RoundedRectangleBorder(
      borderRadius: BorderRadius.circular(12),
    ),
    child: ListTile(
      leading: Checkbox(
        value: todo.isCompleted,
        onChanged: (value) => _toggleTodo(originalIndex),
        shape: const CircleBorder(),
      ),
      title: Text(
        todo.title,
        style: TextStyle(
          decoration: todo.isCompleted
              ? TextDecoration.lineThrough
              : null,
          color: todo.isCompleted
              ? Colors.grey
              : Colors.black87,
          fontWeight: FontWeight.w500,
        ),
      ),
      trailing: IconButton(
        icon: const Icon(Icons.delete_outline),
        color: Colors.red[400],
        onPressed: () => _deleteTodo(originalIndex),
      ),
    ),
  );
},</code></pre>
                    </div>
                </section>

                <!-- 動作確認カード -->
                <section class="prose prose-slate max-w-none mb-8">
                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 bg-emerald-500 text-white rounded-full flex items-center justify-center">
                                <i class="fas fa-rocket"></i>
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold text-emerald-900 mb-2">動作確認ポイント</h3>
                                <ul class="text-sm text-emerald-800 space-y-1">
                                    <li><i class="fas fa-check text-emerald-600"></i> ToDoを追加できる</li>
                                    <li><i class="fas fa-check text-emerald-600"></i> チェックボックスで完了/未完了を切り替えられる</li>
                                    <li><i class="fas fa-check text-emerald-600"></i> 削除ボタンでToDoを削除できる</li>
                                    <li><i class="fas fa-check text-emerald-600"></i> フィルターボタンで表示を切り替えられる</li>
                                    <li><i class="fas fa-check text-emerald-600"></i> 統計表示が正しく更新される</li>
                                    <li><i class="fas fa-check text-emerald-600"></i> アプリを再起動してもデータが保持される</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- トラブルシューティング -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        トラブルシューティング
                    </h2>

                    <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl p-5">
                        <h3 class="text-lg font-semibold text-orange-900 mb-4">よくあるエラーと対処法</h3>

                        <div class="space-y-4">
                            <!-- エラー1 -->
                            <div class="bg-orange-100 rounded-lg p-4">
                                <h4 class="font-semibold text-orange-900 mb-2 flex items-center gap-2">
                                    <i class="fas fa-exclamation-triangle text-orange-600"></i>
                                    データが保存されない
                                </h4>
                                <p class="text-sm text-orange-800 mb-2">
                                    <strong>原因:</strong> _saveTodos()を呼び忘れている
                                </p>
                                <p class="text-sm text-orange-800">
                                    <strong>対処:</strong> _addTodo、_toggleTodo、_deleteTodoの最後に_saveTodos()を追加
                                </p>
                            </div>

                            <!-- エラー2 -->
                            <div class="bg-orange-100 rounded-lg p-4">
                                <h4 class="font-semibold text-orange-900 mb-2 flex items-center gap-2">
                                    <i class="fas fa-exclamation-triangle text-orange-600"></i>
                                    フィルター後に削除するとエラー
                                </h4>
                                <p class="text-sm text-orange-800 mb-2">
                                    <strong>原因:</strong> フィルター済みリストのインデックスを使用している
                                </p>
                                <p class="text-sm text-orange-800">
                                    <strong>対処:</strong> originalIndex = _todos.indexOf(todo)で元のインデックスを取得
                                </p>
                            </div>

                            <!-- エラー3 -->
                            <div class="bg-orange-100 rounded-lg p-4">
                                <h4 class="font-semibold text-orange-900 mb-2 flex items-center gap-2">
                                    <i class="fas fa-exclamation-triangle text-orange-600"></i>
                                    JSONエンコードエラー
                                </h4>
                                <p class="text-sm text-orange-800 mb-2">
                                    <strong>原因:</strong> TodoクラスのtoJson()メソッドが正しく実装されていない
                                </p>
                                <p class="text-sm text-orange-800">
                                    <strong>対処:</strong> 全フィールド（id, title, isCompleted）がMapに含まれているか確認
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 拡張アイデア -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        さらなる拡張アイデア
                    </h2>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-edit text-purple-600"></i>
                                ToDoの編集機能
                            </h3>
                            <p class="text-sm text-purple-800">
                                ToDoをタップすると編集ダイアログが表示され、タイトルを変更できるようにする
                            </p>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-calendar text-purple-600"></i>
                                期限の追加
                            </h3>
                            <p class="text-sm text-purple-800">
                                ToDoに期限日を設定し、期限が近いものを強調表示する
                            </p>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-tag text-purple-600"></i>
                                カテゴリ分類
                            </h3>
                            <p class="text-sm text-purple-800">
                                「仕事」「プライベート」などのカテゴリを追加し、カテゴリごとに表示
                            </p>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-sort text-purple-600"></i>
                                並び替え機能
                            </h3>
                            <p class="text-sm text-purple-800">
                                作成日順、タイトル順、期限順など、複数の並び替えオプションを提供
                            </p>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-cloud text-purple-600"></i>
                                クラウド同期
                            </h3>
                            <p class="text-sm text-purple-800">
                                Firebase Firestoreを使って、複数デバイス間でデータを同期
                            </p>
                        </div>

                        <div class="bg-purple-50 rounded-lg p-4 border border-purple-200">
                            <h3 class="font-semibold text-purple-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-bell text-purple-600"></i>
                                通知機能
                            </h3>
                            <p class="text-sm text-purple-800">
                                期限が近づいたらプッシュ通知でリマインダーを送る
                            </p>
                        </div>
                    </div>
                </section>

                <!-- クイズセクション -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        理解度チェッククイズ
                    </h2>

                    <!-- クイズ1 -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 mb-4">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-semibold">
                                Q1
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold text-blue-900 mb-2">CRUDのUは何を表していますか？</h3>
                                <div class="space-y-2 text-sm">
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q1" class="mt-1">
                                        <span>A. Upload（アップロード）</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q1" class="mt-1">
                                        <span>B. Update（更新）</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q1" class="mt-1">
                                        <span>C. Undo（元に戻す）</span>
                                    </label>
                                </div>
                                <details class="mt-3">
                                    <summary class="cursor-pointer text-sm text-blue-600 hover:text-blue-700">解答を見る</summary>
                                    <div class="mt-2 p-3 bg-blue-100 rounded-lg text-sm text-blue-900">
                                        <strong>正解: B</strong><br>
                                        CRUDは「Create（作成）」「Read（読取）」「Update（更新）」「Delete（削除）」の頭文字です。データ操作の基本4操作を表します。
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <!-- クイズ2 -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 mb-4">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-semibold">
                                Q2
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold text-blue-900 mb-2">shared_preferencesパッケージの役割は何ですか？</h3>
                                <div class="space-y-2 text-sm">
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q2" class="mt-1">
                                        <span>A. ネットワーク通信を行う</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q2" class="mt-1">
                                        <span>B. ローカルストレージにデータを保存する</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q2" class="mt-1">
                                        <span>C. 画像を表示する</span>
                                    </label>
                                </div>
                                <details class="mt-3">
                                    <summary class="cursor-pointer text-sm text-blue-600 hover:text-blue-700">解答を見る</summary>
                                    <div class="mt-2 p-3 bg-blue-100 rounded-lg text-sm text-blue-900">
                                        <strong>正解: B</strong><br>
                                        shared_preferencesはキーバリュー形式でデータをローカルストレージに保存するためのパッケージです。アプリを閉じてもデータが保持されます。
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <!-- クイズ3 -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 mb-4">
                        <div class="flex items-start gap-3">
                            <div class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded-full flex items-center justify-center font-semibold">
                                Q3
                            </div>
                            <div class="flex-1">
                                <h3 class="font-semibold text-blue-900 mb-2">フィルター機能で、元のリストのインデックスを取得する必要があるのはなぜですか？</h3>
                                <div class="space-y-2 text-sm">
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q3" class="mt-1">
                                        <span>A. パフォーマンスを向上させるため</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q3" class="mt-1">
                                        <span>B. フィルター済みリストと元のリストでインデックスが異なるため</span>
                                    </label>
                                    <label class="flex items-start gap-2 cursor-pointer text-blue-800">
                                        <input type="radio" name="q3" class="mt-1">
                                        <span>C. メモリを節約するため</span>
                                    </label>
                                </div>
                                <details class="mt-3">
                                    <summary class="cursor-pointer text-sm text-blue-600 hover:text-blue-700">解答を見る</summary>
                                    <div class="mt-2 p-3 bg-blue-100 rounded-lg text-sm text-blue-900">
                                        <strong>正解: B</strong><br>
                                        フィルター済みリストは元のリストの一部のみを含むため、インデックスが一致しません。削除や更新時は元のリストでの正しいインデックスを使う必要があります。
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 章まとめ -->
                <section class="prose prose-slate max-w-none mb-8">
                    <div class="bg-gradient-to-r from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-6">
                        <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 mb-4">
                            <i class="fas fa-bookmark text-primary-500"></i>
                            第20章のまとめ
                        </h2>
                        <ul class="space-y-2 text-slate-700">
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>ToDoアプリ</strong>を通じて実践的なアプリ開発の全体像を理解した</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>CRUD操作</strong>（作成・読取・更新・削除）を実装できるようになった</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>shared_preferences</strong>を使ったローカルデータの永続化を実践した</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>フィルター機能</strong>で動的にリスト表示を切り替える方法を学んだ</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>統計表示</strong>と<strong>空状態表示</strong>でUXを向上させる手法を習得した</span>
                            </li>
                            <li class="flex items-start gap-2">
                                <i class="fas fa-check-circle text-primary-500 mt-1 flex-shrink-0"></i>
                                <span><strong>Material Design</strong>を活用した美しいUIデザインを実装した</span>
                            </li>
                        </ul>

                        <div class="mt-6 p-4 bg-primary-50 rounded-lg border border-primary-200">
                            <h3 class="font-semibold text-primary-900 mb-2 flex items-center gap-2">
                                <i class="fas fa-graduation-cap text-primary-600"></i>
                                おめでとうございます！
                            </h3>
                            <p class="text-sm text-primary-800">
                                全20章の学習を完了しました！これでFlutterの基礎から実践的なアプリ開発まで、一通りのスキルを身につけました。次のステップとして、状態管理ライブラリ（Riverpod、BLoC）やFirebase連携など、さらに高度な技術に挑戦してみましょう。
                            </p>
                        </div>
                    </div>
                </section>

                <!-- ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 border-t border-slate-200">
                    <a href="flutter-learning-material-19.html"
                       class="flex items-center gap-2 px-6 py-3 bg-slate-100 hover:bg-slate-200
                              text-slate-700 rounded-lg transition-colors">
                        <i class="fas fa-arrow-left"></i>
                        <span>前の章へ</span>
                    </a>
                    <div>
                        <span class="text-sm text-slate-400">次の章</span>
                        <p class="text-slate-300">なし（完了）</p>
                    </div>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="#" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- JavaScript読み込み -->
    <script src="sidebar-content.js"></script>
    <script src="main.js"></script>
    <script src="drawing-tool.js"></script>

    <!-- Highlight.js初期化 -->
    <script>
        hljs.highlightAll();
    </script>

    <!-- Mermaid初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
        });
    </script>
</body>
</html>
