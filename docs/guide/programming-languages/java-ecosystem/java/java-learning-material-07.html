<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Java学習教材 第7章 - 入出力操作</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        .navbar {
            background-color: #f57c00;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .chapter-title {
            color: #f57c00;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #f57c00;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #ff9800;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        .quiz-container {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #f57c00;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .nav-link.active {
            background-color: #f57c00 !important;
            color: white !important;
        }

        .io-table {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>Java学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-01.html">第1章: Java基礎</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-02.html">第2章: Java言語の基本</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-03.html">第3章: オブジェクト指向プログラミング入門</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-04.html">第4章: オブジェクト指向プログラミング応用</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-05.html">第5章: Java API基礎</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-06.html">第6章: 例外処理</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="java-learning-material-07.html">第7章: 入出力操作</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="java-learning-material-08.html">第8章: コレクションフレームワーク応用</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第7章: 入出力操作</h1>
                </div>

                <div id="chapter7">
                    <h2 class="chapter-title">ファイルとデータの操作をマスターする</h2>

                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Javaの入出力システムの基本概念を理解する</li>
                            <li>ファイルの読み書き操作を効率的に行う方法を習得する</li>
                            <li>ストリーム処理とバッファリングの仕組みを学ぶ</li>
                            <li>オブジェクトのシリアル化と復元の技術をマスターする</li>
                            <li>Java NIO（New I/O）の基礎知識を身につける</li>
                            <li>実用的なファイル処理プログラムを作成できるようになる</li>
                        </ul>
                    </div>

                    <!-- 7.1 Java の入出力システム -->
                    <h3 class="section-title">7.1 Java の入出力システム</h3>
                    <p>Javaの入出力システムは<strong>ストリーム（Stream）</strong>という概念に基づいています。ストリームは、データの流れを抽象化した仕組みで、ファイル、ネットワーク、メモリなど様々なデータソースを統一的に扱うことができます。</p>


                    <h4>ストリームの分類</h4>
                    <div class="io-table">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>分類基準</th>
                                    <th>種類</th>
                                    <th>説明</th>
                                    <th>主要クラス例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="2"><strong>方向</strong></td>
                                    <td>入力ストリーム</td>
                                    <td>データを読み込む</td>
                                    <td>InputStream, Reader</td>
                                </tr>
                                <tr>
                                    <td>出力ストリーム</td>
                                    <td>データを書き出す</td>
                                    <td>OutputStream, Writer</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>データ形式</strong></td>
                                    <td>バイトストリーム</td>
                                    <td>バイナリデータ（8bit単位）</td>
                                    <td>FileInputStream, FileOutputStream</td>
                                </tr>
                                <tr>
                                    <td>文字ストリーム</td>
                                    <td>テキストデータ（文字単位）</td>
                                    <td>FileReader, FileWriter</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 7.2 ファイル操作の基本 -->
                    <h3 class="section-title">7.2 ファイル操作の基本</h3>
                    <p>ファイルの読み書きは、Javaプログラムで最も頻繁に行われる入出力操作です。テキストファイルの処理から始めて、段階的に高度な操作を学習しましょう。</p>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 7-1: テキストファイルの基本操作</h5>
                        <p>ファイルの作成、書き込み、読み込みの基本的な操作を学習しましょう。</p>

                        <pre class="code-block"><code class="language-java">import java.io.*;
import java.util.Scanner;

public class BasicFileOperations {
    public static void main(String[] args) {
        String filename = "student_data.txt";
        
        System.out.println("=== ファイル書き込み ===");
        writeStudentData(filename);
        
        System.out.println("\n=== ファイル読み込み（FileReader + BufferedReader） ===");
        readFileWithBufferedReader(filename);
        
        System.out.println("\n=== ファイル読み込み（Scanner） ===");
        readFileWithScanner(filename);
        
        System.out.println("\n=== ファイル追記書き込み ===");
        appendToFile(filename);
        
        System.out.println("\n=== 更新後のファイル内容 ===");
        readFileWithBufferedReader(filename);
    }
    
    // ファイルにデータを書き込む
    public static void writeStudentData(String filename) {
        try (FileWriter fileWriter = new FileWriter(filename);
             BufferedWriter bufferedWriter = new BufferedWriter(fileWriter)) {
            
            System.out.println("学生データをファイルに書き込み中...");
            
            bufferedWriter.write("=== 学生一覧 ===");
            bufferedWriter.newLine();
            bufferedWriter.write("ID,名前,年齢,専攻");
            bufferedWriter.newLine();
            
            String[] students = {
                "001,田中太郎,20,情報科学",
                "002,佐藤花子,19,経済学",
                "003,山田次郎,21,物理学",
                "004,鈴木美咲,18,文学",
                "005,高橋健一,22,工学"
            };
            
            for (String student : students) {
                bufferedWriter.write(student);
                bufferedWriter.newLine();
            }
            
            System.out.println("書き込み完了: " + filename);
            
        } catch (IOException e) {
            System.out.println("書き込みエラー: " + e.getMessage());
        }
    }
    
    // BufferedReaderでファイルを読み込む
    public static void readFileWithBufferedReader(String filename) {
        try (FileReader fileReader = new FileReader(filename);
             BufferedReader bufferedReader = new BufferedReader(fileReader)) {
            
            System.out.println("ファイル内容（BufferedReader）:");
            String line;
            int lineNumber = 1;
            
            while ((line = bufferedReader.readLine()) != null) {
                System.out.printf("%3d: %s%n", lineNumber++, line);
            }
            
        } catch (FileNotFoundException e) {
            System.out.println("ファイルが見つかりません: " + filename);
        } catch (IOException e) {
            System.out.println("読み込みエラー: " + e.getMessage());
        }
    }
    
    // Scannerでファイルを読み込む
    public static void readFileWithScanner(String filename) {
        try (Scanner scanner = new Scanner(new File(filename))) {
            
            System.out.println("ファイル内容（Scanner）:");
            int lineNumber = 1;
            
            while (scanner.hasNextLine()) {
                String line = scanner.nextLine();
                System.out.printf("%3d: %s%n", lineNumber++, line);
                
                // CSVデータの解析例
                if (line.contains(",") && !line.startsWith("ID")) {
                    String[] parts = line.split(",");
                    if (parts.length == 4) {
                        System.out.printf("     → ID: %s, 名前: %s, 年齢: %s, 専攻: %s%n",
                                parts[0], parts[1], parts[2], parts[3]);
                    }
                }
            }
            
        } catch (FileNotFoundException e) {
            System.out.println("ファイルが見つかりません: " + filename);
        }
    }
    
    // ファイルに追記する
    public static void appendToFile(String filename) {
        try (FileWriter fileWriter = new FileWriter(filename, true);  // true で追記モード
             BufferedWriter bufferedWriter = new BufferedWriter(fileWriter)) {
            
            System.out.println("追加データを書き込み中...");
            
            bufferedWriter.newLine();
            bufferedWriter.write("=== 追加学生 ===");
            bufferedWriter.newLine();
            bufferedWriter.write("006,中村智子,20,化学");
            bufferedWriter.newLine();
            bufferedWriter.write("007,林洋介,19,数学");
            bufferedWriter.newLine();
            
            System.out.println("追記完了");
            
        } catch (IOException e) {
            System.out.println("追記エラー: " + e.getMessage());
        }
    }
}</code></pre>
                    </div>

                    <!-- 7.3 バイナリファイルとシリアル化 -->
                    <h3 class="section-title">7.3 バイナリファイルとオブジェクトのシリアル化</h3>
                    <p><strong>シリアル化（Serialization）</strong>は、Javaオブジェクトをバイナリ形式でファイルに保存し、後で復元する技術です。オブジェクトの状態を永続化したり、ネットワーク経由で送信したりする際に使用されます。</p>

                    <div class="highlight">
                        <h6>シリアル化の要件</h6>
                        <ul>
                            <li><strong>Serializableインターフェース</strong>を実装する必要がある</li>
                            <li><strong>serialVersionUID</strong>でバージョン管理を行う（推奨）</li>
                            <li><strong>transient</strong>キーワードで特定のフィールドを除外可能</li>
                            <li><strong>static</strong>フィールドはシリアル化されない</li>
                        </ul>
                    </div>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 7-2: オブジェクトのシリアル化と復元</h5>
                        <p>学生情報をオブジェクトとしてファイルに保存し、復元する処理を実装しましょう。</p>

                        <pre class="code-block"><code class="language-java">import java.io.*;
import java.util.*;

// シリアル化可能な学生クラス
class Student implements Serializable {
    private static final long serialVersionUID = 1L;
    
    private String studentId;
    private String name;
    private int age;
    private String major;
    private List&lt;String&gt; subjects;
    private transient String password;  // シリアル化対象外
    
    public Student(String studentId, String name, int age, String major) {
        this.studentId = studentId;
        this.name = name;
        this.age = age;
        this.major = major;
        this.subjects = new ArrayList&lt;&gt;();
        this.password = "secret123";
    }
    
    public void addSubject(String subject) {
        subjects.add(subject);
    }
    
    @Override
    public String toString() {
        return String.format("Student{id='%s', name='%s', age=%d, major='%s', subjects=%s, password='%s'}",
                studentId, name, age, major, subjects, password);
    }
    
    // ゲッター
    public String getStudentId() { return studentId; }
    public String getName() { return name; }
    public int getAge() { return age; }
    public String getMajor() { return major; }
    public List&lt;String&gt; getSubjects() { return subjects; }
}

public class SerializationExample {
    private static final String DATA_FILE = "students.dat";
    
    public static void main(String[] args) {
        System.out.println("=== オブジェクトの作成 ===");
        List&lt;Student&gt; students = createStudents();
        displayStudents(students, "作成した学生リスト");
        
        System.out.println("\n=== シリアル化（ファイル保存） ===");
        serializeStudents(students, DATA_FILE);
        
        System.out.println("\n=== デシリアル化（ファイル読み込み） ===");
        List&lt;Student&gt; restoredStudents = deserializeStudents(DATA_FILE);
        displayStudents(restoredStudents, "復元された学生リスト");
        
        System.out.println("\n=== バイナリファイルの情報 ===");
        displayFileInfo(DATA_FILE);
    }
    
    private static List&lt;Student&gt; createStudents() {
        List&lt;Student&gt; students = new ArrayList&lt;&gt;();
        
        Student student1 = new Student("001", "田中太郎", 20, "情報科学");
        student1.addSubject("Java プログラミング");
        student1.addSubject("データベース");
        student1.addSubject("アルゴリズム");
        
        Student student2 = new Student("002", "佐藤花子", 19, "経済学");
        student2.addSubject("ミクロ経済学");
        student2.addSubject("マクロ経済学");
        
        Student student3 = new Student("003", "山田次郎", 21, "物理学");
        student3.addSubject("量子力学");
        student3.addSubject("相対性理論");
        student3.addSubject("統計力学");
        
        students.add(student1);
        students.add(student2);
        students.add(student3);
        
        return students;
    }
    
    private static void serializeStudents(List&lt;Student&gt; students, String filename) {
        try (FileOutputStream fos = new FileOutputStream(filename);
             ObjectOutputStream oos = new ObjectOutputStream(fos)) {
            
            oos.writeObject(students);
            System.out.println("シリアル化完了: " + students.size() + "人の学生データをファイルに保存");
            
        } catch (IOException e) {
            System.out.println("シリアル化エラー: " + e.getMessage());
        }
    }
    
    @SuppressWarnings("unchecked")
    private static List&lt;Student&gt; deserializeStudents(String filename) {
        try (FileInputStream fis = new FileInputStream(filename);
             ObjectInputStream ois = new ObjectInputStream(fis)) {
            
            List&lt;Student&gt; students = (List&lt;Student&gt;) ois.readObject();
            System.out.println("デシリアル化完了: " + students.size() + "人の学生データを復元");
            return students;
            
        } catch (FileNotFoundException e) {
            System.out.println("ファイルが見つかりません: " + filename);
        } catch (IOException e) {
            System.out.println("読み込みエラー: " + e.getMessage());
        } catch (ClassNotFoundException e) {
            System.out.println("クラスが見つかりません: " + e.getMessage());
        }
        
        return new ArrayList&lt;&gt;();
    }
    
    private static void displayStudents(List&lt;Student&gt; students, String title) {
        System.out.println(title + ":");
        for (int i = 0; i < students.size(); i++) {
            System.out.printf("%d. %s%n", i + 1, students.get(i));
        }
        
        if (students.isEmpty()) {
            System.out.println("（データなし）");
        }
    }
    
    private static void displayFileInfo(String filename) {
        File file = new File(filename);
        if (file.exists()) {
            System.out.println("ファイル名: " + filename);
            System.out.println("ファイルサイズ: " + file.length() + " バイト");
            System.out.println("最終更新: " + new Date(file.lastModified()));
            System.out.println("読み取り可能: " + file.canRead());
            System.out.println("書き込み可能: " + file.canWrite());
        } else {
            System.out.println("ファイルが存在しません: " + filename);
        }
    }
}</code></pre>
                    </div>

                    <!-- 7.4 Java NIO の基礎 -->
                    <h3 class="section-title">7.4 Java NIO（New I/O）の基礎</h3>
                    <p>Java 7以降で導入された<strong>java.nio.file パッケージ</strong>は、従来のファイル操作API（java.io）よりも高性能で使いやすいファイル操作機能を提供します。</p>

                    <div class="highlight">
                        <h6>Java NIO の主な利点</h6>
                        <ul>
                            <li><strong>Path インターフェース</strong>：ファイルパスの柔軟な表現</li>
                            <li><strong>Files クラス</strong>：便利なユーティリティメソッド群</li>
                            <li><strong>高性能</strong>：大容量ファイルの効率的な処理</li>
                            <li><strong>例外処理の簡素化</strong>：try-with-resources との親和性</li>
                        </ul>
                    </div>

                    <!-- 実習 -->
                    <div class="exercise-container">
                        <h5>実習 7-3: Java NIO を使ったファイル操作</h5>
                        <p>Java NIO を使用したモダンなファイル操作を学習しましょう。</p>

                        <pre class="code-block"><code class="language-java">import java.nio.file.*;
import java.nio.charset.StandardCharsets;
import java.io.IOException;
import java.util.*;
import java.util.stream.Stream;

public class NIOFileOperations {
    public static void main(String[] args) {
        Path dataDir = Paths.get("nio_data");
        Path textFile = dataDir.resolve("sample.txt");
        Path csvFile = dataDir.resolve("products.csv");
        Path backupDir = dataDir.resolve("backup");
        
        try {
            System.out.println("=== ディレクトリの作成 ===");
            createDirectories(dataDir, backupDir);
            
            System.out.println("\n=== ファイルの書き込み（NIO） ===");
            writeTextFile(textFile);
            writeCSVFile(csvFile);
            
            System.out.println("\n=== ファイルの読み込み（NIO） ===");
            readTextFile(textFile);
            readCSVFile(csvFile);
            
            System.out.println("\n=== ファイル情報の取得 ===");
            displayFileAttributes(textFile);
            displayFileAttributes(csvFile);
            
            System.out.println("\n=== ディレクトリの一覧表示 ===");
            listDirectory(dataDir);
            
            System.out.println("\n=== ファイルのコピー ===");
            copyFiles(dataDir, backupDir);
            
            System.out.println("\n=== ファイル検索 ===");
            searchFiles(dataDir, "*.txt");
            
        } catch (IOException e) {
            System.out.println("I/Oエラー: " + e.getMessage());
        }
    }
    
    private static void createDirectories(Path... paths) throws IOException {
        for (Path path : paths) {
            if (!Files.exists(path)) {
                Files.createDirectories(path);
                System.out.println("ディレクトリを作成しました: " + path);
            } else {
                System.out.println("ディレクトリは既に存在します: " + path);
            }
        }
    }
    
    private static void writeTextFile(Path filePath) throws IOException {
        List&lt;String&gt; lines = Arrays.asList(
            "Java NIO ファイル操作サンプル",
            "==========================================",
            "",
            "このファイルは java.nio.file パッケージを使用して作成されました。",
            "従来の java.io パッケージよりも効率的で使いやすい API を提供します。",
            "",
            "主な特徴:",
            "- Path インターフェースによる柔軟なパス操作",
            "- Files クラスの豊富なユーティリティメソッド",
            "- 高性能なファイル I/O",
            "- Stream API との統合",
            "",
            "作成日時: " + new Date()
        );
        
        Files.write(filePath, lines, StandardCharsets.UTF_8,
                   StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);
        System.out.println("テキストファイルを作成しました: " + filePath);
    }
    
    private static void writeCSVFile(Path filePath) throws IOException {
        List&lt;String&gt; csvData = Arrays.asList(
            "ID,商品名,価格,在庫数,カテゴリ",
            "001,ノートPC,85000,15,電子機器",
            "002,マウス,2500,50,電子機器",
            "003,キーボード,8000,30,電子機器",
            "004,モニター,32000,8,電子機器",
            "005,スピーカー,12000,20,オーディオ",
            "006,ヘッドホン,15000,25,オーディオ",
            "007,Webカメラ,6000,40,電子機器"
        );
        
        Files.write(filePath, csvData, StandardCharsets.UTF_8,
                   StandardOpenOption.CREATE, StandardOpenOption.TRUNCATE_EXISTING);
        System.out.println("CSVファイルを作成しました: " + filePath);
    }
    
    private static void readTextFile(Path filePath) throws IOException {
        System.out.println("テキストファイルの内容: " + filePath.getFileName());
        System.out.println("----------------------------------------");
        
        // 全行を一度に読み込み
        List&lt;String&gt; lines = Files.readAllLines(filePath, StandardCharsets.UTF_8);
        for (int i = 0; i < lines.size(); i++) {
            System.out.printf("%3d: %s%n", i + 1, lines.get(i));
        }
    }
    
    private static void readCSVFile(Path filePath) throws IOException {
        System.out.println("CSVファイルの内容: " + filePath.getFileName());
        System.out.println("----------------------------------------");
        
        // Stream API を使用した読み込み
        try (Stream&lt;String&gt; lines = Files.lines(filePath, StandardCharsets.UTF_8)) {
            lines.skip(1)  // ヘッダー行をスキップ
                 .map(line -&gt; line.split(","))
                 .filter(parts -&gt; parts.length == 5)
                 .forEach(parts -&gt; {
                     System.out.printf("商品: %s, 価格: %s円, 在庫: %s個, カテゴリ: %s%n",
                             parts[1], parts[2], parts[3], parts[4]);
                 });
        }
    }
    
    private static void displayFileAttributes(Path filePath) throws IOException {
        if (!Files.exists(filePath)) {
            System.out.println("ファイルが存在しません: " + filePath);
            return;
        }
        
        System.out.println("ファイル情報: " + filePath.getFileName());
        System.out.println("  フルパス: " + filePath.toAbsolutePath());
        System.out.println("  サイズ: " + Files.size(filePath) + " バイト");
        System.out.println("  最終更新: " + Files.getLastModifiedTime(filePath));
        System.out.println("  読み取り可能: " + Files.isReadable(filePath));
        System.out.println("  書き込み可能: " + Files.isWritable(filePath));
        System.out.println("  実行可能: " + Files.isExecutable(filePath));
        System.out.println("  ディレクトリ: " + Files.isDirectory(filePath));
        System.out.println("  通常ファイル: " + Files.isRegularFile(filePath));
        System.out.println();
    }
    
    private static void listDirectory(Path dirPath) throws IOException {
        System.out.println("ディレクトリの内容: " + dirPath);
        System.out.println("----------------------------------------");
        
        try (Stream&lt;Path&gt; paths = Files.list(dirPath)) {
            paths.sorted()
                 .forEach(path -&gt; {
                     try {
                         String type = Files.isDirectory(path) ? "[DIR]" : "[FILE]";
                         long size = Files.isRegularFile(path) ? Files.size(path) : 0;
                         System.out.printf("%s %10d bytes %s%n", type, size, path.getFileName());
                     } catch (IOException e) {
                         System.out.println("エラー: " + e.getMessage());
                     }
                 });
        }
    }
    
    private static void copyFiles(Path sourceDir, Path targetDir) throws IOException {
        System.out.println("ファイルのコピー: " + sourceDir + " → " + targetDir);
        
        try (Stream&lt;Path&gt; paths = Files.list(sourceDir)) {
            paths.filter(Files::isRegularFile)
                 .forEach(source -&gt; {
                     try {
                         Path target = targetDir.resolve(source.getFileName());
                         Files.copy(source, target, StandardCopyOption.REPLACE_EXISTING);
                         System.out.println("コピー完了: " + source.getFileName());
                     } catch (IOException e) {
                         System.out.println("コピーエラー: " + e.getMessage());
                     }
                 });
        }
    }
    
    private static void searchFiles(Path searchDir, String pattern) throws IOException {
        System.out.println("ファイル検索: " + pattern + " in " + searchDir);
        System.out.println("----------------------------------------");
        
        PathMatcher matcher = FileSystems.getDefault().getPathMatcher("glob:" + pattern);
        
        try (Stream&lt;Path&gt; paths = Files.walk(searchDir)) {
            paths.filter(Files::isRegularFile)
                 .filter(path -&gt; matcher.matches(path.getFileName()))
                 .forEach(path -&gt; {
                     try {
                         System.out.printf("見つかったファイル: %s (%d bytes)%n",
                                 path, Files.size(path));
                     } catch (IOException e) {
                         System.out.println("サイズ取得エラー: " + e.getMessage());
                     }
                 });
        }
    }
}</code></pre>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>バイトストリームと文字ストリームの違いとして正しいものはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) バイトストリームは文字専用、文字ストリームはバイナリ専用</li>
                                    <li>b) バイトストリームはバイナリデータ、文字ストリームはテキストデータ</li>
                                    <li>c) 性能面でバイトストリームの方が遅い</li>
                                    <li>d) どちらも同じ機能を提供する</li>
                                </ul>
                            </li>
                            <li>
                                <strong>シリアル化に関する説明として正しいものはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) すべてのオブジェクトが自動的にシリアル化可能</li>
                                    <li>b) Serializable インターフェースの実装が必要</li>
                                    <li>c) static フィールドもシリアル化される</li>
                                    <li>d) transient フィールドもシリアル化される</li>
                                </ul>
                            </li>
                            <li>
                                <strong>try-with-resources 文の利点として正しいものはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) 例外が発生しなくなる</li>
                                    <li>b) ファイル操作が高速化される</li>
                                    <li>c) リソースの自動クローズが保証される</li>
                                    <li>d) メモリ使用量が削減される</li>
                                </ul>
                            </li>
                            <li>
                                <strong>Java NIO の特徴として正しいものはどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) 従来の java.io よりも遅い</li>
                                    <li>b) Path インターフェースと Files クラスを提供</li>
                                    <li>c) テキストファイルしか扱えない</li>
                                    <li>d) Java 11以降でのみ使用可能</li>
                                </ul>
                            </li>
                            <li>
                                <strong>BufferedWriter を使用する主な理由はどれですか？</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) ファイルサイズを圧縮するため</li>
                                    <li>b) 書き込み処理を効率化するため</li>
                                    <li>c) セキュリティを向上させるため</li>
                                    <li>d) 文字コードを自動変換するため</li>
                                </ul>
                            </li>
                        </ol>

                        <details style="margin-top: 1rem;">
                            <summary>解答を表示</summary>
                            <div style="margin-top: 0.5rem;">
                                <p><strong>解答:</strong></p>
                                <ol>
                                    <li>b) バイトストリームはバイナリデータ、文字ストリームはテキストデータ - データの性質に応じた使い分け</li>
                                    <li>b) Serializable インターフェースの実装が必要 - シリアル化のマーカーインターフェース</li>
                                    <li>c) リソースの自動クローズが保証される - AutoCloseable リソースが確実に解放される</li>
                                    <li>b) Path インターフェースと Files クラスを提供 - モダンで効率的なファイル操作API</li>
                                    <li>b) 書き込み処理を効率化するため - バッファリングによる性能向上</li>
                                </ol>
                            </div>
                        </details>
                    </div>

                    <!-- 章のまとめ -->
                    <h3 class="section-title">章のまとめ</h3>
                    <p>この章では、Javaでの入出力操作について学習しました：</p>

                    <ul>
                        <li><strong>ストリームの概念</strong>：バイトストリームと文字ストリーム、入力と出力の基本構造</li>
                        <li><strong>ファイル操作の基本</strong>：FileReader/FileWriter、BufferedReader/BufferedWriter による効率的な処理</li>
                        <li><strong>シリアル化</strong>：オブジェクトの永続化と復元、Serializable インターフェースの活用</li>
                        <li><strong>Java NIO</strong>：Path と Files による現代的なファイル操作、Stream API との統合</li>
                        <li><strong>例外処理との統合</strong>：try-with-resources によるリソース管理のベストプラクティス</li>
                    </ul>

                    <div class="highlight">
                        <h6>次章への準備</h6>
                        <p>最終章では、Javaのコレクションフレームワークの高度な機能について学習します。ジェネリクス、イテレータ、ラムダ式、Stream API、Optional クラスなど、現代的なJavaプログラミングに不可欠な要素を習得していきます。</p>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="java-learning-material-06.html" class="btn btn-secondary">← 前の章: 例外処理</a>
                        <a href="java-learning-material-08.html" class="btn btn-primary">次の章: コレクション応用 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>