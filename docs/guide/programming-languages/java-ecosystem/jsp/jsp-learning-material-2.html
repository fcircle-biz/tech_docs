<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSP学習教材 第2章 - JSPの基本理解</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #f57c00;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #f57c00;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #f57c00;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #ff9800;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #f57c00;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #f57c00 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>JSP学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-1.html">
                                第1章: 事前準備
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="jsp-learning-material-2.html">
                                第2章: JSPの基本理解
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-3.html">
                                第3章: スクリプトレットと式
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-4.html">
                                第4章: ディレクティブとインポート
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-5.html">
                                第5章: リクエストとレスポンス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-6.html">
                                第6章: JSPとJavaBeans
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-7.html">
                                第7章: セッションとスコープ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-8.html">
                                第8章: ELとJSTL入門
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-9.html">
                                第9章: 簡易Webアプリ開発
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="jsp-learning-material-10.html">
                                第10章: 次のステップへ
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第2章: JSPの基本理解</h1>
                </div>

                <div id="chapter2">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">JSPの基本概念と動作原理</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>JSPの基本概念と役割を深く理解する</li>
                            <li>JSPファイルの処理フローと実行メカニズムを学ぶ</li>
                            <li>JSPの主要な構文要素とその使い方を修得する</li>
                            <li>簡単なJSPファイルの作成から実行までの流れを理解する</li>
                            <li>JSPとHTMLの関係性と組み合わせ方を学ぶ</li>
                            <li>JSP開発における基本的なベストプラクティスを習得する</li>
                        </ul>
                    </div>

                    <!-- セクション1: JSPの基本概念 -->
                    <h3 class="section-title">2.1 JSPとは何か</h3>
                    <p>JSP（JavaServer Pages）は、動的なWebコンテンツを生成するためのJavaベースのサーバーサイド技術です。HTMLテンプレートにJavaコードを組み込むことで、データベースの内容やユーザーの入力に応じて変化するWebページを作成できます。</p>
                    
                    <h4>2.1.1 JSPの位置づけ</h4>
                    <p>Web開発技術の中でのJSPの位置づけを理解しましょう：</p>

                    <div class="mermaid">
                        flowchart TB
                            subgraph CLIENT["クライアントサイド"]
                                C1["HTML/CSS"]
                                C2["JavaScript"]
                                C3["ブラウザ"]
                            end
                            subgraph SERVER["サーバーサイド"]
                                S1["JSP"]
                                S2["Java/JDBC"]
                                S3["Apache Tomcat"]
                            end
                            subgraph DATABASE["データ層"]
                                D1[("データベース")]
                            end
                            
                            CLIENT -->|"HTTPリクエスト"| SERVER
                            SERVER -->|"HTML/CSS/JavaScript"| CLIENT
                            SERVER --> DATABASE
                            DATABASE --> SERVER
                    </div>

                    <h4>2.1.2 静的コンテンツと動的コンテンツの違い</h4>
                    <p>Webページは大きく静的コンテンツと動的コンテンツに分類されます：</p>
                    
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>項目</th>
                                <th>静的コンテンツ</th>
                                <th>動的コンテンツ（JSP）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>内容</td>
                                <td>固定された内容</td>
                                <td>リクエストに応じて変化</td>
                            </tr>
                            <tr>
                                <td>処理場所</td>
                                <td>ブラウザ（クライアント）</td>
                                <td>Webサーバー（サーバー）</td>
                            </tr>
                            <tr>
                                <td>データベース連携</td>
                                <td>不可</td>
                                <td>可能</td>
                            </tr>
                            <tr>
                                <td>ユーザー認証</td>
                                <td>不可</td>
                                <td>可能</td>
                            </tr>
                            <tr>
                                <td>例</td>
                                <td>会社概要、お知らせページ</td>
                                <td>ログイン画面、商品一覧、検索結果</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- セクション2: JSPの処理フロー -->
                    <h3 class="section-title">2.2 JSPの処理フローと実行メカニズム</h3>
                    <p>JSPがブラウザに表示されるまでの詳細な処理フローを理解することは、JSP開発において非常に重要です。</p>

                    <h4>2.2.1 JSPの処理段階</h4>
                    <p>JSPファイルが実行される際は、以下の段階を経て処理されます：</p>

                    <div class="mermaid">
                        flowchart TD
                            A["①ブラウザから<br/>JSPリクエスト"] --> B["②Tomcatが<br/>JSPファイル受信"]
                            B --> C["③JSPファイルを<br/>Javaサーブレットに変換"]
                            C --> D["④Javaサーブレットを<br/>バイトコードにコンパイル"]
                            D --> E["⑤バイトコードを実行"]
                            E --> F["⑥HTML出力生成"]
                            F --> G["⑦HTMLを<br/>ブラウザに送信"]
                            G --> H["⑧ブラウザで<br/>Webページ表示"]
                    </div>

                    <div class="exercise-container">
                        <h5>実習 2-1: JSP変換プロセスの確認</h5>
                        <p>JSPがどのようにJavaサーブレットに変換されるかを実際に確認します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>以下のJSPファイルをsample.jspとして作成</li>
                            <li>Tomcatにデプロイしてブラウザでアクセス</li>
                            <li>Tomcatのworkディレクトリ内で生成されたJavaファイルを確認</li>
                            <li>JSPがどのようにJavaコードに変換されているかを観察</li>
                        </ol>
                        <h6>sample.jsp</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ page contentType="text/html; charset=UTF-8" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JSP変換テスト&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;JSP変換の確認&lt;/h1&gt;
    &lt;p&gt;現在の日時: &lt;%= new java.util.Date() %&gt;&lt;/p&gt;
    &lt;p&gt;計算結果: &lt;%= 10 + 5 %&gt;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        <h6>期待される結果</h6>
                        <p>Tomcatのwork/Catalina/localhost/[アプリ名]/org/apache/jsp/フォルダ内にsample_jsp.javaファイルが生成され、JSPコードがJavaサーブレットコードに変換されていることを確認できます。</p>
                    </div>

                    <!-- セクション3: JSPの基本構文要素 -->
                    <h3 class="section-title">2.3 JSPの主要な構文要素</h3>
                    <p>JSPには、HTMLと組み合わせてJavaコードを記述するための特殊な構文要素があります。これらの要素を理解することで、効果的なJSPアプリケーションを開発できます。</p>

                    <h4>2.3.1 JSP構文要素の分類</h4>
                    <p>JSPの構文要素は以下のように分類されます：</p>

                    <div class="mermaid">
                        flowchart TB
                            A["JSP構文要素"] --> B["スクリプト要素"]
                            A --> C["ディレクティブ"]
                            A --> D["アクション要素"]
                            A --> E["コメント"]
                            
                            B --> B1["スクリプトレット &lt;% ... %&gt;"]
                            B --> B2["式 &lt;%= ... %&gt;"]
                            B --> B3["宣言 &lt;%! ... %&gt;"]
                            
                            C --> C1["page ディレクティブ"]
                            C --> C2["include ディレクティブ"]
                            C --> C3["taglib ディレクティブ"]
                            
                            D --> D1["jsp:useBean"]
                            D --> D2["jsp:include"]
                            D --> D3["jsp:forward"]
                    </div>

                    <h4>2.3.2 基本的なスクリプト要素</h4>
                    <p>最も基本となるスクリプト要素について学習しましょう：</p>

                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>構文要素</th>
                                <th>記法</th>
                                <th>用途</th>
                                <th>例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>式（Expression）</td>
                                <td>&lt;%= ... %&gt;</td>
                                <td>値をHTMLに出力</td>
                                <td>&lt;%= new Date() %&gt;</td>
                            </tr>
                            <tr>
                                <td>スクリプトレット</td>
                                <td>&lt;% ... %&gt;</td>
                                <td>Javaコードの実行</td>
                                <td>&lt;% int x = 10; %&gt;</td>
                            </tr>
                            <tr>
                                <td>宣言</td>
                                <td>&lt;%! ... %&gt;</td>
                                <td>メソッド・変数宣言</td>
                                <td>&lt;%! int counter = 0; %&gt;</td>
                            </tr>
                            <tr>
                                <td>コメント</td>
                                <td>&lt;%-- ... --%&gt;</td>
                                <td>JSP専用コメント</td>
                                <td>&lt;%-- これはコメント --%&gt;</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exercise-container">
                        <h5>実習 2-2: 基本構文要素の活用</h5>
                        <p>JSPの基本的な構文要素を使用して、動的なコンテンツを生成するページを作成します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>以下のJSPファイルをbasic-syntax.jspとして作成</li>
                            <li>各構文要素がどのように動作するかを確認</li>
                            <li>ブラウザでページを複数回リロードして動的要素を観察</li>
                        </ol>
                        <h6>basic-syntax.jsp</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ page contentType="text/html; charset=UTF-8" %&gt;
&lt;%!
    // 宣言: クラスレベルの変数とメソッド
    private int pageViewCount = 0;
    
    public String getGreeting(String name) {
        return "こんにちは、" + name + "さん！";
    }
%&gt;
&lt;%
    // スクリプトレット: 処理ロジック
    pageViewCount++;
    java.util.Date currentTime = new java.util.Date();
    String userAgent = request.getHeader("User-Agent");
    String browserType = "不明";
    
    if (userAgent != null) {
        if (userAgent.contains("Chrome")) {
            browserType = "Chrome";
        } else if (userAgent.contains("Firefox")) {
            browserType = "Firefox";
        } else if (userAgent.contains("Safari")) {
            browserType = "Safari";
        }
    }
%&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JSP基本構文の練習&lt;/title&gt;
    &lt;style&gt;
        body { font-family: 'Noto Sans JP', sans-serif; margin: 40px; }
        .info-box { background: #f0f8ff; padding: 15px; border-radius: 5px; margin: 10px 0; }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;JSP基本構文デモ&lt;/h1&gt;
    
    &lt;div class="info-box"&gt;
        &lt;h2&gt;式（Expression）の例&lt;/h2&gt;
        &lt;p&gt;現在の日時: &lt;%= currentTime %&gt;&lt;/p&gt;
        &lt;p&gt;メソッド呼び出し: &lt;%= getGreeting("JSP学習者") %&gt;&lt;/p&gt;
        &lt;p&gt;計算結果: &lt;%= 25 * 4 + 10 %&gt;&lt;/p&gt;
    &lt;/div&gt;
    
    &lt;div class="info-box"&gt;
        &lt;h2&gt;宣言とスクリプトレットの例&lt;/h2&gt;
        &lt;p&gt;このページの表示回数: &lt;%= pageViewCount %&gt;&lt;/p&gt;
        &lt;p&gt;使用ブラウザ: &lt;%= browserType %&gt;&lt;/p&gt;
    &lt;/div&gt;
    
    &lt;div class="info-box"&gt;
        &lt;h2&gt;条件分岐の例&lt;/h2&gt;
        &lt;%
            java.util.Calendar cal = java.util.Calendar.getInstance();
            int hour = cal.get(java.util.Calendar.HOUR_OF_DAY);
        %&gt;
        &lt;p&gt;
            &lt;% if (hour &lt; 12) { %&gt;
                おはようございます！
            &lt;% } else if (hour &lt; 18) { %&gt;
                こんにちは！
            &lt;% } else { %&gt;
                こんばんは！
            &lt;% } %&gt;
            現在は&lt;%= hour %&gt;時です。
        &lt;/p&gt;
    &lt;/div&gt;
    
    &lt;%-- JSPコメント: この部分はブラウザに送信されません --%&gt;
    &lt;!-- HTMLコメント: この部分はブラウザに送信されます --&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        <h6>期待される結果</h6>
                        <p>ページが表示され、現在時刻、ページ表示回数、ブラウザ情報、時間帯に応じた挨拶などが動的に生成されます。ページを更新すると表示回数が増加することを確認できます。</p>
                    </div>

                    <!-- セクション4: JSPとHTMLの関係 -->
                    <h3 class="section-title">2.4 JSPとHTMLの関係性</h3>
                    <p>JSPは本質的にHTMLテンプレートにJavaコードを組み込む技術です。HTMLの知識を活用しながら、動的要素を追加する方法を理解しましょう。</p>

                    <h4>2.4.1 HTMLテンプレート + Javaコード</h4>
                    <p>JSPページは以下のような構造を持ちます：</p>

                    <div class="mermaid">
                        flowchart TB
                            A["JSPページ"] --> B["HTMLテンプレート部分"]
                            A --> C["Javaコード部分"]
                            B --> B1["静的コンテンツ<br/>(HTML, CSS, JavaScript)"]
                            C --> C1["動的コンテンツ生成<br/>(データベース, 計算, 条件分岐)"]
                            B1 --> D["統合されたHTML出力"]
                            C1 --> D
                    </div>

                    <h4>2.4.2 効果的なHTMLとJSPの組み合わせ</h4>
                    <p>保守性と可読性を高めるためのベストプラクティス：</p>
                    <ul>
                        <li><strong>関心の分離</strong>：デザイン（HTML/CSS）とロジック（Java）を適切に分離</li>
                        <li><strong>可読性の重視</strong>：HTMLの構造を壊さないJavaコード配置</li>
                        <li><strong>再利用性</strong>：共通部分はインクルードファイルとして分離</li>
                        <li><strong>セキュリティ</strong>：ユーザー入力の適切なエスケープ処理</li>
                    </ul>

                    <!-- セクション5: JSPファイルの作成から実行 -->
                    <h3 class="section-title">2.5 JSPファイルの作成から実行までの流れ</h3>
                    <p>実際のJSPファイルを作成し、Tomcatで実行するまでの具体的な手順を学習します。</p>

                    <div class="exercise-container">
                        <h5>実習 2-3: 完全なJSPページの作成</h5>
                        <p>HTML、CSS、Javaコードを組み合わせた実用的なJSPページを作成します。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>以下のJSPファイルをcomplete-example.jspとして作成</li>
                            <li>Webアプリケーションとしてデプロイ</li>
                            <li>ブラウザで動作確認</li>
                            <li>各機能がどのように実装されているかを分析</li>
                        </ol>
                        <h6>complete-example.jsp</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ page contentType="text/html; charset=UTF-8" %&gt;
&lt;%@ page import="java.util.*, java.text.*" %&gt;
&lt;%!
    // ユーティリティメソッドの宣言
    public String formatNumber(double number) {
        DecimalFormat df = new DecimalFormat("#,##0.00");
        return df.format(number);
    }
    
    public String getColorByValue(double value) {
        if (value &gt; 70) return "success";
        if (value &gt; 40) return "warning"; 
        return "danger";
    }
%&gt;
&lt;%
    // サンプルデータの生成
    String[] products = {"ノートPC", "マウス", "キーボード", "モニター", "プリンター"};
    double[] prices = {89800.0, 2980.0, 5780.0, 34800.0, 15600.0};
    int[] stocks = {15, 120, 89, 25, 8};
    
    double totalValue = 0;
    for (int i = 0; i &lt; products.length; i++) {
        totalValue += prices[i] * stocks[i];
    }
    
    SimpleDateFormat sdf = new SimpleDateFormat("yyyy年MM月dd日 HH:mm:ss");
    String currentDateTime = sdf.format(new Date());
%&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;商品在庫管理システム&lt;/title&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    &lt;style&gt;
        .header-info { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container-fluid"&gt;
        &lt;div class="row header-info text-white p-3 mb-4"&gt;
            &lt;div class="col"&gt;
                &lt;h1 class="h3"&gt;商品在庫管理システム&lt;/h1&gt;
                &lt;p class="mb-0"&gt;最終更新: &lt;%= currentDateTime %&gt;&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        
        &lt;div class="row"&gt;
            &lt;div class="col-md-8"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h5 class="mb-0"&gt;在庫一覧&lt;/h5&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body p-0"&gt;
                        &lt;table class="table table-striped mb-0"&gt;
                            &lt;thead class="table-dark"&gt;
                                &lt;tr&gt;
                                    &lt;th&gt;商品名&lt;/th&gt;
                                    &lt;th&gt;単価&lt;/th&gt;
                                    &lt;th&gt;在庫数&lt;/th&gt;
                                    &lt;th&gt;在庫価値&lt;/th&gt;
                                    &lt;th&gt;状態&lt;/th&gt;
                                &lt;/tr&gt;
                            &lt;/thead&gt;
                            &lt;tbody&gt;
                                &lt;% for (int i = 0; i &lt; products.length; i++) { %&gt;
                                &lt;tr&gt;
                                    &lt;td&gt;&lt;%= products[i] %&gt;&lt;/td&gt;
                                    &lt;td&gt;¥&lt;%= formatNumber(prices[i]) %&gt;&lt;/td&gt;
                                    &lt;td&gt;
                                        &lt;span class="badge bg-&lt;%= getColorByValue(stocks[i]) %&gt;"&gt;
                                            &lt;%= stocks[i] %&gt;個
                                        &lt;/span&gt;
                                    &lt;/td&gt;
                                    &lt;td&gt;¥&lt;%= formatNumber(prices[i] * stocks[i]) %&gt;&lt;/td&gt;
                                    &lt;td&gt;
                                        &lt;% if (stocks[i] &lt; 10) { %&gt;
                                            &lt;span class="badge bg-danger"&gt;要発注&lt;/span&gt;
                                        &lt;% } else if (stocks[i] &lt; 30) { %&gt;
                                            &lt;span class="badge bg-warning"&gt;注意&lt;/span&gt;
                                        &lt;% } else { %&gt;
                                            &lt;span class="badge bg-success"&gt;良好&lt;/span&gt;
                                        &lt;% } %&gt;
                                    &lt;/td&gt;
                                &lt;/tr&gt;
                                &lt;% } %&gt;
                            &lt;/tbody&gt;
                        &lt;/table&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;div class="col-md-4"&gt;
                &lt;div class="card mb-3"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h5 class="mb-0"&gt;サマリー情報&lt;/h5&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;h6&gt;総在庫価値&lt;/h6&gt;
                        &lt;p class="h4 text-primary"&gt;¥&lt;%= formatNumber(totalValue) %&gt;&lt;/p&gt;
                        
                        &lt;h6&gt;商品カテゴリ数&lt;/h6&gt;
                        &lt;p class="h4 text-info"&gt;&lt;%= products.length %&gt;種類&lt;/p&gt;
                        
                        &lt;h6&gt;要発注商品&lt;/h6&gt;
                        &lt;p class="h4 text-warning"&gt;
                            &lt;% 
                                int lowStockCount = 0;
                                for (int stock : stocks) {
                                    if (stock &lt; 10) lowStockCount++;
                                }
                            %&gt;
                            &lt;%= lowStockCount %&gt;商品
                        &lt;/p&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="card"&gt;
                    &lt;div class="card-header"&gt;
                        &lt;h5 class="mb-0"&gt;システム情報&lt;/h5&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;small class="text-muted"&gt;
                            サーバー時刻: &lt;%= new Date() %&gt;&lt;br&gt;
                            JSP バージョン: 3.1&lt;br&gt;
                            文字エンコーディング: UTF-8
                        &lt;/small&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        <h6>期待される結果</h6>
                        <p>商品在庫管理システムのような実用的なWebページが表示されます。商品一覧テーブル、在庫状況の色分け表示、サマリー情報など、動的に生成されたコンテンツを確認できます。</p>
                    </div>

                    <!-- セクション6: ベストプラクティス -->
                    <h3 class="section-title">2.6 JSP開発のベストプラクティス</h3>
                    <p>保守性が高く、セキュアなJSPアプリケーションを開発するための重要な原則を学びます。</p>

                    <h4>2.6.1 コードの分離と構造化</h4>
                    <div class="warning">
                        <h5>避けるべき書き方</h5>
                        <p>JSPファイル内に大量のJavaコードを記述することは、以下の問題を引き起こします：</p>
                        <ul>
                            <li>保守性の低下</li>
                            <li>デザイナーとプログラマーの協業困難</li>
                            <li>テストの複雑化</li>
                            <li>セキュリティリスクの増大</li>
                        </ul>
                    </div>

                    <h4>2.6.2 推奨される開発アプローチ</h4>
                    <p>JSP開発における推奨パターン：</p>
                    <ul>
                        <li><strong>MVC（Model-View-Controller）パターン</strong>：ロジックとプレゼンテーションを分離</li>
                        <li><strong>JavaBeans活用</strong>：データの管理と受け渡しに専用クラスを使用</li>
                        <li><strong>EL（Expression Language）</strong>：JSPコード内のJava記述を最小化</li>
                        <li><strong>JSTL（JSP Standard Tag Library）</strong>：標準タグライブラリを活用</li>
                        <li><strong>適切なコメント</strong>：保守性向上のための文書化</li>
                    </ul>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>JSPファイルが実行されてブラウザに表示されるまでの処理段階を順序立てて説明してください。</li>
                            <li>JSPの式（&lt;%= ... %&gt;）とスクリプトレット（&lt;% ... %&gt;）の違いを、具体的な使用例とともに説明してください。</li>
                            <li>宣言（&lt;%! ... %&gt;）を使用する場面と、通常のスクリプトレット内での変数宣言との違いを説明してください。</li>
                            <li>静的コンテンツと動的コンテンツの特徴を比較し、JSPがどちらに分類されるかその理由とともに説明してください。</li>
                            <li>JSP開発において「関心の分離」が重要な理由を、保守性の観点から説明してください。</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>①ブラウザからJSPリクエスト → ②TomcatがJSPファイル受信 → ③JSPをJavaサーブレットに変換 → ④Javaサーブレットをバイトコードにコンパイル → ⑤バイトコード実行 → ⑥HTML出力生成 → ⑦HTMLをブラウザに送信 → ⑧ブラウザでWebページ表示</li>
                                <li>式（&lt;%= new Date() %&gt;）は値を直接HTML出力に出力するために使用し、スクリプトレット（&lt;% int x = 10; %&gt;）は変数宣言や制御構造などの処理ロジックを記述するために使用します。</li>
                                <li>宣言（&lt;%! %&gt;）はクラスレベルの変数やメソッドを定義するために使用し、サーブレット全体で共有されます。スクリプトレット内の変数はメソッドレベルのローカル変数として機能します。</li>
                                <li>静的コンテンツは固定された内容でクライアント側で処理されますが、動的コンテンツはリクエストに応じて変化し、サーバー側で処理されます。JSPは動的コンテンツに分類され、データベース連携やユーザー入力に応じたコンテンツ生成が可能です。</li>
                                <li>関心の分離により、デザイン（HTML/CSS）とロジック（Java）を適切に分離することで、各専門分野の開発者が独立して作業でき、コードの可読性・保守性・テスタビリティが向上します。</li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章のまとめ -->
                    <h3 class="section-title">2.7 まとめ</h3>
                    <p>この章では、JSPの基本概念と動作原理について学習しました。</p>
                    <ul>
                        <li><strong>JSPの役割理解</strong>：動的Webコンテンツ生成技術としての位置づけ</li>
                        <li><strong>処理フロー把握</strong>：JSPからHTMLが生成される詳細なプロセス</li>
                        <li><strong>基本構文習得</strong>：式、スクリプトレット、宣言の使い方</li>
                        <li><strong>実践的活用</strong>：HTMLとJavaコードを組み合わせた実用例</li>
                        <li><strong>開発原則理解</strong>：保守性の高いJSPアプリケーション開発のベストプラクティス</li>
                    </ul>
                    <p>次章では、スクリプトレットと式について、より詳細で実践的な使用方法を学習していきます。</p>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="jsp-learning-material-1.html" class="btn btn-secondary">← 前の章</a>
                        <a href="jsp-learning-material-3.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>