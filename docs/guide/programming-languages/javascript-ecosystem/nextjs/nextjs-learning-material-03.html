<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Next.js学習教材 第3章 - ページとルーティング（App Router）</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        .navbar {
            background-color: #667eea;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .chapter-title {
            color: #667eea;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #764ba2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        .quiz-container {
            background-color: rgba(102, 126, 234, 0.1);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #667eea;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #764ba2;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #667eea;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .nav-link.active {
            background-color: #667eea !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>Next.js学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-01.html">第1章: Next.js入門と環境構築</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-02.html">第2章: Reactの基礎とコンポーネント設計</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="nextjs-learning-material-03.html">第3章: ページとルーティング（App Router）</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-04.html">第4章: サーバーコンポーネントとクライアントコンポーネント</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-05.html">第5章: データフェッチングとレンダリング戦略</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-06.html">第6章: APIルートとサーバーアクション</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-07.html">第7章: スタイリングと画像最適化</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-08.html">第8章: 認証とミドルウェア</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-09.html">第9章: パフォーマンス最適化とベストプラクティス</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="nextjs-learning-material-10.html">第10章: デプロイメントと本番環境設定</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: ページとルーティング（App Router）</h1>
                </div>

                <div id="chapter3">
                    <h2 class="chapter-title">ファイルベースルーティングの理解</h2>

                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>App Routerの基本概念とファイルベースルーティングを理解する</li>
                            <li>page.jsとlayout.jsの役割と使い分けを習得する</li>
                            <li>動的ルート（[id]）の作成方法を学ぶ</li>
                            <li>ルートグループとネストされたルートを理解する</li>
                            <li>Linkコンポーネントとナビゲーションを実装する</li>
                            <li>useRouterフックでプログラム的なナビゲーションを行う</li>
                        </ul>
                    </div>

                    <h3 class="section-title">3.1 App Routerの基本概念</h3>

                    <h4>3.1.1 ファイルベースルーティングとは</h4>
                    <p>
                        Next.jsの最大の特徴の1つが<strong>ファイルベースルーティング</strong>です。ルーティング設定ファイルを書く代わりに、<code>app</code>ディレクトリ内のフォルダ構造がそのままURLに対応します。
                    </p>

                    <div class="mermaid">
                        flowchart TB
                            A["app/"]
                            A --> B["page.js → /"]
                            A --> C["about/"]
                            C --> D["page.js → /about"]
                            A --> E["blog/"]
                            E --> F["page.js → /blog"]
                            E --> G["[slug]/"]
                            G --> H["page.js → /blog/:slug"]
                    </div>

                    <h4>3.1.2 特殊なファイル名の役割</h4>

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-light">
                                <tr>
                                    <th>ファイル名</th>
                                    <th>役割</th>
                                    <th>必須/任意</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><code>page.js</code></td>
                                    <td>ページコンテンツを定義（URLアクセス可能）</td>
                                    <td>必須</td>
                                </tr>
                                <tr>
                                    <td><code>layout.js</code></td>
                                    <td>共通レイアウト（複数ページで共有）</td>
                                    <td>任意</td>
                                </tr>
                                <tr>
                                    <td><code>loading.js</code></td>
                                    <td>ローディング状態のUI</td>
                                    <td>任意</td>
                                </tr>
                                <tr>
                                    <td><code>error.js</code></td>
                                    <td>エラー時のUI</td>
                                    <td>任意</td>
                                </tr>
                                <tr>
                                    <td><code>not-found.js</code></td>
                                    <td>404ページ</td>
                                    <td>任意</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="section-title">3.2 基本的なページの作成</h3>

                    <div class="exercise-container">
                        <h5>実習 3-1: 複数ページの作成</h5>
                        <p>About、Contact、Blogページを作成してみましょう。</p>

                        <h6>手順1: Aboutページ</h6>
                        <pre class="code-block"><code class="language-bash"># app/aboutフォルダを作成
mkdir app/about</code></pre>

                        <pre class="code-block"><code class="language-javascript">// app/about/page.js
export default function AboutPage() {
  return (
    &lt;div style={{ padding: '50px' }}&gt;
      &lt;h1&gt;私たちについて&lt;/h1&gt;
      &lt;p&gt;このサイトはNext.js学習用のサンプルサイトです。&lt;/p&gt;
      &lt;p&gt;Next.jsの機能を実際に試しながら学んでいきます。&lt;/p&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <h6>手順2: Contactページ</h6>
                        <pre class="code-block"><code class="language-javascript">// app/contact/page.js
export default function ContactPage() {
  return (
    &lt;div style={{ padding: '50px' }}&gt;
      &lt;h1&gt;お問い合わせ&lt;/h1&gt;
      &lt;p&gt;メール: info@example.com&lt;/p&gt;
      &lt;p&gt;電話: 03-1234-5678&lt;/p&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <h6>アクセス確認</h6>
                        <ul>
                            <li><code>http://localhost:3000/about</code></li>
                            <li><code>http://localhost:3000/contact</code></li>
                        </ul>
                    </div>

                    <h3 class="section-title">3.3 layout.jsによる共通レイアウト</h3>

                    <h4>3.3.1 ルートレイアウト</h4>
                    <p>
                        <code>app/layout.js</code>は、すべてのページで共通するレイアウトを定義します。これはアプリケーション全体に適用されます。
                    </p>

                    <pre class="code-block"><code class="language-javascript">// app/layout.js
import './globals.css';

export const metadata = {
  title: 'My Next.js App',
  description: 'Next.js学習用アプリケーション',
};

export default function RootLayout({ children }) {
  return (
    &lt;html lang="ja"&gt;
      &lt;body&gt;
        &lt;header style={{ background: '#667eea', padding: '20px' }}&gt;
          &lt;h1&gt;My Next.js App&lt;/h1&gt;
        &lt;/header&gt;
        &lt;main&gt;{children}&lt;/main&gt;
        &lt;footer style={{ background: '#282c34', color: 'white', padding: '20px', textAlign: 'center' }}&gt;
          &lt;p&gt;© 2025 My Next.js App&lt;/p&gt;
        &lt;/footer&gt;
      &lt;/body&gt;
    &lt;/html&gt;
  );
}</code></pre>

                    <p>重要なポイント：</p>
                    <ul>
                        <li><code>{children}</code>：各ページのコンテンツがここに表示される</li>
                        <li><code>metadata</code>：ページのメタデータ（タイトル、description等）</li>
                        <li>ルートレイアウトは必ず<code>&lt;html&gt;</code>と<code>&lt;body&gt;</code>を含む必要がある</li>
                    </ul>

                    <h4>3.3.2 ネストされたレイアウト</h4>
                    <p>
                        各フォルダにlayout.jsを配置することで、そのセクション専用のレイアウトを定義できます：
                    </p>

                    <pre class="code-block"><code class="language-javascript">// app/blog/layout.js
export default function BlogLayout({ children }) {
  return (
    &lt;div style={{ display: 'flex' }}&gt;
      &lt;aside style={{ width: '200px', padding: '20px', background: '#f0f0f0' }}&gt;
        &lt;h3&gt;ブログカテゴリ&lt;/h3&gt;
        &lt;ul&gt;
          &lt;li&gt;技術&lt;/li&gt;
          &lt;li&gt;ライフスタイル&lt;/li&gt;
          &lt;li&gt;旅行&lt;/li&gt;
        &lt;/ul&gt;
      &lt;/aside&gt;
      &lt;div style={{ flex: 1, padding: '20px' }}&gt;
        {children}
      &lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <div class="mermaid">
                        flowchart TB
                            A["app/layout.js<br/>（ルートレイアウト）"]
                            A --> B["app/page.js<br/>(ホーム)"]
                            A --> C["app/blog/layout.js<br/>（ブログレイアウト）"]
                            C --> D["app/blog/page.js<br/>（ブログ一覧）"]
                            C --> E["app/blog/[slug]/page.js<br/>（記事詳細）"]
                    </div>

                    <h3 class="section-title">3.4 動的ルート</h3>

                    <h4>3.4.1 動的セグメント [slug]</h4>
                    <p>
                        フォルダ名を<code>[]</code>で囲むと、動的なURLパラメータを受け取れます：
                    </p>

                    <div class="exercise-container">
                        <h5>実習 3-2: ブログ記事詳細ページの作成</h5>

                        <h6>フォルダ構造</h6>
                        <pre class="code-block"><code class="language-bash">app/
├── blog/
│   ├── page.js          # /blog
│   └── [slug]/
│       └── page.js      # /blog/:slug</code></pre>

                        <h6>ブログ一覧ページ</h6>
                        <pre class="code-block"><code class="language-javascript">// app/blog/page.js
import Link from 'next/link';

export default function BlogPage() {
  const posts = [
    { slug: 'nextjs-intro', title: 'Next.js入門' },
    { slug: 'react-hooks', title: 'React Hooks完全ガイド' },
    { slug: 'typescript-basics', title: 'TypeScript基礎' },
  ];

  return (
    &lt;div style={{ padding: '50px' }}&gt;
      &lt;h1&gt;ブログ記事一覧&lt;/h1&gt;
      &lt;ul&gt;
        {posts.map(post =&gt; (
          &lt;li key={post.slug}&gt;
            &lt;Link href={`/blog/${post.slug}`}&gt;
              {post.title}
            &lt;/Link&gt;
          &lt;/li&gt;
        ))}
      &lt;/ul&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <h6>記事詳細ページ</h6>
                        <pre class="code-block"><code class="language-javascript">// app/blog/[slug]/page.js
export default function BlogPostPage({ params }) {
  return (
    &lt;div style={{ padding: '50px' }}&gt;
      &lt;h1&gt;記事: {params.slug}&lt;/h1&gt;
      &lt;p&gt;このページは動的ルートで生成されています。&lt;/p&gt;
      &lt;p&gt;URLパラメータ: {params.slug}&lt;/p&gt;
    &lt;/div&gt;
  );
}</code></pre>

                        <p>重要：<code>params</code>オブジェクトから動的パラメータを取得できます。</p>
                    </div>

                    <h4>3.4.2 複数の動的セグメント</h4>
                    <p>
                        複数のパラメータを使用することも可能です：
                    </p>

                    <pre class="code-block"><code class="language-bash">app/
└── shop/
    └── [category]/
        └── [productId]/
            └── page.js    # /shop/:category/:productId</code></pre>

                    <pre class="code-block"><code class="language-javascript">// app/shop/[category]/[productId]/page.js
export default function ProductPage({ params }) {
  return (
    &lt;div&gt;
      &lt;h1&gt;商品ページ&lt;/h1&gt;
      &lt;p&gt;カテゴリ: {params.category}&lt;/p&gt;
      &lt;p&gt;商品ID: {params.productId}&lt;/p&gt;
    &lt;/div&gt;
  );
}
// URL例: /shop/electronics/laptop-123</code></pre>

                    <h3 class="section-title">3.5 ルートグループ</h3>

                    <h4>3.5.1 ルートグループとは</h4>
                    <p>
                        フォルダ名を<code>()</code>で囲むと、URLには影響を与えずにルートを論理的にグループ化できます：
                    </p>

                    <pre class="code-block"><code class="language-bash">app/
├── (marketing)/
│   ├── about/
│   │   └── page.js      # /about（URLに(marketing)は含まれない）
│   └── contact/
│       └── page.js      # /contact
└── (dashboard)/
    ├── settings/
    │   └── page.js      # /settings
    └── profile/
        └── page.js      # /profile</code></pre>

                    <p>ルートグループの利点：</p>
                    <ul>
                        <li>関連するルートをまとめて管理できる</li>
                        <li>各グループに異なるlayout.jsを適用できる</li>
                        <li>URLには影響しない（SEOにも影響なし）</li>
                    </ul>

                    <h3 class="section-title">3.6 ナビゲーション</h3>

                    <h4>3.6.1 Linkコンポーネント</h4>
                    <p>
                        Next.jsでページ間を移動するには、<code>Link</code>コンポーネントを使用します：
                    </p>

                    <pre class="code-block"><code class="language-javascript">import Link from 'next/link';

export default function Navigation() {
  return (
    &lt;nav&gt;
      &lt;Link href="/"&gt;ホーム&lt;/Link&gt;
      &lt;Link href="/about"&gt;会社概要&lt;/Link&gt;
      &lt;Link href="/blog"&gt;ブログ&lt;/Link&gt;
      &lt;Link href="/contact"&gt;お問い合わせ&lt;/Link&gt;
    &lt;/nav&gt;
  );
}</code></pre>

                    <p>Linkコンポーネントの特徴：</p>
                    <ul>
                        <li>クライアントサイドルーティング（ページ全体をリロードしない）</li>
                        <li>プリフェッチング（自動的に次のページを先読み）</li>
                        <li>スムーズなページ遷移</li>
                    </ul>

                    <div class="warning">
                        <h6>注意：&lt;a&gt;タグとの違い</h6>
                        <p>
                            通常の<code>&lt;a&gt;</code>タグを使うとページ全体がリロードされ、Reactの状態が失われます。Next.js内のナビゲーションには必ず<code>Link</code>コンポーネントを使用してください。
                        </p>
                    </div>

                    <h4>3.6.2 useRouterフックによるプログラム的なナビゲーション</h4>
                    <p>
                        ボタンクリックなどでプログラム的にページ遷移する場合は、<code>useRouter</code>フックを使用します：
                    </p>

                    <pre class="code-block"><code class="language-javascript">'use client';

import { useRouter } from 'next/navigation';

export default function MyButton() {
  const router = useRouter();

  const handleClick = () => {
    // プログラム的にページ遷移
    router.push('/about');
  };

  return (
    &lt;button onClick={handleClick}&gt;
      会社概要へ移動
    &lt;/button&gt;
  );
}</code></pre>

                    <p>useRouterの主なメソッド：</p>
                    <ul>
                        <li><code>router.push('/path')</code>：指定されたURLに遷移</li>
                        <li><code>router.back()</code>：前のページに戻る</li>
                        <li><code>router.refresh()</code>：現在のページをリフレッシュ</li>
                    </ul>

                    <h3 class="section-title">3.7 loading.jsとerror.js</h3>

                    <h4>3.7.1 loading.js：ローディングUI</h4>
                    <p>
                        <code>loading.js</code>を配置すると、ページの読み込み中に表示されるUIを定義できます：
                    </p>

                    <pre class="code-block"><code class="language-javascript">// app/blog/loading.js
export default function Loading() {
  return (
    &lt;div style={{ textAlign: 'center', padding: '50px' }}&gt;
      &lt;p&gt;読み込み中...&lt;/p&gt;
      &lt;div className="spinner"&gt;&lt;/div&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <h4>3.7.2 error.js：エラーハンドリング</h4>
                    <p>
                        <code>error.js</code>でエラー時のUIを定義します：
                    </p>

                    <pre class="code-block"><code class="language-javascript">// app/blog/error.js
'use client';

export default function Error({ error, reset }) {
  return (
    &lt;div style={{ padding: '50px', textAlign: 'center' }}&gt;
      &lt;h2&gt;エラーが発生しました&lt;/h2&gt;
      &lt;p&gt;{error.message}&lt;/p&gt;
      &lt;button onClick={() =&gt; reset()}&gt;
        再試行
      &lt;/button&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>app/products/[id]/page.jsというファイルは、どのようなURLパターンに対応しますか？</strong>
                                <div style="margin-top: 10px; padding: 10px; background-color: white; border-radius: 5px;">
                                    回答：/products/:id（例：/products/123、/products/abc）
                                </div>
                            </li>
                            <li>
                                <strong>layout.jsの{children}には何が表示されますか？</strong>
                                <div style="margin-top: 10px; padding: 10px; background-color: white; border-radius: 5px;">
                                    回答：そのレイアウト配下の各ページ（page.js）のコンテンツ
                                </div>
                            </li>
                            <li>
                                <strong>Next.js内でページ遷移を行う際に使うべきコンポーネントは何ですか？</strong>
                                <div style="margin-top: 10px; padding: 10px; background-color: white; border-radius: 5px;">
                                    回答：Linkコンポーネント（next/linkからインポート）
                                </div>
                            </li>
                        </ol>
                    </div>

                    <h3 class="section-title">3.8 まとめ</h3>
                    <p>この章では、App Routerのルーティングについて学びました：</p>
                    <ul>
                        <li>ファイルベースルーティングでURLとファイル構造が対応</li>
                        <li>page.jsでページコンテンツを定義</li>
                        <li>layout.jsで共通レイアウトを作成</li>
                        <li>[slug]で動的ルートを実装</li>
                        <li>ルートグループで論理的な整理が可能</li>
                        <li>LinkコンポーネントとuseRouterでナビゲーション</li>
                    </ul>

                    <div class="highlight">
                        <h6>次の章の予告</h6>
                        <p>
                            第4章では、Next.jsの革新的な機能である<strong>React Server Components</strong>について学びます。サーバーコンポーネントとクライアントコンポーネントの違い、使い分け、パフォーマンス最適化の方法を理解していきます。
                        </p>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="nextjs-learning-material-02.html" class="btn btn-secondary">← 前の章</a>
                        <a href="nextjs-learning-material-04.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
