<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET Core (VB.NET)学習教材 第3章 - Razorビューとレイアウト</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #663399;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #663399;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #663399;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #8e44ad;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #663399;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #663399 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>ASP.NET Core (VB.NET)学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-01.html">
                                第1章: ASP.NET Core入門
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-02.html">
                                第2章: MVCアーキテクチャ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="aspnetcore-vb-learning-material-03.html">
                                第3章: Razorビューとレイアウト
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-04.html">
                                第4章: モデルバインディング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-05.html">
                                第5章: 依存性注入とミドルウェア
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-06.html">
                                第6章: Entity Framework Core
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-07.html">
                                第7章: Web API開発
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-08.html">
                                第8章: 認証と認可
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-09.html">
                                第9章: 状態管理とキャッシング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnetcore-vb-learning-material-10.html">
                                第10章: 実践的なWebアプリケーション
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: Razorビューとレイアウト</h1>
                </div>

                <div id="chapter3">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">動的なWebページの構築</h2>
                    
                    <!-- 学習目標（必須） -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Razorシンタックスの基本構文とVB.NET特有の記述方法</li>
                            <li>レイアウトページを使用した統一されたページデザインの実現</li>
                            <li>部分ビューによるコードの再利用と保守性の向上</li>
                            <li>ビューコンポーネントを使った複雑なUIコンポーネントの作成</li>
                            <li>Tag Helpersによるフォーム作成とHTML生成の効率化</li>
                        </ul>
                    </div>

                    <!-- セクション3.1 -->
                    <h3 class="section-title">3.1 Razorシンタックスの基礎</h3>
                    
                    <p>
                        Razorは、HTMLとサーバーサイドコードを統合するビューエンジンです。
                        @記号を使用してVB.NETコードをHTML内に埋め込むことができ、
                        動的なWebページを効率的に作成できます。
                    </p>

                    <div class="mermaid">
                        graph TD
                            A["Razorビュー(.vbhtml)"] --> B["Razorエンジン"]
                            B --> C["VB.NETコード実行"]
                            C --> D["HTML生成"]
                            D --> E["ブラウザに送信"]
                            
                            F["モデルデータ"] --> B
                            G["ViewBag/ViewData"] --> B
                    </div>

                    <h4>基本的なRazor構文</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Products/Index.vbhtml --&gt;
@* VB.NET用のRazorビューファイル *@
@ModelType List(Of String)

&lt;h1&gt;製品一覧&lt;/h1&gt;

@* 単一の式の出力 *@
&lt;p&gt;現在の時刻: @DateTime.Now.ToString("yyyy/MM/dd HH:mm:ss")&lt;/p&gt;

@* 条件分岐 *@
@If Model IsNot Nothing AndAlso Model.Count &gt; 0 Then
    &lt;ul&gt;
        @* ループ処理 *@
        @For Each product In Model
            &lt;li&gt;@product&lt;/li&gt;
        Next
    &lt;/ul&gt;
Else
    &lt;p&gt;製品が登録されていません。&lt;/p&gt;
End If

@* コードブロック *@
@Code
    Dim pageTitle As String = "製品管理システム"
    Dim itemCount As Integer = If(Model?.Count, 0)
End Code

&lt;title&gt;@pageTitle&lt;/title&gt;
&lt;p&gt;@itemCount 件の製品があります。&lt;/p&gt;
</code></pre>

                    <h4>VB.NET特有のRazor構文</h4>

                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>構文</th>
                                <th>用途</th>
                                <th>VB.NET例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>@ModelType</td>
                                <td>ビューの型指定</td>
                                <td><code>@ModelType Product</code></td>
                            </tr>
                            <tr>
                                <td>@Code...End Code</td>
                                <td>複数行のコードブロック</td>
                                <td><code>@Code Dim x = 10 End Code</code></td>
                            </tr>
                            <tr>
                                <td>@If...End If</td>
                                <td>条件分岐</td>
                                <td><code>@If condition Then...End If</code></td>
                            </tr>
                            <tr>
                                <td>@For Each...Next</td>
                                <td>繰り返し処理</td>
                                <td><code>@For Each item In items...Next</code></td>
                            </tr>
                            <tr>
                                <td>@*...*@</td>
                                <td>コメント</td>
                                <td><code>@* これはコメント *@</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 3-1: 基本的なRazorビューの作成</h5>
                        <p>前章で作成したProductsControllerに対応するビューファイルを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Views フォルダ内に Products フォルダを作成</li>
                            <li>Products フォルダ内に Index.vbhtml を作成</li>
                            <li>以下のコードを実装してビューを作成</li>
                            <li>アプリケーションを実行して /Products/Index にアクセス</li>
                        </ol>
                        
                        <h6>実装コード</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- Views/Products/Index.vbhtml --&gt;
@ModelType List(Of String)

&lt;div class="container mt-4"&gt;
    &lt;div class="row"&gt;
        &lt;div class="col-12"&gt;
            &lt;h1 class="mb-4"&gt;製品一覧&lt;/h1&gt;
            
            @* 製品数の表示 *@
            @Code
                Dim productCount As Integer = If(Model?.Count, 0)
                Dim displayClass As String = If(productCount &gt; 0, "alert-info", "alert-warning")
            End Code
            
            &lt;div class="alert @displayClass"&gt;
                &lt;strong&gt;@productCount&lt;/strong&gt; 件の製品が登録されています。
            &lt;/div&gt;

            @* 製品リストの表示 *@
            @If Model IsNot Nothing AndAlso Model.Count &gt; 0 Then
                &lt;div class="row"&gt;
                    @For Each product In Model
                        &lt;div class="col-md-6 col-lg-4 mb-3"&gt;
                            &lt;div class="card"&gt;
                                &lt;div class="card-body"&gt;
                                    &lt;h5 class="card-title"&gt;@product&lt;/h5&gt;
                                    &lt;p class="card-text"&gt;@product の詳細情報&lt;/p&gt;
                                    &lt;a href="#" class="btn btn-primary"&gt;詳細を見る&lt;/a&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    Next
                &lt;/div&gt;
            Else
                &lt;div class="text-center py-5"&gt;
                    &lt;h3 class="text-muted"&gt;製品が登録されていません&lt;/h3&gt;
                    &lt;p&gt;新しい製品を追加してください。&lt;/p&gt;
                    &lt;a href="/Products/Create" class="btn btn-success"&gt;製品を追加&lt;/a&gt;
                &lt;/div&gt;
            End If
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>
                            ブラウザで製品一覧ページが表示され、Bootstrap を使用したカード形式で
                            製品が一覧表示される。製品が0件の場合は適切なメッセージが表示される。
                        </p>
                    </div>

                    <!-- セクション3.2 -->
                    <h3 class="section-title">3.2 レイアウトページの活用</h3>
                    
                    <p>
                        レイアウトページは、複数のビューで共通して使用されるHTMLテンプレートです。
                        ヘッダー、ナビゲーション、フッターなどの共通要素を一箇所で管理し、
                        保守性の向上とコードの重複を防ぐことができます。
                    </p>

                    <div class="mermaid">
                        graph TD
                            A["_Layout.vbhtml レイアウトページ"] --> B["共通のHTML構造"]
                            B --> C["ヘッダー"]
                            B --> D["ナビゲーション"]
                            B --> E["@RenderBody 各ビューの内容"]
                            B --> F["フッター"]
                            
                            G["Index.vbhtml"] --> E
                            H["Details.vbhtml"] --> E
                            I["Create.vbhtml"] --> E
                    </div>

                    <h4>基本的なレイアウトページの構造</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Shared/_Layout.vbhtml --&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;@ViewData("Title") - 製品管理システム&lt;/title&gt;
    
    &lt;!-- Bootstrap CSS --&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    
    @RenderSection("Styles", required:=False)
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;nav class="navbar navbar-expand-sm navbar-toggleable-sm navbar-light bg-white border-bottom box-shadow mb-3"&gt;
            &lt;div class="container-fluid"&gt;
                &lt;a class="navbar-brand" href="/"&gt;製品管理システム&lt;/a&gt;
                &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target=".navbar-collapse"&gt;
                    &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
                &lt;/button&gt;
                &lt;div class="navbar-collapse collapse d-sm-inline-flex justify-content-between"&gt;
                    &lt;ul class="navbar-nav flex-grow-1"&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" href="/"&gt;ホーム&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" href="/Products"&gt;製品&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link text-dark" href="/Home/Privacy"&gt;プライバシー&lt;/a&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/nav&gt;
    &lt;/header&gt;
    
    &lt;div class="container"&gt;
        &lt;main role="main" class="pb-3"&gt;
            @RenderBody()
        &lt;/main&gt;
    &lt;/div&gt;

    &lt;footer class="border-top footer text-muted"&gt;
        &lt;div class="container"&gt;
            &amp;copy; @DateTime.Now.Year - 製品管理システム
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;!-- Bootstrap JS --&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
    
    @RenderSection("Scripts", required:=False)
&lt;/body&gt;
&lt;/html&gt;
</code></pre>

                    <h4>ビューでのレイアウト使用</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Products/Details.vbhtml --&gt;
@ModelType Product
@Code
    ViewData("Title") = "製品詳細"
    Layout = "_Layout"
End Code

&lt;h1&gt;製品詳細&lt;/h1&gt;

&lt;div class="card"&gt;
    &lt;div class="card-header"&gt;
        &lt;h2&gt;@Model.Name&lt;/h2&gt;
    &lt;/div&gt;
    &lt;div class="card-body"&gt;
        &lt;p&gt;&lt;strong&gt;価格:&lt;/strong&gt; @Model.Price.ToString("C")&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;カテゴリ:&lt;/strong&gt; @Model.Category&lt;/p&gt;
        &lt;p&gt;&lt;strong&gt;説明:&lt;/strong&gt; @Model.Description&lt;/p&gt;
    &lt;/div&gt;
&lt;/div&gt;

@* カスタムスタイルセクション *@
@Section Styles
    &lt;style&gt;
        .card {
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
    &lt;/style&gt;
End Section

@* カスタムスクリプトセクション *@
@Section Scripts
    &lt;script&gt;
        console.log('製品詳細ページが読み込まれました');
    &lt;/script&gt;
End Section
</code></pre>

                    <!-- セクション3.3 -->
                    <h3 class="section-title">3.3 部分ビュー（Partial Views）</h3>
                    
                    <p>
                        部分ビューは、複数のビューで再利用できる小さなビューコンポーネントです。
                        共通のUIコンポーネントや繰り返し使用される要素を部分ビューとして切り出すことで、
                        コードの保守性と再利用性が向上します。
                    </p>

                    <h4>部分ビューの作成例</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Shared/_ProductCard.vbhtml --&gt;
@ModelType Product

&lt;div class="col-md-6 col-lg-4 mb-3"&gt;
    &lt;div class="card h-100"&gt;
        @If Not String.IsNullOrEmpty(Model.ImageUrl) Then
            &lt;img src="@Model.ImageUrl" class="card-img-top" alt="@Model.Name"&gt;
        End If
        &lt;div class="card-body d-flex flex-column"&gt;
            &lt;h5 class="card-title"&gt;@Model.Name&lt;/h5&gt;
            &lt;p class="card-text flex-grow-1"&gt;@Model.Description&lt;/p&gt;
            &lt;div class="mt-auto"&gt;
                &lt;p class="card-text"&gt;
                    &lt;strong class="text-primary"&gt;@Model.Price.ToString("C")&lt;/strong&gt;
                &lt;/p&gt;
                &lt;div class="btn-group w-100"&gt;
                    &lt;a href="/Products/Details/@Model.Id" class="btn btn-outline-primary btn-sm"&gt;詳細&lt;/a&gt;
                    &lt;a href="/Products/Edit/@Model.Id" class="btn btn-outline-secondary btn-sm"&gt;編集&lt;/a&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre>

                    <h4>部分ビューの使用方法</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Products/Index.vbhtml --&gt;
@ModelType List(Of Product)

&lt;h1&gt;製品一覧&lt;/h1&gt;

&lt;div class="row"&gt;
    @For Each product In Model
        @* 部分ビューの呼び出し *@
        @Html.Partial("_ProductCard", product)
    Next
&lt;/div&gt;

&lt;!-- 非同期で部分ビューを読み込む場合 --&gt;
&lt;div class="row" id="product-list"&gt;
    @For Each product In Model
        @Await Html.PartialAsync("_ProductCard", product)
    Next
&lt;/div&gt;
</code></pre>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 3-2: レイアウトと部分ビューの作成</h5>
                        <p>共通レイアウトと再利用可能な部分ビューを作成して、統一されたデザインを実現します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Views/Shared フォルダに _Layout.vbhtml を作成</li>
                            <li>Views/Shared フォルダに _Navigation.vbhtml 部分ビューを作成</li>
                            <li>既存のビューファイルでレイアウトを使用するよう修正</li>
                            <li>アプリケーションを実行して統一されたデザインを確認</li>
                        </ol>
                        
                        <h6>実装コード（ナビゲーション部分ビュー）</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- Views/Shared/_Navigation.vbhtml --&gt;
&lt;nav class="navbar navbar-expand-lg navbar-dark bg-primary"&gt;
    &lt;div class="container"&gt;
        &lt;a class="navbar-brand" href="/"&gt;
            &lt;i class="fas fa-cube"&gt;&lt;/i&gt; 製品管理システム
        &lt;/a&gt;
        
        &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"&gt;
            &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
        &lt;/button&gt;
        
        &lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
            &lt;ul class="navbar-nav me-auto"&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="/"&gt;
                        &lt;i class="fas fa-home"&gt;&lt;/i&gt; ホーム
                    &lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="/Products"&gt;
                        &lt;i class="fas fa-box"&gt;&lt;/i&gt; 製品一覧
                    &lt;/a&gt;
                &lt;/li&gt;
                &lt;li class="nav-item"&gt;
                    &lt;a class="nav-link" href="/Products/Create"&gt;
                        &lt;i class="fas fa-plus"&gt;&lt;/i&gt; 製品追加
                    &lt;/a&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
            
            &lt;ul class="navbar-nav"&gt;
                &lt;li class="nav-item dropdown"&gt;
                    &lt;a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown"&gt;
                        &lt;i class="fas fa-user"&gt;&lt;/i&gt; アカウント
                    &lt;/a&gt;
                    &lt;ul class="dropdown-menu"&gt;
                        &lt;li&gt;&lt;a class="dropdown-item" href="#"&gt;プロフィール&lt;/a&gt;&lt;/li&gt;
                        &lt;li&gt;&lt;a class="dropdown-item" href="#"&gt;設定&lt;/a&gt;&lt;/li&gt;
                        &lt;li&gt;&lt;hr class="dropdown-divider"&gt;&lt;/li&gt;
                        &lt;li&gt;&lt;a class="dropdown-item" href="#"&gt;ログアウト&lt;/a&gt;&lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/nav&gt;
</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>
                            すべてのページが統一されたレイアウトで表示され、
                            ナビゲーションが共通化される。Font Awesome アイコンを使用した
                            視覚的に魅力的なナビゲーションが表示される。
                        </p>
                    </div>

                    <!-- セクション3.4 -->
                    <h3 class="section-title">3.4 Tag Helpersの活用</h3>
                    
                    <p>
                        Tag Helpersは、HTMLタグにサーバーサイド処理を組み込むための機能です。
                        従来のHTMLヘルパーメソッドよりも自然で読みやすいコードが書けます。
                    </p>

                    <h4>フォーム関連のTag Helpers</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- Views/Products/Create.vbhtml --&gt;
@ModelType Product

&lt;h1&gt;製品の新規作成&lt;/h1&gt;

&lt;form asp-action="Create" method="post"&gt;
    &lt;div asp-validation-summary="ModelOnly" class="text-danger"&gt;&lt;/div&gt;
    
    &lt;div class="mb-3"&gt;
        &lt;label asp-for="Name" class="form-label"&gt;&lt;/label&gt;
        &lt;input asp-for="Name" class="form-control" /&gt;
        &lt;span asp-validation-for="Name" class="text-danger"&gt;&lt;/span&gt;
    &lt;/div&gt;

    &lt;div class="mb-3"&gt;
        &lt;label asp-for="Price" class="form-label"&gt;&lt;/label&gt;
        &lt;input asp-for="Price" class="form-control" type="number" step="0.01" /&gt;
        &lt;span asp-validation-for="Price" class="text-danger"&gt;&lt;/span&gt;
    &lt;/div&gt;

    &lt;div class="mb-3"&gt;
        &lt;label asp-for="Category" class="form-label"&gt;&lt;/label&gt;
        &lt;select asp-for="Category" class="form-select"&gt;
            &lt;option value=""&gt;カテゴリを選択してください&lt;/option&gt;
            &lt;option value="Electronics"&gt;電子機器&lt;/option&gt;
            &lt;option value="Clothing"&gt;衣類&lt;/option&gt;
            &lt;option value="Books"&gt;書籍&lt;/option&gt;
        &lt;/select&gt;
        &lt;span asp-validation-for="Category" class="text-danger"&gt;&lt;/span&gt;
    &lt;/div&gt;

    &lt;div class="mb-3"&gt;
        &lt;label asp-for="Description" class="form-label"&gt;&lt;/label&gt;
        &lt;textarea asp-for="Description" class="form-control" rows="4"&gt;&lt;/textarea&gt;
        &lt;span asp-validation-for="Description" class="text-danger"&gt;&lt;/span&gt;
    &lt;/div&gt;

    &lt;div class="mb-3 form-check"&gt;
        &lt;input asp-for="IsActive" type="checkbox" class="form-check-input" /&gt;
        &lt;label asp-for="IsActive" class="form-check-label"&gt;アクティブ&lt;/label&gt;
    &lt;/div&gt;

    &lt;div class="mb-3"&gt;
        &lt;input type="submit" value="作成" class="btn btn-primary" /&gt;
        &lt;a asp-action="Index" class="btn btn-secondary"&gt;キャンセル&lt;/a&gt;
    &lt;/div&gt;
&lt;/form&gt;
</code></pre>

                    <h4>その他のTag Helpers</h4>

                    <pre class="code-block"><code class="language-html">&lt;!-- リンク生成 --&gt;
&lt;a asp-controller="Products" asp-action="Details" asp-route-id="@Model.Id" class="btn btn-info"&gt;
    詳細を見る
&lt;/a&gt;

&lt;!-- 画像表示（キャッシュバスティング付き） --&gt;
&lt;img src="~/images/logo.png" asp-append-version="true" alt="ロゴ" /&gt;

&lt;!-- CSS/JSファイル読み込み --&gt;
&lt;link rel="stylesheet" href="~/css/custom.css" asp-append-version="true" /&gt;
&lt;script src="~/js/custom.js" asp-append-version="true"&gt;&lt;/script&gt;

&lt;!-- 環境別のファイル読み込み --&gt;
&lt;environment include="Development"&gt;
    &lt;script src="~/js/debug.js"&gt;&lt;/script&gt;
&lt;/environment&gt;

&lt;environment exclude="Development"&gt;
    &lt;script src="~/js/production.min.js" asp-append-version="true"&gt;&lt;/script&gt;
&lt;/environment&gt;
</code></pre>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>問題1:</strong> VB.NETのRazorビューファイルで、複数行のコードブロックを記述する際に使用する構文は何ですか？
                            </li>
                            <li>
                                <strong>問題2:</strong> レイアウトページで @RenderBody() の役割は何ですか？また、セクション（@RenderSection）との違いを説明しなさい。
                            </li>
                            <li>
                                <strong>問題3:</strong> 部分ビューを呼び出す2つの方法（同期・非同期）を示し、それぞれの使用場面を説明しなさい。
                            </li>
                            <li>
                                <strong>問題4:</strong> Tag Helpersを使用してフォームを作成する際の利点を3つ挙げなさい。
                            </li>
                        </ol>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">3.5 章のまとめ</h3>
                    
                    <p>
                        この章では、Razorビューエンジンを使用した動的なWebページの作成方法について学習しました。
                        重要なポイントを振り返ってみましょう：
                    </p>

                    <div class="highlight">
                        <h6>学習した重要ポイント</h6>
                        <ul>
                            <li>VB.NET特有のRazor構文（@Code...End Code、@If...End If等）</li>
                            <li>レイアウトページによる共通デザインの統一と保守性の向上</li>
                            <li>部分ビューによるUIコンポーネントの再利用</li>
                            <li>ViewData、ViewBag、TempDataを使用したデータ受け渡し</li>
                            <li>Tag Helpersによる直感的なフォーム作成</li>
                            <li>セクション機能による柔軟なレイアウト拡張</li>
                        </ul>
                    </div>

                    <p>
                        次章では、モデルバインディングとバリデーションについて学習し、
                        フォームデータの受け取りと検証機能の実装方法を習得していきます。
                    </p>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnetcore-vb-learning-material-02.html" class="btn btn-secondary">← 前の章: MVCアーキテクチャの基礎</a>
                        <a href="aspnetcore-vb-learning-material-04.html" class="btn btn-primary">次の章: モデルバインディングとバリデーション →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>