<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VB.NET学習教材 第9章 - .NET Frameworkライブラリ活用</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #5c6bc0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #5c6bc0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #5c6bc0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #7986cb;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        .quiz-container {
            background-color: #e8eaf6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #5c6bc0;
        }
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .nav-link.active {
            background-color: #5c6bc0 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>VB.NET学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-1.html">
                                第1章: VB.NET入門と開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-2.html">
                                第2章: VB.NET基本文法
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-3.html">
                                第3章: 制御構造とプロシージャ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-4.html">
                                第4章: 配列とコレクション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-5.html">
                                第5章: オブジェクト指向プログラミング基礎
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-6.html">
                                第6章: オブジェクト指向プログラミング応用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-7.html">
                                第7章: 例外処理とデバッグ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-8.html">
                                第8章: ファイル操作と文字列処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="vbnet-learning-material-9.html">
                                第9章: .NET Frameworkライブラリ活用
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="vbnet-learning-material-10.html">
                                第10章: 実践的なアプリケーション開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第9章: .NET Frameworkライブラリ活用</h1>
                </div>

                <div id="chapter9">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">.NETの豊富なライブラリを活用する</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>DateTime構造体による日付・時刻処理を習得する</li>
                            <li>Mathクラスの数学関数を活用する</li>
                            <li>Randomクラスによる乱数生成を学ぶ</li>
                            <li>System.IOクラス群によるファイル・ディレクトリ操作を理解する</li>
                            <li>LINQ（Language Integrated Query）の基礎を学ぶ</li>
                            <li>ジェネリクスによる型安全なプログラミングを理解する</li>
                        </ul>
                    </div>

                    <!-- セクション1: DateTime構造体 -->
                    <h3 class="section-title">9.1 日付・時刻処理（DateTime）</h3>
                    
                    <p>
                        <strong>DateTime</strong>構造体は、日付と時刻を表現し、操作するための強力な機能を提供します。予約システム、ログ管理、期限チェックなど、多くのアプリケーションで重要な役割を果たします。
                    </p>

                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Console.WriteLine("=== DateTime操作の例 ===")
        
        ' 現在の日付・時刻
        Dim now As DateTime = DateTime.Now
        Console.WriteLine("現在の日時: " & now.ToString("yyyy年M月d日 H:mm:ss"))
        
        ' 特定の日付を作成
        Dim birthday As New DateTime(1995, 3, 15)
        Console.WriteLine("誕生日: " & birthday.ToString("yyyy年M月d日"))
        
        ' 年齢の計算
        Dim age As Integer = CalculateAge(birthday, now)
        Console.WriteLine($"年齢: {age}歳")
        
        ' 日付の加算・減算
        Dim nextWeek As DateTime = now.AddDays(7)
        Dim lastMonth As DateTime = now.AddMonths(-1)
        
        Console.WriteLine($"1週間後: {nextWeek:yyyy年M月d日}")
        Console.WriteLine($"1ヶ月前: {lastMonth:yyyy年M月d日}")
        
        ' 日付の比較
        If now > birthday Then
            Console.WriteLine("今日は誕生日より後です")
        End If
        
        ' 曜日の取得
        Console.WriteLine($"今日は{GetJapaneseDayOfWeek(now.DayOfWeek)}曜日です")
        
        ' 期間の計算
        Dim timeSpan As TimeSpan = now - birthday
        Console.WriteLine($"誕生日からの経過日数: {timeSpan.TotalDays:F0}日")
        
        Console.ReadKey()
    End Sub
    
    Function CalculateAge(birthDate As DateTime, currentDate As DateTime) As Integer
        Dim age As Integer = currentDate.Year - birthDate.Year
        If currentDate < birthDate.AddYears(age) Then
            age -= 1
        End If
        Return age
    End Function
    
    Function GetJapaneseDayOfWeek(dayOfWeek As DayOfWeek) As String
        Select Case dayOfWeek
            Case DayOfWeek.Sunday : Return "日"
            Case DayOfWeek.Monday : Return "月"
            Case DayOfWeek.Tuesday : Return "火"
            Case DayOfWeek.Wednesday : Return "水"
            Case DayOfWeek.Thursday : Return "木"
            Case DayOfWeek.Friday : Return "金"
            Case DayOfWeek.Saturday : Return "土"
            Case Else : Return "?"
        End Select
    End Function
End Module</code></pre>

                    <!-- セクション2: 数学関数とRandom -->
                    <h3 class="section-title">9.2 数学関数（Math）と乱数（Random）</h3>
                    
                    <p>
                        <strong>Math</strong>クラスは三角関数、対数、平方根など様々な数学関数を提供します。<strong>Random</strong>クラスは乱数生成に使用され、ゲーム、シミュレーション、テストデータ生成などで活用されます。
                    </p>

                    <!-- 実習課題1 -->
                    <div class="exercise-container">
                        <h5>実習 9-1: 統計計算プログラム</h5>
                        <p>MathとRandomクラスを使って、データの統計情報を計算するプログラムを作成しましょう。</p>
                        
                        <h6>サンプルコード</h6>
                        <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        Console.WriteLine("=== 統計計算プログラム ===")
        
        ' ランダムデータの生成
        Dim random As New Random()
        Dim data As New List(Of Double)
        
        Console.WriteLine("100個のランダムな数値（1-100）を生成中...")
        For i As Integer = 1 To 100
            data.Add(random.Next(1, 101))
        Next
        
        ' 統計計算
        Dim sum As Double = data.Sum()
        Dim average As Double = data.Average()
        Dim minimum As Double = data.Min()
        Dim maximum As Double = data.Max()
        Dim variance As Double = CalculateVariance(data, average)
        Dim standardDeviation As Double = Math.Sqrt(variance)
        
        ' 結果の表示
        Console.WriteLine()
        Console.WriteLine("=== 統計結果 ===")
        Console.WriteLine($"データ数: {data.Count}個")
        Console.WriteLine($"合計: {sum:F2}")
        Console.WriteLine($"平均: {average:F2}")
        Console.WriteLine($"最小値: {minimum}")
        Console.WriteLine($"最大値: {maximum}")
        Console.WriteLine($"分散: {variance:F2}")
        Console.WriteLine($"標準偏差: {standardDeviation:F2}")
        
        ' 三角関数の例
        Console.WriteLine()
        Console.WriteLine("=== 三角関数の例 ===")
        For angle As Integer = 0 To 90 Step 30
            Dim radians As Double = Math.PI * angle / 180
            Console.WriteLine($"{angle}度: Sin={Math.Sin(radians):F3}, Cos={Math.Cos(radians):F3}, Tan={Math.Tan(radians):F3}")
        Next
        
        ' 指数・対数の例
        Console.WriteLine()
        Console.WriteLine("=== 指数・対数の例 ===")
        For i As Integer = 1 To 5
            Dim value As Double = i * 2
            Console.WriteLine($"値{value}: 2^{value}={Math.Pow(2, value):F1}, Log({value})={Math.Log(value):F3}")
        Next
        
        Console.ReadKey()
    End Sub
    
    Function CalculateVariance(data As List(Of Double), mean As Double) As Double
        Dim sumOfSquaredDifferences As Double = 0
        For Each value As Double In data
            sumOfSquaredDifferences += Math.Pow(value - mean, 2)
        Next
        Return sumOfSquaredDifferences / data.Count
    End Function
End Module</code></pre>
                    </div>

                    <!-- セクション3: LINQ基礎 -->
                    <h3 class="section-title">9.3 LINQ（Language Integrated Query）基礎</h3>
                    
                    <p>
                        <strong>LINQ</strong>は、コレクションや配列に対してSQL風のクエリを実行できる機能です。データのフィルタリング、並び替え、グループ化、集計などを直感的に記述できます。
                    </p>

                    <pre class="code-block"><code class="language-vbnet">Module Program
    Sub Main(args As String())
        ' サンプルデータ
        Dim students As New List(Of Student) From {
            New Student("田中太郎", 20, 85),
            New Student("佐藤花子", 19, 92),
            New Student("鈴木一郎", 21, 78),
            New Student("高橋美穂", 20, 88),
            New Student("伊藤健二", 22, 95)
        }
        
        Console.WriteLine("=== LINQ操作の例 ===")
        Console.WriteLine("全学生:")
        For Each student In students
            Console.WriteLine($"  {student.Name} ({student.Age}歳) - {student.Score}点")
        Next
        
        ' Where: フィルタリング
        Console.WriteLine()
        Console.WriteLine("20歳の学生:")
        Dim twentyYearOlds = students.Where(Function(s) s.Age = 20)
        For Each student In twentyYearOlds
            Console.WriteLine($"  {student.Name} - {student.Score}点")
        Next
        
        ' OrderBy: 並び替え
        Console.WriteLine()
        Console.WriteLine("成績順（降順）:")
        Dim orderedByScore = students.OrderByDescending(Function(s) s.Score)
        For Each student In orderedByScore
            Console.WriteLine($"  {student.Name} - {student.Score}点")
        Next
        
        ' Select: 射影（変換）
        Console.WriteLine()
        Console.WriteLine("学生名のみ:")
        Dim names = students.Select(Function(s) s.Name)
        For Each name In names
            Console.WriteLine($"  {name}")
        Next
        
        ' 集計関数
        Console.WriteLine()
        Console.WriteLine("=== 統計情報 ===")
        Console.WriteLine($"学生数: {students.Count()}人")
        Console.WriteLine($"平均年齢: {students.Average(Function(s) s.Age):F1}歳")
        Console.WriteLine($"平均点: {students.Average(Function(s) s.Score):F1}点")
        Console.WriteLine($"最高点: {students.Max(Function(s) s.Score)}点")
        Console.WriteLine($"最低点: {students.Min(Function(s) s.Score)}点")
        
        ' 条件に一致するかどうか
        Console.WriteLine($"90点以上の学生はいますか？ {students.Any(Function(s) s.Score >= 90)}")
        Console.WriteLine($"全員が60点以上ですか？ {students.All(Function(s) s.Score >= 60)}")
        
        Console.ReadKey()
    End Sub
End Module

Public Class Student
    Public Property Name As String
    Public Property Age As Integer
    Public Property Score As Integer
    
    Public Sub New(name As String, age As Integer, score As Integer)
        Me.Name = name
        Me.Age = age
        Me.Score = score
    End Sub
End Class</code></pre>

                    <!-- セクション4: ジェネリクス -->
                    <h3 class="section-title">9.4 ジェネリクス（Generics）</h3>
                    
                    <p>
                        <strong>ジェネリクス</strong>は、型パラメータを使って型安全なコレクションやクラスを作成する機能です。コンパイル時の型チェックにより、実行時エラーを防ぎ、パフォーマンスを向上させます。
                    </p>

                    <pre class="code-block"><code class="language-vbnet">' ジェネリッククラスの例
Public Class SimpleStack(Of T)
    Private items As New List(Of T)
    
    Public Sub Push(item As T)
        items.Add(item)
    End Sub
    
    Public Function Pop() As T
        If items.Count = 0 Then
            Throw New InvalidOperationException("スタックが空です")
        End If
        
        Dim item As T = items(items.Count - 1)
        items.RemoveAt(items.Count - 1)
        Return item
    End Function
    
    Public ReadOnly Property Count As Integer
        Get
            Return items.Count
        End Get
    End Property
    
    Public Function IsEmpty() As Boolean
        Return items.Count = 0
    End Function
End Class

Module Program
    Sub Main(args As String())
        Console.WriteLine("=== ジェネリクスの例 ===")
        
        ' 文字列用スタック
        Dim stringStack As New SimpleStack(Of String)
        stringStack.Push("Hello")
        stringStack.Push("World")
        stringStack.Push("VB.NET")
        
        Console.WriteLine("文字列スタック:")
        While Not stringStack.IsEmpty()
            Console.WriteLine($"  Pop: {stringStack.Pop()}")
        End While
        
        ' 整数用スタック
        Dim intStack As New SimpleStack(Of Integer)
        intStack.Push(10)
        intStack.Push(20)
        intStack.Push(30)
        
        Console.WriteLine()
        Console.WriteLine("整数スタック:")
        While Not intStack.IsEmpty()
            Console.WriteLine($"  Pop: {intStack.Pop()}")
        End While
        
        Console.ReadKey()
    End Sub
End Module</code></pre>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>現在の日付と時刻を取得するプロパティは？</strong><br>
                                a) DateTime.Current<br>
                                b) DateTime.Now<br>
                                c) DateTime.Today<br>
                                d) DateTime.GetCurrent()
                            </li>
                            <li>
                                <strong>平方根を計算するMathクラスのメソッドは？</strong><br>
                                a) Math.Square()<br>
                                b) Math.Root()<br>
                                c) Math.Sqrt()<br>
                                d) Math.Power()
                            </li>
                            <li>
                                <strong>LINQでコレクションをフィルタリングする方法は？</strong><br>
                                a) Filter()<br>
                                b) Where()<br>
                                c) Select()<br>
                                d) Find()
                            </li>
                            <li>
                                <strong>ジェネリクスの主な利点は？</strong><br>
                                a) 実行速度の向上<br>
                                b) 型安全性の向上<br>
                                c) メモリ使用量の削減<br>
                                d) コードの短縮
                            </li>
                        </ol>
                        
                        <details>
                            <summary>解答を表示</summary>
                            <ol>
                                <li><strong>b) DateTime.Now</strong> - 現在の日付と時刻を取得します。</li>
                                <li><strong>c) Math.Sqrt()</strong> - 平方根を計算するメソッドです。</li>
                                <li><strong>b) Where()</strong> - 条件に合致する要素をフィルタリングします。</li>
                                <li><strong>b) 型安全性の向上</strong> - コンパイル時の型チェックにより型安全性が向上します。</li>
                            </ol>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">9.5 第9章のまとめ</h3>
                    
                    <div class="highlight">
                        <h5>この章で学んだこと</h5>
                        <ul>
                            <li><strong>DateTime</strong>: 日付・時刻の処理と計算</li>
                            <li><strong>Math</strong>: 数学関数による計算処理</li>
                            <li><strong>Random</strong>: 乱数生成とテストデータ作成</li>
                            <li><strong>LINQ</strong>: SQL風クエリによるデータ操作</li>
                            <li><strong>ジェネリクス</strong>: 型安全なコレクションとクラス</li>
                            <li><strong>.NETライブラリ</strong>: 豊富な機能による開発効率向上</li>
                        </ul>
                    </div>

                    <p>
                        第9章では、.NET Frameworkの豊富なライブラリを活用する方法を学習しました。これらのライブラリを効果的に使うことで、高品質なアプリケーションを効率的に開発できます。次の最終章では、これまで学んだ知識を統合した実践的なアプリケーション開発に取り組みます。
                    </p>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="vbnet-learning-material-8.html" class="btn btn-secondary">← 前の章: ファイル操作と文字列処理</a>
                        <a href="vbnet-learning-material-10.html" class="btn btn-primary">次の章: 実践的なアプリケーション開発 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>