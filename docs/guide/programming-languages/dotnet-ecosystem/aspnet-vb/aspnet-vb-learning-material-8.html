<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET（VB.NET）学習教材 第8章 - マスターページとナビゲーション</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- Custom CSS -->
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        .navbar {
            background-color: #512da8;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        .chapter-title {
            color: #512da8;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #512da8;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #673ab7;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        .quiz-container {
            background-color: #ede7f6;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #512da8;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .nav-link.active {
            background-color: #512da8 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>ASP.NET（VB.NET）学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-1.html">
                                第1章: ASP.NET Web Forms入門と開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-2.html">
                                第2章: Web FormsとWebコントロール
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-3.html">
                                第3章: イベント処理とPostBack
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-4.html">
                                第4章: データ検証とエラーハンドリング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-5.html">
                                第5章: 状態管理（Session、ViewState、Cache）
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-6.html">
                                第6章: データベース連携（ADO.NET）
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-7.html">
                                第7章: データバインドとGridView
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="aspnet-vb-learning-material-8.html">
                                第8章: マスターページとナビゲーション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-9.html">
                                第9章: セキュリティとメンバーシップ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="aspnet-vb-learning-material-10.html">
                                第10章: 実践的なWebアプリケーション開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第8章: マスターページとナビゲーション</h1>
                </div>

                <div id="chapter8">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">統一されたWebサイトの設計と実装</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>マスターページの概念と、Webサイト設計における重要性を理解する</li>
                            <li>コンテンツページとマスターページの関係と実装方法を習得する</li>
                            <li>サイトマップによるサイト構造の定義とメリットを学ぶ</li>
                            <li>メニューコントロールとTreeViewによるナビゲーション実装を理解する</li>
                            <li>ブレッドクラムナビゲーションとSiteMapPathの活用方法を習得する</li>
                            <li>レスポンシブデザインとモバイル対応の実装方法を学ぶ</li>
                        </ul>
                    </div>

                    <!-- セクション1: マスターページとは何か -->
                    <h3 class="section-title">8.1 マスターページとは何か</h3>
                    
                    <p><strong>マスターページ（Master Page）</strong>は、Webサイト全体で共通するレイアウト、デザイン、機能を定義するテンプレート機能です。これまでの学習では個々のページを独立して作成していましたが、実際のWebサイトでは複数のページで統一されたデザインと構造が必要です。</p>
                    
                    <div class="highlight">
                        <h6>マスターページが解決する課題</h6>
                        <p><strong>従来の問題：</strong></p>
                        <ul>
                            <li><strong>重複コード</strong>：ヘッダー、フッター、ナビゲーションが各ページで重複</li>
                            <li><strong>保守性の悪化</strong>：デザイン変更時に全ページの修正が必要</li>
                            <li><strong>一貫性の欠如</strong>：ページごとにレイアウトが微妙に異なる問題</li>
                            <li><strong>開発効率の低下</strong>：新規ページ作成時の作業量増大</li>
                        </ul>
                        
                        <p><strong>マスターページによる解決：</strong></p>
                        <ul>
                            <li><strong>共通部品の集約</strong>：ヘッダー、フッター、CSS、JavaScriptを一元管理</li>
                            <li><strong>容易な保守</strong>：マスターページの修正だけで全ページに反映</li>
                            <li><strong>デザインの統一</strong>：全ページで一貫したユーザーエクスペリエンス</li>
                            <li><strong>開発速度の向上</strong>：コンテンツ部分のみに集中できる</li>
                        </ul>
                    </div>

                    <!-- マスターページ構造図 -->
                    <div class="mermaid">
                        graph TD
                            A[Master Page<br/>共通レイアウト] --> B[Header<br/>ヘッダー部分]
                            A --> C[Navigation<br/>ナビゲーション]
                            A --> D[ContentPlaceHolder<br/>可変コンテンツ領域]
                            A --> E[Footer<br/>フッター部分]
                            
                            D --> F[Content Page 1<br/>ホームページ]
                            D --> G[Content Page 2<br/>商品一覧]
                            D --> H[Content Page 3<br/>お問い合わせ]
                    </div>

                    <!-- セクション2: マスターページの構造と理論 -->
                    <h3 class="section-title">8.2 マスターページの構造と理論</h3>
                    
                    <p>マスターページシステムは、<strong>テンプレートメソッドパターン</strong>というデザインパターンを実装しています。これは、全体の処理の流れ（アルゴリズムの骨格）を親クラス（マスターページ）で定義し、具体的な処理内容を子クラス（コンテンツページ）で実装する方法です。</p>

                    <div class="highlight">
                        <h6>マスターページシステムの重要概念</h6>
                        <ul>
                            <li><strong>ContentPlaceHolder</strong>：マスターページ内でコンテンツを配置する「プレースホルダー（場所取り）」</li>
                            <li><strong>Content</strong>：コンテンツページ内でContentPlaceHolderに配置される実際の内容</li>
                            <li><strong>継承関係</strong>：コンテンツページがマスターページを継承する関係</li>
                            <li><strong>レンダリング統合</strong>：実行時にマスターページとコンテンツページが統合されて最終HTMLを生成</li>
                        </ul>
                    </div>

                    <!-- 実習1: 基本的なマスターページの作成 -->
                    <div class="exercise-container">
                        <h5>実習 8-1: 基本的なマスターページの作成</h5>
                        <p>企業サイト用のマスターページを作成して、共通レイアウトの設計方法を学びましょう。</p>
                        
                        <h6>手順1: マスターページファイルの作成</h6>
                        <p>Visual Studioで新しい項目を追加 → 「マスターページ」を選択 → Site.masterとして作成</p>

                        <h6>Site.master ファイル</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ Master Language="VB" AutoEventWireup="false" CodeBehind="Site.master.vb" Inherits="CompanySite.Site" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head runat="server"&gt;
    &lt;meta charset="utf-8" /&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0" /&gt;
    &lt;title&gt;&lt;asp:ContentPlaceHolder ID="TitleContent" runat="server" /&gt; - 株式会社サンプル&lt;/title&gt;
    
    &lt;!-- Bootstrap CSS --&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    
    &lt;!-- Custom CSS --&gt;
    &lt;style&gt;
        .navbar-brand {
            font-weight: bold;
            font-size: 1.5rem;
        }
        .footer {
            background-color: #f8f9fa;
            padding: 2rem 0;
            margin-top: 3rem;
        }
        .main-content {
            min-height: 500px;
            padding: 2rem 0;
        }
    &lt;/style&gt;
    
    &lt;asp:ContentPlaceHolder ID="HeadContent" runat="server"&gt;
    &lt;/asp:ContentPlaceHolder&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;!-- ヘッダー --&gt;
        &lt;header&gt;
            &lt;nav class="navbar navbar-expand-lg navbar-dark bg-primary"&gt;
                &lt;div class="container"&gt;
                    &lt;a class="navbar-brand" href="Default.aspx"&gt;株式会社サンプル&lt;/a&gt;
                    
                    &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"&gt;
                        &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
                    &lt;/button&gt;
                    
                    &lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
                        &lt;ul class="navbar-nav ms-auto"&gt;
                            &lt;li class="nav-item"&gt;
                                &lt;a class="nav-link" href="Default.aspx"&gt;ホーム&lt;/a&gt;
                            &lt;/li&gt;
                            &lt;li class="nav-item"&gt;
                                &lt;a class="nav-link" href="About.aspx"&gt;会社概要&lt;/a&gt;
                            &lt;/li&gt;
                            &lt;li class="nav-item"&gt;
                                &lt;a class="nav-link" href="Products.aspx"&gt;製品・サービス&lt;/a&gt;
                            &lt;/li&gt;
                            &lt;li class="nav-item"&gt;
                                &lt;a class="nav-link" href="Contact.aspx"&gt;お問い合わせ&lt;/a&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/nav&gt;
        &lt;/header&gt;

        &lt;!-- メインコンテンツ --&gt;
        &lt;main class="main-content"&gt;
            &lt;div class="container"&gt;
                &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;
                &lt;/asp:ContentPlaceHolder&gt;
            &lt;/div&gt;
        &lt;/main&gt;

        &lt;!-- フッター --&gt;
        &lt;footer class="footer"&gt;
            &lt;div class="container"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-md-6"&gt;
                        &lt;h5&gt;株式会社サンプル&lt;/h5&gt;
                        &lt;p class="mb-0"&gt;〒100-0001 東京都千代田区千代田1-1-1&lt;/p&gt;
                        &lt;p&gt;TEL: 03-1234-5678 / FAX: 03-1234-5679&lt;/p&gt;
                    &lt;/div&gt;
                    &lt;div class="col-md-6 text-md-end"&gt;
                        &lt;p class="mb-0"&gt;&copy; 2025 株式会社サンプル All rights reserved.&lt;/p&gt;
                        &lt;asp:Label ID="lblLastUpdate" runat="server" CssClass="text-muted small"&gt;&lt;/asp:Label&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/footer&gt;
    &lt;/form&gt;

    &lt;!-- Bootstrap JavaScript --&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>

                        <h6>Site.master.vb（コードビハインド）</h6>
                        <pre class="code-block"><code class="language-vbnet">
Partial Class Site
    Inherits System.Web.UI.MasterPage

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        ' 最終更新日時を表示
        lblLastUpdate.Text = "最終更新: " & DateTime.Now.ToString("yyyy年MM月dd日 HH:mm")
    End Sub
    
    ' 子ページから呼び出し可能なパブリックメソッド
    Public Sub SetPageTitle(title As String)
        Page.Title = title & " - 株式会社サンプル"
    End Sub
    
    ' 子ページから現在のユーザー情報を表示する機能
    Public Sub ShowUserInfo(userName As String)
        ' 実装例：ヘッダーにユーザー名を表示するなど
        ' この機能は第9章のセキュリティで詳細実装
    End Sub
End Class</code></pre>

                        <h6>重要なポイント</h6>
                        <ul>
                            <li><strong>ContentPlaceHolder</strong>：TitleContent、HeadContent、MainContentの3つを定義</li>
                            <li><strong>レスポンシブデザイン</strong>：Bootstrap使用でモバイル対応</li>
                            <li><strong>SEO対応</strong>：適切なtitle要素とmeta要素</li>
                            <li><strong>保守性</strong>：CSSとJavaScriptの一元管理</li>
                        </ul>
                    </div>

                    <!-- セクション3: コンテンツページの実装 -->
                    <h3 class="section-title">8.3 コンテンツページの実装</h3>
                    
                    <p>マスターページを作成した後は、それを使用する<strong>コンテンツページ</strong>を作成します。コンテンツページは、マスターページで定義されたContentPlaceHolderに対応するContentコントロールを持ちます。</p>

                    <!-- 実習2: コンテンツページの作成 -->
                    <div class="exercise-container">
                        <h5>実習 8-2: マスターページを使用したコンテンツページの作成</h5>
                        <p>作成したマスターページを使用して、会社のホームページを作成してみましょう。</p>
                        
                        <h6>Default.aspx（ホームページ）</h6>
                        <pre class="code-block"><code class="language-html">&lt;%@ Page Title="ホーム" Language="VB" MasterPageFile="~/Site.master" AutoEventWireup="false" CodeBehind="Default.aspx.vb" Inherits="CompanySite.Default" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="TitleContent" Runat="Server"&gt;
    ホーム
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="HeadContent" Runat="Server"&gt;
    &lt;!-- このページ固有のCSS --&gt;
    &lt;style&gt;
        .hero-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 4rem 0;
            margin-bottom: 3rem;
            border-radius: 10px;
        }
        .feature-card {
            transition: transform 0.3s ease;
        }
        .feature-card:hover {
            transform: translateY(-5px);
        }
    &lt;/style&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content3" ContentPlaceHolderID="MainContent" Runat="Server"&gt;
    &lt;!-- ヒーローセクション --&gt;
    &lt;section class="hero-section text-center"&gt;
        &lt;div class="container"&gt;
            &lt;h1 class="display-4 fw-bold"&gt;革新的なソリューションで&lt;br&gt;お客様の成功をサポート&lt;/h1&gt;
            &lt;p class="lead"&gt;私たちは最新のテクノロジーと豊富な経験で、お客様のビジネス課題を解決します。&lt;/p&gt;
            &lt;asp:Button ID="btnContact" runat="server" Text="お問い合わせ" 
                        CssClass="btn btn-light btn-lg" PostBackUrl="~/Contact.aspx" /&gt;
        &lt;/div&gt;
    &lt;/section&gt;

    &lt;!-- サービス紹介 --&gt;
    &lt;section class="mb-5"&gt;
        &lt;div class="text-center mb-4"&gt;
            &lt;h2&gt;主なサービス&lt;/h2&gt;
            &lt;p class="text-muted"&gt;お客様のニーズに合わせた幅広いサービスを提供しています&lt;/p&gt;
        &lt;/div&gt;
        
        &lt;div class="row"&gt;
            &lt;div class="col-md-4 mb-4"&gt;
                &lt;div class="card feature-card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;i class="fas fa-code fa-3x text-primary"&gt;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;h4&gt;Webシステム開発&lt;/h4&gt;
                        &lt;p class="card-text"&gt;最新の技術スタックを使用した高品質なWebアプリケーション開発&lt;/p&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;div class="col-md-4 mb-4"&gt;
                &lt;div class="card feature-card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;i class="fas fa-mobile-alt fa-3x text-success"&gt;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;h4&gt;モバイルアプリ開発&lt;/h4&gt;
                        &lt;p class="card-text"&gt;iOS・Android対応のネイティブ・クロスプラットフォームアプリ開発&lt;/p&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            
            &lt;div class="col-md-4 mb-4"&gt;
                &lt;div class="card feature-card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;div class="mb-3"&gt;
                            &lt;i class="fas fa-shield-alt fa-3x text-warning"&gt;&lt;/i&gt;
                        &lt;/div&gt;
                        &lt;h4&gt;ITコンサルティング&lt;/h4&gt;
                        &lt;p class="card-text"&gt;システム設計からセキュリティ対策まで包括的なIT戦略をサポート&lt;/p&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/section&gt;

    &lt;!-- お知らせセクション --&gt;
    &lt;section&gt;
        &lt;h3&gt;最新のお知らせ&lt;/h3&gt;
        &lt;asp:GridView ID="gvNews" runat="server" CssClass="table table-hover" 
                      AutoGenerateColumns="False" ShowHeader="False"&gt;
            &lt;Columns&gt;
                &lt;asp:BoundField DataField="Date" DataFormatString="{0:MM/dd}" ItemStyle-Width="60px" ItemStyle-CssClass="text-muted" /&gt;
                &lt;asp:HyperLinkField DataNavigateUrlFields="NewsID" DataNavigateUrlFormatString="NewsDetail.aspx?id={0}" 
                                    DataTextField="Title" ItemStyle-CssClass="fw-bold" /&gt;
            &lt;/Columns&gt;
        &lt;/asp:GridView&gt;
        
        &lt;div class="text-end"&gt;
            &lt;asp:HyperLink ID="lnkAllNews" runat="server" NavigateUrl="~/News.aspx" CssClass="btn btn-outline-primary"&gt;
                すべてのお知らせを見る
            &lt;/asp:HyperLink&gt;
        &lt;/div&gt;
    &lt;/section&gt;
&lt;/asp:Content&gt;</code></pre>

                        <h6>Default.aspx.vb（コードビハインド）</h6>
                        <pre class="code-block"><code class="language-vbnet">
Partial Class _Default
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        If Not IsPostBack Then
            ' マスターページのメソッドを呼び出してタイトル設定
            Dim masterPage As Site = CType(Me.Master, Site)
            masterPage.SetPageTitle("ホーム")
            
            ' 最新のお知らせを読み込み
            LoadLatestNews()
        End If
    End Sub

    Private Sub LoadLatestNews()
        ' サンプルデータ（実際はデータベースから取得）
        Dim newsTable As New DataTable()
        newsTable.Columns.Add("NewsID", GetType(Integer))
        newsTable.Columns.Add("Date", GetType(Date))
        newsTable.Columns.Add("Title", GetType(String))
        
        newsTable.Rows.Add(1, DateTime.Now.AddDays(-1), "新サービス「クラウドソリューション」提供開始")
        newsTable.Rows.Add(2, DateTime.Now.AddDays(-3), "年末年始休業のお知らせ")
        newsTable.Rows.Add(3, DateTime.Now.AddDays(-7), "ISO27001認証取得のお知らせ")
        
        gvNews.DataSource = newsTable
        gvNews.DataBind()
    End Sub
End Class</code></pre>

                        <h6>実装のポイント</h6>
                        <ul>
                            <li><strong>MasterPageFile属性</strong>：使用するマスターページを指定</li>
                            <li><strong>Content要素</strong>：各ContentPlaceHolderに対応</li>
                            <li><strong>ページ固有CSS</strong>：HeadContentで個別スタイルを追加可能</li>
                            <li><strong>マスターページとの連携</strong>：型変換してマスターページのメソッド呼び出し</li>
                        </ul>
                    </div>

                    <!-- セクション4: サイトマップとナビゲーション -->
                    <h3 class="section-title">8.4 サイトマップとナビゲーション</h3>
                    
                    <p>大規模なWebサイトでは、サイト構造を体系的に管理し、ユーザーが迷わずに目的のページにたどり着けるナビゲーション機能が重要です。ASP.NETでは<strong>サイトマップ（Site Map）</strong>機能を使用して、サイト構造を定義し、自動的にナビゲーションコントロールを生成できます。</p>

                    <div class="highlight">
                        <h6>サイトマップシステムのメリット</h6>
                        <ul>
                            <li><strong>構造の可視化</strong>：サイト全体の構造を一元的に定義・管理</li>
                            <li><strong>自動ナビゲーション</strong>：メニューやブレッドクラムを自動生成</li>
                            <li><strong>SEO効果</strong>：検索エンジンがサイト構造を理解しやすい</li>
                            <li><strong>保守性向上</strong>：ページ追加時の作業を大幅に削減</li>
                            <li><strong>アクセス制御</strong>：セキュリティロール連携でメニュー表示制御</li>
                        </ul>
                    </div>

                    <!-- 実習3: サイトマップの実装 -->
                    <div class="exercise-container">
                        <h5>実習 8-3: サイトマップとメニューコントロールの実装</h5>
                        <p>サイトマップを定義し、自動的にナビゲーションメニューを生成する仕組みを実装してみましょう。</p>
                        
                        <h6>手順1: Web.sitemap ファイルの作成</h6>
                        <p>プロジェクトのルートに Web.sitemap ファイルを追加します。</p>

                        <pre class="code-block"><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;siteMap xmlns="http://schemas.microsoft.com/AspNet/SiteMap-File-1.0"&gt;
  &lt;siteMapNode url="~/Default.aspx" title="ホーム" description="会社のトップページ"&gt;
    
    &lt;siteMapNode url="~/About.aspx" title="会社概要" description="会社の基本情報"&gt;
      &lt;siteMapNode url="~/About/History.aspx" title="会社沿革" description="会社の歴史" /&gt;
      &lt;siteMapNode url="~/About/Organization.aspx" title="組織図" description="組織構成" /&gt;
      &lt;siteMapNode url="~/About/Access.aspx" title="アクセス" description="所在地・アクセス方法" /&gt;
    &lt;/siteMapNode&gt;
    
    &lt;siteMapNode url="~/Products.aspx" title="製品・サービス" description="提供する製品とサービス"&gt;
      &lt;siteMapNode url="~/Products/WebSystems.aspx" title="Webシステム開発" description="Webシステム開発サービス" /&gt;
      &lt;siteMapNode url="~/Products/MobileApps.aspx" title="モバイルアプリ開発" description="スマホアプリ開発サービス" /&gt;
      &lt;siteMapNode url="~/Products/Consulting.aspx" title="ITコンサルティング" description="IT戦略コンサルティング" /&gt;
    &lt;/siteMapNode&gt;
    
    &lt;siteMapNode url="~/News.aspx" title="お知らせ" description="最新のお知らせ・ニュース" /&gt;
    
    &lt;siteMapNode url="~/Support.aspx" title="サポート" description="お客様サポート"&gt;
      &lt;siteMapNode url="~/Support/FAQ.aspx" title="よくある質問" description="FAQ" /&gt;
      &lt;siteMapNode url="~/Support/Downloads.aspx" title="ダウンロード" description="資料ダウンロード" /&gt;
    &lt;/siteMapNode&gt;
    
    &lt;siteMapNode url="~/Contact.aspx" title="お問い合わせ" description="お問い合わせフォーム" /&gt;
    
  &lt;/siteMapNode&gt;
&lt;/siteMap&gt;</code></pre>

                        <h6>手順2: web.config でサイトマップを有効化</h6>
                        <pre class="code-block"><code class="language-xml">&lt;system.web&gt;
  &lt;!-- サイトマッププロバイダーの設定 --&gt;
  &lt;siteMap enabled="true"&gt;
    &lt;providers&gt;
      &lt;clear /&gt;
      &lt;add name="AspNetXmlSiteMapProvider" 
           type="System.Web.XmlSiteMapProvider" 
           siteMapFile="Web.sitemap" 
           securityTrimmingEnabled="true" /&gt;
    &lt;/providers&gt;
  &lt;/siteMap&gt;
&lt;/system.web&gt;</code></pre>

                        <h6>手順3: マスターページにMenuコントロールを追加</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- Site.master のナビゲーション部分を更新 --&gt;
&lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
    &lt;asp:Menu ID="NavigationMenu" runat="server" 
              Orientation="Horizontal" 
              CssClass="navbar-nav ms-auto"
              StaticMenuItemStyle-CssClass="nav-item"
              StaticSubMenuIndent="0"
              MaximumDynamicDisplayLevels="2"
              DataSourceID="SiteMapDataSource1"&gt;
    &lt;/asp:Menu&gt;
    
    &lt;asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" /&gt;
&lt;/div&gt;</code></pre>

                        <h6>手順4: ブレッドクラムナビゲーションの追加</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- マスターページのメインコンテンツ部分に追加 --&gt;
&lt;main class="main-content"&gt;
    &lt;div class="container"&gt;
        &lt;!-- ブレッドクラムナビゲーション --&gt;
        &lt;nav aria-label="breadcrumb"&gt;
            &lt;asp:SiteMapPath ID="SiteMapPath1" runat="server" 
                             CssClass="breadcrumb"
                             CurrentNodeStyle-CssClass="breadcrumb-item active"
                             NodeStyle-CssClass="breadcrumb-item"
                             RenderCurrentNodeAsLink="False"
                             PathSeparator=""&gt;
                &lt;PathSeparatorTemplate&gt;
                    &lt;span class="breadcrumb-item"&gt;&amp;gt;&lt;/span&gt;
                &lt;/PathSeparatorTemplate&gt;
            &lt;/asp:SiteMapPath&gt;
        &lt;/nav&gt;
        
        &lt;asp:ContentPlaceHolder ID="MainContent" runat="server"&gt;
        &lt;/asp:ContentPlaceHolder&gt;
    &lt;/div&gt;
&lt;/main&gt;</code></pre>

                        <h6>期待される効果</h6>
                        <ul>
                            <li><strong>自動メニュー生成</strong>：Web.sitemapの内容に基づいてナビゲーションメニューが自動生成</li>
                            <li><strong>階層構造の表現</strong>：ドロップダウンメニューで子ページを表示</li>
                            <li><strong>現在位置の表示</strong>：ブレッドクラムで現在のページ位置を明示</li>
                            <li><strong>SEO向上</strong>：検索エンジンがサイト構造を適切に認識</li>
                        </ul>
                    </div>

                    <!-- セクション5: レスポンシブデザインと実践的な考慮事項 -->
                    <h3 class="section-title">8.5 レスポンシブデザインと実践的な考慮事項</h3>
                    
                    <p>現代のWebサイトでは、PC、タブレット、スマートフォンなど様々なデバイスに対応する<strong>レスポンシブデザイン</strong>が必須です。マスターページの設計時から、これらの要件を考慮する必要があります。</p>

                    <div class="highlight">
                        <h6>レスポンシブデザインの設計原則</h6>
                        <ul>
                            <li><strong>モバイルファースト</strong>：最小画面から設計を開始</li>
                            <li><strong>柔軟なグリッド</strong>：固定幅ではなく相対的な配置</li>
                            <li><strong>画像の最適化</strong>：デバイスに応じた画像サイズ</li>
                            <li><strong>タッチ操作対応</strong>：指で操作しやすいボタンサイズ</li>
                            <li><strong>パフォーマンス重視</strong>：モバイル環境での高速読み込み</li>
                        </ul>
                    </div>

                    <!-- モバイル対応の実装例 -->
                    <div class="exercise-container">
                        <h5>実習 8-4: モバイル対応マスターページの改良</h5>
                        <p>既存のマスターページをモバイル対応に改良し、実践的な企業サイトレベルに仕上げましょう。</p>
                        
                        <h6>改良版 Site.master のCSSセクション</h6>
                        <pre class="code-block"><code class="language-css">/* レスポンシブデザイン用CSS */
&lt;style&gt;
    /* 基本レイアウト */
    .navbar-brand {
        font-weight: bold;
        font-size: 1.5rem;
    }
    
    /* フッター */
    .footer {
        background-color: #f8f9fa;
        padding: 2rem 0;
        margin-top: 3rem;
    }
    
    /* メインコンテンツ */
    .main-content {
        min-height: 500px;
        padding: 2rem 0;
    }
    
    /* モバイル対応 */
    @media (max-width: 768px) {
        .navbar-brand {
            font-size: 1.2rem;
        }
        
        .main-content {
            padding: 1rem 0;
        }
        
        .hero-section {
            padding: 2rem 0 !important;
        }
        
        .hero-section h1 {
            font-size: 1.8rem !important;
        }
        
        /* ブレッドクラムをモバイルで簡略化 */
        .breadcrumb {
            font-size: 0.8rem;
            padding: 0.5rem 0;
        }
    }
    
    /* タブレット対応 */
    @media (min-width: 768px) and (max-width: 1024px) {
        .container {
            max-width: 95%;
        }
    }
    
    /* プリント対応 */
    @media print {
        .navbar, .footer, .breadcrumb {
            display: none !important;
        }
        
        .main-content {
            padding: 0 !important;
        }
    }
&lt;/style&gt;</code></pre>

                        <h6>アクセシビリティ対応の追加</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- アクセシビリティ向上のための要素追加 --&gt;
&lt;nav class="navbar navbar-expand-lg navbar-dark bg-primary" role="navigation" aria-label="メインナビゲーション"&gt;
    &lt;div class="container"&gt;
        &lt;a class="navbar-brand" href="Default.aspx" aria-label="ホームページへ戻る"&gt;株式会社サンプル&lt;/a&gt;
        
        &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                data-bs-target="#navbarNav" aria-controls="navbarNav" 
                aria-expanded="false" aria-label="ナビゲーションメニューを開く"&gt;
            &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
        &lt;/button&gt;
        
        &lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
            &lt;asp:Menu ID="NavigationMenu" runat="server" 
                      Orientation="Horizontal" 
                      CssClass="navbar-nav ms-auto"
                      StaticMenuItemStyle-CssClass="nav-item"
                      DataSourceID="SiteMapDataSource1"
                      AccessKey="M"
                      TabIndex="1"&gt;
            &lt;/asp:Menu&gt;
            
            &lt;asp:SiteMapDataSource ID="SiteMapDataSource1" runat="server" /&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/nav&gt;</code></pre>

                        <h6>パフォーマンス最適化の実装</h6>
                        <pre class="code-block"><code class="language-vbnet">
' Site.master.vb にパフォーマンス最適化機能を追加
Partial Class Site
    Inherits System.Web.UI.MasterPage

    Protected Sub Page_Load(sender As Object, e As EventArgs) Handles Me.Load
        ' ViewState最適化
        If Not IsPostBack Then
            OptimizePerformance()
        End If
        
        ' 最終更新日時を表示
        lblLastUpdate.Text = "最終更新: " & DateTime.Now.ToString("yyyy年MM月dd日 HH:mm")
    End Sub
    
    Private Sub OptimizePerformance()
        ' 不要なViewStateを無効化
        Page.EnableViewState = False
        
        ' 出力キャッシュの設定（必要に応じて）
        Response.Cache.SetCacheability(HttpCacheability.ServerAndPrivate)
        Response.Cache.SetExpires(DateTime.Now.AddMinutes(30))
        
        ' 圧縮の有効化（IIS設定と連携）
        Response.Filter = New GZipStream(Response.Filter, CompressionMode.Compress)
    End Sub
    
    ' SEO対応のためのメタタグ設定メソッド
    Public Sub SetMetaTags(description As String, keywords As String)
        Dim metaDesc As New HtmlMeta()
        metaDesc.Name = "description"
        metaDesc.Content = description
        Page.Header.Controls.Add(metaDesc)
        
        Dim metaKey As New HtmlMeta()
        metaKey.Name = "keywords"
        metaKey.Content = keywords
        Page.Header.Controls.Add(metaKey)
    End Sub
End Class</code></pre>

                        <h6>実装の効果</h6>
                        <ul>
                            <li><strong>マルチデバイス対応</strong>：PC、タブレット、スマホで最適な表示</li>
                            <li><strong>アクセシビリティ</strong>：スクリーンリーダーや音声ブラウザに対応</li>
                            <li><strong>SEO最適化</strong>：検索エンジンに優しい構造</li>
                            <li><strong>パフォーマンス向上</strong>：高速読み込みとキャッシュ活用</li>
                        </ul>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>マスターページの目的と効果</strong>：マスターページを使用しない従来の開発方法と比較して、マスターページシステムがもたらす具体的なメリットを5つ説明してください。</li>
                            
                            <li><strong>ContentPlaceHolderの設計</strong>：効果的なマスターページを設計するために、どのようなContentPlaceHolderを配置すべきか、その理由と共に説明してください。</li>
                            
                            <li><strong>サイトマップの活用</strong>：Web.sitemapファイルを使用することで実現できる機能を4つ挙げ、それぞれがWebサイト運営にもたらす利点を説明してください。</li>
                            
                            <li><strong>レスポンシブデザイン</strong>：マスターページでレスポンシブデザインを実装する際の重要な考慮事項を3つ説明し、具体的な実装方法を示してください。</li>
                            
                            <li><strong>パフォーマンス最適化</strong>：マスターページを使用したWebサイトのパフォーマンスを向上させるための技術的手法を5つ説明してください。</li>
                        </ol>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="aspnet-vb-learning-material-7.html" class="btn btn-secondary">← 第7章: データバインドとGridView</a>
                        <a href="aspnet-vb-learning-material-9.html" class="btn btn-primary">第9章: セキュリティとメンバーシップ →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>