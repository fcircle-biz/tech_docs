<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>Ruby入門学習教材 第9章 - ファイルの読み書き</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Ruby Red カラーテーマ
                        primary: {
                            50: '#fef2f2',
                            100: '#fee2e2',
                            200: '#fecaca',
                            300: '#fca5a5',
                            400: '#f87171',
                            500: '#ef4444',
                            600: '#dc2626',
                            700: '#b91c1c',
                            800: '#991b1b',
                            900: '#7f1d1d',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fas fa-gem text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">Ruby入門学習教材</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-code text-[9px]"></i>
                                <span>プログラミング言語</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約14時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="#" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="#" class="hover:text-primary-600 transition-colors">Ruby入門</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第9章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                     bg-primary-100 text-primary-700">
                            第9章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 1時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">ファイルの読み書き - データを保存・読み込みしよう</h1>
                    <p class="text-slate-600">テキストファイルやCSVファイルの読み込みと書き込み方法を学び、プログラムで作成したデータを保存・再利用する実用的な技術を習得しましょう。</p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200
                            rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ファイル操作の基本概念と、なぜデータを保存する必要があるのかを理解する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>File.readとFile.writeを使ったシンプルなファイル読み書きの方法を学ぶ</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>File.openとブロック構文を使った安全なファイル操作を習得する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>CSVファイルの読み込みと書き込みを実践し、実用的なデータ処理を行う</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション1: ファイル操作とは？ -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.1 ファイル操作とは？なぜ必要なのか
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        これまで学んできたプログラムは、実行するたびに変数の値がリセットされていました。たとえば、ユーザーが入力した名前や、計算した結果は、<strong class="text-slate-800">プログラムを終了すると消えてしまいます</strong>。
                    </p>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        しかし、実用的なプログラムでは「前回の結果を保存しておきたい」「大量のデータを読み込みたい」という場面がたくさんあります。そこで登場するのが<strong class="text-slate-800">ファイル操作</strong>です。
                    </p>

                    <div class="my-6">
                        <div class="mermaid">
flowchart LR
    A([プログラム実行]) --> B{データを保存？}
    B -->|しない| C[プログラム終了で<br/>データ消失]
    B -->|する| D[ファイルに書き込み]
    D --> E[プログラム終了]
    E --> F([次回起動])
    F --> G[ファイルから読み込み]
    G --> H[データを再利用]

    style A fill:#fee2e2
    style C fill:#fecaca
    style D fill:#d1fae5
    style H fill:#d1fae5
                        </div>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-emerald-900 font-medium break-words">ファイル操作でできること</p>
                                <p class="text-emerald-800 text-sm mt-1 break-words">
                                    ファイルに保存すれば、プログラムを終了しても データが残ります。また、Excelファイルやテキストファイルなど、他のアプリケーションで作成したデータも読み込めます。
                                </p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">ファイル操作の活用例</h3>
                    <div class="space-y-3 my-6">
                        <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
                            <h4 class="font-semibold text-slate-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-list text-primary-500"></i>
                                1. ToDoリストアプリ
                            </h4>
                            <p class="text-slate-600 text-sm">
                                ユーザーが入力したタスクをファイルに保存し、次回起動時に読み込んで表示します。
                            </p>
                        </div>

                        <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
                            <h4 class="font-semibold text-slate-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-chart-bar text-primary-500"></i>
                                2. データ分析プログラム
                            </h4>
                            <p class="text-slate-600 text-sm">
                                CSVファイルに保存された売上データを読み込んで、集計・分析を行います。
                            </p>
                        </div>

                        <div class="bg-slate-50 border border-slate-200 rounded-lg p-4">
                            <h4 class="font-semibold text-slate-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-cog text-primary-500"></i>
                                3. 設定ファイルの保存
                            </h4>
                            <p class="text-slate-600 text-sm">
                                アプリケーションの設定（言語、テーマなど）をファイルに保存し、次回起動時に復元します。
                            </p>
                        </div>
                    </div>
                </section>

                <!-- セクション2: File.readでファイルを読み込む -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.2 File.read - ファイル全体を一度に読み込む
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        Rubyでは、<code class="bg-slate-100 px-2 py-1 rounded text-sm">File.read</code>メソッドを使うと、ファイル全体の内容を一度に読み込むことができます。
                    </p>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">基本的な使い方</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">read_example.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイル全体を読み込む
content = File.read("message.txt")
puts content</code></pre>
                    </div>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        このコードは、<code class="bg-slate-100 px-2 py-1 rounded text-sm">message.txt</code>という名前のファイルの内容を読み込み、変数<code class="bg-slate-100 px-2 py-1 rounded text-sm">content</code>に格納します。
                    </p>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">ファイルの場所（パス）について</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    ファイル名だけを指定した場合、Rubyプログラムと同じフォルダにあるファイルを探します。別のフォルダにあるファイルを読み込む場合は、フルパス（絶対パス）を指定します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 実習9-1 -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実習 9-1: テキストファイルを読み込んでみよう</h3>
                            <p class="text-purple-900 mb-4 break-words">まずは、簡単なテキストファイルを作成して、それを読み込むプログラムを書いてみましょう。</p>
                            <h4 class="font-medium text-purple-800 mb-2 break-words">手順</h4>
                            <ol class="space-y-3 mb-4">
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                    <span class="flex-1 min-w-0 break-words">メモ帳などで「greeting.txt」というファイルを作成し、「こんにちは、Ruby!」と書いて保存します</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                    <span class="flex-1 min-w-0 break-words">同じフォルダに以下のRubyプログラムを作成します</span>
                                </li>
                            </ol>

                            <div class="code-block-wrapper my-4">
                                <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                                    <span class="text-slate-400 text-sm">read_greeting.rb</span>
                                    <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                            onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># greeting.txtの内容を読み込む
message = File.read("greeting.txt")

# 読み込んだ内容を表示
puts "ファイルの内容:"
puts message</code></pre>
                            </div>

                            <ol class="space-y-3" start="3">
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                    <span class="flex-1 min-w-0 break-words">プログラムを実行して、「こんにちは、Ruby!」と表示されることを確認します</span>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- セクション3: File.writeでファイルに書き込む -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.3 File.write - ファイルにデータを書き込む
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        今度は、プログラムで作成したデータをファイルに保存してみましょう。<code class="bg-slate-100 px-2 py-1 rounded text-sm">File.write</code>メソッドを使うと、簡単にファイルへ書き込みができます。
                    </p>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">基本的な使い方</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">write_example.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルにデータを書き込む
File.write("output.txt", "これはRubyで書き込んだテキストです。")

puts "ファイルに書き込みました！"</code></pre>
                    </div>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        このコードを実行すると、<code class="bg-slate-100 px-2 py-1 rounded text-sm">output.txt</code>というファイルが作成され（または既存ファイルが上書きされ）、指定した文字列が書き込まれます。
                    </p>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-red-900 font-medium break-words">上書きに注意</p>
                                <p class="text-red-800 text-sm mt-1 break-words">
                                    File.writeは既存のファイルを上書きします。元の内容は消えてしまうので注意してください。追記したい場合は、後述するFile.openの追記モードを使います。
                                </p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">複数行の書き込み</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        複数行のテキストを書き込む場合は、改行文字<code class="bg-slate-100 px-2 py-1 rounded text-sm">\n</code>を使います。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">multiline_write.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># 複数行のテキストを書き込む
text = "1行目のテキスト\n2行目のテキスト\n3行目のテキスト"
File.write("multiline.txt", text)

puts "複数行を書き込みました！"</code></pre>
                    </div>
                </section>

                <!-- 実習9-2 -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実習 9-2: メモ帳プログラムを作ろう</h3>
                            <p class="text-purple-900 mb-4 break-words">ユーザーの入力を受け取って、ファイルに保存するシンプルなメモ帳プログラムを作成してみましょう。</p>

                            <div class="code-block-wrapper my-4">
                                <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                                    <span class="text-slate-400 text-sm">memo.rb</span>
                                    <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                            onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ユーザーからメモを受け取る
puts "メモを入力してください:"
memo = gets.chomp

# ファイルに保存
File.write("my_memo.txt", memo)

puts "メモを保存しました！"

# 保存した内容を確認
puts "\n保存した内容:"
puts File.read("my_memo.txt")</code></pre>
                            </div>

                            <p class="text-purple-900 text-sm mt-3 break-words">
                                このプログラムを実行し、何か入力してEnterを押してみましょう。同じフォルダに「my_memo.txt」が作成されます。
                            </p>
                        </div>
                    </div>
                </div>

                <!-- セクション4: File.openとブロック構文 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.4 File.open - より柔軟なファイル操作
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-2 py-1 rounded text-sm">File.open</code>を使うと、ファイルを開いて、読み込みや書き込みを自由に行うことができます。特に、<strong class="text-slate-800">ブロック構文</strong>を使うと、ファイルを自動的に閉じてくれるので安全です。
                    </p>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">読み込みモード（"r"）</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">open_read.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルを読み込みモードで開く
File.open("greeting.txt", "r") do |file|
  content = file.read
  puts content
end
# ブロックを抜けると、自動的にファイルが閉じられる</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">書き込みモード（"w"）</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">open_write.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルを書き込みモードで開く
File.open("output.txt", "w") do |file|
  file.puts "1行目"
  file.puts "2行目"
  file.puts "3行目"
end</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">追記モード（"a"）</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        既存のファイルに内容を追加したい場合は、追記モード<code class="bg-slate-100 px-2 py-1 rounded text-sm">"a"</code>を使います。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">append.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルに追記する（元の内容は残る）
File.open("log.txt", "a") do |file|
  file.puts "新しいログエントリ"
end</code></pre>
                    </div>

                    <div class="my-6">
                        <div class="mermaid">
flowchart TD
    A([File.open]) --> B{モード選択}
    B -->|r: 読み込み| C[既存ファイルを読む]
    B -->|w: 書き込み| D[新規作成 OR 上書き]
    B -->|a: 追記| E[既存ファイルに追加]

    style A fill:#fee2e2
    style C fill:#dbeafe
    style D fill:#fecaca
    style E fill:#d1fae5
                        </div>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-emerald-900 font-medium break-words">ブロック構文の利点</p>
                                <p class="text-emerald-800 text-sm mt-1 break-words">
                                    File.openでブロック構文を使うと、ブロックを抜けた時点で自動的にファイルが閉じられます。ファイルを開いたまま忘れてしまうミスを防げるので、推奨される書き方です。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション5: 行ごとにファイルを読み込む -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.5 行ごとにファイルを読み込む
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        大きなファイルを扱う場合や、1行ずつ処理したい場合は、<code class="bg-slate-100 px-2 py-1 rounded text-sm">each_line</code>メソッドを使うと便利です。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">read_lines.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルを1行ずつ読み込む
File.open("data.txt", "r") do |file|
  file.each_line do |line|
    puts "行の内容: #{line}"
  end
end</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">実用例：特定の行だけを抽出する</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">filter_lines.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># "Ruby"という単語を含む行だけを抽出する
File.open("article.txt", "r") do |file|
  file.each_line do |line|
    if line.include?("Ruby")
      puts line
    end
  end
end</code></pre>
                    </div>
                </section>

                <!-- セクション6: CSVファイルの読み書き -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.6 CSVファイルの読み書き
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        CSV（Comma-Separated Values）は、データをカンマで区切って保存する形式です。ExcelやGoogleスプレッドシートでも扱えるため、実務でよく使われます。RubyにはCSVライブラリが標準で用意されています。
                    </p>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">CSVファイルを読み込む</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">read_csv.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># CSVライブラリを読み込む
require 'csv'

# CSVファイルを読み込む
CSV.foreach("data.csv") do |row|
  puts "名前: #{row[0]}, 年齢: #{row[1]}"
end</code></pre>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">CSVファイルに書き込む</h3>
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">write_csv.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># CSVライブラリを読み込む
require 'csv'

# CSVファイルに書き込む
CSV.open("members.csv", "w") do |csv|
  csv << ["名前", "年齢", "職業"]  # ヘッダー行
  csv << ["田中太郎", 25, "エンジニア"]
  csv << ["佐藤花子", 30, "デザイナー"]
  csv << ["鈴木一郎", 28, "営業"]
end

puts "CSVファイルを作成しました！"</code></pre>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">requireとは？</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    <code class="bg-blue-100 px-1 rounded">require</code>は、外部ライブラリを読み込むための命令です。CSVライブラリはRubyに標準で含まれているので、インストール不要で使えます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 実習9-3 -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実習 9-3: 成績管理プログラムを作ろう</h3>
                            <p class="text-purple-900 mb-4 break-words">生徒の名前と点数をCSVファイルに保存し、そのファイルを読み込んで平均点を計算するプログラムを作成してみましょう。</p>

                            <div class="code-block-wrapper my-4">
                                <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                                    <span class="text-slate-400 text-sm">grade_manager.rb</span>
                                    <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                            onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                </div>
                                <pre class="!mt-0 !rounded-t-none"><code class="language-ruby">require 'csv'

# 成績データをCSVに保存
CSV.open("grades.csv", "w") do |csv|
  csv << ["名前", "点数"]
  csv << ["田中", 85]
  csv << ["佐藤", 92]
  csv << ["鈴木", 78]
  csv << ["高橋", 88]
end

puts "成績データを保存しました。"

# CSVファイルを読み込んで平均点を計算
total = 0
count = 0

CSV.foreach("grades.csv", headers: true) do |row|
  total += row["点数"].to_i
  count += 1
end

average = total / count
puts "平均点: #{average}点"</code></pre>
                            </div>

                            <p class="text-purple-900 text-sm mt-3 break-words">
                                <code class="bg-purple-100 px-1 rounded">headers: true</code>を指定すると、1行目をヘッダーとして扱い、列名でデータにアクセスできます。
                            </p>
                        </div>
                    </div>
                </div>

                <!-- セクション7: エラー処理の基本 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        9.7 エラー処理の基本 - ファイルが存在しない場合
                    </h2>

                    <p class="text-slate-600 leading-relaxed mb-4">
                        ファイル操作では、「指定したファイルが存在しない」というエラーが起きることがよくあります。事前にファイルの存在を確認することで、エラーを防ぐことができます。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">check_file.rb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors"
                                    onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-ruby"># ファイルの存在を確認してから読み込む
filename = "data.txt"

if File.exist?(filename)
  content = File.read(filename)
  puts content
else
  puts "エラー: #{filename} が見つかりません。"
end</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-emerald-900 font-medium break-words">ユーザーフレンドリーなエラー処理</p>
                                <p class="text-emerald-800 text-sm mt-1 break-words">
                                    ファイルが存在しない場合に分かりやすいメッセージを表示することで、ユーザーが何をすれば良いか理解しやすくなります。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- トラブルシューティング -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl overflow-hidden mb-6">
                    <div class="bg-orange-100 px-6 py-3 border-b border-orange-200">
                        <h3 class="font-semibold text-orange-800 flex items-center gap-2">
                            <i class="fas fa-tools"></i>
                            トラブルシューティング
                        </h3>
                    </div>
                    <div class="p-6 space-y-4">
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">「No such file or directory」エラーが出る</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900">
                                <p class="mb-2"><strong>原因:</strong> 指定したファイルが見つかりません。</p>
                                <p><strong>解決方法:</strong> ①ファイル名のスペルミスを確認、②Rubyプログラムと同じフォルダにファイルがあるか確認、③File.exist?で事前チェック</p>
                            </div>
                        </details>

                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">日本語が文字化けする</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900">
                                <p class="mb-2"><strong>原因:</strong> ファイルの文字エンコーディングが異なります。</p>
                                <p><strong>解決方法:</strong> File.openの第3引数でエンコーディングを指定します。<code class="bg-orange-100 px-1 rounded">File.open("file.txt", "r", encoding: "UTF-8")</code></p>
                            </div>
                        </details>

                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">ファイルに書き込んだのに内容が反映されない</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900">
                                <p class="mb-2"><strong>原因:</strong> ファイルが正しく閉じられていない可能性があります。</p>
                                <p><strong>解決方法:</strong> File.openではブロック構文を使うと自動的に閉じられます。または、File.writeを使うと確実に書き込まれます。</p>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200
                            rounded-xl p-5 my-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-4">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. File.readとFile.writeの違いは何ですか？それぞれ何をするメソッドか説明してください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            File.readはファイルの内容を読み込むメソッドで、ファイル全体を文字列として取得します。File.writeはファイルにデータを書き込むメソッドで、指定した文字列をファイルに保存します（既存ファイルは上書きされます）。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. File.openの書き込みモード（"w"）と追記モード（"a"）の違いを説明してください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            書き込みモード（"w"）は既存のファイルを上書きします（元の内容は消える）。追記モード（"a"）は既存のファイルの末尾に新しい内容を追加します（元の内容は残る）。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. CSVファイルを扱うために必要な命令は何ですか？また、その理由も説明してください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            <code class="bg-blue-200 px-1 rounded">require 'csv'</code>が必要です。これは、RubyのCSVライブラリを読み込むための命令で、CSV.foreachやCSV.openなどのCSV専用メソッドを使えるようにします。
                                        </p>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 章のまとめ -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        この章のまとめ
                    </h2>

                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-check text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-3">学んだこと</h3>
                                <ul class="space-y-3 text-emerald-900">
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <strong>ファイル操作の重要性：</strong>プログラムで作成したデータを保存し、次回も使える形で残せる
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <strong>File.readとFile.write：</strong>シンプルにファイルを読み書きできる便利なメソッド
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <strong>File.openとブロック構文：</strong>柔軟なファイル操作が可能で、自動的にファイルが閉じられる安全な書き方
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <strong>CSVファイルの扱い方：</strong>requireでライブラリを読み込み、実務でよく使うCSVデータを処理できる
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <p class="text-slate-600 leading-relaxed">
                        次の章では、Rubyの重要な概念である「クラスとオブジェクト」について学びます。プログラムをより整理された形で書けるようになり、Rubyらしいコードが書けるようになります。
                    </p>
                </section>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="ruby-beginner-learning-material-08.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600 transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">第8章: メソッドの基本</span>
                        </div>
                    </a>
                    <a href="ruby-beginner-learning-material-10.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">第10章: クラスとオブジェクト入門</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="#" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
