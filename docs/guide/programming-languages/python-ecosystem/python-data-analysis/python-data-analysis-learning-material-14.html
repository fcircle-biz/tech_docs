<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>Pythonデータ分析入門 第14章 - グラフのカスタマイズと見栄えの向上</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Python - Blue
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fab fa-python text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">Pythonデータ分析入門</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-chart-bar text-[9px]"></i>
                                <span>データ分析</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約23時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="https://fcircle-biz.github.io/tech_docs/guide/programming-languages/python-ecosystem/python-data-analysis/" class="hover:text-primary-600 transition-colors">Pythonデータ分析入門</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第14章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-700">
                            第14章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 約1時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">
                        グラフのカスタマイズと見栄えの向上
                    </h1>
                    <p class="text-slate-600">
                        グラフの色・フォント・レイアウトを調整して、プレゼンテーションやレポートに使える品質のグラフを作成する方法を学びます。日本語フォントの設定方法や、スタイルシートを活用したグラフの統一感の出し方も解説します。
                    </p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-xl p-5 mb-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>色・線種・マーカーのカスタマイズ方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>日本語フォントの設定方法（文字化け対策）</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>スタイルシート（plt.style）を活用したグラフの統一デザイン</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>グラフの保存（savefig）とファイル形式の選択</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>tight_layout・subplots_adjustによるレイアウト調整</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション 14.1 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.1 カスタマイズの重要性
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        前章まででグラフの「種類」を使い分けることを学びました。この章では、グラフの「見た目」を整えることを学びます。データの意味は正しく伝わっても、見づらいグラフでは相手に伝わりません。
                    </p>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        特に業務でレポートやプレゼン資料を作る場面では、グラフの品質が説得力に直結します。適切な色使い・フォント・レイアウトの調整は、データを「正確に伝える」だけでなく「わかりやすく伝える」ために不可欠なスキルです。
                    </p>

                    <!-- カスタマイズ要素の概観図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-sitemap text-primary-500"></i>
                            グラフカスタマイズの主な要素
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph Style["見た目の設定"]
        C1["色（color）"]
        C2["線種（linestyle）"]
        C3["マーカー（marker）"]
        C4["フォント・文字サイズ"]
    end

    subgraph Layout["レイアウトの設定"]
        L1["Figure サイズ（figsize）"]
        L2["余白調整（tight_layout）"]
        L3["グリッド線（grid）"]
        L4["軸の範囲（xlim / ylim）"]
    end

    subgraph Output["出力・保存"]
        O1["DPI（解像度）"]
        O2["ファイル形式（PNG / PDF / SVG）"]
        O3["savefig による保存"]
    end

    style C1 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style C2 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style C3 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style C4 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style L1 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style L2 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style L3 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style L4 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style O1 fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
    style O2 fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
    style O3 fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
                        </div>
                    </div>
                </section>

                <!-- セクション 14.2 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.2 色・線種・マーカーのカスタマイズ
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        matplotlibでは、グラフの各要素を細かく指定できます。色・線の種類・データ点のマーカーを組み合わせて、見やすいグラフを作りましょう。
                    </p>

                    <h3 class="text-base font-semibold text-slate-700 mb-3">色の指定方法</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        matplotlibでは、色を以下のいずれかの形式で指定できます。
                    </p>

                    <!-- 色の指定方法テーブル -->
                    <div class="overflow-x-auto mb-6">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-primary-50">
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">指定方法</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">例</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">説明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-slate-700">色名（英語）</td>
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">'red'</code>, <code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">'steelblue'</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">CSS色名と同様に使用可能</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-slate-700">HEXコード</td>
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">'#3b82f6'</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">Webデザインと同じ16進数カラーコード</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-slate-700">RGBタプル</td>
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">(0.2, 0.5, 1.0)</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">0〜1の範囲で赤・緑・青を指定</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-slate-700">カラーマップ省略形</td>
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">'C0'</code>, <code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">'C1'</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">デフォルトカラーサイクルを参照</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- コードブロック: 色・線種・マーカー -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">color_line_marker.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import numpy as np

x = np.linspace(0, 10, 20)  # 0〜10を20分割

fig, ax = plt.subplots(figsize=(9, 5))

# 色・線種・マーカーをそれぞれ指定
ax.plot(x, np.sin(x),
        color='#3b82f6',      # HEXコードで青
        linestyle='-',        # 実線
        linewidth=2,          # 線の太さ
        marker='o',           # 丸マーカー
        markersize=6,         # マーカーサイズ
        label='sin(x)')

ax.plot(x, np.cos(x),
        color='tomato',       # 色名で赤系
        linestyle='--',       # 破線
        linewidth=2,
        marker='s',           # 四角マーカー
        markersize=6,
        label='cos(x)')

ax.set_title('色・線種・マーカーのカスタマイズ', fontsize=14)
ax.set_xlabel('x')
ax.set_ylabel('値')
ax.legend()                   # 凡例を表示
ax.grid(True, alpha=0.3)      # 薄いグリッド線
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mb-3 mt-6">主な線種とマーカーの一覧</h3>

                    <!-- 線種・マーカーテーブル -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-white border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                                <i class="fas fa-minus text-primary-500"></i>
                                線種（linestyle）
                            </h4>
                            <table class="w-full text-sm">
                                <tbody>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'-'</code></td>
                                        <td class="py-1.5 text-slate-700">実線（デフォルト）</td>
                                    </tr>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'--'</code></td>
                                        <td class="py-1.5 text-slate-700">破線</td>
                                    </tr>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">':'</code></td>
                                        <td class="py-1.5 text-slate-700">点線</td>
                                    </tr>
                                    <tr>
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'-.'</code></td>
                                        <td class="py-1.5 text-slate-700">一点鎖線</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="bg-white border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-3 flex items-center gap-2">
                                <i class="fas fa-circle text-primary-500"></i>
                                マーカー（marker）
                            </h4>
                            <table class="w-full text-sm">
                                <tbody>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'o'</code></td>
                                        <td class="py-1.5 text-slate-700">丸</td>
                                    </tr>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'s'</code></td>
                                        <td class="py-1.5 text-slate-700">四角</td>
                                    </tr>
                                    <tr class="border-b border-slate-100">
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'^'</code></td>
                                        <td class="py-1.5 text-slate-700">上三角</td>
                                    </tr>
                                    <tr>
                                        <td class="py-1.5 font-mono text-slate-600"><code class="bg-slate-100 px-1 rounded">'D'</code></td>
                                        <td class="py-1.5 text-slate-700">ひし形</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <!-- セクション 14.3 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.3 日本語フォントの設定
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        matplotlibのデフォルトフォントは日本語に対応していないため、そのまま日本語を含むタイトルや軸ラベルを設定すると「文字化け（□□□）」が発生します。これはデータ分析でよく遭遇するトラブルの一つです。
                    </p>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600 mt-1"></i>
                            <div>
                                <p class="text-red-900 font-medium">日本語文字化けの症状</p>
                                <p class="text-red-800 text-sm mt-1">
                                    タイトルや軸ラベルに日本語を設定したのに、グラフには「□□□」や「???」と表示される。これはmatplotlibが使用するフォントに日本語グリフ（字形データ）が含まれていないために発生します。
                                </p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mb-3">解決方法1: japanize-matplotlib（最も簡単）</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">japanize-matplotlib</code> というライブラリを使うと、インポートするだけで自動的に日本語対応フォントが設定されます。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">ターミナル</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-bash"># japanize-matplotlib をインストール
pip install japanize-matplotlib</code></pre>
                    </div>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">japanese_font_easy.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import japanize_matplotlib  # インポートするだけで日本語対応！
import numpy as np

x = [1, 2, 3, 4, 5]
y = [10, 25, 18, 32, 27]

plt.figure(figsize=(8, 4))
plt.plot(x, y, marker='o', color='steelblue')
plt.title('月別アクセス数の推移')   # 日本語タイトル
plt.xlabel('月')                    # 日本語ラベル
plt.ylabel('アクセス数（万回）')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mb-3 mt-6">解決方法2: rcParams でフォントを直接指定</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">matplotlib.rcParams</code> を使って、フォントを明示的に指定する方法です。OS上にインストールされている日本語フォントを直接指定します。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">japanese_font_rcparams.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import matplotlib

# OSに応じてフォントを指定
# Windows の場合
matplotlib.rcParams['font.family'] = 'MS Gothic'
# Mac の場合
# matplotlib.rcParams['font.family'] = 'Hiragino Sans'
# Linux（IPAフォント）の場合
# matplotlib.rcParams['font.family'] = 'IPAGothic'

plt.figure(figsize=(8, 4))
plt.bar(['東京', '大阪', '名古屋', '福岡'], [100, 80, 60, 40],
        color=['#3b82f6', '#10b981', '#f59e0b', '#ef4444'])
plt.title('都市別売上比較')
plt.ylabel('売上（万円）')
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">どちらの方法を使うべきか</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    手軽に使いたい場合は <strong>japanize-matplotlib</strong> が最もシンプルです。チーム環境や特定フォントにこだわる場合は <strong>rcParams</strong> で明示的に指定する方法が適しています。ただし rcParams の場合、OSによって利用可能なフォント名が異なるので注意が必要です。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 14.4 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.4 スタイルシートの活用
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        matplotlibには「スタイルシート」という機能があります。1行のコードで、グラフ全体の見た目（色、フォント、背景）をまとめて変更できます。複数のグラフを統一されたデザインで作成したいときに非常に便利です。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">style_list.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt

# 利用可能なスタイルの一覧を確認
print(plt.style.available)
# 出力例: ['Solarize_Light2', '_classic_test_patch', 'bmh', 'classic',
#          'dark_background', 'fast', 'fivethirtyeight', 'ggplot',
#          'grayscale', 'seaborn-v0_8', ...]</code></pre>
                    </div>

                    <!-- 代表的なスタイル紹介 -->
                    <h3 class="text-base font-semibold text-slate-700 mb-3">代表的なスタイル</h3>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-2 flex items-center gap-2">
                                <code class="bg-slate-200 px-1.5 py-0.5 rounded text-sm font-mono">ggplot</code>
                            </h4>
                            <p class="text-slate-600 text-sm">Rの可視化パッケージ「ggplot2」風のスタイル。淡いグリッド線と落ち着いた色合いが特徴で、学術発表に向いています。</p>
                        </div>
                        <div class="bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-2 flex items-center gap-2">
                                <code class="bg-slate-200 px-1.5 py-0.5 rounded text-sm font-mono">seaborn-v0_8</code>
                            </h4>
                            <p class="text-slate-600 text-sm">統計可視化ライブラリSeabornのデフォルトスタイル。清潔感のある白背景とグリッド線が特徴で、汎用的に使いやすいです。</p>
                        </div>
                        <div class="bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-2 flex items-center gap-2">
                                <code class="bg-slate-200 px-1.5 py-0.5 rounded text-sm font-mono">fivethirtyeight</code>
                            </h4>
                            <p class="text-slate-600 text-sm">ニュースサイトFiveThirtyEight風。太めのグリッド線と鮮やかな色が特徴で、メディア向けのグラフに向いています。</p>
                        </div>
                        <div class="bg-gradient-to-br from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-4">
                            <h4 class="font-semibold text-slate-700 mb-2 flex items-center gap-2">
                                <code class="bg-slate-200 px-1.5 py-0.5 rounded text-sm font-mono">bmh</code>
                            </h4>
                            <p class="text-slate-600 text-sm">Bayesian Methods for Hackersというブックから来たスタイル。シンプルで読みやすく、ブログや技術資料に向いています。</p>
                        </div>
                    </div>

                    <!-- コードブロック: スタイルシートの使い方 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">style_usage.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import numpy as np

# スタイルを適用（この行以降のすべてのグラフに適用される）
plt.style.use('ggplot')

x = np.arange(1, 7)
sales = [120, 145, 138, 170, 155, 190]

plt.figure(figsize=(8, 4))
plt.bar(x, sales, color='steelblue')
plt.title('月別売上（ggplotスタイル）')
plt.xlabel('月')
plt.ylabel('売上（万円）')
plt.xticks(x, ['1月', '2月', '3月', '4月', '5月', '6月'])
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">スタイルの一時的な適用</p>
                                <p class="text-emerald-800 text-sm mt-1">
                                    <code class="bg-emerald-100 px-1 rounded font-mono">plt.style.use()</code> はその後のすべてのグラフに影響します。特定のグラフにだけスタイルを適用したい場合は、<code class="bg-emerald-100 px-1 rounded font-mono">with plt.style.context('ggplot'):</code> を使うと、ブロック内のグラフにのみスタイルが適用されます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 14.5 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.5 グラフの保存（savefig）
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        Jupyter Notebook上で表示されるグラフは、レポートやプレゼン資料に貼り付けるためにファイルとして保存できます。<code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">plt.savefig()</code> を使います。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">save_figure.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import japanize_matplotlib
import numpy as np

months = ['1月', '2月', '3月', '4月', '5月', '6月']
sales  = [120, 145, 138, 170, 155, 190]

fig, ax = plt.subplots(figsize=(10, 5))
ax.bar(months, sales, color='#3b82f6', alpha=0.8, edgecolor='white')
ax.set_title('上半期月別売上', fontsize=16, fontweight='bold')
ax.set_xlabel('月', fontsize=12)
ax.set_ylabel('売上（万円）', fontsize=12)
ax.grid(axis='y', alpha=0.3)       # 横方向のみグリッド

plt.tight_layout()

# PNG形式で保存（dpi=150で中品質）
plt.savefig('sales_chart.png', dpi=150, bbox_inches='tight')

# PDF形式でも保存（印刷・ベクター用）
plt.savefig('sales_chart.pdf', bbox_inches='tight')

print("グラフを保存しました")</code></pre>
                    </div>

                    <!-- savefig オプション解説テーブル -->
                    <h3 class="text-base font-semibold text-slate-700 mb-3">savefig の主なオプション</h3>
                    <div class="overflow-x-auto mb-6">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-primary-50">
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">オプション</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">説明</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">推奨値</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">dpi</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">解像度（dots per inch）。数値が大きいほど高品質で大容量</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">Web用: 96〜150、印刷用: 300</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">bbox_inches</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">グラフ周囲の余白設定</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">'tight' で余白を最小化（推奨）</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">transparent</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">背景を透明にする（PNG/SVGのみ有効）</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">True / False</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">facecolor</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">保存時の背景色を指定</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">'white', '#f8fafc' など</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- ファイル形式の使い分け -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-4">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-file-image text-primary-500"></i>
                            ファイル形式の使い分け
                        </h3>
                        <div class="mermaid">
flowchart TD
    Start["グラフを保存したい"] --> Q1{"用途は?"}
    Q1 -->|Webサイト・メール| PNG["PNG形式\n.savefig('chart.png', dpi=150)"]
    Q1 -->|印刷・高品質| PDF["PDF形式\n.savefig('chart.pdf')"]
    Q1 -->|拡大縮小に耐える| SVG["SVG形式\n.savefig('chart.svg')"]
    Q1 -->|PowerPoint貼付| PNG2["PNG形式\ndpi=300 で高解像度保存"]

    style PNG fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style PDF fill:#d1fae5,stroke:#10b981,color:#064e3b
    style SVG fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
    style PNG2 fill:#fef3c7,stroke:#f59e0b,color:#92400e
                        </div>
                    </div>

                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-circle text-orange-600 mt-1"></i>
                            <div>
                                <p class="text-orange-900 font-medium">savefig は plt.show() の前に呼び出す</p>
                                <p class="text-orange-800 text-sm mt-1">
                                    <code class="bg-orange-100 px-1 rounded font-mono">plt.show()</code> を呼び出すと、グラフの描画状態がリセットされます。そのため <code class="bg-orange-100 px-1 rounded font-mono">savefig()</code> は必ず <code class="bg-orange-100 px-1 rounded font-mono">plt.show()</code> より前に記述してください。逆の順序にすると、空白のファイルが保存されてしまいます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 14.6 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.6 レイアウトの調整
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        複数のグラフを並べたり、タイトルや凡例が他の要素と重なってしまうとき、レイアウトを調整することで見やすいグラフが作れます。
                    </p>

                    <h3 class="text-base font-semibold text-slate-700 mb-3">tight_layout と constrained_layout</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">plt.tight_layout()</code> は、グラフ内の要素が重ならないよう余白を自動調整する便利な関数です。ほぼすべてのグラフで使うことを推奨します。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">layout_adjustment.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import japanize_matplotlib
import numpy as np

# 2行2列のサブプロット（4つのグラフ）
fig, axes = plt.subplots(2, 2, figsize=(10, 8))

months  = ['1月', '2月', '3月', '4月', '5月', '6月']
sales_A = [100, 120, 110, 140, 130, 160]
sales_B = [80,  95,  88,  105, 98,  115]

# 左上: 折れ線グラフ
axes[0, 0].plot(months, sales_A, marker='o', label='商品A')
axes[0, 0].plot(months, sales_B, marker='s', label='商品B')
axes[0, 0].set_title('売上推移')
axes[0, 0].legend()

# 右上: 棒グラフ
x = np.arange(len(months))
axes[0, 1].bar(x - 0.2, sales_A, width=0.4, label='商品A')
axes[0, 1].bar(x + 0.2, sales_B, width=0.4, label='商品B')
axes[0, 1].set_title('月別売上比較')
axes[0, 1].set_xticks(x)
axes[0, 1].set_xticklabels(months)
axes[0, 1].legend()

# 左下: ヒストグラム
data = np.random.normal(150, 20, 200)
axes[1, 0].hist(data, bins=15, color='steelblue', edgecolor='white')
axes[1, 0].set_title('売上分布')

# 右下: 散布図
axes[1, 1].scatter(sales_A, sales_B, color='tomato', alpha=0.7)
axes[1, 1].set_title('商品A vs 商品B')
axes[1, 1].set_xlabel('商品A')
axes[1, 1].set_ylabel('商品B')

# tight_layout で各グラフの余白を自動調整
plt.tight_layout(pad=2.0)  # pad で外側の余白を指定
plt.savefig('layout_example.png', dpi=150, bbox_inches='tight')
plt.show()</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mb-3 mt-6">軸の範囲・目盛りのカスタマイズ</h3>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">axis_customization.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import japanize_matplotlib

fig, ax = plt.subplots(figsize=(8, 5))

months = ['1月', '2月', '3月', '4月', '5月', '6月']
sales  = [120, 145, 138, 170, 155, 190]

ax.plot(months, sales, marker='o', color='steelblue', linewidth=2)

# 軸の範囲を指定（y軸を0から始めず100から）
ax.set_ylim(100, 210)
# y軸の目盛りを20刻みで設定
ax.set_yticks(range(100, 211, 20))

# タイトル・ラベルのフォントサイズを調整
ax.set_title('上半期売上推移', fontsize=16, fontweight='bold', pad=15)
ax.set_xlabel('月', fontsize=12)
ax.set_ylabel('売上（万円）', fontsize=12)

# 目盛りラベルのフォントサイズも調整
ax.tick_params(axis='both', labelsize=11)

# グリッド線（横のみ、薄め）
ax.grid(axis='y', linestyle='--', alpha=0.4)
ax.spines['top'].set_visible(False)    # 上の枠線を非表示
ax.spines['right'].set_visible(False)  # 右の枠線を非表示

plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">spines（枠線）の非表示でスッキリ見せる</p>
                                <p class="text-emerald-800 text-sm mt-1">
                                    <code class="bg-emerald-100 px-1 rounded font-mono">ax.spines['top'].set_visible(False)</code> と <code class="bg-emerald-100 px-1 rounded font-mono">ax.spines['right'].set_visible(False)</code> で上と右の枠線を消すだけで、グラフがスタイリッシュな見た目になります。ビジネスレポートでよく使われるテクニックです。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 14.7 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.7 テキストアノテーション（注釈）の追加
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        グラフの特定の点に注目を促したいとき、テキストや矢印でアノテーション（注釈）を追加できます。「この月に売上が急増した理由」などをグラフ上に直接示すことで、説得力が増します。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">annotation_example.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import japanize_matplotlib

months = ['1月', '2月', '3月', '4月', '5月', '6月']
sales  = [120, 145, 138, 170, 155, 190]

fig, ax = plt.subplots(figsize=(9, 5))
ax.plot(months, sales, marker='o', color='steelblue', linewidth=2)

# 最大値の点にアノテーションを追加
max_idx = sales.index(max(sales))   # 最大値のインデックス（5）
ax.annotate(
    f'最大: {sales[max_idx]}万円',   # 表示テキスト
    xy=(max_idx, sales[max_idx]),    # 矢印の先（注目点）
    xytext=(max_idx - 1.5, sales[max_idx] - 15),  # テキスト位置
    arrowprops=dict(arrowstyle='->', color='red', lw=1.5),
    fontsize=11, color='red', fontweight='bold'
)

# 各データ点に数値ラベルを表示
for i, (month, val) in enumerate(zip(months, sales)):
    ax.text(i, val + 3, str(val), ha='center', va='bottom',
            fontsize=9, color='slate')

ax.set_title('上半期売上推移', fontsize=14)
ax.set_xlabel('月')
ax.set_ylabel('売上（万円）')
ax.set_ylim(100, 210)
ax.grid(axis='y', alpha=0.3)
plt.tight_layout()
plt.show()</code></pre>
                    </div>
                </section>

                <!-- セクション 14.8 まとめ実践 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.8 総合例 - レポート品質のグラフを作成する
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        これまで学んだカスタマイズ技術を組み合わせて、プレゼンや報告書に使える品質のグラフを作成してみましょう。
                    </p>

                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">report_quality_chart.ipynb</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt
import matplotlib.patches as mpatches
import japanize_matplotlib
import numpy as np

# データ準備
months   = ['1月', '2月', '3月', '4月', '5月', '6月']
sales_A  = [100, 120, 115, 145, 135, 160]
sales_B  = [80,  90,  85,  110, 100, 125]
target   = [110, 115, 120, 125, 130, 135]  # 目標値

fig, ax = plt.subplots(figsize=(11, 6))

# 棒グラフ（積み上げ）
x = np.arange(len(months))
bar1 = ax.bar(x, sales_A, label='商品A', color='#3b82f6', alpha=0.85)
bar2 = ax.bar(x, sales_B, bottom=sales_A, label='商品B',
              color='#10b981', alpha=0.85)

# 目標ラインを折れ線で表示
ax.plot(x, target, color='#ef4444', linewidth=2.5,
        linestyle='--', marker='D', markersize=7, label='月次目標')

# タイトル・ラベル（フォントサイズ・太さ指定）
ax.set_title('上半期 商品別売上と目標比較', fontsize=16,
             fontweight='bold', pad=16)
ax.set_xlabel('月', fontsize=12)
ax.set_ylabel('売上（万円）', fontsize=12)

# 軸の設定
ax.set_xticks(x)
ax.set_xticklabels(months, fontsize=11)
ax.set_ylim(0, 320)

# 各棒の合計値を表示
for i, (a, b) in enumerate(zip(sales_A, sales_B)):
    ax.text(i, a + b + 3, str(a + b),
            ha='center', va='bottom', fontsize=9, color='#475569')

# 見た目の整理
ax.legend(fontsize=11, loc='upper left')
ax.grid(axis='y', linestyle='--', alpha=0.35)
ax.spines['top'].set_visible(False)
ax.spines['right'].set_visible(False)
ax.tick_params(axis='both', labelsize=10)

plt.tight_layout()

# 高品質で保存
plt.savefig('report_chart.png', dpi=200, bbox_inches='tight',
            facecolor='white')
print("グラフをreport_chart.pngに保存しました")
plt.show()</code></pre>
                    </div>

                    <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-5 mb-4">
                        <h3 class="text-base font-semibold text-slate-700 mb-3 flex items-center gap-2">
                            <i class="fas fa-check-double text-primary-500"></i>
                            このコードで使ったカスタマイズ一覧
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-2">
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>HEXコードで色指定（#3b82f6、#10b981）</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>alpha で透明度を調整して重なりを見やすく</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>日本語フォント（japanize_matplotlib）</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>データ点に数値ラベルを追加（ax.text）</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>spines で上・右枠線を非表示</span>
                            </div>
                            <div class="flex items-center gap-2 text-slate-600 text-sm">
                                <i class="fas fa-check text-primary-500 flex-shrink-0"></i>
                                <span>savefig でdpi=200の高解像度保存</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 実習カード -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">
                                実習 14-1: カスタムグラフを保存する
                            </h3>
                            <p class="text-purple-900 mb-4 break-words">
                                これまで学んだカスタマイズ技術を使って、自分だけのオリジナルグラフを作成し、PNG形式で保存しましょう。
                            </p>

                            <h4 class="font-medium text-purple-800 mb-2">手順</h4>
                            <ol class="space-y-3 mb-4">
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                    <span class="flex-1 min-w-0 break-words">任意のデータ（自分の好きなデータや第13章のデータ）を用意する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                    <span class="flex-1 min-w-0 break-words">色・線種・マーカーのうち2つ以上をデフォルトから変更する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                    <span class="flex-1 min-w-0 break-words">日本語のタイトルと軸ラベルを設定する（japanize_matplotlibを使用）</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">4</span>
                                    <span class="flex-1 min-w-0 break-words"><code class="bg-purple-100 px-1 rounded font-mono">plt.savefig('my_chart.png', dpi=150, bbox_inches='tight')</code> でファイルに保存する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">5</span>
                                    <span class="flex-1 min-w-0 break-words">保存されたPNGファイルをファイルエクスプローラーで開いて確認する</span>
                                </li>
                            </ol>

                            <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-3 mt-2">
                                <div class="flex items-start gap-2">
                                    <i class="fas fa-check-circle text-emerald-600 mt-0.5"></i>
                                    <div>
                                        <p class="text-emerald-800 font-medium text-sm">成功の目印</p>
                                        <p class="text-emerald-700 text-sm mt-1">Jupyter Notebookと同じフォルダに <strong>my_chart.png</strong> が生成され、日本語テキストが正しく表示されているグラフが保存されている</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- セクション まとめ -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        14.9 この章のまとめ
                    </h2>

                    <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-flag-checkered text-primary-500"></i>
                            学んだこと
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">色はHEXコード・色名・RGBタプルで指定できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">線種（-、--、:、-.）とマーカー（o、s、^など）を組み合わせて視認性を高める</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">japanize_matplotlibをインポートするだけで日本語フォントが有効になる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">plt.style.use() でグラフ全体の見た目を統一できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">savefig はplt.show()より前に呼ぶ。dpi で解像度、bbox_inches='tight' で余白を最小化</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">tight_layout・spines非表示・アノテーションでレポート品質のグラフが作れる</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-5">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. matplotlibで日本語を正しく表示するための方法を2つ説明してください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <ul class="space-y-1">
                                                <li><strong>①japanize-matplotlib</strong>: <code class="bg-blue-200 px-1 rounded font-mono">pip install japanize-matplotlib</code> でインストールし、<code class="bg-blue-200 px-1 rounded font-mono">import japanize_matplotlib</code> とインポートするだけで自動的に日本語フォントが設定される。最も手軽な方法。</li>
                                                <li class="mt-1"><strong>②matplotlib.rcParams</strong>: <code class="bg-blue-200 px-1 rounded font-mono">matplotlib.rcParams['font.family'] = 'MS Gothic'</code> のようにOSにインストールされているフォント名を直接指定する方法。OSによってフォント名が異なる点に注意。</li>
                                            </ul>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. グラフを PNG ファイルとして保存するコードを書いてください。解像度は150dpi、周囲の余白は最小にしてください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <code class="block bg-blue-200 px-2 py-1 rounded font-mono mt-1">plt.savefig('chart.png', dpi=150, bbox_inches='tight')</code>
                                            <p class="mt-2">注意: この行は <code class="bg-blue-200 px-1 rounded font-mono">plt.show()</code> よりも前に記述する必要があります。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. グラフのスタイルを一時的に「ggplot」に変えて、そのブロック内でのみ適用させるコードはどのように書きますか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <pre class="bg-blue-200 rounded p-2 font-mono text-xs whitespace-pre">with plt.style.context('ggplot'):
    # ここで描いたグラフにだけ ggplot スタイルが適用される
    plt.plot([1, 2, 3], [1, 4, 9])
    plt.show()</pre>
                                            <p class="mt-2"><code class="bg-blue-200 px-1 rounded font-mono">plt.style.use()</code> と異なり、コンテキストマネージャー（with文）を使うことで、スタイルの影響範囲をブロック内に限定できます。</p>
                                        </div>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- トラブルシューティング -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl overflow-hidden mb-8">
                    <div class="bg-orange-100 px-6 py-3 border-b border-orange-200">
                        <h3 class="font-semibold text-orange-800 flex items-center gap-2">
                            <i class="fas fa-tools"></i>
                            よくあるトラブルと解決方法
                        </h3>
                    </div>
                    <div class="p-6 space-y-4">
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">グラフのタイトルや軸ラベルが □□□ になる（文字化け）</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> matplotlibが使用するフォントに日本語グリフが含まれていない。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">pip install japanize-matplotlib</code> でインストール後、コードの先頭に <code class="bg-orange-100 px-1 rounded font-mono">import japanize_matplotlib</code> を追加する。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">savefig で保存したファイルが空白（何も描かれていない）</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.show()</code> の後に <code class="bg-orange-100 px-1 rounded font-mono">plt.savefig()</code> を呼んでいる。plt.show() を呼ぶと描画状態がリセットされる。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.savefig()</code> を <code class="bg-orange-100 px-1 rounded font-mono">plt.show()</code> より前の行に移動する。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">tight_layout でも要素が重なってしまう</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> Figureのサイズが小さすぎて、すべての要素を収めきれない。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.subplots(figsize=(12, 8))</code> のように figsize を大きくするか、<code class="bg-orange-100 px-1 rounded font-mono">plt.tight_layout(pad=3.0)</code> でパディングを増やす。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">スタイルを変更したら他のグラフにも影響してしまった</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.style.use()</code> はノートブック全体に永続的に適用される。</p>
                                <p><strong>解決方法:</strong> 特定のグラフにだけスタイルを適用したい場合は <code class="bg-orange-100 px-1 rounded font-mono">with plt.style.context('ggplot'):</code> を使う。もとのスタイルに戻すには <code class="bg-orange-100 px-1 rounded font-mono">plt.style.use('default')</code> を実行する。</p>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="python-data-analysis-learning-material-13.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600 transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">実践的なデータ可視化 - 目的に合ったグラフ選び</span>
                        </div>
                    </a>
                    <a href="python-data-analysis-learning-material-15.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">総合演習 - 売上データ分析プロジェクト</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2026 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="https://github.com/fcircle-biz/tech_docs" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
