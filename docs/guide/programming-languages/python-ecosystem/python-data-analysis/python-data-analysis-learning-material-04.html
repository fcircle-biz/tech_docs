<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>Pythonデータ分析入門 第4章 - pandas入門 - SeriesとDataFrameを理解する</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Python - Blue
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fab fa-python text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">Pythonデータ分析入門</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-chart-bar text-[9px]"></i>
                                <span>データ分析</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約23時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="https://fcircle-biz.github.io/tech_docs/guide/programming-languages/python-ecosystem/python-data-analysis/" class="hover:text-primary-600 transition-colors">Pythonデータ分析入門</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第4章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-700">
                            第4章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 約1.5時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">
                        pandas入門 - SeriesとDataFrameを理解する
                    </h1>
                    <p class="text-slate-600">
                        pandasの2つの基本データ構造であるSeries（1次元）とDataFrame（2次元）の概念と基本操作を学びます。Excelの列やシートに例えながら、直感的に理解できるよう解説します。行・列の選択方法（loc, iloc）とデータ型の扱い方も習得します。
                    </p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-xl p-5 mb-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>SeriesとDataFrameの概念と違い（Excelとの対比で理解する）</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>Seriesの作成と基本操作（インデックス・スライス・演算）</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>DataFrameの作成と基本操作（行・列の選択、追加、削除）</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>loc（ラベル指定）とiloc（番号指定）によるデータ選択</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>データ型（dtype）の確認と変換</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション 4.1 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.1 pandasとは何か
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <strong>pandas</strong>（パンダス）は、Pythonでデータ分析を行うための最も重要なライブラリです。「Panel Data」という統計用語に由来する名前で、表形式のデータを効率的に操作するための機能を提供します。
                    </p>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        pandasを使うと、Excelのような表形式でデータを扱えます。CSVやExcelファイルの読み込み、データの絞り込み・並び替え・集計など、データ分析に必要な操作をPythonコードで簡潔に記述できます。
                    </p>

                    <!-- Excelとの対応図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-table text-primary-500"></i>
                            ExcelとpandasのデータStructure対応
                        </h3>
                        <div class="mermaid">
flowchart LR
    subgraph Excel["Excelのイメージ"]
        EC["列（Column）\n一つの項目データ"]
        ES["シート（Sheet）\n全体のデータ表"]
    end

    subgraph Pandas["pandasのデータ構造"]
        PS["Series（シリーズ）\n1次元のデータ列"]
        PD["DataFrame（データフレーム）\n2次元の表形式データ"]
    end

    EC -- 対応 --> PS
    ES -- 対応 --> PD

    style PS fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style PD fill:#d1fae5,stroke:#10b981,color:#064e3b
    style EC fill:#fef3c7,stroke:#f59e0b,color:#92400e
    style ES fill:#fef3c7,stroke:#f59e0b,color:#92400e
                        </div>
                        <p class="text-slate-500 text-sm mt-3">
                            <i class="fas fa-info-circle mr-1"></i>DataFrameはSeriesが複数集まったもの、とイメージすると理解しやすいです。
                        </p>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">pandasの2大データ構造</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    pandasには主に2つのデータ構造があります。<strong>Series</strong>はExcelの1列に相当する1次元データ、<strong>DataFrame</strong>はExcelのシート全体に相当する2次元データです。この章では両者の概念と使い方を丁寧に解説します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 4.2 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.2 Series - 1次元のデータ構造
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <strong>Series</strong>は、値とインデックス（ラベル）のペアで構成される1次元のデータ構造です。Excelの1列のデータに似ています。インデックスは自動的に0, 1, 2...と振られますが、文字列など任意のラベルを指定することもできます。
                    </p>

                    <!-- Seriesの構造図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-list text-primary-500"></i>
                            Seriesの構造
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <!-- 数値インデックス -->
                            <div>
                                <p class="text-sm font-medium text-slate-600 mb-2">デフォルトの数値インデックス</p>
                                <div class="bg-slate-50 rounded-lg border border-slate-200 overflow-hidden">
                                    <div class="grid grid-cols-2 bg-slate-200 text-slate-700 text-sm font-semibold">
                                        <div class="px-4 py-2 border-r border-slate-300">インデックス</div>
                                        <div class="px-4 py-2">値</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-blue-700 font-mono">0</div>
                                        <div class="px-4 py-2 text-slate-700">120</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-blue-700 font-mono">1</div>
                                        <div class="px-4 py-2 text-slate-700">135</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-blue-700 font-mono">2</div>
                                        <div class="px-4 py-2 text-slate-700">160</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-blue-700 font-mono">3</div>
                                        <div class="px-4 py-2 text-slate-700">150</div>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500 mt-2">dtype: int64</p>
                            </div>
                            <!-- ラベルインデックス -->
                            <div>
                                <p class="text-sm font-medium text-slate-600 mb-2">ラベル付きインデックス</p>
                                <div class="bg-slate-50 rounded-lg border border-slate-200 overflow-hidden">
                                    <div class="grid grid-cols-2 bg-slate-200 text-slate-700 text-sm font-semibold">
                                        <div class="px-4 py-2 border-r border-slate-300">インデックス</div>
                                        <div class="px-4 py-2">値</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-emerald-700 font-mono">1月</div>
                                        <div class="px-4 py-2 text-slate-700">120</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-emerald-700 font-mono">2月</div>
                                        <div class="px-4 py-2 text-slate-700">135</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-emerald-700 font-mono">3月</div>
                                        <div class="px-4 py-2 text-slate-700">160</div>
                                    </div>
                                    <div class="grid grid-cols-2 text-sm border-t border-slate-200">
                                        <div class="px-4 py-2 border-r border-slate-200 text-emerald-700 font-mono">4月</div>
                                        <div class="px-4 py-2 text-slate-700">150</div>
                                    </div>
                                </div>
                                <p class="text-xs text-slate-500 mt-2">dtype: int64</p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">Seriesの作成方法</h3>

                    <!-- コードブロック: Series作成 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">series_basics.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

# リストからSeriesを作成（インデックスは自動で0,1,2...）
sales = pd.Series([120, 135, 160, 150])
print(sales)
# 出力:
# 0    120
# 1    135
# 2    160
# 3    150
# dtype: int64

# インデックスに名前を付ける
sales_labeled = pd.Series(
    [120, 135, 160, 150],
    index=['1月', '2月', '3月', '4月']
)
print(sales_labeled)
# 出力:
# 1月    120
# 2月    135
# 3月    160
# 4月    150
# dtype: int64

# 辞書からSeriesを作成
data = {'A': 10, 'B': 20, 'C': 30}
s = pd.Series(data)
print(s)  # A: 10, B: 20, C: 30</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">Seriesの基本操作</h3>

                    <!-- コードブロック: Series操作 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">series_operations.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

sales = pd.Series(
    [120, 135, 160, 150, 175, 200],
    index=['1月', '2月', '3月', '4月', '5月', '6月']
)

# インデックスで値を取得
print(sales['1月'])    # 120
print(sales[0])        # 120（番号でも取得可能）

# スライスで範囲取得
print(sales['1月':'3月'])  # 1月〜3月のデータ

# 統計計算（NumPyと同様の操作が可能）
print(f"合計: {sales.sum()}")    # 合計: 940
print(f"平均: {sales.mean()}")   # 平均: 156.666...
print(f"最大: {sales.max()}")    # 最大: 200

# Series同士の演算（インデックスで自動対応）
cost = pd.Series([80, 90, 100, 95], index=['1月','2月','3月','4月'])
revenue = pd.Series([120, 135, 160, 150], index=['1月','2月','3月','4月'])
profit = revenue - cost  # 月別の利益を計算
print(profit)</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">Seriesの演算はインデックスで自動対応</p>
                                <p class="text-emerald-800 text-sm mt-1">
                                    SeriesとSeriesを演算すると、インデックスが同じ要素同士で計算されます。インデックスが一致しない場合は <code class="bg-emerald-100 px-1 rounded font-mono">NaN</code>（欠損値）になります。これがpandasの強力な特徴の一つです。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 4.3 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.3 DataFrame - 2次元の表形式データ
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <strong>DataFrame</strong>は、行と列で構成される2次元の表形式データ構造です。Excelのシートと同じようなイメージです。複数のSeriesを列として組み合わせたものと考えると理解しやすいです。
                    </p>

                    <!-- DataFrameの構造説明 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-table text-primary-500"></i>
                            DataFrameの構造イメージ
                        </h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-sm border-collapse">
                                <thead>
                                    <tr class="bg-primary-100">
                                        <th class="border border-slate-200 px-4 py-2 text-primary-800 font-semibold">インデックス（行ラベル）</th>
                                        <th class="border border-slate-200 px-4 py-2 text-primary-800 font-semibold">月</th>
                                        <th class="border border-slate-200 px-4 py-2 text-primary-800 font-semibold">売上（万円）</th>
                                        <th class="border border-slate-200 px-4 py-2 text-primary-800 font-semibold">商品カテゴリ</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr class="hover:bg-slate-50">
                                        <td class="border border-slate-200 px-4 py-2 font-mono text-blue-700">0</td>
                                        <td class="border border-slate-200 px-4 py-2">1月</td>
                                        <td class="border border-slate-200 px-4 py-2">120</td>
                                        <td class="border border-slate-200 px-4 py-2">食品</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="border border-slate-200 px-4 py-2 font-mono text-blue-700">1</td>
                                        <td class="border border-slate-200 px-4 py-2">2月</td>
                                        <td class="border border-slate-200 px-4 py-2">135</td>
                                        <td class="border border-slate-200 px-4 py-2">電化製品</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="border border-slate-200 px-4 py-2 font-mono text-blue-700">2</td>
                                        <td class="border border-slate-200 px-4 py-2">3月</td>
                                        <td class="border border-slate-200 px-4 py-2">160</td>
                                        <td class="border border-slate-200 px-4 py-2">食品</td>
                                    </tr>
                                    <tr class="hover:bg-slate-50">
                                        <td class="border border-slate-200 px-4 py-2 font-mono text-blue-700">3</td>
                                        <td class="border border-slate-200 px-4 py-2">4月</td>
                                        <td class="border border-slate-200 px-4 py-2">150</td>
                                        <td class="border border-slate-200 px-4 py-2">衣料品</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-3">
                            <div class="bg-blue-50 rounded-lg p-3 text-sm">
                                <p class="font-medium text-blue-800 mb-1">インデックス（行ラベル）</p>
                                <p class="text-blue-700">各行を識別するラベル。デフォルトは0, 1, 2...の連番</p>
                            </div>
                            <div class="bg-emerald-50 rounded-lg p-3 text-sm">
                                <p class="font-medium text-emerald-800 mb-1">カラム（列名）</p>
                                <p class="text-emerald-700">各列のヘッダー名。「月」「売上」などデータの属性を表す</p>
                            </div>
                            <div class="bg-purple-50 rounded-lg p-3 text-sm">
                                <p class="font-medium text-purple-800 mb-1">値（セル）</p>
                                <p class="text-purple-700">実際のデータ。数値、文字列、日付など様々な型が混在可能</p>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">DataFrameの作成方法</h3>

                    <!-- コードブロック: DataFrame作成 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">dataframe_create.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

# 辞書からDataFrameを作成（最も一般的）
data = {
    '月':        ['1月', '2月', '3月', '4月'],
    '売上':      [120, 135, 160, 150],
    'カテゴリ':  ['食品', '電化製品', '食品', '衣料品']
}
df = pd.DataFrame(data)
print(df)

# リストのリストから作成（列名は後で指定）
rows = [
    ['1月', 120, '食品'],
    ['2月', 135, '電化製品'],
    ['3月', 160, '食品'],
]
df2 = pd.DataFrame(rows, columns=['月', '売上', 'カテゴリ'])

# インデックスを指定して作成
df3 = pd.DataFrame(data, index=['row1', 'row2', 'row3', 'row4'])</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">DataFrameの基本情報確認</h3>

                    <!-- コードブロック: DataFrame基本確認 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">dataframe_info.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

df = pd.DataFrame({
    '月': ['1月', '2月', '3月', '4月', '5月'],
    '売上': [120, 135, 160, 150, 175],
    'カテゴリ': ['食品', '電化製品', '食品', '衣料品', '食品']
})

print(df.shape)         # (5, 3) → 行数5、列数3
print(df.columns)       # Index(['月', '売上', 'カテゴリ'])
print(df.index)         # RangeIndex(start=0, stop=5, step=1)
print(df.dtypes)        # 各列のデータ型を表示
print(len(df))          # 5 → 行数を取得

# 先頭・末尾のn行を表示
print(df.head(3))       # 先頭3行
print(df.tail(2))       # 末尾2行</code></pre>
                    </div>
                </section>

                <!-- セクション 4.4 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.4 列の選択と操作
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        DataFrameから特定の列や行を取り出す操作は、データ分析で最も頻繁に使います。列の選択にはブラケット記法を使い、単一の列名を指定するとSeriesが、リストで複数列を指定するとDataFrameが返ります。
                    </p>

                    <!-- コードブロック: 列操作 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">column_selection.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

df = pd.DataFrame({
    '月': ['1月', '2月', '3月', '4月'],
    '売上': [120, 135, 160, 150],
    '原価': [80, 90, 100, 95]
})

# 1列を選択 → Series が返る
sales_series = df['売上']
print(type(sales_series))   # <class 'pandas.core.series.Series'>

# 複数列を選択 → DataFrame が返る
sub_df = df[['月', '売上']]  # ブラケットを二重にする
print(type(sub_df))         # <class 'pandas.core.frame.DataFrame'>

# 新しい列を追加（計算式で作成）
df['利益'] = df['売上'] - df['原価']
print(df)

# 列を削除
df_dropped = df.drop(columns=['原価'])  # 元のdfは変更されない
print(df_dropped)

# 列名を変更
df_renamed = df.rename(columns={'売上': '売上金額', '原価': '原価金額'})
print(df_renamed.columns)</code></pre>
                    </div>

                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-circle text-orange-600 mt-1"></i>
                            <div>
                                <p class="text-orange-900 font-medium">よくある間違い：ブラケットの数</p>
                                <p class="text-orange-800 text-sm mt-1">
                                    <code class="bg-orange-100 px-1 rounded font-mono">df['売上']</code> は1列を取得してSeriesを返します。<code class="bg-orange-100 px-1 rounded font-mono">df[['売上']]</code>（ブラケット二重）は1列を含むDataFrameを返します。複数列を選択する場合はリストを渡すため二重ブラケットになります。この違いは初心者がよく混乱するポイントです。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 4.5 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.5 行の選択 - loc と iloc
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        DataFrameから特定の行を取得する方法は主に2つあります。<strong>loc</strong>はラベル（名前）で指定し、<strong>iloc</strong>は整数番号（位置）で指定します。この2つの違いを正確に理解することが重要です。
                    </p>

                    <!-- locとilocの比較 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-search text-primary-500"></i>
                            locとilocの違い
                        </h3>
                        <div class="mermaid">
flowchart TD
    A["行・列の選択"] --> B{"指定方法"}
    B -->|"ラベル名で指定"| C["loc\nloc&#91;行ラベル, 列ラベル&#93;"]
    B -->|"番号で指定"| D["iloc\niloc&#91;行番号, 列番号&#93;"]

    C --> C1["df.loc&#91;0, '売上'&#93;\nインデックス0、列名'売上'"]
    C --> C2["df.loc&#91;1:3, '月':'売上'&#93;\n範囲指定（終端含む）"]

    D --> D1["df.iloc&#91;0, 1&#93;\n0行目、1列目"]
    D --> D2["df.iloc&#91;1:3, 0:2&#93;\n範囲指定（終端含まない）"]

    style C fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style D fill:#d1fae5,stroke:#10b981,color:#064e3b
                        </div>
                    </div>

                    <!-- コードブロック: loc/iloc -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">loc_iloc_example.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

df = pd.DataFrame({
    '月':   ['1月', '2月', '3月', '4月'],
    '売上': [120,   135,   160,   150  ],
    '原価': [80,    90,    100,   95   ]
}, index=['row0', 'row1', 'row2', 'row3'])

# --- loc: ラベルで指定 ---
print(df.loc['row0'])           # row0の行全体
print(df.loc['row0', '売上'])   # row0の売上列 → 120
print(df.loc['row0':'row2'])    # row0〜row2の行（終端含む）

# 行と列を両方指定
print(df.loc['row0':'row2', '月':'売上'])

# --- iloc: 番号で指定 ---
print(df.iloc[0])           # 0番目の行全体
print(df.iloc[0, 1])        # 0行目の1列目 → 120
print(df.iloc[0:3])         # 0〜2番目の行（終端含まない）

# 行と列を両方指定
print(df.iloc[0:3, 0:2])    # 0〜2行、0〜1列</code></pre>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">locとilocのスライスの違い</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    <strong>loc</strong>のスライスは終端を含みます（例: <code class="bg-blue-100 px-1 rounded font-mono">loc['row0':'row2']</code> → row0, row1, row2）。一方、<strong>iloc</strong>のスライスはPythonのリストと同様、終端を含みません（例: <code class="bg-blue-100 px-1 rounded font-mono">iloc[0:3]</code> → 0, 1, 2）。この違いを覚えておくとバグを防げます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 4.6 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.6 データ型（dtype）の確認と変換
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        pandasの各列はデータ型（dtype）を持っています。データ型が適切でない場合、計算が正しく動かなかったり予期しないエラーが発生することがあります。データ型の確認と変換は、データ分析の前処理として非常に重要なステップです。
                    </p>

                    <!-- データ型一覧表 -->
                    <div class="overflow-x-auto mb-6">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-primary-50">
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">pandasのdtype</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">Pythonの型</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">説明</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">int64</td>
                                    <td class="border border-slate-200 px-4 py-2">int</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">整数値</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">120, 0, -5</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">float64</td>
                                    <td class="border border-slate-200 px-4 py-2">float</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">浮動小数点数</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">3.14, 1.0</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">object</td>
                                    <td class="border border-slate-200 px-4 py-2">str</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">文字列（テキスト）</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">'食品', '1月'</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">bool</td>
                                    <td class="border border-slate-200 px-4 py-2">bool</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">真偽値</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">True, False</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">datetime64</td>
                                    <td class="border border-slate-200 px-4 py-2">datetime</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">日付・時刻</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">2024-01-01</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-mono text-slate-700">category</td>
                                    <td class="border border-slate-200 px-4 py-2">Categorical</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">カテゴリ型（メモリ効率が良い）</td>
                                    <td class="border border-slate-200 px-4 py-2 font-mono">'小', '中', '大'</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- コードブロック: dtype確認と変換 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">dtype_conversion.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

df = pd.DataFrame({
    '月':   ['1月', '2月', '3月'],
    '売上': ['120', '135', '160'],  # 文字列として読み込まれた場合
    '日付': ['2024-01-01', '2024-02-01', '2024-03-01']
})

# データ型を確認
print(df.dtypes)
# 月     object
# 売上   object  ← 文字列のまま！数値計算できない
# 日付   object

# 売上列を数値（int）に変換
df['売上'] = df['売上'].astype(int)
print(df['売上'].dtype)     # int64

# 日付列を日付型に変換
df['日付'] = pd.to_datetime(df['日付'])
print(df['日付'].dtype)     # datetime64[ns]

# カテゴリ型に変換（メモリ節約）
df['月'] = df['月'].astype('category')
print(df.dtypes)</code></pre>
                    </div>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600 mt-1"></i>
                            <div>
                                <p class="text-red-900 font-medium">CSVを読み込んだ際のデータ型に注意</p>
                                <p class="text-red-800 text-sm mt-1">
                                    CSVから読み込んだ数値データが文字列（object型）として扱われることがあります。例えば「売上」列が <code class="bg-red-100 px-1 rounded font-mono">object</code> 型だと、<code class="bg-red-100 px-1 rounded font-mono">df['売上'].sum()</code> が数値の合計ではなく文字列の連結になってしまいます。必ず <code class="bg-red-100 px-1 rounded font-mono">df.dtypes</code> でデータ型を確認する習慣をつけましょう。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 4.7 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.7 SeriesとDataFrameの関係
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        DataFrameの列を取り出すとSeriesになります。逆に、複数のSeriesを組み合わせてDataFrameを作ることもできます。両者の関係を理解することで、柔軟なデータ操作が可能になります。
                    </p>

                    <!-- コードブロック: SeriesとDataFrameの変換 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">series_dataframe_relation.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd

df = pd.DataFrame({
    '月':   ['1月', '2月', '3月', '4月'],
    '売上': [120, 135, 160, 150],
    '原価': [80, 90, 100, 95]
})

# DataFrameの列 → Series
s = df['売上']
print(type(s))        # <class 'pandas.core.series.Series'>
print(s.name)         # 売上 （Seriesは列名を保持）

# 複数のSeriesからDataFrameを作成
s1 = pd.Series([120, 135, 160], name='売上')
s2 = pd.Series([80, 90, 100],   name='原価')
new_df = pd.concat([s1, s2], axis=1)  # axis=1で横に結合
print(new_df)

# SeriesをDataFrameに変換
df_from_series = s.to_frame()   # Seriesを1列のDataFrameに変換
print(type(df_from_series))     # DataFrame</code></pre>
                    </div>

                    <!-- SeriesとDataFrameの関係図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-project-diagram text-primary-500"></i>
                            SeriesとDataFrameの関係図
                        </h3>
                        <div class="mermaid">
flowchart LR
    subgraph DF["DataFrame（表全体）"]
        C1["Series: 月列"]
        C2["Series: 売上列"]
        C3["Series: 原価列"]
    end

    A["DataFrameから列を取得\ndf&#91;'売上'&#93;"] --> C2
    C2 --> B["Seriesとして操作\n.mean&#40;&#41;, .sum&#40;&#41;など"]
    C2 --> E["計算結果を新列として追加\ndf&#91;'利益'&#93; = df&#91;'売上'&#93; - df&#91;'原価'&#93;"]

    style C1 fill:#fef3c7,stroke:#f59e0b,color:#92400e
    style C2 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style C3 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
                        </div>
                    </div>
                </section>

                <!-- 実習カード -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">
                                実習 4-1: 商品売上データのDataFrame操作
                            </h3>
                            <p class="text-purple-900 mb-4 break-words">
                                商品売上データを使ってDataFrameの作成・列操作・loc/ilocによる選択を練習しましょう。
                            </p>

                            <h4 class="font-medium text-purple-800 mb-2">手順</h4>
                            <ol class="space-y-3 mb-4">
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                    <span class="flex-1 min-w-0 break-words">Jupyter Notebookを開き、商品名・価格・数量・カテゴリのDataFrameを辞書から作成する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                    <span class="flex-1 min-w-0 break-words"><code class="bg-purple-100 px-1 rounded font-mono">df['売上金額'] = df['価格'] * df['数量']</code> で売上金額列を追加する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                    <span class="flex-1 min-w-0 break-words"><code class="bg-purple-100 px-1 rounded font-mono">loc</code> で2〜4行目の「商品名」と「売上金額」列だけを選択して表示する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">4</span>
                                    <span class="flex-1 min-w-0 break-words"><code class="bg-purple-100 px-1 rounded font-mono">df.dtypes</code> でデータ型を確認し、必要に応じて変換する</span>
                                </li>
                            </ol>

                            <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-3 mt-2">
                                <div class="flex items-start gap-2">
                                    <i class="fas fa-check-circle text-emerald-600 mt-0.5"></i>
                                    <div>
                                        <p class="text-emerald-800 font-medium text-sm">成功の目印</p>
                                        <p class="text-emerald-700 text-sm mt-1">売上金額列が正しく計算され、loc で意図した行・列だけが取得できる</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- セクション 4.8 まとめ -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        4.8 この章のまとめ
                    </h2>

                    <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-flag-checkered text-primary-500"></i>
                            学んだこと
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">SeriesはExcelの1列に相当する1次元データ構造で、インデックスと値のペアで構成される</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">DataFrameはExcelのシートに相当する2次元データ構造で、複数のSeriesを列として持つ</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">辞書や2次元リストからDataFrameを作成できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">列の選択は <code class="bg-slate-100 px-1 rounded font-mono">df['列名']</code>（Series）または <code class="bg-slate-100 px-1 rounded font-mono">df[['列名1', '列名2']]</code>（DataFrame）で行う</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">locはラベル指定（終端含む）、ilocは番号指定（終端含まない）でデータを選択する</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">astype()でデータ型を変換でき、CSVから読んだ数値が文字列になっていることがあるので注意が必要</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-5">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. SeriesとDataFrameの違いを、Excelの概念を使って説明してください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            <p class="text-sm"><strong>Series</strong>はExcelの1列（縦1列のデータ）に相当する1次元データ構造です。各要素にインデックス（ラベル）が付いています。<br><strong>DataFrame</strong>はExcelのシート全体（複数の列からなる表）に相当する2次元データ構造です。複数のSeriesが列として集まったものとも言えます。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. <code class="bg-blue-100 px-1 rounded font-mono">df['売上']</code> と <code class="bg-blue-100 px-1 rounded font-mono">df[['売上']]</code> の返り値の型の違いを答えてください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            <p class="text-sm"><code class="bg-blue-200 px-1 rounded font-mono">df['売上']</code>（ブラケット1つ）は <strong>Series</strong> を返します。<code class="bg-blue-200 px-1 rounded font-mono">df[['売上']]</code>（ブラケット2つ、内側がリスト）は <strong>DataFrame</strong>（1列のDataFrame）を返します。複数列を選ぶ場合は必ずリストを渡すので二重ブラケットになります。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. locとilocのスライス指定における「終端を含むか含まないか」の違いを答えてください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <strong>loc</strong>のスライスは終端を含みます。例えば <code class="bg-blue-200 px-1 rounded font-mono">df.loc[0:2]</code> は0, 1, 2行目の3行を返します。<strong>iloc</strong>のスライスはPythonのリストと同様、終端を含みません。例えば <code class="bg-blue-200 px-1 rounded font-mono">df.iloc[0:2]</code> は0, 1行目の2行のみを返します。
                                        </p>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- トラブルシューティング -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl overflow-hidden mb-8">
                    <div class="bg-orange-100 px-6 py-3 border-b border-orange-200">
                        <h3 class="font-semibold text-orange-800 flex items-center gap-2">
                            <i class="fas fa-tools"></i>
                            よくあるトラブルと解決方法
                        </h3>
                    </div>
                    <div class="p-6 space-y-4">
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">KeyError: '売上' - 列名でエラーになる</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> 列名のスペルミスや、全角・半角の違い、前後に余分なスペースが含まれている。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">print(df.columns.tolist())</code> で実際の列名を確認する。CSVから読み込んだ場合は列名に空白が含まれていることがあるので <code class="bg-orange-100 px-1 rounded font-mono">df.columns = df.columns.str.strip()</code> で除去する。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">TypeError: unsupported operand type - 数値計算ができない</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> 計算しようとしている列が数値型ではなく文字列型（object）になっている。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">df.dtypes</code> でデータ型を確認し、<code class="bg-orange-100 px-1 rounded font-mono">df['売上'] = df['売上'].astype(float)</code> で数値型に変換してから計算する。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">SettingWithCopyWarning が表示される</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> DataFrameのコピーに値を設定しようとしている。<code class="bg-orange-100 px-1 rounded font-mono">df[df['A'] > 0]['B'] = 1</code> のような連鎖的なインデックス指定が原因。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">df.loc[df['A'] > 0, 'B'] = 1</code> のようにlocを使って一度に行・列を指定する。</p>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="python-data-analysis-learning-material-03.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600 transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">NumPy実践 - データ分析に必要な配列操作</span>
                        </div>
                    </a>
                    <a href="python-data-analysis-learning-material-05.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">データの読み込みと書き出し - 外部データとの連携</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2026 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="https://github.com/fcircle-biz/tech_docs" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
