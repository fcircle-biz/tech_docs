<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>Pythonデータ分析入門 第13章 - 実践的なデータ可視化 - 目的に合ったグラフ選び</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // Python - Blue
                        primary: {
                            50: '#eff6ff',
                            100: '#dbeafe',
                            200: '#bfdbfe',
                            300: '#93c5fd',
                            400: '#60a5fa',
                            500: '#3b82f6',
                            600: '#2563eb',
                            700: '#1d4ed8',
                            800: '#1e40af',
                            900: '#1e3a8a',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fab fa-python text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">Pythonデータ分析入門</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-chart-bar text-[9px]"></i>
                                <span>データ分析</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約23時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="https://fcircle-biz.github.io/tech_docs/guide/programming-languages/python-ecosystem/python-data-analysis/" class="hover:text-primary-600 transition-colors">Pythonデータ分析入門</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第13章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-700">
                            第13章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 約1.5時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">
                        実践的なデータ可視化 - 目的に合ったグラフ選び
                    </h1>
                    <p class="text-slate-600">
                        ヒストグラム、箱ひげ図、円グラフ、ヒートマップなど多様なグラフを学び、データの特徴や伝えたいメッセージに応じた最適な可視化手法を習得します。サブプロットによる複数グラフの並列表示や、pandasのplotメソッドとの連携も解説します。
                    </p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200 rounded-xl p-5 mb-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ヒストグラム（hist）でデータの分布を可視化する方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>箱ひげ図（boxplot）で外れ値と分布の広がりを把握する方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>円グラフ（pie）で構成比を視覚化する方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ヒートマップで相関行列などを可視化する方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>サブプロット（subplots）で複数グラフを並べる方法</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>pandasのplotメソッドを使ったシンプルな可視化</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション 13.1 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.1 グラフの種類と使い分け
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        前章ではmatplotlibの基本を学びました。この章では「何を伝えたいか」に応じて適切なグラフを選ぶ力を身につけます。同じデータでも、使うグラフの種類によって読み手に伝わる情報が大きく変わります。
                    </p>

                    <!-- グラフ選択フローチャート -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-sitemap text-primary-500"></i>
                            目的に応じたグラフの選び方
                        </h3>
                        <div class="mermaid">
flowchart TD
    Start["何を伝えたい？"] --> A{データの目的}
    A -->|"分布・ばらつき"| B["ヒストグラム\n箱ひげ図"]
    A -->|"構成比・割合"| C["円グラフ\n積み上げ棒グラフ"]
    A -->|"変数間の関係"| D["散布図\nヒートマップ"]
    A -->|"時系列変化"| E["折れ線グラフ"]
    A -->|"カテゴリ比較"| F["棒グラフ"]

    style B fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style C fill:#fef3c7,stroke:#f59e0b,color:#92400e
    style D fill:#d1fae5,stroke:#10b981,color:#064e3b
    style E fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
    style F fill:#fee2e2,stroke:#ef4444,color:#7f1d1d
                        </div>
                    </div>

                    <!-- グラフ一覧カード -->
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 border border-blue-200 rounded-xl p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fas fa-chart-bar text-blue-500"></i>
                                <h4 class="font-semibold text-blue-900">ヒストグラム（hist）</h4>
                            </div>
                            <p class="text-blue-800 text-sm">データの値がどの範囲に集中しているか「分布の形」を確認するのに最適です。</p>
                        </div>
                        <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 border border-emerald-200 rounded-xl p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fas fa-box text-emerald-500"></i>
                                <h4 class="font-semibold text-emerald-900">箱ひげ図（boxplot）</h4>
                            </div>
                            <p class="text-emerald-800 text-sm">中央値・四分位範囲・外れ値を一目で把握できます。グループ間の比較に強いです。</p>
                        </div>
                        <div class="bg-gradient-to-br from-amber-50 to-yellow-100 border border-amber-200 rounded-xl p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fas fa-chart-pie text-amber-500"></i>
                                <h4 class="font-semibold text-amber-900">円グラフ（pie）</h4>
                            </div>
                            <p class="text-amber-800 text-sm">全体に対する各カテゴリの割合（構成比）を視覚化します。カテゴリ数が少ない場合に有効です。</p>
                        </div>
                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 border border-purple-200 rounded-xl p-4">
                            <div class="flex items-center gap-2 mb-2">
                                <i class="fas fa-th text-purple-500"></i>
                                <h4 class="font-semibold text-purple-900">ヒートマップ</h4>
                            </div>
                            <p class="text-purple-800 text-sm">行列形式のデータを色の濃淡で表現します。相関行列の可視化に特に有効です。</p>
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">グラフ選びの基本原則</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    「何のためのグラフか」を先に決めましょう。きれいに見えるグラフより、メッセージが伝わるグラフが重要です。円グラフはカテゴリが多いと逆に分かりにくくなるため、5種類以下のカテゴリに限定することを推奨します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.2 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.2 ヒストグラム - データの分布を見る
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ヒストグラムは、数値データを決められた幅（ビン）で区切り、各区間に何個のデータが入るかを棒の高さで表したグラフです。データの「形」（正規分布か、偏っているか、複峰か）を直感的に把握できます。
                    </p>

                    <!-- ヒストグラムの概念図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-chart-bar text-primary-500"></i>
                            ヒストグラムの仕組み
                        </h3>
                        <div class="mermaid">
flowchart LR
    subgraph Data["元のデータ（身長）"]
        d["155, 162, 168, 171, 175,\n178, 180, 183, 155, 163..."]
    end

    subgraph Bins["区間に分類（ビン幅: 5cm）"]
        b1["150-155cm: 2件"]
        b2["155-160cm: 5件"]
        b3["160-165cm: 8件"]
        b4["165-170cm: 12件"]
        b5["170-175cm: 9件"]
    end

    subgraph Graph["ヒストグラム"]
        g["棒の高さ = 件数\n（度数）"]
    end

    Data --> Bins --> Graph

    style b4 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
                        </div>
                    </div>

                    <!-- コードブロック: ヒストグラム基本 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">histogram_basic.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

# サンプルデータ: 100人のテストスコア（0〜100点）
np.random.seed(42)                         # 再現性のためシードを固定
scores = np.random.normal(70, 15, 100)    # 平均70・標準偏差15の正規分布
scores = np.clip(scores, 0, 100)          # 0〜100の範囲に収める

# 基本的なヒストグラム
plt.figure(figsize=(8, 5))
plt.hist(scores, bins=15, color='steelblue', edgecolor='white')
plt.title('テストスコアの分布')
plt.xlabel('スコア（点）')
plt.ylabel('人数（度数）')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">binsパラメータの効果</h3>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">bins</code> はデータを何個の区間に分けるかを指定します。少なすぎると大雑把、多すぎると細かくなり分布の形が分かりにくくなります。
                    </p>

                    <!-- コードブロック: 密度・複数比較 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">histogram_advanced.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python"># 2グループの分布を重ねて比較する
np.random.seed(42)
group_a = np.random.normal(65, 12, 80)   # グループA: 平均65点
group_b = np.random.normal(75, 10, 80)   # グループB: 平均75点

plt.figure(figsize=(9, 5))
# alpha で透明度を設定して重ねて表示
plt.hist(group_a, bins=15, alpha=0.6, color='steelblue', label='グループA')
plt.hist(group_b, bins=15, alpha=0.6, color='tomato', label='グループB')
plt.title('グループ別スコア分布の比較')
plt.xlabel('スコア（点）')
plt.ylabel('人数')
plt.legend()
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">histの主要パラメータ</p>
                                <ul class="text-emerald-800 text-sm mt-1 space-y-1">
                                    <li><code class="bg-emerald-100 px-1 rounded font-mono">bins</code>: 区間の数（整数）または区間の境界リスト</li>
                                    <li><code class="bg-emerald-100 px-1 rounded font-mono">alpha</code>: 透明度（0〜1）。複数のヒストグラムを重ねるときに使用</li>
                                    <li><code class="bg-emerald-100 px-1 rounded font-mono">edgecolor</code>: 棒の枠線の色</li>
                                    <li><code class="bg-emerald-100 px-1 rounded font-mono">density=True</code>: 度数ではなく確率密度で表示</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.3 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.3 箱ひげ図 - 分布と外れ値を一望する
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        箱ひげ図（ボックスプロット）は、データの統計的な特徴を1つのグラフで表現できる強力な可視化手法です。特に複数グループを比較するときに威力を発揮します。
                    </p>

                    <!-- 箱ひげ図の構成要素 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-box text-primary-500"></i>
                            箱ひげ図の読み方
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph BoxPlot["箱ひげ図の構成要素"]
        W1["上のひげ: 最大値\n（外れ値を除く）"]
        Q3["箱の上端: 第3四分位数\n（Q3: 75%点）"]
        Med["箱の中の線: 中央値\n（Q2: 50%点）"]
        Q1["箱の下端: 第1四分位数\n（Q1: 25%点）"]
        W2["下のひげ: 最小値\n（外れ値を除く）"]
        Out["点（●）: 外れ値\n（IQRの1.5倍を超えるデータ）"]
    end

    W1 --> Q3 --> Med --> Q1 --> W2

    style Med fill:#fef3c7,stroke:#f59e0b,color:#92400e
    style Q3 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style Q1 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
                        </div>
                        <p class="text-slate-500 text-sm mt-3">
                            <i class="fas fa-info-circle mr-1"></i>IQR（四分位範囲）= Q3 - Q1。箱の高さがIQRで、データの中央50%がこの範囲に収まります。
                        </p>
                    </div>

                    <!-- コードブロック: 箱ひげ図 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">boxplot_example.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)
# 4教科のテスト結果データ
subjects = {
    '数学': np.random.normal(65, 18, 50),
    '英語': np.random.normal(72, 12, 50),
    '国語': np.random.normal(78, 10, 50),
    '理科': np.random.normal(68, 15, 50),
}

plt.figure(figsize=(9, 6))
# 辞書の値リストを渡してまとめて描画
plt.boxplot(subjects.values(), labels=subjects.keys(),
            patch_artist=True,       # 箱に色を塗る
            notch=False)             # ノッチなし（ノッチ付きはnotch=True）

plt.title('教科別テストスコアの分布比較')
plt.xlabel('教科')
plt.ylabel('スコア（点）')
plt.grid(True, alpha=0.3, axis='y')
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-orange-50 border-l-4 border-orange-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-circle text-orange-600 mt-1"></i>
                            <div>
                                <p class="text-orange-900 font-medium">箱ひげ図 vs ヒストグラム</p>
                                <p class="text-orange-800 text-sm mt-1">
                                    複数グループを比較するなら箱ひげ図、1つのグループの分布形状を詳しく見るならヒストグラムが適しています。どちらも分布を見るツールですが、目的に応じて使い分けましょう。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.4 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.4 円グラフ - 構成比を視覚化する
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        円グラフ（パイチャート）は全体を100%として、各カテゴリの割合を扇形の面積で表します。「売上のうちどの商品カテゴリが何%を占めるか」といった構成比を直感的に伝えるのに適しています。
                    </p>

                    <!-- コードブロック: 円グラフ基本 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">pie_chart_example.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import matplotlib.pyplot as plt

# 商品カテゴリ別売上比率
categories = ['食品', '衣類', '電子機器', '日用品', 'その他']
sales      = [35, 25, 20, 12, 8]    # 単位: %

# 特定の要素を強調（explode）
explode = [0.05, 0, 0, 0, 0]       # 食品カテゴリを少し飛び出す

plt.figure(figsize=(8, 6))
plt.pie(
    sales,
    labels=categories,
    autopct='%1.1f%%',       # パーセンテージを表示
    startangle=90,           # 12時の位置から開始
    explode=explode,         # 特定スライスを強調
    colors=['#4CAF50', '#2196F3', '#FF9800', '#9C27B0', '#9E9E9E']
)
plt.title('商品カテゴリ別売上構成比')
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600 mt-1"></i>
                            <div>
                                <p class="text-red-900 font-medium">円グラフの使いすぎに注意</p>
                                <p class="text-red-800 text-sm mt-1">
                                    円グラフは5種類以上のカテゴリには不向きです。カテゴリが多い場合は棒グラフで表示したほうが差が分かりやすくなります。また、値が近いカテゴリの比較は円グラフでは読み取りにくいため、棒グラフを使いましょう。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.5 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.5 ヒートマップ - 行列データを色で表す
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ヒートマップは、行列形式の数値データを色の濃淡で表現したグラフです。特に「相関行列の可視化」（どの変数とどの変数が強く関連しているかを一覧する）に多用されます。
                    </p>

                    <!-- ヒートマップの用途 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-th text-primary-500"></i>
                            ヒートマップの主な用途
                        </h3>
                        <div class="mermaid">
flowchart LR
    HM["ヒートマップ"]
    HM --> C["相関行列\n変数間の相関係数を可視化"]
    HM --> T["時系列クロス集計\n曜日×時間帯の集計結果"]
    HM --> P["ピボットテーブル\n2次元の集計データ"]

    style HM fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
    style C fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style T fill:#d1fae5,stroke:#10b981,color:#064e3b
    style P fill:#fef3c7,stroke:#f59e0b,color:#92400e
                        </div>
                    </div>

                    <!-- コードブロック: ヒートマップ（相関行列） -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">heatmap_correlation.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

np.random.seed(42)
# サンプルデータ（4変数の相関を確認）
df = pd.DataFrame({
    '身長': np.random.normal(170, 10, 50),
    '体重': np.random.normal(65, 12, 50),
    '年収': np.random.normal(500, 100, 50),
    '勤続年数': np.random.randint(1, 30, 50),
})

# 相関行列を計算
corr_matrix = df.corr()

# imshowでヒートマップを描画
fig, ax = plt.subplots(figsize=(7, 6))
im = ax.imshow(corr_matrix, cmap='coolwarm', vmin=-1, vmax=1)

# 軸ラベルを設定
ax.set_xticks(range(len(corr_matrix.columns)))
ax.set_yticks(range(len(corr_matrix.columns)))
ax.set_xticklabels(corr_matrix.columns)
ax.set_yticklabels(corr_matrix.columns)

# 各セルに相関係数の数値を表示
for i in range(len(corr_matrix)):
    for j in range(len(corr_matrix.columns)):
        ax.text(j, i, f'{corr_matrix.iloc[i, j]:.2f}',
                ha='center', va='center', fontsize=10)

plt.colorbar(im, ax=ax)          # カラーバーを追加
ax.set_title('変数間の相関行列')
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">相関係数の読み方</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    相関係数は -1〜1 の値を取ります。<strong>1に近い</strong>と正の強い相関（一方が増えると他方も増える）、<strong>-1に近い</strong>と負の強い相関（一方が増えると他方は減る）、<strong>0に近い</strong>と無相関です。ヒートマップでは暖色が正の相関、寒色が負の相関を表します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.6 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.6 サブプロット - 複数グラフを並べる
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">plt.subplots()</code> を使うと、1つのFigure（図）の中に複数のAxes（グラフ領域）を配置できます。データの異なる側面を一度に見せたいときに非常に便利です。
                    </p>

                    <!-- サブプロットの概念図 -->
                    <div class="bg-white border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-th-large text-primary-500"></i>
                            サブプロットのレイアウト
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph Figure["Figure（1枚の図全体）"]
        subgraph Row1["1行目"]
            ax1["Axes[0,0]\nグラフ1"]
            ax2["Axes[0,1]\nグラフ2"]
        end
        subgraph Row2["2行目"]
            ax3["Axes[1,0]\nグラフ3"]
            ax4["Axes[1,1]\nグラフ4"]
        end
    end

    style ax1 fill:#dbeafe,stroke:#3b82f6,color:#1e40af
    style ax2 fill:#d1fae5,stroke:#10b981,color:#064e3b
    style ax3 fill:#fef3c7,stroke:#f59e0b,color:#92400e
    style ax4 fill:#ede9fe,stroke:#8b5cf6,color:#4c1d95
                        </div>
                        <p class="text-slate-500 text-sm mt-3">
                            <i class="fas fa-info-circle mr-1"></i><code class="font-mono">plt.subplots(2, 2)</code> で2行2列の配置になります。
                        </p>
                    </div>

                    <!-- コードブロック: サブプロット基本 -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">subplots_example.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import numpy as np
import matplotlib.pyplot as plt

np.random.seed(42)
data = np.random.normal(70, 15, 100)   # スコアデータ

# 2行2列のサブプロットを作成
fig, axes = plt.subplots(2, 2, figsize=(10, 8))
fig.suptitle('データの多角的な可視化', fontsize=14)

# [0,0] ヒストグラム
axes[0, 0].hist(data, bins=15, color='steelblue', edgecolor='white')
axes[0, 0].set_title('ヒストグラム')
axes[0, 0].set_xlabel('スコア')

# [0,1] 箱ひげ図
axes[0, 1].boxplot(data, patch_artist=True)
axes[0, 1].set_title('箱ひげ図')
axes[0, 1].set_ylabel('スコア')

# [1,0] 折れ線グラフ（最初の30件）
axes[1, 0].plot(range(30), data[:30], color='tomato', marker='o', ms=4)
axes[1, 0].set_title('最初の30件の推移')
axes[1, 0].set_xlabel('インデックス')

# [1,1] 累積ヒストグラム
axes[1, 1].hist(data, bins=15, cumulative=True,
                color='mediumpurple', edgecolor='white')
axes[1, 1].set_title('累積ヒストグラム')
axes[1, 1].set_xlabel('スコア')

plt.tight_layout()    # 各グラフが重ならないよう間隔を調整
plt.show()</code></pre>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">tight_layout() を忘れずに</p>
                                <p class="text-emerald-800 text-sm mt-1">
                                    サブプロットを使うときは <code class="bg-emerald-100 px-1 rounded font-mono">plt.tight_layout()</code> を必ず呼び出しましょう。これを忘れるとタイトルや軸ラベルが隣のグラフと重なってしまいます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.7 -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.7 pandasのplotメソッド - DataFrameから直接グラフを描く
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        pandasのDataFrameには <code class="bg-slate-100 px-1.5 py-0.5 rounded text-sm font-mono">.plot()</code> メソッドが組み込まれています。matplotlibを直接呼ぶよりシンプルなコードでグラフを作成できるため、素早く可視化したい場合に非常に便利です。
                    </p>

                    <!-- コードブロック: pandas plot メソッド -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">pandas_plot_example.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt

# 月別売上データを作成
df = pd.DataFrame({
    '月': ['1月', '2月', '3月', '4月', '5月', '6月'],
    '食品': [120, 135, 150, 140, 160, 175],
    '衣類': [80, 90, 100, 85, 95, 110],
    '電子機器': [60, 70, 65, 75, 80, 90],
})
df = df.set_index('月')   # 月を行インデックスに設定

# 折れ線グラフ（kind='line' がデフォルト）
df.plot(kind='line', figsize=(9, 5), marker='o')
plt.title('月別カテゴリ別売上推移')
plt.ylabel('売上（万円）')
plt.grid(True, alpha=0.3)
plt.tight_layout()
plt.show()

# 棒グラフ（積み上げ）
df.plot(kind='bar', stacked=True, figsize=(9, 5))
plt.title('月別カテゴリ別売上（積み上げ）')
plt.ylabel('売上（万円）')
plt.xticks(rotation=0)    # X軸ラベルを水平に
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <!-- pandas plot の種類一覧 -->
                    <h3 class="text-base font-semibold text-slate-700 mt-6 mb-3">plotメソッドのkind一覧</h3>

                    <div class="overflow-x-auto mb-6">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-primary-50">
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">kind値</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">グラフの種類</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">主な用途</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">line</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">折れ線グラフ（デフォルト）</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">時系列の変化・トレンド</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">bar</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">縦棒グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">カテゴリの比較</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">barh</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">横棒グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">ラベルが長いカテゴリ比較</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">hist</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">ヒストグラム</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">数値データの分布</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">box</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">箱ひげ図</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">分布・外れ値の確認</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">scatter</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">散布図</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">2変数間の関係</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">pie</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">円グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">構成比</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2"><code class="bg-slate-100 px-1.5 py-0.5 rounded font-mono">area</code></td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">面積グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">時系列の積み上げ推移</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- コードブロック: ヒストグラムとboxをpandasで -->
                    <div class="code-block-wrapper my-6">
                        <div class="flex items-center justify-between bg-slate-800 px-4 py-2 rounded-t-lg">
                            <span class="text-slate-400 text-sm">pandas_hist_box.py</span>
                            <button class="copy-btn text-slate-400 hover:text-white transition-colors" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre class="!mt-0 !rounded-t-none"><code class="language-python">import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

np.random.seed(42)
# 複数列のデータ
df = pd.DataFrame({
    '数学': np.random.normal(65, 15, 100),
    '英語': np.random.normal(72, 12, 100),
    '国語': np.random.normal(78, 10, 100),
})

# ヒストグラム（全列を一度に）
df.plot(kind='hist', bins=15, alpha=0.6, figsize=(9, 5))
plt.title('教科別スコア分布')
plt.xlabel('スコア（点）')
plt.tight_layout()
plt.show()

# 箱ひげ図（全列を一度に）
df.plot(kind='box', figsize=(7, 5))
plt.title('教科別スコアの箱ひげ図')
plt.ylabel('スコア（点）')
plt.tight_layout()
plt.show()</code></pre>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">matplotlibとpandas plotの使い分け</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    素早くデータを確認したいならpandasの <code class="bg-blue-100 px-1 rounded font-mono">.plot()</code> が便利です。一方、細かいカスタマイズ（軸の範囲・色・アノテーションなど）が必要な場合はmatplotlibを直接使いましょう。内部的にはpandas plotもmatplotlibを使っているため、両方を混在させることもできます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.8 グラフ選択の実践ガイド -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.8 実践：グラフ選択のまとめと比較
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        これまでに学んだグラフの特性を整理します。実際の分析では「このデータで何を伝えたいか」を先に決めてからグラフを選ぶことが重要です。
                    </p>

                    <!-- グラフ選択まとめテーブル -->
                    <div class="overflow-x-auto mb-6">
                        <table class="w-full text-sm border-collapse">
                            <thead>
                                <tr class="bg-primary-50">
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">グラフ</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">得意なこと</th>
                                    <th class="border border-slate-200 px-4 py-2 text-left text-primary-800 font-semibold">注意点</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-blue-700">折れ線グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">時系列の変化・トレンド</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">連続データでないと不自然</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-emerald-700">棒グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">カテゴリ間の比較</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">カテゴリが多いと読みにくい</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-blue-700">散布図</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">2変数の相関・関係性</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">データ点が多すぎると見えにくい</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-blue-700">ヒストグラム</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">1変数の分布の形</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">ビン数で見え方が変わる</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-emerald-700">箱ひげ図</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">複数グループの分布比較・外れ値</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">細かい分布形状は読み取りにくい</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-amber-700">円グラフ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">全体に対する構成比</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">カテゴリが5つ超えると不向き</td>
                                </tr>
                                <tr class="hover:bg-slate-50">
                                    <td class="border border-slate-200 px-4 py-2 font-medium text-purple-700">ヒートマップ</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-700">行列データ・相関行列</td>
                                    <td class="border border-slate-200 px-4 py-2 text-slate-600">カラースケールの設定が重要</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </section>

                <!-- 実習カード -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-code text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">
                                実習 13-1: 多様なグラフで1つのデータセットを分析する
                            </h3>
                            <p class="text-purple-900 mb-4 break-words">
                                架空の学力調査データを使って、5種類のグラフを描き、それぞれの見え方の違いを体感しましょう。
                            </p>

                            <h4 class="font-medium text-purple-800 mb-2">手順</h4>
                            <ol class="space-y-3 mb-4">
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                    <span class="flex-1 min-w-0 break-words">Jupyter Notebookを開き、<code class="bg-purple-100 px-1 rounded font-mono">np.random.normal()</code> で3教科100人分のスコアデータを生成する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                    <span class="flex-1 min-w-0 break-words">ヒストグラム（3教科重ねて表示）で分布の形を確認する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                    <span class="flex-1 min-w-0 break-words">箱ひげ図で3教科の中央値・ばらつき・外れ値を比較する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">4</span>
                                    <span class="flex-1 min-w-0 break-words">相関行列を計算してヒートマップで可視化する</span>
                                </li>
                                <li class="flex items-start gap-3 text-purple-900">
                                    <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">5</span>
                                    <span class="flex-1 min-w-0 break-words"><code class="bg-purple-100 px-1 rounded font-mono">plt.subplots()</code> で上記のグラフを1枚の図に並べる</span>
                                </li>
                            </ol>

                            <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-3 mt-2">
                                <div class="flex items-start gap-2">
                                    <i class="fas fa-check-circle text-emerald-600 mt-0.5"></i>
                                    <div>
                                        <p class="text-emerald-800 font-medium text-sm">成功の目印</p>
                                        <p class="text-emerald-700 text-sm mt-1">4つのサブプロット（ヒストグラム・箱ひげ図・散布図・ヒートマップ）が1枚の図に並んで表示される</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- セクション 13.9 まとめ -->
                <section class="mb-10">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800 border-l-4 border-primary-500 pl-4 mb-4">
                        13.9 この章のまとめ
                    </h2>

                    <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-6">
                        <h3 class="text-base font-semibold text-slate-700 mb-4 flex items-center gap-2">
                            <i class="fas fa-flag-checkered text-primary-500"></i>
                            学んだこと
                        </h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">ヒストグラム（hist）でデータの分布形状とばらつきを把握できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">箱ひげ図（boxplot）で複数グループを横並びで比較し、外れ値も一目で確認できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">円グラフ（pie）は構成比を伝えるグラフで、カテゴリが少ない場合に有効</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">ヒートマップは相関行列などの行列データを色の濃淡で直感的に表現できる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">plt.subplots() で複数のグラフを1枚の図に並べることができる</span>
                            </div>
                            <div class="flex items-start gap-2">
                                <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                                <span class="text-slate-700 text-sm">pandasのplot()メソッドでDataFrameから簡単にグラフを描ける</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-5">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. ヒストグラムと箱ひげ図はどちらもデータの分布を見るために使います。それぞれが得意なシーンはどのような場合ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            <p class="text-sm"><strong>ヒストグラム</strong>: 1つのデータの「分布の形」を詳しく見たいとき。正規分布か、偏っているか、複峰かを確認するのに向いています。<br>
                                            <strong>箱ひげ図</strong>: 複数グループを同時に比較したいとき。中央値・四分位範囲・外れ値を一目で把握でき、グループ間の違いを効率よく確認できます。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. plt.subplots(2, 3) を使うと何個のグラフが並びますか？また、各グラフへアクセスするにはどのように書きますか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <p>2行3列なので合計 <strong>6個</strong>のグラフが並びます。各グラフへは <code class="bg-blue-200 px-1 rounded font-mono">axes[行番号, 列番号]</code> でアクセスします。例えば左上は <code class="bg-blue-200 px-1 rounded font-mono">axes[0, 0]</code>、右下は <code class="bg-blue-200 px-1 rounded font-mono">axes[1, 2]</code> です。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. pandasのDataFrame.plot(kind='bar') と plt.bar() の違いは何ですか？どちらを使うべきですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words text-sm">
                                            <p><code class="bg-blue-200 px-1 rounded font-mono">df.plot(kind='bar')</code> はDataFrameのインデックスや列名を自動で使うためコードが短くなります。一方 <code class="bg-blue-200 px-1 rounded font-mono">plt.bar()</code> は細かいカスタマイズが可能です。素早く確認したい場合はpandasの <code class="bg-blue-200 px-1 rounded font-mono">.plot()</code>、細かく整えたい場合はmatplotlibを直接使うのが効率的です。内部的には両方matplotlibを使っているため混在も可能です。</p>
                                        </div>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- トラブルシューティング -->
                <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl overflow-hidden mb-8">
                    <div class="bg-orange-100 px-6 py-3 border-b border-orange-200">
                        <h3 class="font-semibold text-orange-800 flex items-center gap-2">
                            <i class="fas fa-tools"></i>
                            よくあるトラブルと解決方法
                        </h3>
                    </div>
                    <div class="p-6 space-y-4">
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">ヒストグラムの棒がすべて同じ高さになる</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> データの値がすべて同じ、またはbinsの数がデータのユニーク値よりも多い。</p>
                                <p><strong>解決方法:</strong> binsの数を減らすか、データにばらつきがあるか確認する。<code class="bg-orange-100 px-1 rounded font-mono">print(data.describe())</code> でデータの分布を確認してから適切なbins数を選ぶ。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">サブプロットでグラフが重なってしまう</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.tight_layout()</code> を呼んでいない、またはfig sizeが小さすぎる。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.show()</code> の直前に <code class="bg-orange-100 px-1 rounded font-mono">plt.tight_layout()</code> を追加する。それでも解決しない場合は <code class="bg-orange-100 px-1 rounded font-mono">figsize</code> を大きくする（例: <code class="bg-orange-100 px-1 rounded font-mono">figsize=(12, 10)</code>）。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">円グラフのラベルが重なって読めない</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> カテゴリ数が多い、またはラベル文字が長い。</p>
                                <p><strong>解決方法:</strong> <code class="bg-orange-100 px-1 rounded font-mono">plt.legend()</code> で別に凡例を表示し、グラフ内のラベルは短縮するか非表示にする（<code class="bg-orange-100 px-1 rounded font-mono">labels=None</code>）。カテゴリが5つ以上なら棒グラフへの変更も検討する。</p>
                            </div>
                        </details>
                        <details class="group">
                            <summary class="flex items-center gap-3 cursor-pointer list-none p-3 rounded-lg bg-white border border-orange-200 hover:bg-orange-50 transition-colors">
                                <i class="fas fa-exclamation-triangle text-orange-500"></i>
                                <span class="font-medium text-orange-800">ヒートマップの数値の色と実際の値が合わない</span>
                                <i class="fas fa-chevron-down ml-auto text-orange-400 transition-transform group-open:rotate-180"></i>
                            </summary>
                            <div class="mt-3 pl-10 text-orange-900 text-sm">
                                <p class="mb-2"><strong>原因:</strong> <code class="bg-orange-100 px-1 rounded font-mono">vmin</code> / <code class="bg-orange-100 px-1 rounded font-mono">vmax</code> が適切に設定されていない。</p>
                                <p><strong>解決方法:</strong> 相関行列の場合は <code class="bg-orange-100 px-1 rounded font-mono">vmin=-1, vmax=1</code> を指定する。それ以外は <code class="bg-orange-100 px-1 rounded font-mono">vmin=data.min().min()</code> と <code class="bg-orange-100 px-1 rounded font-mono">vmax=data.max().max()</code> でデータの範囲に合わせる。</p>
                            </div>
                        </details>
                    </div>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="python-data-analysis-learning-material-12.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600 transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">matplotlib入門 - グラフ作成の基礎</span>
                        </div>
                    </a>
                    <a href="python-data-analysis-learning-material-14.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">グラフのカスタマイズと見栄えの向上</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2026 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="https://github.com/fcircle-biz/tech_docs" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
