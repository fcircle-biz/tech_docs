<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamlitå­¦ç¿’æ•™æ ç¬¬8ç«  - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã¨APIçµ±åˆ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .navbar {
            background-color: #4caf50;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #4caf50;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #66bb6a;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #4caf50;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .info-box {
            background-color: #e1f5fe;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #2196F3;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #4caf50 !important;
            color: white !important;
        }

        .nav-link {
            color: #666;
        }

        .nav-link:hover {
            background-color: #e8f5e8;
            color: #4caf50;
        }

        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        pre {
            background-color: #f5f5f5;
            padding: 1rem;
            border-radius: 4px;
            overflow-x: auto;
        }

        code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">Streamlitå­¦ç¿’æ•™æ</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link text-white" href="../README.md">å­¦ç¿’ã‚¬ã‚¤ãƒ‰ã«æˆ»ã‚‹</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        ç« ã®ä¸€è¦§
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-01.html">ç¬¬1ç« : å…¥é–€ã¨ç’°å¢ƒæ§‹ç¯‰</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-02.html">ç¬¬2ç« : åŸºæœ¬çš„ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-03.html">ç¬¬3ç« : ãƒ‡ãƒ¼ã‚¿è¡¨ç¤ºã¨å¯è¦–åŒ–</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-04.html">ç¬¬4ç« : ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã¨ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ã‚·ãƒ§ãƒ³</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-05.html">ç¬¬5ç« : ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-06.html">ç¬¬6ç« : ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã¨ãƒ‡ãƒ¼ã‚¿å‡¦ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-07.html">ç¬¬7ç« : ãƒãƒ«ãƒãƒšãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="#chapter8">ç¬¬8ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã¨APIçµ±åˆ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-09.html">ç¬¬9ç« : ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¨æœ¬ç•ªç’°å¢ƒ</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="streamlit-learning-material-10.html">ç¬¬10ç« : å®Ÿè·µçš„ãªãƒ‡ãƒ¼ã‚¿åˆ†æã‚¢ãƒ—ãƒªé–‹ç™º</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- ç« ãƒ˜ãƒƒãƒ€ãƒ¼ -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬8ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã¨APIçµ±åˆ</h1>
                </div>

                <div id="chapter8">
                    <!-- ç« ã‚¿ã‚¤ãƒˆãƒ« -->
                    <h2 class="chapter-title">å¤–éƒ¨ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã¨ã®çµ±åˆã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿å‡¦ç†</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>SQLiteã¨PostgreSQLãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ã®é€£æº</li>
                            <li>å¤–éƒ¨APIã¨ã®é€šä¿¡ã¨ãƒ‡ãƒ¼ã‚¿å–å¾—</li>
                            <li>ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿æ›´æ–°ã®å®Ÿè£…</li>
                            <li>åŸºæœ¬çš„ãªèªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…</li>
                            <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹CRUDæ“ä½œã¨Streamlitã®çµ±åˆ</li>
                        </ul>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æº -->
                    <h3 class="section-title">8.1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã®åŸºç¤</h3>
                    <p>Streamlitã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ã€SQLiteã‚„PostgreSQLãªã©ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨é€£æºã—ã¦ã€æ°¸ç¶šçš„ãªãƒ‡ãƒ¼ã‚¿ç®¡ç†ã‚’å®Ÿç¾ã§ãã¾ã™ã€‚</p>
                    
                    <h4>ã‚µãƒãƒ¼ãƒˆã•ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</th>
                                <th>ç‰¹å¾´</th>
                                <th>é©ç”¨å ´é¢</th>
                                <th>ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>SQLite</td>
                                <td>ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ã€è»½é‡</td>
                                <td>é–‹ç™ºãƒ»ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—</td>
                                <td>sqlite3ï¼ˆæ¨™æº–ï¼‰</td>
                            </tr>
                            <tr>
                                <td>PostgreSQL</td>
                                <td>é«˜æ©Ÿèƒ½ã€æœ¬æ ¼çš„</td>
                                <td>æœ¬ç•ªç’°å¢ƒ</td>
                                <td>psycopg2, SQLAlchemy</td>
                            </tr>
                            <tr>
                                <td>MySQL</td>
                                <td>åºƒãæ™®åŠ</td>
                                <td>Webã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</td>
                                <td>PyMySQL, SQLAlchemy</td>
                            </tr>
                            <tr>
                                <td>MongoDB</td>
                                <td>NoSQLã€JSONå½¢å¼</td>
                                <td>ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæŒ‡å‘</td>
                                <td>pymongo</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info-box">
                        <h6>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</h6>
                        <ul>
                            <li><strong>æ¥ç¶šãƒ—ãƒ¼ãƒ«</strong>: st.connection()ã§ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</li>
                            <li><strong>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–</strong>: ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªã®ä½¿ç”¨</li>
                            <li><strong>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</strong>: ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ä¿è¨¼</li>
                            <li><strong>ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ´»ç”¨</strong>: @st.cache_dataã§ã‚¯ã‚¨ãƒªçµæœã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 8-1: SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã‚¢ãƒ—ãƒª</h5>
                        <p>SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨é€£æºã—ãŸé¡§å®¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>database_app.py ã‚’ä½œæˆ</h6>
                        <pre class="code-block"><code class="language-python">import streamlit as st
import sqlite3
import pandas as pd
from datetime import datetime, date
import hashlib
import uuid

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºã‚¢ãƒ—ãƒª",
    page_icon="ğŸ—„ï¸",
    layout="wide"
)

class DatabaseManager:
    """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, db_path="customers.db"):
        self.db_path = db_path
        self.init_database()
    
    def init_database(self):
        """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–"""
        with sqlite3.connect(self.db_path) as conn:
            # é¡§å®¢ãƒ†ãƒ¼ãƒ–ãƒ«
            conn.execute("""
                CREATE TABLE IF NOT EXISTS customers (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    customer_id TEXT UNIQUE NOT NULL,
                    name TEXT NOT NULL,
                    email TEXT UNIQUE NOT NULL,
                    phone TEXT,
                    address TEXT,
                    company TEXT,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
                )
            """)
            
            # æ³¨æ–‡ãƒ†ãƒ¼ãƒ–ãƒ«
            conn.execute("""
                CREATE TABLE IF NOT EXISTS orders (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    order_id TEXT UNIQUE NOT NULL,
                    customer_id TEXT NOT NULL,
                    product_name TEXT NOT NULL,
                    quantity INTEGER NOT NULL,
                    unit_price REAL NOT NULL,
                    total_amount REAL NOT NULL,
                    order_date DATE NOT NULL,
                    status TEXT DEFAULT 'pending',
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    FOREIGN KEY (customer_id) REFERENCES customers (customer_id)
                )
            """)
            
            conn.commit()
    
    @st.cache_data(ttl=60)  # 1åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    def get_customers(_self):
        """å…¨é¡§å®¢ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"""
        with sqlite3.connect(_self.db_path) as conn:
            return pd.read_sql_query("SELECT * FROM customers ORDER BY created_at DESC", conn)
    
    @st.cache_data(ttl=60)
    def get_orders(_self):
        """å…¨æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—"""
        with sqlite3.connect(_self.db_path) as conn:
            query = """
                SELECT o.*, c.name as customer_name, c.email 
                FROM orders o 
                JOIN customers c ON o.customer_id = c.customer_id 
                ORDER BY o.created_at DESC
            """
            return pd.read_sql_query(query, conn)
    
    def add_customer(self, name, email, phone=None, address=None, company=None):
        """æ–°ã—ã„é¡§å®¢ã‚’è¿½åŠ """
        customer_id = f"CUST-{uuid.uuid4().hex[:8].upper()}"
        
        try:
            with sqlite3.connect(self.db_path) as conn:
                conn.execute("""
                    INSERT INTO customers (customer_id, name, email, phone, address, company)
                    VALUES (?, ?, ?, ?, ?, ?)
                """, (customer_id, name, email, phone, address, company))
                conn.commit()
                # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
                st.cache_data.clear()
                return True, customer_id
        except sqlite3.IntegrityError as e:
            return False, str(e)
    
    def update_customer(self, customer_id, name, email, phone=None, address=None, company=None):
        """é¡§å®¢æƒ…å ±ã‚’æ›´æ–°"""
        try:
            with sqlite3.connect(self.db_path) as conn:
                conn.execute("""
                    UPDATE customers 
                    SET name=?, email=?, phone=?, address=?, company=?, updated_at=CURRENT_TIMESTAMP
                    WHERE customer_id=?
                """, (name, email, phone, address, company, customer_id))
                conn.commit()
                # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
                st.cache_data.clear()
                return True, "æ›´æ–°æˆåŠŸ"
        except sqlite3.IntegrityError as e:
            return False, str(e)
    
    def delete_customer(self, customer_id):
        """é¡§å®¢ã‚’å‰Šé™¤"""
        try:
            with sqlite3.connect(self.db_path) as conn:
                # é–¢é€£ã™ã‚‹æ³¨æ–‡ã‚‚å‰Šé™¤
                conn.execute("DELETE FROM orders WHERE customer_id=?", (customer_id,))
                conn.execute("DELETE FROM customers WHERE customer_id=?", (customer_id,))
                conn.commit()
                # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
                st.cache_data.clear()
                return True, "å‰Šé™¤æˆåŠŸ"
        except Exception as e:
            return False, str(e)
    
    def add_order(self, customer_id, product_name, quantity, unit_price):
        """æ–°ã—ã„æ³¨æ–‡ã‚’è¿½åŠ """
        order_id = f"ORD-{uuid.uuid4().hex[:8].upper()}"
        total_amount = quantity * unit_price
        order_date = date.today()
        
        try:
            with sqlite3.connect(self.db_path) as conn:
                conn.execute("""
                    INSERT INTO orders (order_id, customer_id, product_name, quantity, unit_price, total_amount, order_date)
                    VALUES (?, ?, ?, ?, ?, ?, ?)
                """, (order_id, customer_id, product_name, quantity, unit_price, total_amount, order_date))
                conn.commit()
                # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢
                st.cache_data.clear()
                return True, order_id
        except Exception as e:
            return False, str(e)
    
    def get_customer_by_id(self, customer_id):
        """IDã§é¡§å®¢ã‚’æ¤œç´¢"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.execute("SELECT * FROM customers WHERE customer_id=?", (customer_id,))
            return cursor.fetchone()

# ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®åˆæœŸåŒ–
@st.cache_resource
def get_database_manager():
    return DatabaseManager()

db = get_database_manager()

st.title("ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é€£æºé¡§å®¢ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ")

# ã‚¿ãƒ–ã§æ©Ÿèƒ½ã‚’åˆ†å‰²
tab1, tab2, tab3, tab4 = st.tabs(["ğŸ‘¥ é¡§å®¢ç®¡ç†", "ğŸ“¦ æ³¨æ–‡ç®¡ç†", "ğŸ“Š çµ±è¨ˆæƒ…å ±", "ğŸ”§ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†"])

with tab1:
    st.subheader("é¡§å®¢ç®¡ç†")
    
    # ã‚µã‚¤ãƒ‰ãƒãƒ¼ã§æ“ä½œé¸æŠ
    with st.sidebar:
        st.header("é¡§å®¢æ“ä½œ")
        operation = st.radio("æ“ä½œã‚’é¸æŠ", ["è¡¨ç¤º", "è¿½åŠ ", "ç·¨é›†", "å‰Šé™¤"])
    
    if operation == "è¡¨ç¤º":
        st.write("**ç™»éŒ²é¡§å®¢ä¸€è¦§**")
        
        customers_df = db.get_customers()
        
        if not customers_df.empty:
            # æ¤œç´¢æ©Ÿèƒ½
            search_term = st.text_input("ğŸ” é¡§å®¢æ¤œç´¢ï¼ˆåå‰ã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ï¼‰")
            
            if search_term:
                mask = customers_df['name'].str.contains(search_term, case=False, na=False) | \
                       customers_df['email'].str.contains(search_term, case=False, na=False)
                filtered_df = customers_df[mask]
            else:
                filtered_df = customers_df
            
            # è¡¨ç¤ºåˆ—ã®é¸æŠ
            display_columns = st.multiselect(
                "è¡¨ç¤ºã™ã‚‹åˆ—ã‚’é¸æŠ",
                options=filtered_df.columns.tolist(),
                default=['customer_id', 'name', 'email', 'company', 'created_at']
            )
            
            if display_columns:
                st.dataframe(
                    filtered_df[display_columns], 
                    use_container_width=True,
                    hide_index=True
                )
            
            # çµ±è¨ˆæƒ…å ±
            col1, col2, col3 = st.columns(3)
            
            with col1:
                st.metric("ç·é¡§å®¢æ•°", len(customers_df))
            
            with col2:
                companies = customers_df['company'].dropna().nunique()
                st.metric("ç™»éŒ²ä¼æ¥­æ•°", companies)
            
            with col3:
                today_customers = customers_df[
                    pd.to_datetime(customers_df['created_at']).dt.date == date.today()
                ]
                st.metric("ä»Šæ—¥ã®æ–°è¦ç™»éŒ²", len(today_customers))
        
        else:
            st.info("ã¾ã é¡§å®¢ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
    
    elif operation == "è¿½åŠ ":
        st.write("**æ–°è¦é¡§å®¢ç™»éŒ²**")
        
        with st.form("add_customer_form"):
            col1, col2 = st.columns(2)
            
            with col1:
                name = st.text_input("é¡§å®¢å *", placeholder="å±±ç”°å¤ªéƒ")
                email = st.text_input("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *", placeholder="yamada@example.com")
                phone = st.text_input("é›»è©±ç•ªå·", placeholder="03-1234-5678")
            
            with col2:
                company = st.text_input("ä¼šç¤¾å", placeholder="æ ªå¼ä¼šç¤¾ã‚µãƒ³ãƒ—ãƒ«")
                address = st.text_area("ä½æ‰€", placeholder="æ±äº¬éƒ½æ¸‹è°·åŒº...")
            
            submitted = st.form_submit_button("ğŸ’¾ é¡§å®¢ã‚’ç™»éŒ²", type="primary")
            
            if submitted:
                if name and email:
                    success, result = db.add_customer(name, email, phone, address, company)
                    
                    if success:
                        st.success(f"âœ… é¡§å®¢ãŒæ­£å¸¸ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼\né¡§å®¢ID: {result}")
                        st.balloons()
                    else:
                        st.error(f"âŒ ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: {result}")
                else:
                    st.error("âŒ å¿…é ˆé …ç›®ï¼ˆé¡§å®¢åã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
    
    elif operation == "ç·¨é›†":
        st.write("**é¡§å®¢æƒ…å ±ç·¨é›†**")
        
        customers_df = db.get_customers()
        
        if not customers_df.empty:
            # ç·¨é›†ã™ã‚‹é¡§å®¢ã‚’é¸æŠ
            customer_options = {
                f"{row['name']} ({row['customer_id']})": row['customer_id'] 
                for _, row in customers_df.iterrows()
            }
            
            selected_customer_label = st.selectbox("ç·¨é›†ã™ã‚‹é¡§å®¢ã‚’é¸æŠ", list(customer_options.keys()))
            
            if selected_customer_label:
                customer_id = customer_options[selected_customer_label]
                customer_data = db.get_customer_by_id(customer_id)
                
                if customer_data:
                    # ç¾åœ¨ã®æƒ…å ±ã‚’è¡¨ç¤º
                    st.write(f"**ç·¨é›†å¯¾è±¡**: {customer_data[2]} ({customer_data[1]})")
                    
                    with st.form("edit_customer_form"):
                        col1, col2 = st.columns(2)
                        
                        with col1:
                            name = st.text_input("é¡§å®¢å *", value=customer_data[2])
                            email = st.text_input("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ *", value=customer_data[3])
                            phone = st.text_input("é›»è©±ç•ªå·", value=customer_data[4] or "")
                        
                        with col2:
                            company = st.text_input("ä¼šç¤¾å", value=customer_data[6] or "")
                            address = st.text_area("ä½æ‰€", value=customer_data[5] or "")
                        
                        submitted = st.form_submit_button("ğŸ’¾ æ›´æ–°", type="primary")
                        
                        if submitted:
                            if name and email:
                                success, result = db.update_customer(customer_id, name, email, phone, address, company)
                                
                                if success:
                                    st.success("âœ… é¡§å®¢æƒ…å ±ãŒæ­£å¸¸ã«æ›´æ–°ã•ã‚Œã¾ã—ãŸï¼")
                                else:
                                    st.error(f"âŒ æ›´æ–°ã«å¤±æ•—ã—ã¾ã—ãŸ: {result}")
                            else:
                                st.error("âŒ å¿…é ˆé …ç›®ï¼ˆé¡§å®¢åã€ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ï¼‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
        else:
            st.info("ç·¨é›†å¯èƒ½ãªé¡§å®¢ãŒã„ã¾ã›ã‚“ã€‚")
    
    elif operation == "å‰Šé™¤":
        st.write("**é¡§å®¢å‰Šé™¤**")
        
        customers_df = db.get_customers()
        
        if not customers_df.empty:
            # å‰Šé™¤ã™ã‚‹é¡§å®¢ã‚’é¸æŠ
            customer_options = {
                f"{row['name']} ({row['customer_id']})": row['customer_id'] 
                for _, row in customers_df.iterrows()
            }
            
            selected_customer_label = st.selectbox("å‰Šé™¤ã™ã‚‹é¡§å®¢ã‚’é¸æŠ", list(customer_options.keys()))
            
            if selected_customer_label:
                customer_id = customer_options[selected_customer_label]
                customer_data = db.get_customer_by_id(customer_id)
                
                if customer_data:
                    # é¡§å®¢æƒ…å ±ã‚’è¡¨ç¤º
                    st.write(f"**å‰Šé™¤å¯¾è±¡**: {customer_data[2]} ({customer_data[1]})")
                    st.write(f"**ãƒ¡ãƒ¼ãƒ«**: {customer_data[3]}")
                    st.write(f"**ä¼šç¤¾**: {customer_data[6] or 'ãªã—'}")
                    
                    st.warning("âš ï¸ ã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚é–¢é€£ã™ã‚‹æ³¨æ–‡ãƒ‡ãƒ¼ã‚¿ã‚‚å‰Šé™¤ã•ã‚Œã¾ã™ã€‚")
                    
                    if st.button("ğŸ—‘ï¸ å‰Šé™¤å®Ÿè¡Œ", type="secondary"):
                        success, result = db.delete_customer(customer_id)
                        
                        if success:
                            st.success("âœ… é¡§å®¢ãŒæ­£å¸¸ã«å‰Šé™¤ã•ã‚Œã¾ã—ãŸã€‚")
                        else:
                            st.error(f"âŒ å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: {result}")
        else:
            st.info("å‰Šé™¤å¯èƒ½ãªé¡§å®¢ãŒã„ã¾ã›ã‚“ã€‚")

with tab2:
    st.subheader("æ³¨æ–‡ç®¡ç†")
    
    operation = st.radio("æ“ä½œã‚’é¸æŠ", ["æ³¨æ–‡ä¸€è¦§", "æ–°è¦æ³¨æ–‡"], horizontal=True)
    
    if operation == "æ³¨æ–‡ä¸€è¦§":
        st.write("**æ³¨æ–‡å±¥æ­´**")
        
        orders_df = db.get_orders()
        
        if not orders_df.empty:
            # ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
            col1, col2 = st.columns(2)
            
            with col1:
                status_filter = st.multiselect(
                    "ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã§ãƒ•ã‚£ãƒ«ã‚¿",
                    options=orders_df['status'].unique(),
                    default=orders_df['status'].unique()
                )
            
            with col2:
                date_range = st.date_input(
                    "æœŸé–“ã§ãƒ•ã‚£ãƒ«ã‚¿",
                    value=(orders_df['order_date'].min(), orders_df['order_date'].max()),
                    min_value=orders_df['order_date'].min(),
                    max_value=orders_df['order_date'].max()
                )
            
            # ãƒ•ã‚£ãƒ«ã‚¿é©ç”¨
            filtered_orders = orders_df[orders_df['status'].isin(status_filter)]
            
            if len(date_range) == 2:
                filtered_orders = filtered_orders[
                    (pd.to_datetime(filtered_orders['order_date']).dt.date >= date_range[0]) &
                    (pd.to_datetime(filtered_orders['order_date']).dt.date <= date_range[1])
                ]
            
            # è¡¨ç¤º
            display_cols = ['order_id', 'customer_name', 'product_name', 'quantity', 'total_amount', 'order_date', 'status']
            st.dataframe(filtered_orders[display_cols], use_container_width=True, hide_index=True)
            
            # çµ±è¨ˆæƒ…å ±
            col1, col2, col3, col4 = st.columns(4)
            
            with col1:
                st.metric("ç·æ³¨æ–‡æ•°", len(filtered_orders))
            
            with col2:
                total_amount = filtered_orders['total_amount'].sum()
                st.metric("ç·å£²ä¸Š", f"Â¥{total_amount:,.0f}")
            
            with col3:
                avg_amount = filtered_orders['total_amount'].mean()
                st.metric("å¹³å‡æ³¨æ–‡é¡", f"Â¥{avg_amount:,.0f}")
            
            with col4:
                pending_orders = len(filtered_orders[filtered_orders['status'] == 'pending'])
                st.metric("ä¿ç•™ä¸­æ³¨æ–‡", pending_orders)
        
        else:
            st.info("ã¾ã æ³¨æ–‡ãŒã‚ã‚Šã¾ã›ã‚“ã€‚")
    
    elif operation == "æ–°è¦æ³¨æ–‡":
        st.write("**æ–°è¦æ³¨æ–‡ç™»éŒ²**")
        
        customers_df = db.get_customers()
        
        if not customers_df.empty:
            with st.form("add_order_form"):
                # é¡§å®¢é¸æŠ
                customer_options = {
                    f"{row['name']} ({row['customer_id']})": row['customer_id'] 
                    for _, row in customers_df.iterrows()
                }
                
                selected_customer = st.selectbox("é¡§å®¢ã‚’é¸æŠ", list(customer_options.keys()))
                
                col1, col2 = st.columns(2)
                
                with col1:
                    product_name = st.text_input("å•†å“å *", placeholder="å•†å“A")
                    quantity = st.number_input("æ•°é‡ *", min_value=1, value=1)
                
                with col2:
                    unit_price = st.number_input("å˜ä¾¡ *", min_value=0.0, value=1000.0, step=100.0)
                    total_preview = quantity * unit_price
                    st.write(f"**åˆè¨ˆé‡‘é¡**: Â¥{total_preview:,.0f}")
                
                submitted = st.form_submit_button("ğŸ“¦ æ³¨æ–‡ã‚’ç™»éŒ²", type="primary")
                
                if submitted:
                    if selected_customer and product_name and quantity > 0 and unit_price > 0:
                        customer_id = customer_options[selected_customer]
                        success, result = db.add_order(customer_id, product_name, quantity, unit_price)
                        
                        if success:
                            st.success(f"âœ… æ³¨æ–‡ãŒæ­£å¸¸ã«ç™»éŒ²ã•ã‚Œã¾ã—ãŸï¼\næ³¨æ–‡ID: {result}")
                        else:
                            st.error(f"âŒ æ³¨æ–‡ç™»éŒ²ã«å¤±æ•—ã—ã¾ã—ãŸ: {result}")
                    else:
                        st.error("âŒ å…¨ã¦ã®å¿…é ˆé …ç›®ã‚’æ­£ã—ãå…¥åŠ›ã—ã¦ãã ã•ã„ã€‚")
        else:
            st.info("æ³¨æ–‡ã‚’ç™»éŒ²ã™ã‚‹ã«ã¯ã€ã¾ãšé¡§å®¢ã‚’ç™»éŒ²ã—ã¦ãã ã•ã„ã€‚")

with tab3:
    st.subheader("çµ±è¨ˆæƒ…å ±")
    
    customers_df = db.get_customers()
    orders_df = db.get_orders()
    
    if not customers_df.empty or not orders_df.empty:
        col1, col2 = st.columns(2)
        
        with col1:
            st.write("**é¡§å®¢çµ±è¨ˆ**")
            if not customers_df.empty:
                # ä¼æ¥­åˆ¥é¡§å®¢æ•°
                if customers_df['company'].notna().any():
                    company_counts = customers_df['company'].value_counts().head(10)
                    st.bar_chart(company_counts)
                
                # æ–°è¦ç™»éŒ²æ¨ç§»
                customers_df['date'] = pd.to_datetime(customers_df['created_at']).dt.date
                daily_registrations = customers_df.groupby('date').size()
                st.line_chart(daily_registrations)
        
        with col2:
            st.write("**æ³¨æ–‡çµ±è¨ˆ**")
            if not orders_df.empty:
                # å•†å“åˆ¥å£²ä¸Š
                product_sales = orders_df.groupby('product_name')['total_amount'].sum().head(10)
                st.bar_chart(product_sales)
                
                # æ—¥åˆ¥å£²ä¸Šæ¨ç§»
                orders_df['order_date'] = pd.to_datetime(orders_df['order_date'])
                daily_sales = orders_df.groupby(orders_df['order_date'].dt.date)['total_amount'].sum()
                st.line_chart(daily_sales)
    else:
        st.info("çµ±è¨ˆã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã®ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“ã€‚")

with tab4:
    st.subheader("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†")
    
    col1, col2 = st.columns(2)
    
    with col1:
        st.write("**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æƒ…å ±**")
        
        # ãƒ†ãƒ¼ãƒ–ãƒ«æƒ…å ±
        with sqlite3.connect(db.db_path) as conn:
            # é¡§å®¢ãƒ†ãƒ¼ãƒ–ãƒ«
            customer_count = conn.execute("SELECT COUNT(*) FROM customers").fetchone()[0]
            st.metric("é¡§å®¢ãƒ†ãƒ¼ãƒ–ãƒ«", f"{customer_count} ãƒ¬ã‚³ãƒ¼ãƒ‰")
            
            # æ³¨æ–‡ãƒ†ãƒ¼ãƒ–ãƒ«
            order_count = conn.execute("SELECT COUNT(*) FROM orders").fetchone()[0]
            st.metric("æ³¨æ–‡ãƒ†ãƒ¼ãƒ–ãƒ«", f"{order_count} ãƒ¬ã‚³ãƒ¼ãƒ‰")
            
            # ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º
            import os
            if os.path.exists(db.db_path):
                db_size = os.path.getsize(db.db_path) / 1024  # KB
                st.metric("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚µã‚¤ã‚º", f"{db_size:.1f} KB")
    
    with col2:
        st.write("**ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ**")
        
        if st.button("ğŸ”„ ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚’ã‚¯ãƒªã‚¢"):
            st.cache_data.clear()
            st.success("ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒã‚¯ãƒªã‚¢ã•ã‚Œã¾ã—ãŸ")
        
        if st.button("ğŸ“Š ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ "):
            # ã‚µãƒ³ãƒ—ãƒ«é¡§å®¢ã‚’è¿½åŠ 
            sample_customers = [
                ("ç”°ä¸­ä¸€éƒ", "tanaka@example.com", "03-1111-1111", "æ±äº¬éƒ½æ–°å®¿åŒº", "æ ªå¼ä¼šç¤¾A"),
                ("ä½è—¤èŠ±å­", "sato@example.com", "03-2222-2222", "æ±äº¬éƒ½æ¸‹è°·åŒº", "æ ªå¼ä¼šç¤¾B"),
                ("å±±ç”°å¤ªéƒ", "yamada@example.com", "03-3333-3333", "å¤§é˜ªåºœå¤§é˜ªå¸‚", "æ ªå¼ä¼šç¤¾C")
            ]
            
            for name, email, phone, address, company in sample_customers:
                db.add_customer(name, email, phone, address, company)
            
            st.success("ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒè¿½åŠ ã•ã‚Œã¾ã—ãŸ")
        
        st.warning("âš ï¸ ä»¥ä¸‹ã®æ“ä½œã¯æ³¨æ„ã—ã¦å®Ÿè¡Œã—ã¦ãã ã•ã„")
        
        if st.button("ğŸ—‘ï¸ å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤", type="secondary"):
            with sqlite3.connect(db.db_path) as conn:
                conn.execute("DELETE FROM orders")
                conn.execute("DELETE FROM customers")
                conn.commit()
            st.cache_data.clear()
            st.success("å…¨ãƒ‡ãƒ¼ã‚¿ãŒå‰Šé™¤ã•ã‚Œã¾ã—ãŸ")
</code></pre>
                        
                        <h6>å¿…è¦ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h6>
                        <pre class="code-block"><code class="language-python"># åŸºæœ¬çš„ã«ã¯Streamlitã«å«ã¾ã‚Œã¦ã„ã‚‹æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ç”¨
# è¿½åŠ ã§PyMySQLï¼ˆMySQLç”¨ï¼‰ã‚„psycopg2ï¼ˆPostgreSQLç”¨ï¼‰ãŒå¿…è¦ãªå ´åˆ
pip install pymysql psycopg2-binary sqlalchemy</code></pre>
                        
                        <h6>å®Ÿè¡Œã¨ç¢ºèª</h6>
                        <pre class="code-block"><code class="language-bash">streamlit run database_app.py</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <p>SQLiteãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨å®Œå…¨ã«çµ±åˆã•ã‚ŒãŸé¡§å®¢ãƒ»æ³¨æ–‡ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ãŒè¡¨ç¤ºã•ã‚Œã€CRUDæ“ä½œãŒã™ã¹ã¦æ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³2: APIçµ±åˆ -->
                    <h3 class="section-title">8.2 å¤–éƒ¨APIçµ±åˆã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒ¼ã‚¿</h3>
                    <p>å¤–éƒ¨APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–°ã™ã‚‹ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ§‹ç¯‰ã™ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 8-2: APIçµ±åˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰</h5>
                        <p>è¤‡æ•°ã®å¤–éƒ¨APIã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§æ›´æ–°ã™ã‚‹ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>api_integration_app.py ã‚’ä½œæˆ</h6>
                        <pre class="code-block"><code class="language-python">import streamlit as st
import requests
import pandas as pd
import plotly.graph_objects as go
import plotly.express as px
from datetime import datetime, timedelta
import time
import json
import base64
from typing import Dict, Any, Optional

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="APIçµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰",
    page_icon="ğŸŒ",
    layout="wide",
    initial_sidebar_state="expanded"
)

class APIManager:
    """APIç®¡ç†ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self):
        self.session = requests.Session()
        self.session.timeout = 10
        
        # ãƒ¬ãƒ¼ãƒˆåˆ¶é™å¯¾å¿œ
        self.last_request_time = {}
        self.min_interval = 1  # æœ€å°ãƒªã‚¯ã‚¨ã‚¹ãƒˆé–“éš”ï¼ˆç§’ï¼‰
    
    def _rate_limit_check(self, api_name: str):
        """ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãƒã‚§ãƒƒã‚¯"""
        current_time = time.time()
        last_time = self.last_request_time.get(api_name, 0)
        
        if current_time - last_time < self.min_interval:
            time.sleep(self.min_interval - (current_time - last_time))
        
        self.last_request_time[api_name] = time.time()
    
    @st.cache_data(ttl=300)  # 5åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    def get_weather_data(_self, city: str = "Tokyo") -> Dict[str, Any]:
        """å¤©æ°—äºˆå ±ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆOpenWeatherMapé¢¨ã®ãƒ€ãƒŸãƒ¼APIï¼‰"""
        _self._rate_limit_check("weather")
        
        try:
            # å®Ÿéš›ã®APIã®ä»£ã‚ã‚Šã«ãƒ€ãƒŸãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆ
            import random
            
            weather_data = {
                "city": city,
                "country": "JP",
                "temperature": round(random.uniform(15, 35), 1),
                "humidity": random.randint(40, 80),
                "pressure": random.randint(990, 1030),
                "wind_speed": round(random.uniform(0, 15), 1),
                "description": random.choice(["æ™´ã‚Œ", "æ›‡ã‚Š", "é›¨", "é›ª"]),
                "timestamp": datetime.now().isoformat()
            }
            
            return {"success": True, "data": weather_data}
        
        except Exception as e:
            return {"success": False, "error": str(e)}
    
    @st.cache_data(ttl=60)  # 1åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    def get_stock_data(_self, symbol: str = "AAPL") -> Dict[str, Any]:
        """æ ªä¾¡ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰"""
        _self._rate_limit_check("stock")
        
        try:
            import random
            
            # ãƒ€ãƒŸãƒ¼æ ªä¾¡ãƒ‡ãƒ¼ã‚¿
            base_price = 150.0
            change_percent = random.uniform(-5, 5)
            current_price = base_price * (1 + change_percent / 100)
            
            stock_data = {
                "symbol": symbol,
                "price": round(current_price, 2),
                "change": round(current_price - base_price, 2),
                "change_percent": round(change_percent, 2),
                "volume": random.randint(1000000, 10000000),
                "high": round(current_price * 1.05, 2),
                "low": round(current_price * 0.95, 2),
                "timestamp": datetime.now().isoformat()
            }
            
            return {"success": True, "data": stock_data}
        
        except Exception as e:
            return {"success": False, "error": str(e)}
    
    @st.cache_data(ttl=120)  # 2åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    def get_news_data(_self, category: str = "technology") -> Dict[str, Any]:
        """ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰"""
        _self._rate_limit_check("news")
        
        try:
            # ãƒ€ãƒŸãƒ¼ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒ‡ãƒ¼ã‚¿
            sample_news = [
                {
                    "title": "AIæŠ€è¡“ã®æœ€æ–°å‹•å‘ã«ã¤ã„ã¦",
                    "summary": "äººå·¥çŸ¥èƒ½æŠ€è¡“ã®æœ€æ–°ãƒˆãƒ¬ãƒ³ãƒ‰ã¨ä»Šå¾Œã®å±•æœ›...",
                    "category": "technology",
                    "published_at": (datetime.now() - timedelta(hours=2)).isoformat(),
                    "source": "Tech News"
                },
                {
                    "title": "æ–°ã—ã„ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªãŒç™»å ´",
                    "summary": "é–‹ç™ºè€…å‘ã‘ã®æ–°è¨€èªãŒãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã€æ³¨ç›®ã‚’é›†ã‚ã¦ã„ã¾ã™...",
                    "category": "technology",
                    "published_at": (datetime.now() - timedelta(hours=5)).isoformat(),
                    "source": "Dev Weekly"
                },
                {
                    "title": "ã‚¯ãƒ©ã‚¦ãƒ‰ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®æœªæ¥",
                    "summary": "ã‚¯ãƒ©ã‚¦ãƒ‰æŠ€è¡“ã®é€²åŒ–ã¨ä¼æ¥­ã¸ã®å½±éŸ¿ã«ã¤ã„ã¦...",
                    "category": "technology",
                    "published_at": (datetime.now() - timedelta(hours=8)).isoformat(),
                    "source": "Cloud Today"
                }
            ]
            
            return {"success": True, "data": sample_news}
        
        except Exception as e:
            return {"success": False, "error": str(e)}
    
    @st.cache_data(ttl=180)  # 3åˆ†é–“ã‚­ãƒ£ãƒƒã‚·ãƒ¥
    def get_crypto_data(_self) -> Dict[str, Any]:
        """ä»®æƒ³é€šè²¨ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆãƒ€ãƒŸãƒ¼ï¼‰"""
        _self._rate_limit_check("crypto")
        
        try:
            import random
            
            crypto_data = []
            
            cryptos = ["Bitcoin", "Ethereum", "Ripple", "Litecoin"]
            base_prices = [45000, 3000, 0.5, 150]
            
            for crypto, base_price in zip(cryptos, base_prices):
                change_percent = random.uniform(-10, 10)
                current_price = base_price * (1 + change_percent / 100)
                
                crypto_data.append({
                    "name": crypto,
                    "symbol": crypto[:3].upper(),
                    "price": round(current_price, 2),
                    "change_24h": round(change_percent, 2),
                    "volume_24h": random.randint(1000000, 100000000),
                    "market_cap": round(current_price * random.randint(10000000, 100000000), 2)
                })
            
            return {"success": True, "data": crypto_data}
        
        except Exception as e:
            return {"success": False, "error": str(e)}

# APIãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®åˆæœŸåŒ–
@st.cache_resource
def get_api_manager():
    return APIManager()

api_manager = get_api_manager()

# ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®åˆæœŸåŒ–
if 'auto_refresh' not in st.session_state:
    st.session_state.auto_refresh = False

if 'refresh_interval' not in st.session_state:
    st.session_state.refresh_interval = 30

st.title("ğŸŒ APIçµ±åˆãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰")

# ã‚µã‚¤ãƒ‰ãƒãƒ¼è¨­å®š
st.sidebar.header("âš™ï¸ ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¨­å®š")

# è‡ªå‹•æ›´æ–°è¨­å®š
auto_refresh = st.sidebar.checkbox("è‡ªå‹•æ›´æ–°", value=st.session_state.auto_refresh)
st.session_state.auto_refresh = auto_refresh

if auto_refresh:
    refresh_interval = st.sidebar.slider(
        "æ›´æ–°é–“éš”ï¼ˆç§’ï¼‰", 
        min_value=10, 
        max_value=300, 
        value=st.session_state.refresh_interval,
        step=10
    )
    st.session_state.refresh_interval = refresh_interval

# æ‰‹å‹•æ›´æ–°ãƒœã‚¿ãƒ³
if st.sidebar.button("ğŸ”„ æ‰‹å‹•æ›´æ–°", type="primary"):
    st.cache_data.clear()
    st.rerun()

# ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹é¸æŠ
st.sidebar.subheader("ğŸ“Š è¡¨ç¤ºãƒ‡ãƒ¼ã‚¿")
show_weather = st.sidebar.checkbox("å¤©æ°—äºˆå ±", value=True)
show_stocks = st.sidebar.checkbox("æ ªä¾¡æƒ…å ±", value=True)
show_crypto = st.sidebar.checkbox("ä»®æƒ³é€šè²¨", value=True)
show_news = st.sidebar.checkbox("ãƒ‹ãƒ¥ãƒ¼ã‚¹", value=True)

# APIæ¥ç¶šçŠ¶æ³
st.sidebar.subheader("ğŸ”— APIæ¥ç¶šçŠ¶æ³")

# æœ€çµ‚æ›´æ–°æ™‚åˆ»è¡¨ç¤º
last_update = datetime.now().strftime("%Y/%m/%d %H:%M:%S")
st.sidebar.write(f"**æœ€çµ‚æ›´æ–°**: {last_update}")

# ãƒ¡ã‚¤ãƒ³ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰
col1, col2 = st.columns([2, 1])

with col1:
    # å¤©æ°—äºˆå ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    if show_weather:
        st.subheader("ğŸŒ¤ï¸ å¤©æ°—äºˆå ±")
        
        weather_result = api_manager.get_weather_data("Tokyo")
        
        if weather_result["success"]:
            weather_data = weather_result["data"]
            
            col1_1, col1_2, col1_3, col1_4 = st.columns(4)
            
            with col1_1:
                st.metric(
                    "æ°—æ¸©", 
                    f"{weather_data['temperature']}Â°C",
                    delta=f"{weather_data['description']}"
                )
            
            with col1_2:
                st.metric("æ¹¿åº¦", f"{weather_data['humidity']}%")
            
            with col1_3:
                st.metric("æ°—åœ§", f"{weather_data['pressure']} hPa")
            
            with col1_4:
                st.metric("é¢¨é€Ÿ", f"{weather_data['wind_speed']} m/s")
        
        else:
            st.error(f"å¤©æ°—ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ã«å¤±æ•—: {weather_result['error']}")
    
    # æ ªä¾¡æƒ…å ±ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    if show_stocks:
        st.subheader("ğŸ“ˆ æ ªä¾¡æƒ…å ±")
        
        symbols = ["AAPL", "GOOGL", "MSFT", "TSLA"]
        
        stock_data_list = []
        
        for symbol in symbols:
            stock_result = api_manager.get_stock_data(symbol)
            
            if stock_result["success"]:
                stock_data_list.append(stock_result["data"])
        
        if stock_data_list:
            stock_df = pd.DataFrame(stock_data_list)
            
            # æ ªä¾¡è¡¨ç¤º
            for _, stock in stock_df.iterrows():
                col_symbol, col_price, col_change = st.columns([1, 1, 1])
                
                with col_symbol:
                    st.write(f"**{stock['symbol']}**")
                
                with col_price:
                    st.metric("ä¾¡æ ¼", f"${stock['price']}")
                
                with col_change:
                    delta_color = "normal" if stock['change'] >= 0 else "inverse"
                    st.metric(
                        "å¤‰å‹•", 
                        f"{stock['change_percent']:+.2f}%",
                        delta=f"${stock['change']:+.2f}"
                    )
            
            # æ ªä¾¡ãƒãƒ£ãƒ¼ãƒˆ
            fig_stocks = px.bar(
                stock_df, 
                x='symbol', 
                y='price',
                title='æ ªä¾¡æ¯”è¼ƒ',
                color='change_percent',
                color_continuous_scale='RdYlGn'
            )
            st.plotly_chart(fig_stocks, use_container_width=True)
    
    # ä»®æƒ³é€šè²¨ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    if show_crypto:
        st.subheader("â‚¿ ä»®æƒ³é€šè²¨")
        
        crypto_result = api_manager.get_crypto_data()
        
        if crypto_result["success"]:
            crypto_data = crypto_result["data"]
            crypto_df = pd.DataFrame(crypto_data)
            
            # ä»®æƒ³é€šè²¨è¡¨ç¤º
            st.dataframe(
                crypto_df,
                use_container_width=True,
                hide_index=True,
                column_config={
                    "price": st.column_config.NumberColumn("ä¾¡æ ¼ ($)", format="$%.2f"),
                    "change_24h": st.column_config.NumberColumn("24hå¤‰å‹• (%)", format="%.2f%%"),
                    "volume_24h": st.column_config.NumberColumn("24hå–å¼•é‡", format="$%d"),
                    "market_cap": st.column_config.NumberColumn("æ™‚ä¾¡ç·é¡", format="$%.0f")
                }
            )
            
            # ä»®æƒ³é€šè²¨ãƒãƒ£ãƒ¼ãƒˆ
            fig_crypto = px.scatter(
                crypto_df,
                x='volume_24h',
                y='price',
                size='market_cap',
                color='change_24h',
                hover_name='name',
                title='ä»®æƒ³é€šè²¨ãƒãƒƒãƒ—ï¼ˆä¾¡æ ¼ vs å–å¼•é‡ï¼‰',
                color_continuous_scale='RdYlGn'
            )
            st.plotly_chart(fig_crypto, use_container_width=True)

with col2:
    # ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚»ã‚¯ã‚·ãƒ§ãƒ³
    if show_news:
        st.subheader("ğŸ“° æœ€æ–°ãƒ‹ãƒ¥ãƒ¼ã‚¹")
        
        news_result = api_manager.get_news_data("technology")
        
        if news_result["success"]:
            news_data = news_result["data"]
            
            for article in news_data:
                with st.container():
                    st.write(f"**{article['title']}**")
                    st.write(f"*{article['source']}*")
                    st.write(article['summary'])
                    
                    published_time = datetime.fromisoformat(article['published_at'].replace('Z', '+00:00'))
                    time_ago = datetime.now() - published_time.replace(tzinfo=None)
                    
                    if time_ago.days > 0:
                        time_str = f"{time_ago.days}æ—¥å‰"
                    elif time_ago.seconds > 3600:
                        time_str = f"{time_ago.seconds // 3600}æ™‚é–“å‰"
                    else:
                        time_str = f"{time_ago.seconds // 60}åˆ†å‰"
                    
                    st.caption(f"ğŸ•’ {time_str}")
                    st.divider()
    
    # ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±
    st.subheader("â„¹ï¸ ã‚·ã‚¹ãƒ†ãƒ æƒ…å ±")
    
    # APIçµ±è¨ˆ
    with st.container():
        st.write("**APIçµ±è¨ˆ**")
        
        api_stats = {
            "å¤©æ°—API": "âœ… æ­£å¸¸" if show_weather else "âšª ç„¡åŠ¹",
            "æ ªä¾¡API": "âœ… æ­£å¸¸" if show_stocks else "âšª ç„¡åŠ¹",
            "ä»®æƒ³é€šè²¨API": "âœ… æ­£å¸¸" if show_crypto else "âšª ç„¡åŠ¹",
            "ãƒ‹ãƒ¥ãƒ¼ã‚¹API": "âœ… æ­£å¸¸" if show_news else "âšª ç„¡åŠ¹"
        }
        
        for api_name, status in api_stats.items():
            st.write(f"- {api_name}: {status}")
    
    # ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æƒ…å ±
    if st.checkbox("ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æƒ…å ±ã‚’è¡¨ç¤º"):
        st.write("**ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**")
        
        # ã‚­ãƒ£ãƒƒã‚·ãƒ¥æƒ…å ±
        cache_info = st.cache_data.info if hasattr(st.cache_data, 'info') else "æƒ…å ±ãªã—"
        st.write(f"ã‚­ãƒ£ãƒƒã‚·ãƒ¥æƒ…å ±: {cache_info}")
        
        # ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ï¼ˆæ¦‚ç®—ï¼‰
        import sys
        memory_usage = sys.getsizeof(st.session_state) / 1024
        st.write(f"ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ¡ãƒ¢ãƒª: {memory_usage:.1f} KB")

# è‡ªå‹•æ›´æ–°æ©Ÿèƒ½
if auto_refresh:
    # ãƒ—ãƒ¬ãƒ¼ã‚¹ãƒ›ãƒ«ãƒ€ãƒ¼ã§ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³è¡¨ç¤º
    placeholder = st.empty()
    
    for remaining in range(refresh_interval, 0, -1):
        placeholder.write(f"â° æ¬¡ã®æ›´æ–°ã¾ã§: {remaining}ç§’")
        time.sleep(1)
    
    placeholder.empty()
    
    # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢ã—ã¦å†å®Ÿè¡Œ
    st.cache_data.clear()
    st.rerun()

# ãƒ•ãƒƒã‚¿ãƒ¼
st.markdown("---")
st.markdown("""
<div style='text-align: center; color: #666; font-size: 0.8em;'>
    ğŸŒ APIçµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ | ãƒ‡ãƒ¼ã‚¿ã¯å­¦ç¿’ç›®çš„ã®ã‚µãƒ³ãƒ—ãƒ«ã§ã™
</div>
""", unsafe_allow_html=True)</code></pre>
                        
                        <h6>å®Ÿè¡Œã¨ç¢ºèª</h6>
                        <pre class="code-block"><code class="language-bash">streamlit run api_integration_app.py</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <p>è¤‡æ•°ã®APIã‹ã‚‰ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ã—ã€è‡ªå‹•æ›´æ–°æ©Ÿèƒ½ä»˜ãã®çµ±åˆãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ãŒè¡¨ç¤ºã•ã‚Œã€å„ç¨®ãƒ‡ãƒ¼ã‚¿ãŒé©åˆ‡ã«å¯è¦–åŒ–ã•ã‚Œã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3: èªè¨¼ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ -->
                    <h3 class="section-title">8.3 èªè¨¼æ©Ÿèƒ½ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£</h3>
                    <p>Streamlitã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«åŸºæœ¬çš„ãªèªè¨¼æ©Ÿèƒ½ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å®Ÿè£…ã™ã‚‹æ–¹æ³•ã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <div class="warning">
                        <h6>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®é‡è¦æ€§</h6>
                        <ul>
                            <li><strong>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†</strong>: ãƒãƒƒã‚·ãƒ¥åŒ–ã¨é©åˆ‡ãªä¿å­˜</li>
                            <li><strong>ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†</strong>: ã‚»ã‚­ãƒ¥ã‚¢ãªã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹</li>
                            <li><strong>å…¥åŠ›æ¤œè¨¼</strong>: SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–</li>
                            <li><strong>ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡</strong>: é©åˆ‡ãªæ¨©é™ç®¡ç†</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 8-3: èªè¨¼æ©Ÿèƒ½ä»˜ãã‚»ã‚­ãƒ¥ã‚¢ã‚¢ãƒ—ãƒª</h5>
                        <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€ã‚¢ã‚¯ã‚»ã‚¹åˆ¶å¾¡ã‚’å«ã‚€ã‚»ã‚­ãƒ¥ã‚¢ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>auth_app.py ã‚’ä½œæˆ</h6>
                        <pre class="code-block"><code class="language-python">import streamlit as st
import hashlib
import sqlite3
import secrets
import time
from datetime import datetime, timedelta
import re
from typing import Optional, Dict, Any

# ãƒšãƒ¼ã‚¸è¨­å®š
st.set_page_config(
    page_title="èªè¨¼æ©Ÿèƒ½ä»˜ãã‚¢ãƒ—ãƒª",
    page_icon="ğŸ”",
    layout="wide"
)

class AuthManager:
    """èªè¨¼ç®¡ç†ã‚¯ãƒ©ã‚¹"""
    
    def __init__(self, db_path="auth.db"):
        self.db_path = db_path
        self.init_database()
        
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³è¨­å®š
        self.session_timeout = 3600  # 1æ™‚é–“
        self.max_login_attempts = 5
        self.lockout_duration = 300  # 5åˆ†
    
    def init_database(self):
        """ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åˆæœŸåŒ–"""
        with sqlite3.connect(self.db_path) as conn:
            # ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«
            conn.execute("""
                CREATE TABLE IF NOT EXISTS users (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    username TEXT UNIQUE NOT NULL,
                    email TEXT UNIQUE NOT NULL,
                    password_hash TEXT NOT NULL,
                    salt TEXT NOT NULL,
                    role TEXT DEFAULT 'user',
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    last_login TIMESTAMP,
                    is_active BOOLEAN DEFAULT 1
                )
            """)
            
            # ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ†ãƒ¼ãƒ–ãƒ«
            conn.execute("""
                CREATE TABLE IF NOT EXISTS sessions (
                    session_id TEXT PRIMARY KEY,
                    username TEXT NOT NULL,
                    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    expires_at TIMESTAMP NOT NULL,
                    ip_address TEXT,
                    user_agent TEXT
                )
            """)
            
            # ãƒ­ã‚°ã‚¤ãƒ³ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«
            conn.execute("""
                CREATE TABLE IF NOT EXISTS login_logs (
                    id INTEGER PRIMARY KEY AUTOINCREMENT,
                    username TEXT,
                    ip_address TEXT,
                    success BOOLEAN,
                    timestamp TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
                    error_message TEXT
                )
            """)
            
            conn.commit()
            
            # ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ
            self._create_admin_if_not_exists(conn)
    
    def _create_admin_if_not_exists(self, conn):
        """ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒå­˜åœ¨ã—ãªã„å ´åˆã¯ä½œæˆ"""
        cursor = conn.execute("SELECT COUNT(*) FROM users WHERE role = 'admin'")
        if cursor.fetchone()[0] == 0:
            # ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ä½œæˆ
            self._create_user_internal(conn, "admin", "admin@example.com", "admin123", "admin")
    
    def _hash_password(self, password: str, salt: bytes = None) -> tuple:
        """ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒãƒƒã‚·ãƒ¥åŒ–"""
        if salt is None:
            salt = secrets.token_bytes(32)
        
        # PBKDF2ã‚’ä½¿ç”¨ã—ã¦ãƒãƒƒã‚·ãƒ¥åŒ–
        password_hash = hashlib.pbkdf2_hmac('sha256', password.encode(), salt, 100000)
        
        return password_hash.hex(), salt.hex()
    
    def _create_user_internal(self, conn, username: str, email: str, password: str, role: str = "user"):
        """å†…éƒ¨ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ"""
        password_hash, salt = self._hash_password(password)
        
        conn.execute("""
            INSERT INTO users (username, email, password_hash, salt, role)
            VALUES (?, ?, ?, ?, ?)
        """, (username, email, password_hash, salt, role))
    
    def validate_password(self, password: str) -> Dict[str, Any]:
        """ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯"""
        errors = []
        
        if len(password) < 8:
            errors.append("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯8æ–‡å­—ä»¥ä¸Šã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™")
        
        if not re.search(r'[A-Z]', password):
            errors.append("å¤§æ–‡å­—ã‚’å«ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™")
        
        if not re.search(r'[a-z]', password):
            errors.append("å°æ–‡å­—ã‚’å«ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™")
        
        if not re.search(r'\d', password):
            errors.append("æ•°å­—ã‚’å«ã‚€å¿…è¦ãŒã‚ã‚Šã¾ã™")
        
        return {
            "valid": len(errors) == 0,
            "errors": errors
        }
    
    def validate_email(self, email: str) -> bool:
        """ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹å½¢å¼ãƒã‚§ãƒƒã‚¯"""
        pattern = r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        return re.match(pattern, email) is not None
    
    def create_user(self, username: str, email: str, password: str, role: str = "user") -> Dict[str, Any]:
        """æ–°ã—ã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ä½œæˆ"""
        # å…¥åŠ›æ¤œè¨¼
        if not username or not email or not password:
            return {"success": False, "error": "å…¨ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}
        
        if not self.validate_email(email):
            return {"success": False, "error": "æœ‰åŠ¹ãªãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„"}
        
        password_check = self.validate_password(password)
        if not password_check["valid"]:
            return {"success": False, "error": "\\n".join(password_check["errors"])}
        
        try:
            with sqlite3.connect(self.db_path) as conn:
                # é‡è¤‡ãƒã‚§ãƒƒã‚¯
                cursor = conn.execute("SELECT COUNT(*) FROM users WHERE username = ? OR email = ?", (username, email))
                if cursor.fetchone()[0] > 0:
                    return {"success": False, "error": "ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¾ãŸã¯ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ—¢ã«ä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã™"}
                
                self._create_user_internal(conn, username, email, password, role)
                conn.commit()
                
                return {"success": True, "message": "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒæ­£å¸¸ã«ä½œæˆã•ã‚Œã¾ã—ãŸ"}
        
        except Exception as e:
            return {"success": False, "error": f"ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆã‚¨ãƒ©ãƒ¼: {str(e)}"}
    
    def authenticate(self, username: str, password: str) -> Dict[str, Any]:
        """ãƒ¦ãƒ¼ã‚¶ãƒ¼èªè¨¼"""
        # ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œå›æ•°ãƒã‚§ãƒƒã‚¯
        if self._is_locked_out(username):
            return {"success": False, "error": "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„"}
        
        try:
            with sqlite3.connect(self.db_path) as conn:
                cursor = conn.execute("""
                    SELECT username, password_hash, salt, role, is_active 
                    FROM users WHERE username = ?
                """, (username,))
                
                user = cursor.fetchone()
                
                if user is None:
                    self._log_login_attempt(username, False, "ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ã¾ã›ã‚“")
                    return {"success": False, "error": "èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ"}
                
                username_db, password_hash_db, salt_db, role, is_active = user
                
                if not is_active:
                    self._log_login_attempt(username, False, "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç„¡åŠ¹ã§ã™")
                    return {"success": False, "error": "ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒç„¡åŠ¹ã§ã™"}
                
                # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æ¤œè¨¼
                password_hash, _ = self._hash_password(password, bytes.fromhex(salt_db))
                
                if password_hash == password_hash_db:
                    # èªè¨¼æˆåŠŸ
                    self._log_login_attempt(username, True)
                    self._update_last_login(username)
                    
                    return {
                        "success": True,
                        "user": {
                            "username": username_db,
                            "role": role
                        }
                    }
                else:
                    # èªè¨¼å¤±æ•—
                    self._log_login_attempt(username, False, "ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒç„¡åŠ¹ã§ã™")
                    return {"success": False, "error": "èªè¨¼ã«å¤±æ•—ã—ã¾ã—ãŸ"}
        
        except Exception as e:
            self._log_login_attempt(username, False, f"ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼: {str(e)}")
            return {"success": False, "error": "ã‚·ã‚¹ãƒ†ãƒ ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ"}
    
    def _is_locked_out(self, username: str) -> bool:
        """ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã‚¢ã‚¦ãƒˆçŠ¶æ…‹ã‚’ãƒã‚§ãƒƒã‚¯"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.execute("""
                SELECT COUNT(*) FROM login_logs 
                WHERE username = ? AND success = 0 
                AND timestamp > datetime('now', '-5 minutes')
            """, (username,))
            
            failed_attempts = cursor.fetchone()[0]
            return failed_attempts >= self.max_login_attempts
    
    def _log_login_attempt(self, username: str, success: bool, error_message: str = None):
        """ãƒ­ã‚°ã‚¤ãƒ³è©¦è¡Œã‚’ãƒ­ã‚°ã«è¨˜éŒ²"""
        with sqlite3.connect(self.db_path) as conn:
            conn.execute("""
                INSERT INTO login_logs (username, success, error_message)
                VALUES (?, ?, ?)
            """, (username, success, error_message))
            conn.commit()
    
    def _update_last_login(self, username: str):
        """æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³æ™‚åˆ»ã‚’æ›´æ–°"""
        with sqlite3.connect(self.db_path) as conn:
            conn.execute("""
                UPDATE users SET last_login = CURRENT_TIMESTAMP 
                WHERE username = ?
            """, (username,))
            conn.commit()
    
    def create_session(self, username: str) -> str:
        """ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ä½œæˆ"""
        session_id = secrets.token_urlsafe(32)
        expires_at = datetime.now() + timedelta(seconds=self.session_timeout)
        
        with sqlite3.connect(self.db_path) as conn:
            conn.execute("""
                INSERT INTO sessions (session_id, username, expires_at)
                VALUES (?, ?, ?)
            """, (session_id, username, expires_at))
            conn.commit()
        
        return session_id
    
    def validate_session(self, session_id: str) -> Optional[Dict[str, Any]]:
        """ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’æ¤œè¨¼"""
        if not session_id:
            return None
        
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.execute("""
                SELECT username, expires_at FROM sessions 
                WHERE session_id = ? AND expires_at > datetime('now')
            """, (session_id,))
            
            session = cursor.fetchone()
            
            if session:
                username, expires_at = session
                return {"username": username, "expires_at": expires_at}
        
        return None
    
    def logout(self, session_id: str):
        """ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ"""
        with sqlite3.connect(self.db_path) as conn:
            conn.execute("DELETE FROM sessions WHERE session_id = ?", (session_id,))
            conn.commit()
    
    def get_user_info(self, username: str) -> Optional[Dict[str, Any]]:
        """ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—"""
        with sqlite3.connect(self.db_path) as conn:
            cursor = conn.execute("""
                SELECT username, email, role, created_at, last_login, is_active
                FROM users WHERE username = ?
            """, (username,))
            
            user = cursor.fetchone()
            
            if user:
                return {
                    "username": user[0],
                    "email": user[1],
                    "role": user[2],
                    "created_at": user[3],
                    "last_login": user[4],
                    "is_active": user[5]
                }
        
        return None

# èªè¨¼ãƒãƒãƒ¼ã‚¸ãƒ£ãƒ¼ã®åˆæœŸåŒ–
@st.cache_resource
def get_auth_manager():
    return AuthManager()

auth_manager = get_auth_manager()

# ã‚»ãƒƒã‚·ãƒ§ãƒ³çŠ¶æ…‹ã®åˆæœŸåŒ–
if 'authenticated' not in st.session_state:
    st.session_state.authenticated = False

if 'session_id' not in st.session_state:
    st.session_state.session_id = None

if 'user_info' not in st.session_state:
    st.session_state.user_info = None

# ã‚»ãƒƒã‚·ãƒ§ãƒ³æ¤œè¨¼
if st.session_state.session_id:
    session_info = auth_manager.validate_session(st.session_state.session_id)
    
    if session_info:
        st.session_state.authenticated = True
        st.session_state.user_info = auth_manager.get_user_info(session_info['username'])
    else:
        # ã‚»ãƒƒã‚·ãƒ§ãƒ³ç„¡åŠ¹
        st.session_state.authenticated = False
        st.session_state.session_id = None
        st.session_state.user_info = None

def show_login_page():
    """ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸ã‚’è¡¨ç¤º"""
    st.title("ğŸ” ãƒ­ã‚°ã‚¤ãƒ³")
    
    tab1, tab2 = st.tabs(["ãƒ­ã‚°ã‚¤ãƒ³", "æ–°è¦ç™»éŒ²"])
    
    with tab1:
        st.subheader("ãƒ­ã‚°ã‚¤ãƒ³")
        
        with st.form("login_form"):
            username = st.text_input("ãƒ¦ãƒ¼ã‚¶ãƒ¼å")
            password = st.text_input("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰", type="password")
            
            submitted = st.form_submit_button("ãƒ­ã‚°ã‚¤ãƒ³", type="primary")
            
            if submitted:
                if username and password:
                    result = auth_manager.authenticate(username, password)
                    
                    if result["success"]:
                        # ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸ
                        session_id = auth_manager.create_session(username)
                        
                        st.session_state.authenticated = True
                        st.session_state.session_id = session_id
                        st.session_state.user_info = auth_manager.get_user_info(username)
                        
                        st.success("ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã—ã¾ã—ãŸï¼")
                        st.rerun()
                    else:
                        st.error(result["error"])
                else:
                    st.error("ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
    
    with tab2:
        st.subheader("æ–°è¦ç™»éŒ²")
        
        with st.form("register_form"):
            new_username = st.text_input("ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆæ–°è¦ï¼‰")
            new_email = st.text_input("ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹")
            new_password = st.text_input("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼ˆæ–°è¦ï¼‰", type="password")
            confirm_password = st.text_input("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç¢ºèª", type="password")
            
            submitted = st.form_submit_button("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆ", type="secondary")
            
            if submitted:
                if new_username and new_email and new_password and confirm_password:
                    if new_password != confirm_password:
                        st.error("ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãŒä¸€è‡´ã—ã¾ã›ã‚“")
                    else:
                        result = auth_manager.create_user(new_username, new_email, new_password)
                        
                        if result["success"]:
                            st.success("ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä½œæˆã•ã‚Œã¾ã—ãŸï¼ãƒ­ã‚°ã‚¤ãƒ³ã—ã¦ãã ã•ã„ã€‚")
                        else:
                            st.error(result["error"])
                else:
                    st.error("å…¨ã¦ã®é …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„")
    
    # ãƒ‡ãƒ¢ç”¨æƒ…å ±
    st.markdown("---")
    with st.expander("ğŸ” ãƒ‡ãƒ¢ç”¨ãƒ­ã‚°ã‚¤ãƒ³æƒ…å ±"):
        st.info("""
        **ç®¡ç†è€…ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ**
        - ãƒ¦ãƒ¼ã‚¶ãƒ¼å: admin
        - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: admin123
        
        **æ³¨æ„**: ã“ã‚Œã¯å­¦ç¿’ç”¨ã®ãƒ‡ãƒ¢ã‚¢ãƒ—ãƒªã§ã™ã€‚å®Ÿéš›ã®é‹ç”¨ã§ã¯å¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚
        """)

def show_dashboard():
    """ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’è¡¨ç¤º"""
    user_info = st.session_state.user_info
    
    st.title(f"ğŸ“Š ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ - {user_info['username']}ã•ã‚“")
    
    # ãƒ˜ãƒƒãƒ€ãƒ¼æƒ…å ±
    col1, col2, col3 = st.columns([2, 1, 1])
    
    with col1:
        st.write(f"**ãƒ­ã‚°ã‚¤ãƒ³ãƒ¦ãƒ¼ã‚¶ãƒ¼**: {user_info['username']}")
        st.write(f"**æ¨©é™**: {user_info['role']}")
        st.write(f"**ãƒ¡ãƒ¼ãƒ«**: {user_info['email']}")
    
    with col2:
        if user_info['last_login']:
            last_login = datetime.fromisoformat(user_info['last_login'].replace('Z', '+00:00'))
            st.metric("æœ€çµ‚ãƒ­ã‚°ã‚¤ãƒ³", last_login.strftime("%m/%d %H:%M"))
    
    with col3:
        if st.button("ğŸšª ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ", type="secondary"):
            auth_manager.logout(st.session_state.session_id)
            
            st.session_state.authenticated = False
            st.session_state.session_id = None
            st.session_state.user_info = None
            
            st.success("ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã—ã¾ã—ãŸ")
            st.rerun()
    
    st.markdown("---")
    
    # æ¨©é™åˆ¥ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
    if user_info['role'] == 'admin':
        show_admin_content()
    else:
        show_user_content()

def show_admin_content():
    """ç®¡ç†è€…å‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„"""
    st.subheader("ğŸ› ï¸ ç®¡ç†è€…æ©Ÿèƒ½")
    
    tab1, tab2, tab3 = st.tabs(["ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†", "ãƒ­ã‚°åˆ†æ", "ã‚·ã‚¹ãƒ†ãƒ è¨­å®š"])
    
    with tab1:
        st.write("**ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§**")
        
        with sqlite3.connect(auth_manager.db_path) as conn:
            users_df = pd.read_sql_query("""
                SELECT username, email, role, created_at, last_login, is_active
                FROM users ORDER BY created_at DESC
            """, conn)
        
        st.dataframe(users_df, use_container_width=True)
    
    with tab2:
        st.write("**ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´**")
        
        with sqlite3.connect(auth_manager.db_path) as conn:
            logs_df = pd.read_sql_query("""
                SELECT username, success, timestamp, error_message
                FROM login_logs ORDER BY timestamp DESC LIMIT 50
            """, conn)
        
        if not logs_df.empty:
            st.dataframe(logs_df, use_container_width=True)
            
            # ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸç‡
            success_rate = logs_df['success'].mean() * 100
            st.metric("ãƒ­ã‚°ã‚¤ãƒ³æˆåŠŸç‡", f"{success_rate:.1f}%")
    
    with tab3:
        st.write("**ã‚·ã‚¹ãƒ†ãƒ è¨­å®š**")
        
        st.info("ç®¡ç†è€…å‘ã‘ã‚·ã‚¹ãƒ†ãƒ è¨­å®šæ©Ÿèƒ½ï¼ˆå®Ÿè£…ä¾‹ï¼‰")
        
        if st.button("ğŸ”„ ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—"):
            with sqlite3.connect(auth_manager.db_path) as conn:
                conn.execute("DELETE FROM sessions WHERE expires_at < datetime('now')")
                conn.commit()
            st.success("æœŸé™åˆ‡ã‚Œã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’å‰Šé™¤ã—ã¾ã—ãŸ")

def show_user_content():
    """ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ã‚³ãƒ³ãƒ†ãƒ³ãƒ„"""
    st.subheader("ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æ©Ÿèƒ½")
    
    st.info("èªè¨¼ãŒå¿…è¦ãªã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ä¾‹")
    
    # ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„
    tab1, tab2 = st.tabs(["ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º", "è¨­å®š"])
    
    with tab1:
        st.write("**ä¿è­·ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿**")
        
        # ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿
        sample_data = pd.DataFrame({
            'Date': pd.date_range('2024-01-01', periods=10),
            'Value': range(10, 20),
            'Category': ['A', 'B'] * 5
        })
        
        st.dataframe(sample_data)
    
    with tab2:
        st.write("**ãƒ¦ãƒ¼ã‚¶ãƒ¼è¨­å®š**")
        
        user_info = st.session_state.user_info
        
        st.write(f"ãƒ¦ãƒ¼ã‚¶ãƒ¼å: {user_info['username']}")
        st.write(f"ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹: {user_info['email']}")
        st.write(f"ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆæ—¥: {user_info['created_at']}")

# ãƒ¡ã‚¤ãƒ³ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³
def main():
    if not st.session_state.authenticated:
        show_login_page()
    else:
        show_dashboard()

if __name__ == "__main__":
    main()</code></pre>
                        
                        <h6>å®Ÿè¡Œã¨ç¢ºèª</h6>
                        <pre class="code-block"><code class="language-bash">streamlit run auth_app.py</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <p>å®Œå…¨ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ã€ãƒ­ã‚°ã‚¤ãƒ³ã€ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã€æ¨©é™ç®¡ç†ï¼‰ã‚’æŒã¤ã‚»ã‚­ãƒ¥ã‚¢ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã€ç®¡ç†è€…ã¨ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ç•°ãªã‚‹ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒç¢ºèªã§ãã¾ã™ã€‚</p>
                    </div>

                    <!-- ç†è§£åº¦ç¢ºèª -->
                    <div class="quiz-container">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>
                                <strong>Streamlitã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ã¯ä½•ã§ã™ã‹ï¼Ÿ</strong>
                                <ul style="list-style-type: none;">
                                    <li>a) @st.cache</li>
                                    <li>b) @st.cache_data</li>
                                    <li>c) @st.cache_resource</li>
                                    <li>d) @st.memo</li>
                                </ul>
                                <details style="margin-top: 0.5rem;">
                                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                                    <p><strong>ç­”ãˆ: c)</strong> @st.cache_resourceã¯ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹éš›ã«ä½¿ç”¨ã—ã¾ã™ã€‚@st.cache_dataã¯ãƒ‡ãƒ¼ã‚¿ã‚’ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã™ã‚‹å ´åˆã«ä½¿ç”¨ã—ã¾ã™ã€‚</p>
                                </details>
                            </li>
                            
                            <li>
                                <strong>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã‚’é˜²ããŸã‚ã®åŸºæœ¬çš„ãªå¯¾ç­–ã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„</strong>
                                <details style="margin-top: 0.5rem;">
                                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                                    <p><strong>ç­”ãˆä¾‹:</strong><br>
                                    1. <strong>ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒª</strong>: ãƒ—ãƒªãƒšã‚¢ãƒ‰ã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã‚’ä½¿ç”¨<br>
                                    2. <strong>å…¥åŠ›æ¤œè¨¼</strong>: ãƒ¦ãƒ¼ã‚¶ãƒ¼å…¥åŠ›ã®å³æ ¼ãªãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³<br>
                                    3. <strong>ã‚¨ã‚¹ã‚±ãƒ¼ãƒ—å‡¦ç†</strong>: ç‰¹æ®Šæ–‡å­—ã®é©åˆ‡ãªã‚¨ã‚¹ã‚±ãƒ¼ãƒ—<br>
                                    4. <strong>æœ€å°æ¨©é™ã®åŸå‰‡</strong>: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®æ¨©é™åˆ¶é™</p>
                                </details>
                            </li>
                            
                            <li>
                                <strong>ã‚»ã‚­ãƒ¥ã‚¢ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç®¡ç†ã§é‡è¦ãªè¦ç´ ã‚’3ã¤ç­”ãˆã¦ãã ã•ã„</strong>
                                <details style="margin-top: 0.5rem;">
                                    <summary>è§£ç­”ã‚’è¦‹ã‚‹</summary>
                                    <p><strong>ç­”ãˆ:</strong><br>
                                    1. <strong>ãƒãƒƒã‚·ãƒ¥åŒ–</strong>: PBKDF2ã€bcryptã€scryptãªã©ã®å¼·åŠ›ãªãƒãƒƒã‚·ãƒ¥é–¢æ•°<br>
                                    2. <strong>ã‚½ãƒ«ãƒˆ</strong>: ãƒ¬ã‚¤ãƒ³ãƒœãƒ¼ãƒ†ãƒ¼ãƒ–ãƒ«æ”»æ’ƒå¯¾ç­–<br>
                                    3. <strong>å¼·åº¦ãƒã‚§ãƒƒã‚¯</strong>: é•·ã•ã€è¤‡é›‘ã•ã®è¦ä»¶<br>
                                    4. <strong>ã‚»ã‚­ãƒ¥ã‚¢ãªä¿å­˜</strong>: å¹³æ–‡ã§ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ä¿å­˜ç¦æ­¢</p>
                                </details>
                            </li>
                        </ol>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="streamlit-learning-material-07.html" class="btn btn-secondary">â† å‰ã®ç« : ãƒãƒ«ãƒãƒšãƒ¼ã‚¸ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³</a>
                        <a href="streamlit-learning-material-09.html" class="btn btn-primary">æ¬¡ã®ç« : ãƒ‡ãƒ—ãƒ­ã‚¤ãƒ¡ãƒ³ãƒˆã¨æœ¬ç•ªç’°å¢ƒ â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->

    <!-- Highlight.js åˆæœŸåŒ– -->
    <script>hljs.highlightAll();</script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>