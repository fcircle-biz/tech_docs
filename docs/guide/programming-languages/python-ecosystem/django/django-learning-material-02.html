<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Django学習教材 第2章 - モデルとデータベース設計</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #2e7d32;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        /* タイトル */
        .chapter-title {
            color: #2e7d32;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #2e7d32;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #388e3c;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e8f5e9;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #2e7d32;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #2e7d32 !important;
            color: white !important;
        }

        .nav-link:hover {
            background-color: #388e3c !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>Django学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-01.html">
                                第1章: Django入門と環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="django-learning-material-02.html">
                                第2章: モデルとデータベース設計
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-03.html">
                                第3章: ビューとURLルーティング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-04.html">
                                第4章: テンプレートとフロントエンド統合
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-05.html">
                                第5章: フォームとユーザー入力処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-06.html">
                                第6章: 認証とユーザー管理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-07.html">
                                第7章: Django REST Framework入門
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-08.html">
                                第8章: テストとデバッグ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-09.html">
                                第9章: デプロイメントと本番環境設定
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="django-learning-material-10.html">
                                第10章: 高度な機能と最適化
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第2章: モデルとデータベース設計</h1>
                </div>

                <div id="chapter2">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">データの永続化とORM（Object-Relational Mapping）</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>DjangoのORM（Object-Relational Mapping）の仕組みと利点を理解する</li>
                            <li>モデルクラスの定義方法と各種フィールドタイプの使い分けを習得する</li>
                            <li>マイグレーション（migration）システムの概念と実行方法を学ぶ</li>
                            <li>リレーションシップ（外部キー、多対多、一対一）の実装方法を理解する</li>
                            <li>QuerySet APIを使用したデータの取得・操作・フィルタリング方法を習得する</li>
                        </ul>
                    </div>

                    <!-- セクション1: ORMとは -->
                    <h3 class="section-title">2.1 ORM（Object-Relational Mapping）の理解</h3>
                    <p>
                        <strong>ORM</strong>とは、オブジェクト指向プログラミング言語のオブジェクトと、リレーショナルデータベースの間でデータを変換するプログラミング技術です。
                    </p>
                    
                    <p>
                        従来のSQL文を直接書くアプローチと比較して、ORMには以下のような利点があります：
                    </p>

                    <h4>ORMを使用しない場合（生のSQL）</h4>
                    <pre class="code-block"><code class="language-sql">-- ユーザー情報を取得するSQL
SELECT * FROM users WHERE age >= 18;

-- 新しいユーザーを追加するSQL
INSERT INTO users (name, email, age) VALUES ('田中太郎', 'tanaka@example.com', 25);</code></pre>

                    <h4>DjangoのORMを使用した場合（Pythonコード）</h4>
                    <pre class="code-block"><code class="language-python"># ユーザー情報を取得
adult_users = User.objects.filter(age__gte=18)

# 新しいユーザーを追加
user = User.objects.create(
    name='田中太郎',
    email='tanaka@example.com',
    age=25
)</code></pre>

                    <h4>ORMの利点</h4>
                    <ul>
                        <li><strong>データベース独立性</strong>: SQLite、PostgreSQL、MySQLなど、異なるデータベースでも同じコードが動作</li>
                        <li><strong>セキュリティ</strong>: SQLインジェクション攻撃を自動的に防止</li>
                        <li><strong>生産性</strong>: Pythonの文法でデータベース操作が可能</li>
                        <li><strong>保守性</strong>: データ構造の変更がコードに反映しやすい</li>
                    </ul>

                    <div class="mermaid">
                        graph TB
                            A["Python オブジェクト<br/>(User, Post, Comment)"] --> B["Django ORM<br/>(QuerySet API)"]
                            B --> C["SQL クエリ<br/>(SELECT, INSERT, UPDATE)"]
                            C --> D["データベース<br/>(SQLite, PostgreSQL, MySQL)"]
                            D --> C
                            C --> B
                            B --> A
                    </div>

                    <!-- セクション2: アプリケーションの作成 -->
                    <h3 class="section-title">2.2 Djangoアプリケーションの作成</h3>
                    <p>
                        モデルを定義する前に、まずDjangoアプリケーションを作成する必要があります。アプリケーションは機能ごとに分割された単位で、ブログ機能、ユーザー管理機能などのように整理されます。
                    </p>

                    <pre class="code-block"><code class="language-bash"># Djangoアプリケーション「blog」を作成
python manage.py startapp blog

# 作成されるディレクトリ構造
blog/
├── __init__.py          # Pythonパッケージ識別
├── admin.py             # 管理サイト設定
├── apps.py              # アプリケーション設定
├── migrations/          # マイグレーションファイル
│   └── __init__.py
├── models.py            # データモデル定義
├── tests.py             # テストファイル
└── views.py             # ビュー関数</code></pre>

                    <h4>アプリケーションの登録</h4>
                    <p>作成したアプリケーションを、プロジェクトの設定ファイル（settings.py）に登録します：</p>

                    <pre class="code-block"><code class="language-python"># mysite/settings.py

INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'blog',  # 作成したアプリケーションを追加
]</code></pre>

                    <!-- セクション3: モデルの定義 -->
                    <h3 class="section-title">2.3 基本的なモデルの定義</h3>
                    <p>
                        モデルは、データベースの各テーブルに対応するPythonクラスです。Djangoでは<code>models.py</code>ファイルにモデルを定義します。
                    </p>

                    <h4>ブログ記事用のモデル例</h4>
                    <pre class="code-block"><code class="language-python"># blog/models.py
from django.db import models
from django.utils import timezone

class Post(models.Model):
    """ブログ記事を表すモデル"""
    title = models.CharField(max_length=200, verbose_name='タイトル')
    content = models.TextField(verbose_name='内容')
    created_date = models.DateTimeField(default=timezone.now, verbose_name='作成日時')
    published_date = models.DateTimeField(blank=True, null=True, verbose_name='公開日時')
    
    class Meta:
        verbose_name = 'ブログ記事'
        verbose_name_plural = 'ブログ記事'
        ordering = ['-created_date']  # 新しい記事から順番に表示
    
    def __str__(self):
        """管理画面やシェルでの表示名"""
        return self.title
    
    def publish(self):
        """記事を公開するメソッド"""
        self.published_date = timezone.now()
        self.save()</code></pre>

                    <h4>主要なフィールドタイプ</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>フィールドタイプ</th>
                                <th>用途</th>
                                <th>例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>CharField</code></td>
                                <td>短いテキスト（最大文字数指定必須）</td>
                                <td>タイトル、名前、メールアドレス</td>
                            </tr>
                            <tr>
                                <td><code>TextField</code></td>
                                <td>長いテキスト</td>
                                <td>記事本文、説明文</td>
                            </tr>
                            <tr>
                                <td><code>IntegerField</code></td>
                                <td>整数</td>
                                <td>年齢、件数、価格</td>
                            </tr>
                            <tr>
                                <td><code>DateTimeField</code></td>
                                <td>日時</td>
                                <td>作成日時、更新日時</td>
                            </tr>
                            <tr>
                                <td><code>BooleanField</code></td>
                                <td>真偽値</td>
                                <td>公開フラグ、有効フラグ</td>
                            </tr>
                            <tr>
                                <td><code>EmailField</code></td>
                                <td>メールアドレス</td>
                                <td>ユーザーのメール</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 2-1: 基本的なモデルの作成</h5>
                        <p>ブログアプリケーションを作成し、記事（Post）モデルを定義してみましょう。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>前章で作成したプロジェクトに、「blog」アプリケーションを作成する</li>
                            <li>settings.pyにアプリケーションを登録する</li>
                            <li>Postモデルを定義する</li>
                            <li>マイグレーションファイルを生成・実行する</li>
                        </ol>

                        <h6>実行コマンド</h6>
                        <pre class="code-block"><code class="language-bash"># アプリケーション作成
python manage.py startapp blog

# マイグレーションファイル生成
python manage.py makemigrations blog

# マイグレーション実行
python manage.py migrate</code></pre>

                        <h6>期待される結果</h6>
                        <p>
                            マイグレーションが成功し、データベースに<code>blog_post</code>テーブルが作成されます。
                            Django Shell（<code>python manage.py shell</code>）で確認できます。
                        </p>
                    </div>

                    <!-- セクション4: マイグレーション -->
                    <h3 class="section-title">2.4 マイグレーション（Migration）システム</h3>
                    <p>
                        <strong>マイグレーション</strong>とは、モデルの定義変更をデータベースのスキーマに反映させるためのシステムです。
                        Djangoでは、モデルの変更を検出して自動的にSQL文を生成し、データベースを更新できます。
                    </p>

                    <div class="mermaid">
                        sequenceDiagram
                            participant Dev as 開発者
                            participant Model as models.py
                            participant Mig as マイグレーション
                            participant DB as データベース
                            
                            Dev->>Model: モデルを変更
                            Dev->>Mig: makemigrations実行
                            Mig->>Mig: 変更を検出してファイル生成
                            Dev->>Mig: migrate実行
                            Mig->>DB: SQLを実行してスキーマ更新
                            DB->>Mig: 完了通知
                            Mig->>Dev: マイグレーション完了
                    </div>

                    <h4>マイグレーションの基本コマンド</h4>
                    <pre class="code-block"><code class="language-bash"># 1. モデル変更の検出とマイグレーションファイル生成
python manage.py makemigrations

# 特定のアプリのみ対象にする場合
python manage.py makemigrations blog

# 2. マイグレーションの実行（データベースに反映）
python manage.py migrate

# 3. マイグレーション状況の確認
python manage.py showmigrations

# 4. 生成されるSQLの確認（実行はしない）
python manage.py sqlmigrate blog 0001</code></pre>

                    <h4>マイグレーションファイルの例</h4>
                    <pre class="code-block"><code class="language-python"># blog/migrations/0001_initial.py
from django.db import migrations, models
import django.utils.timezone

class Migration(migrations.Migration):
    
    initial = True
    
    dependencies = []
    
    operations = [
        migrations.CreateModel(
            name='Post',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(max_length=200, verbose_name='タイトル')),
                ('content', models.TextField(verbose_name='内容')),
                ('created_date', models.DateTimeField(default=django.utils.timezone.now, verbose_name='作成日時')),
                ('published_date', models.DateTimeField(blank=True, null=True, verbose_name='公開日時')),
            ],
            options={
                'verbose_name': 'ブログ記事',
                'verbose_name_plural': 'ブログ記事',
                'ordering': ['-created_date'],
            },
        ),
    ]</code></pre>

                    <!-- セクション5: リレーションシップ -->
                    <h3 class="section-title">2.5 モデル間のリレーションシップ</h3>
                    <p>
                        実際のWebアプリケーションでは、複数のモデルが相互に関連し合っています。
                        Djangoでは、以下の3種類のリレーションシップを定義できます：
                    </p>

                    <h4>1. 一対多リレーション（ForeignKey）</h4>
                    <p>最も一般的なリレーション。一つのオブジェクトが複数の関連オブジェクトを持つ関係です。</p>

                    <pre class="code-block"><code class="language-python"># blog/models.py に追加
from django.contrib.auth.models import User

class Category(models.Model):
    """記事のカテゴリを表すモデル"""
    name = models.CharField(max_length=100, verbose_name='カテゴリ名')
    description = models.TextField(blank=True, verbose_name='説明')
    
    class Meta:
        verbose_name = 'カテゴリ'
        verbose_name_plural = 'カテゴリ'
    
    def __str__(self):
        return self.name

class Post(models.Model):
    title = models.CharField(max_length=200, verbose_name='タイトル')
    content = models.TextField(verbose_name='内容')
    # 著者との一対多リレーション
    author = models.ForeignKey(User, on_delete=models.CASCADE, verbose_name='著者')
    # カテゴリとの一対多リレーション
    category = models.ForeignKey(Category, on_delete=models.SET_NULL, null=True, blank=True, verbose_name='カテゴリ')
    created_date = models.DateTimeField(default=timezone.now, verbose_name='作成日時')
    published_date = models.DateTimeField(blank=True, null=True, verbose_name='公開日時')
    
    def __str__(self):
        return self.title</code></pre>

                    <h4>on_deleteオプションの種類</h4>
                    <ul>
                        <li><strong>CASCADE</strong>: 参照先が削除されると、このレコードも削除</li>
                        <li><strong>SET_NULL</strong>: 参照先が削除されると、このフィールドをNULLに設定</li>
                        <li><strong>SET_DEFAULT</strong>: 参照先が削除されると、デフォルト値に設定</li>
                        <li><strong>PROTECT</strong>: 参照先の削除を防ぐ（エラーを発生）</li>
                    </ul>

                    <h4>2. 多対多リレーション（ManyToManyField）</h4>
                    <p>複数のオブジェクトが互いに関連し合う関係です。記事にタグを付ける場合などに使用します。</p>

                    <pre class="code-block"><code class="language-python">class Tag(models.Model):
    """タグを表すモデル"""
    name = models.CharField(max_length=50, unique=True, verbose_name='タグ名')
    
    class Meta:
        verbose_name = 'タグ'
        verbose_name_plural = 'タグ'
    
    def __str__(self):
        return self.name

class Post(models.Model):
    # ... 他のフィールド ...
    
    # タグとの多対多リレーション
    tags = models.ManyToManyField(Tag, blank=True, verbose_name='タグ')
</code></pre>

                    <h4>3. 一対一リレーション（OneToOneField）</h4>
                    <p>ユーザープロフィールの拡張などで使用される、一対一の関係です。</p>

                    <pre class="code-block"><code class="language-python">class Profile(models.Model):
    """ユーザープロフィール拡張"""
    user = models.OneToOneField(User, on_delete=models.CASCADE, verbose_name='ユーザー')
    bio = models.TextField(max_length=500, blank=True, verbose_name='自己紹介')
    location = models.CharField(max_length=30, blank=True, verbose_name='住所')
    birth_date = models.DateField(null=True, blank=True, verbose_name='生年月日')
    
    def __str__(self):
        return f"{self.user.username}のプロフィール"</code></pre>

                    <!-- セクション6: QuerySet API -->
                    <h3 class="section-title">2.6 QuerySet APIでのデータ操作</h3>
                    <p>
                        <strong>QuerySet</strong>は、データベースからオブジェクトを取得・操作するためのDjangoの強力なAPIです。
                        SQLを直接書くことなく、Pythonのメソッドチェーンでクエリを構築できます。
                    </p>

                    <h4>基本的な取得操作</h4>
                    <pre class="code-block"><code class="language-python"># Django Shellで実行（python manage.py shell）

from blog.models import Post, Category, Tag
from django.contrib.auth.models import User

# 全ての記事を取得
all_posts = Post.objects.all()

# 特定の条件で記事を検索
published_posts = Post.objects.filter(published_date__isnull=False)

# 一つのオブジェクトを取得
first_post = Post.objects.get(pk=1)  # 主キーで取得
latest_post = Post.objects.first()   # 最初のレコード

# 条件による絞り込み
tech_posts = Post.objects.filter(category__name='技術')
recent_posts = Post.objects.filter(created_date__gte='2024-01-01')

# 複数条件の組み合わせ
popular_tech_posts = Post.objects.filter(
    category__name='技術',
    created_date__gte='2024-01-01'
)</code></pre>

                    <h4>フィールド検索（Field Lookups）</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>検索方法</th>
                                <th>説明</th>
                                <th>例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>__exact</code></td>
                                <td>完全一致</td>
                                <td><code>title__exact='Django入門'</code></td>
                            </tr>
                            <tr>
                                <td><code>__icontains</code></td>
                                <td>大文字小文字を区別しない部分一致</td>
                                <td><code>title__icontains='django'</code></td>
                            </tr>
                            <tr>
                                <td><code>__startswith</code></td>
                                <td>前方一致</td>
                                <td><code>title__startswith='Python'</code></td>
                            </tr>
                            <tr>
                                <td><code>__gt, __gte</code></td>
                                <td>より大きい、以上</td>
                                <td><code>created_date__gte='2024-01-01'</code></td>
                            </tr>
                            <tr>
                                <td><code>__isnull</code></td>
                                <td>NULLかどうか</td>
                                <td><code>published_date__isnull=False</code></td>
                            </tr>
                            <tr>
                                <td><code>__in</code></td>
                                <td>リストに含まれる</td>
                                <td><code>id__in=[1, 2, 3]</code></td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 2-2: リレーションシップとQuerySet操作</h5>
                        <p>カテゴリとタグを含む拡張されたブログモデルを実装し、QuerySet APIでデータ操作を行いましょう。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Category、Tag、Profileモデルを追加する</li>
                            <li>Postモデルにリレーションシップを追加する</li>
                            <li>マイグレーションを生成・実行する</li>
                            <li>Django Shellでサンプルデータを作成し、QuerySetを試す</li>
                        </ol>

                        <h6>サンプルデータ作成</h6>
                        <pre class="code-block"><code class="language-python"># Django Shellで実行
from django.contrib.auth.models import User
from blog.models import Post, Category, Tag

# ユーザーとカテゴリの作成
user = User.objects.create_user('testuser', 'test@example.com', 'password')
tech_category = Category.objects.create(name='技術', description='プログラミング関連')

# タグの作成
python_tag = Tag.objects.create(name='Python')
django_tag = Tag.objects.create(name='Django')

# 記事の作成
post = Post.objects.create(
    title='Django入門',
    content='Djangoの基本的な使い方について',
    author=user,
    category=tech_category
)

# 記事にタグを追加
post.tags.add(python_tag, django_tag)</code></pre>

                        <h6>期待される結果</h6>
                        <p>
                            リレーションシップが正しく設定され、フィルター検索や関連データの取得が可能になります。
                            管理サイトでも関連データが適切に表示されるようになります。
                        </p>
                    </div>

                    <!-- セクション7: 管理サイト統合 -->
                    <h3 class="section-title">2.7 Django管理サイトでのモデル管理</h3>
                    <p>
                        作成したモデルをDjango管理サイトで管理できるように設定しましょう。
                        <code>admin.py</code>ファイルでモデルを登録することで、Web画面でのデータ管理が可能になります。
                    </p>

                    <pre class="code-block"><code class="language-python"># blog/admin.py
from django.contrib import admin
from .models import Post, Category, Tag, Profile

@admin.register(Category)
class CategoryAdmin(admin.ModelAdmin):
    list_display = ['name', 'description']
    search_fields = ['name']

@admin.register(Tag)
class TagAdmin(admin.ModelAdmin):
    list_display = ['name']
    search_fields = ['name']

@admin.register(Post)
class PostAdmin(admin.ModelAdmin):
    list_display = ['title', 'author', 'category', 'created_date', 'published_date']
    list_filter = ['category', 'created_date', 'published_date']
    search_fields = ['title', 'content']
    date_hierarchy = 'created_date'
    filter_horizontal = ['tags']  # 多対多フィールドを使いやすく表示

@admin.register(Profile)
class ProfileAdmin(admin.ModelAdmin):
    list_display = ['user', 'location', 'birth_date']
    search_fields = ['user__username', 'location']</code></pre>

                    <div class="warning">
                        <h6>管理サイト活用のポイント</h6>
                        <ul>
                            <li><code>list_display</code>: 一覧画面で表示する項目</li>
                            <li><code>list_filter</code>: サイドバーに表示するフィルター項目</li>
                            <li><code>search_fields</code>: 検索対象フィールド</li>
                            <li><code>date_hierarchy</code>: 日付による階層表示</li>
                            <li><code>filter_horizontal</code>: 多対多関係の見やすい表示</li>
                        </ul>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>Djangoのマイグレーションファイルを生成するコマンドはどれですか？</strong>
                                <ul>
                                    <li>a) python manage.py migrate</li>
                                    <li>b) python manage.py makemigrations</li>
                                    <li>c) python manage.py migratedb</li>
                                    <li>d) python manage.py createdb</li>
                                </ul>
                            </li>
                            <li><strong>一対多のリレーションシップを定義するために使用するフィールドタイプは？</strong>
                                <ul>
                                    <li>a) ManyToManyField</li>
                                    <li>b) OneToOneField</li>
                                    <li>c) ForeignKey</li>
                                    <li>d) CharField</li>
                                </ul>
                            </li>
                            <li><strong>タイトルに「Django」が含まれる記事を検索するQuerySetは？</strong>
                                <ul>
                                    <li>a) Post.objects.filter(title='Django')</li>
                                    <li>b) Post.objects.filter(title__contains='Django')</li>
                                    <li>c) Post.objects.get(title='Django')</li>
                                    <li>d) Post.objects.search(title='Django')</li>
                                </ul>
                            </li>
                            <li><strong>on_delete=models.CASCADEの動作は？</strong>
                                <ul>
                                    <li>a) 参照先が削除されても何もしない</li>
                                    <li>b) 参照先が削除されると、このレコードも削除</li>
                                    <li>c) 参照先が削除されると、このフィールドをNULLに設定</li>
                                    <li>d) 参照先の削除を防ぐ</li>
                                </ul>
                            </li>
                            <li><strong>Django管理サイトでモデルを登録するファイルは？</strong>
                                <ul>
                                    <li>a) models.py</li>
                                    <li>b) views.py</li>
                                    <li>c) admin.py</li>
                                    <li>d) settings.py</li>
                                </ul>
                            </li>
                        </ol>
                        
                        <details>
                            <summary>解答を見る</summary>
                            <p>
                                1. b) python manage.py makemigrations - マイグレーションファイル生成<br>
                                2. c) ForeignKey - 一対多リレーションシップの定義<br>
                                3. b) Post.objects.filter(title__contains='Django') - 部分一致検索<br>
                                4. b) 参照先が削除されると、このレコードも削除 - CASCADE動作<br>
                                5. c) admin.py - 管理サイトでのモデル登録ファイル
                            </p>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="django-learning-material-01.html" class="btn btn-secondary">← 前の章</a>
                        <a href="django-learning-material-03.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>