<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クラウドコンピューティング学習教材 第5章 - GCP基礎サービス</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
            line-height: 1.8;
        }

        /* ナビゲーション */
        .navbar {
            background: linear-gradient(135deg, #0d6efd 0%, #0dcaf0 100%);
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
            border-right: 1px solid #dee2e6;
        }

        .sidebar .nav-link {
            color: #495057;
            padding: 0.75rem 1rem;
            transition: all 0.3s;
        }

        .sidebar .nav-link:hover {
            background-color: #e9ecef;
            color: #0d6efd;
        }

        .sidebar .nav-link.active {
            background-color: #0d6efd !important;
            color: white !important;
        }

        /* タイトル */
        .chapter-title {
            color: #0d6efd;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #0d6efd;
            padding-bottom: 0.5rem;
            font-weight: 700;
        }

        .section-title {
            color: #0dcaf0;
            margin-top: 2rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e7f3ff;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0d6efd;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #fff8e1;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info-box {
            background-color: #e8f5e9;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
            overflow-x: auto;
        }

        /* テーブル */
        .table {
            margin: 1.5rem 0;
        }

        .table thead {
            background-color: #0d6efd;
            color: white;
        }

        /* リスト */
        ul, ol {
            margin: 1rem 0;
            padding-left: 2rem;
        }

        li {
            margin: 0.5rem 0;
        }

        /* ボタン */
        .btn-primary {
            background-color: #0d6efd;
            border-color: #0d6efd;
        }

        .btn-primary:hover {
            background-color: #0b5ed7;
            border-color: #0a58ca;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <strong>クラウドコンピューティング学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-1.html">
                                第1章: クラウドコンピューティングの基礎概念
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-2.html">
                                第2章: 主要クラウドプロバイダーの比較とアカウント作成
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-3.html">
                                第3章: AWS基礎サービス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-4.html">
                                第4章: Azure基礎サービス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="cloud-computing-learning-material-5.html">
                                第5章: GCP基礎サービス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-6.html">
                                第6章: クラウドネットワーキングとセキュリティ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-7.html">
                                第7章: クラウドアーキテクチャパターンと設計原則
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-8.html">
                                第8章: サーバーレスコンピューティングとコンテナサービス
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-9.html">
                                第9章: クラウドコスト管理とモニタリング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="cloud-computing-learning-material-10.html">
                                第10章: クラウドベストプラクティスと実践プロジェクト
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第5章: GCP基礎サービス（Compute Engine、Cloud Storage、Cloud SQL）</h1>
                </div>

                <div id="chapter5">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">Google Cloud Platformの主要サービスを理解する</h2>

                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>GCPのリソース階層（組織、フォルダ、プロジェクト、リソース）を理解する</li>
                            <li>Google Compute Engineの作成・管理・操作方法を習得する</li>
                            <li>Google Cloud Storageのストレージクラスと使い分けを理解する</li>
                            <li>Cloud SQLの作成と接続方法を習得する</li>
                            <li>ファイアウォールルールとVPCネットワークの設定を理解する</li>
                            <li>GCPコンソールとCloud Shellの効果的な使い方を身につける</li>
                            <li>gcloudコマンドラインツールの基本操作を学ぶ</li>
                            <li>プリエンプティブルVMによるコスト最適化を理解する</li>
                        </ul>
                    </div>

                    <!-- セクション5.1 -->
                    <h3 class="section-title">5.1 GCPのリソース階層とプロジェクト</h3>

                    <h4>GCPのリソース階層構造</h4>
                    <p>
                        Google Cloud Platform（GCP）は、<strong>階層的なリソース管理構造</strong>を採用しており、組織全体のガバナンスとリソース管理を効率化します。
                    </p>

                    <div class="mermaid">
                        graph TD
                            A[組織<br/>Organization] --> B[フォルダ<br/>Folder]
                            B --> C[プロジェクト<br/>Project]
                            C --> D[リソース<br/>Resources]
                            D --> E1[Compute Engine VM]
                            D --> E2[Cloud Storage Bucket]
                            D --> E3[Cloud SQL Instance]
                            D --> E4[その他のサービス]
                    </div>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>階層レベル</th>
                                <th>説明</th>
                                <th>用途</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>組織</strong><br/>(Organization)</td>
                                <td>企業全体を表す最上位のコンテナ。Google Workspaceまたは Cloud Identityドメインに紐付く</td>
                                <td>大規模組織全体のポリシー管理、一元的なアクセス制御</td>
                            </tr>
                            <tr>
                                <td><strong>フォルダ</strong><br/>(Folder)</td>
                                <td>プロジェクトをグループ化する中間層。階層化可能</td>
                                <td>部門別、チーム別、環境別（本番/開発）の分離</td>
                            </tr>
                            <tr>
                                <td><strong>プロジェクト</strong><br/>(Project)</td>
                                <td>リソースの基本的な組織単位。課金、アクセス制御の基本単位</td>
                                <td>アプリケーション単位、サービス単位でのリソース管理</td>
                            </tr>
                            <tr>
                                <td><strong>リソース</strong><br/>(Resources)</td>
                                <td>実際のGCPサービスのインスタンス（VM、ストレージ等）</td>
                                <td>具体的なクラウドサービスの実体</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>プロジェクトの重要性</h4>
                    <p>
                        <strong>プロジェクトは、GCPにおける最も重要な概念の1つ</strong>です。すべてのリソースはプロジェクトに属し、プロジェクト単位で管理されます。
                    </p>

                    <ul>
                        <li><strong>リソースの分離</strong>: プロジェクト間でリソースは完全に分離される</li>
                        <li><strong>課金の基本単位</strong>: プロジェクト単位で課金が追跡される</li>
                        <li><strong>APIの有効化</strong>: プロジェクトごとにGoogle APIを有効化する必要がある</li>
                        <li><strong>プロジェクトID</strong>: 全世界で一意のIDが割り当てられる（変更不可）</li>
                        <li><strong>プロジェクト番号</strong>: GCPが自動的に割り当てる一意の番号</li>
                    </ul>

                    <div class="info-box">
                        <h6>プロジェクトのベストプラクティス</h6>
                        <ul>
                            <li><strong>環境ごとにプロジェクトを分離</strong>: 本番環境、ステージング環境、開発環境でプロジェクトを分ける</li>
                            <li><strong>命名規則の統一</strong>: 例：company-project-environment（mycompany-webapp-prod）</li>
                            <li><strong>ラベルの活用</strong>: environment、team、cost-centerなどのラベルでリソースを分類</li>
                            <li><strong>IAMの最小権限の原則</strong>: 必要最小限の権限のみを付与</li>
                        </ul>
                    </div>

                    <!-- セクション5.2 -->
                    <h3 class="section-title">5.2 Google Compute Engine（VM）</h3>

                    <h4>Google Compute Engineの概要</h4>
                    <p>
                        <strong>Google Compute Engine（GCE）は、GCPの仮想マシンサービスで、AWSのEC2、AzureのVMに相当</strong>します。高性能なVMインスタンスを柔軟に作成・管理できます。
                    </p>

                    <h4>マシンタイプの選択</h4>
                    <p>
                        GCPでは、事前定義されたマシンタイプの他、カスタムマシンタイプを作成することも可能です。
                    </p>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>マシンファミリー</th>
                                <th>用途</th>
                                <th>特徴</th>
                                <th>具体例</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>E2シリーズ</strong></td>
                                <td>コスト最適化された汎用</td>
                                <td>最もコスト効率が高い</td>
                                <td>e2-micro, e2-small, e2-medium</td>
                            </tr>
                            <tr>
                                <td><strong>N2シリーズ</strong></td>
                                <td>汎用ワークロード</td>
                                <td>バランスの取れたパフォーマンス</td>
                                <td>n2-standard-2, n2-standard-4</td>
                            </tr>
                            <tr>
                                <td><strong>N2Dシリーズ</strong></td>
                                <td>汎用（AMD EPYC）</td>
                                <td>N2よりコスト効率が高い</td>
                                <td>n2d-standard-2, n2d-standard-4</td>
                            </tr>
                            <tr>
                                <td><strong>C2シリーズ</strong></td>
                                <td>コンピューティング最適化</td>
                                <td>高いCPUパフォーマンス</td>
                                <td>c2-standard-4, c2-standard-8</td>
                            </tr>
                            <tr>
                                <td><strong>M2シリーズ</strong></td>
                                <td>メモリ最適化</td>
                                <td>大容量メモリが必要なワークロード</td>
                                <td>m2-ultramem-208, m2-megamem-416</td>
                            </tr>
                            <tr>
                                <td><strong>カスタム</strong></td>
                                <td>独自の仕様</td>
                                <td>vCPUとメモリを自由に組み合わせ</td>
                                <td>custom-4-16384（4 vCPU、16 GB）</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>プリエンプティブルVMとスポットVM</h4>
                    <p>
                        GCPには、<strong>大幅にコストを削減できる2種類の低価格VMオプション</strong>があります。
                    </p>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>種類</th>
                                <th>コスト削減率</th>
                                <th>最大実行時間</th>
                                <th>特徴</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>プリエンプティブルVM</strong></td>
                                <td>最大80%削減</td>
                                <td>24時間</td>
                                <td>いつでも停止される可能性がある。バッチ処理、開発環境に適している</td>
                            </tr>
                            <tr>
                                <td><strong>スポットVM</strong></td>
                                <td>最大91%削減</td>
                                <td>制限なし</td>
                                <td>プリエンプティブルVMの後継。より柔軟で長時間実行可能</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="exercise-container">
                        <h5>実習 5-1: Google Compute Engineの作成とCloud Shellの使用</h5>

                        <p><strong>ステップ1: GCPコンソールにログイン</strong></p>
                        <ol>
                            <li>ブラウザで <code>https://console.cloud.google.com</code> にアクセス</li>
                            <li>Googleアカウントでサインイン</li>
                            <li>プロジェクトを選択（または新規作成）</li>
                        </ol>

                        <p><strong>ステップ2: Cloud Shellの起動</strong></p>
                        <ol>
                            <li>GCPコンソール右上の「Cloud Shellを有効にする」アイコンをクリック</li>
                            <li>ブラウザ下部にCloud Shellターミナルが表示される</li>
                        </ol>

                        <p><strong>ステップ3: gcloudコマンドでVMインスタンス作成</strong></p>
                        <pre><code class="language-bash"># プロジェクトIDの確認
gcloud config get-value project

# プロジェクトIDの設定（必要に応じて）
gcloud config set project YOUR_PROJECT_ID

# デフォルトリージョンとゾーンの設定
gcloud config set compute/region asia-northeast1
gcloud config set compute/zone asia-northeast1-a

# VMインスタンスの作成（Ubuntu 22.04）
gcloud compute instances create my-vm-instance \
    --machine-type=e2-micro \
    --zone=asia-northeast1-a \
    --image-family=ubuntu-2204-lts \
    --image-project=ubuntu-os-cloud \
    --boot-disk-size=10GB \
    --boot-disk-type=pd-standard \
    --tags=http-server

# インスタンス一覧の確認
gcloud compute instances list</code></pre>

                        <p><strong>ステップ4: SSHでVMに接続</strong></p>
                        <pre><code class="language-bash"># gcloudコマンドで接続（最も簡単）
gcloud compute ssh my-vm-instance --zone=asia-northeast1-a

# 接続後、VMで実行
hostname
uname -a
df -h

# 接続を終了
exit</code></pre>

                        <p><strong>ステップ5: ファイアウォールルールの追加</strong></p>
                        <pre><code class="language-bash"># HTTP（ポート80）を許可するファイアウォールルール作成
gcloud compute firewall-rules create allow-http \
    --allow tcp:80 \
    --target-tags http-server \
    --description "Allow HTTP traffic"

# ファイアウォールルール一覧
gcloud compute firewall-rules list</code></pre>

                        <p><strong>ステップ6: VMインスタンスの停止と削除</strong></p>
                        <pre><code class="language-bash"># インスタンスの停止
gcloud compute instances stop my-vm-instance --zone=asia-northeast1-a

# インスタンスの削除
gcloud compute instances delete my-vm-instance --zone=asia-northeast1-a

# ファイアウォールルールの削除
gcloud compute firewall-rules delete allow-http</code></pre>
                    </div>

                    <div class="warning">
                        <h6>重要：無料枠の制限</h6>
                        <p>
                            GCPの無料枠では、<strong>e2-micro インスタンス1台</strong>を米国リージョン（us-west1、us-central1、us-east1）で月間744時間（1ヶ月分）まで無料で使用できます。アジアリージョン（asia-northeast1等）では課金が発生するため、学習時は米国リージョンの使用を推奨します。
                        </p>
                    </div>

                    <!-- セクション5.3 -->
                    <h3 class="section-title">5.3 Google Cloud Storage</h3>

                    <h4>Google Cloud Storageの概要</h4>
                    <p>
                        <strong>Google Cloud Storageは、AWSのS3、AzureのBlob Storageに相当するオブジェクトストレージサービス</strong>です。高い耐久性と可用性を提供し、あらゆるデータを保存できます。
                    </p>

                    <h4>ストレージクラス</h4>
                    <p>
                        Cloud Storageには、<strong>データのアクセス頻度に応じた4つのストレージクラス</strong>があります。
                    </p>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>ストレージクラス</th>
                                <th>最小保存期間</th>
                                <th>特徴</th>
                                <th>用途</th>
                                <th>月額料金（参考）</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>Standard</strong></td>
                                <td>なし</td>
                                <td>頻繁にアクセスされるデータ</td>
                                <td>Webサイトコンテンツ、動画配信、モバイルアプリ</td>
                                <td>$0.020/GB（アジア）</td>
                            </tr>
                            <tr>
                                <td><strong>Nearline</strong></td>
                                <td>30日</td>
                                <td>月1回程度のアクセス</td>
                                <td>データバックアップ、長期保存コンテンツ</td>
                                <td>$0.010/GB（アジア）</td>
                            </tr>
                            <tr>
                                <td><strong>Coldline</strong></td>
                                <td>90日</td>
                                <td>四半期に1回程度のアクセス</td>
                                <td>災害復旧、アーカイブ</td>
                                <td>$0.004/GB（アジア）</td>
                            </tr>
                            <tr>
                                <td><strong>Archive</strong></td>
                                <td>365日</td>
                                <td>年1回未満のアクセス</td>
                                <td>長期アーカイブ、規制対応データ</td>
                                <td>$0.0012/GB（アジア）</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>アクセス制御</h4>
                    <p>
                        Cloud Storageには、複数のアクセス制御方法があります。
                    </p>

                    <ul>
                        <li><strong>IAM（Identity and Access Management）</strong>: プロジェクトレベル、バケットレベルでの権限管理（推奨）</li>
                        <li><strong>ACL（Access Control Lists）</strong>: オブジェクト単位での詳細な権限設定</li>
                        <li><strong>署名付きURL</strong>: 一時的なアクセス権限を付与するURL</li>
                        <li><strong>公開アクセス</strong>: すべてのユーザーにアクセスを許可（注意が必要）</li>
                    </ul>

                    <div class="exercise-container">
                        <h5>実習 5-2: Cloud Storageバケットの作成とファイルアップロード</h5>

                        <p><strong>ステップ1: Cloud Shellでバケット作成</strong></p>
                        <pre><code class="language-bash"># バケット名を環境変数に設定（全世界で一意な名前）
BUCKET_NAME="my-unique-bucket-$(date +%s)"
echo "バケット名: $BUCKET_NAME"

# バケットの作成（Standard、asia-northeast1リージョン）
gsutil mb -c STANDARD -l asia-northeast1 gs://$BUCKET_NAME

# バケット一覧の確認
gsutil ls</code></pre>

                        <p><strong>ステップ2: ファイルのアップロード</strong></p>
                        <pre><code class="language-bash"># サンプルファイルの作成
echo "Hello, Google Cloud Storage!" > sample.txt

# ファイルのアップロード
gsutil cp sample.txt gs://$BUCKET_NAME/

# バケット内のファイル一覧
gsutil ls gs://$BUCKET_NAME/

# ファイルの詳細確認
gsutil ls -L gs://$BUCKET_NAME/sample.txt</code></pre>

                        <p><strong>ステップ3: ファイルのダウンロード</strong></p>
                        <pre><code class="language-bash"># ファイルのダウンロード
gsutil cp gs://$BUCKET_NAME/sample.txt downloaded-sample.txt

# 内容確認
cat downloaded-sample.txt</code></pre>

                        <p><strong>ステップ4: ストレージクラスの変更</strong></p>
                        <pre><code class="language-bash"># オブジェクトのストレージクラスをNearlineに変更
gsutil rewrite -s NEARLINE gs://$BUCKET_NAME/sample.txt

# 変更確認
gsutil ls -L gs://$BUCKET_NAME/sample.txt | grep "Storage class"</code></pre>

                        <p><strong>ステップ5: ライフサイクル管理の設定</strong></p>
                        <pre><code class="language-bash"># ライフサイクル設定JSONの作成
cat > lifecycle.json << 'EOF'
{
  "lifecycle": {
    "rule": [
      {
        "action": {"type": "SetStorageClass", "storageClass": "NEARLINE"},
        "condition": {"age": 30}
      },
      {
        "action": {"type": "SetStorageClass", "storageClass": "COLDLINE"},
        "condition": {"age": 90}
      },
      {
        "action": {"type": "Delete"},
        "condition": {"age": 365}
      }
    ]
  }
}
EOF

# ライフサイクル設定の適用
gsutil lifecycle set lifecycle.json gs://$BUCKET_NAME

# 設定確認
gsutil lifecycle get gs://$BUCKET_NAME</code></pre>

                        <p><strong>ステップ6: バケットの削除</strong></p>
                        <pre><code class="language-bash"># バケット内の全ファイル削除
gsutil rm -r gs://$BUCKET_NAME/*

# バケットの削除
gsutil rb gs://$BUCKET_NAME</code></pre>
                    </div>

                    <!-- セクション5.4 -->
                    <h3 class="section-title">5.4 Cloud SQL</h3>

                    <h4>Cloud SQLの概要</h4>
                    <p>
                        <strong>Cloud SQLは、フルマネージドなリレーショナルデータベースサービスで、AWSのRDS、AzureのSQL Databaseに相当</strong>します。MySQL、PostgreSQL、SQL Serverをサポートしています。
                    </p>

                    <h4>サポートされるデータベースエンジン</h4>
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>エンジン</th>
                                <th>対応バージョン</th>
                                <th>特徴</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>MySQL</strong></td>
                                <td>5.6, 5.7, 8.0</td>
                                <td>最も人気のあるオープンソースDB。Webアプリケーションに最適</td>
                            </tr>
                            <tr>
                                <td><strong>PostgreSQL</strong></td>
                                <td>9.6, 10, 11, 12, 13, 14, 15</td>
                                <td>高度なSQL機能、拡張性が高い。データ分析にも適している</td>
                            </tr>
                            <tr>
                                <td><strong>SQL Server</strong></td>
                                <td>2017, 2019</td>
                                <td>Microsoftエコシステムとの統合に優れる</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>マシンタイプとストレージ</h4>
                    <ul>
                        <li><strong>共有コア</strong>: db-f1-micro（0.6GB RAM）、db-g1-small（1.7GB RAM）- 開発・テスト用</li>
                        <li><strong>専用コア</strong>: db-n1-standard-1〜96（高可用性構成用）</li>
                        <li><strong>ストレージタイプ</strong>: SSD（高性能）、HDD（コスト効率重視）</li>
                        <li><strong>自動ストレージ拡張</strong>: 有効にすると自動的にストレージが拡張される</li>
                    </ul>

                    <div class="exercise-container">
                        <h5>実習 5-3: Cloud SQL（MySQL）の作成と接続</h5>

                        <p><strong>ステップ1: Cloud SQL インスタンスの作成</strong></p>
                        <pre><code class="language-bash"># Cloud SQL Admin APIの有効化
gcloud services enable sqladmin.googleapis.com

# MySQL 8.0 インスタンスの作成（db-f1-micro、SSD 10GB）
gcloud sql instances create my-mysql-instance \
    --database-version=MYSQL_8_0 \
    --tier=db-f1-micro \
    --region=asia-northeast1 \
    --root-password=MySecurePassword123! \
    --storage-type=SSD \
    --storage-size=10GB

# インスタンス一覧の確認
gcloud sql instances list</code></pre>

                        <p><strong>ステップ2: データベースの作成</strong></p>
                        <pre><code class="language-bash"># データベース作成
gcloud sql databases create sampledb --instance=my-mysql-instance

# データベース一覧
gcloud sql databases list --instance=my-mysql-instance</code></pre>

                        <p><strong>ステップ3: ユーザーの作成</strong></p>
                        <pre><code class="language-bash"># ユーザー作成
gcloud sql users create dbuser \
    --instance=my-mysql-instance \
    --password=UserPassword123!

# ユーザー一覧
gcloud sql users list --instance=my-mysql-instance</code></pre>

                        <p><strong>ステップ4: Cloud SQLプロキシ経由で接続（推奨方法）</strong></p>
                        <pre><code class="language-bash"># Cloud SQL Proxyのダウンロード（Linux x86_64）
wget https://dl.google.com/cloudsql/cloud_sql_proxy.linux.amd64 -O cloud_sql_proxy
chmod +x cloud_sql_proxy

# プロキシの起動（バックグラウンド）
# まずインスタンス接続名を取得
INSTANCE_CONNECTION_NAME=$(gcloud sql instances describe my-mysql-instance --format='value(connectionName)')
echo "接続名: $INSTANCE_CONNECTION_NAME"

./cloud_sql_proxy -instances=$INSTANCE_CONNECTION_NAME=tcp:3306 &

# MySQLクライアントで接続
# （mysql-clientがない場合はインストール）
sudo apt-get update && sudo apt-get install -y mysql-client

# 接続
mysql -u dbuser -p -h 127.0.0.1 sampledb
# パスワード: UserPassword123!</code></pre>

                        <p><strong>ステップ5: テーブル作成とデータ挿入</strong></p>
                        <pre><code class="language-sql">-- MySQLプロンプトで実行
CREATE TABLE users (
    id INT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(50) NOT NULL,
    email VARCHAR(100) NOT NULL,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

INSERT INTO users (username, email) VALUES
('alice', 'alice@example.com'),
('bob', 'bob@example.com'),
('charlie', 'charlie@example.com');

SELECT * FROM users;

-- 終了
EXIT;</code></pre>

                        <p><strong>ステップ6: 自動バックアップの確認</strong></p>
                        <pre><code class="language-bash"># バックアップ一覧
gcloud sql backups list --instance=my-mysql-instance

# バックアップ設定の確認
gcloud sql instances describe my-mysql-instance --format='value(settings.backupConfiguration)'</code></pre>

                        <p><strong>ステップ7: インスタンスの削除</strong></p>
                        <pre><code class="language-bash"># Cloud SQL Proxyの停止
pkill cloud_sql_proxy

# インスタンスの削除
gcloud sql instances delete my-mysql-instance</code></pre>
                    </div>

                    <div class="warning">
                        <h6>重要：Cloud SQLのコスト</h6>
                        <p>
                            Cloud SQLは<strong>インスタンスが起動している限り課金</strong>が発生します。db-f1-microでも月額$7〜$10程度かかります。学習後は必ず削除してください。また、自動バックアップも追加料金がかかるため、不要な場合は無効化しましょう。
                        </p>
                    </div>

                    <!-- セクション5.5 -->
                    <h3 class="section-title">5.5 gcloudコマンドラインツールの活用</h3>

                    <h4>gcloud CLIの基本コマンド</h4>
                    <p>
                        <strong>gcloud CLI</strong>は、GCPリソースを管理するための強力なコマンドラインツールです。
                    </p>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>カテゴリ</th>
                                <th>コマンド例</th>
                                <th>説明</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>設定</strong></td>
                                <td><code>gcloud config set project PROJECT_ID</code></td>
                                <td>デフォルトプロジェクトの設定</td>
                            </tr>
                            <tr>
                                <td><strong>認証</strong></td>
                                <td><code>gcloud auth login</code></td>
                                <td>Googleアカウントでログイン</td>
                            </tr>
                            <tr>
                                <td><strong>Compute Engine</strong></td>
                                <td><code>gcloud compute instances list</code></td>
                                <td>VMインスタンス一覧</td>
                            </tr>
                            <tr>
                                <td><strong>Cloud Storage</strong></td>
                                <td><code>gsutil ls</code></td>
                                <td>バケット一覧</td>
                            </tr>
                            <tr>
                                <td><strong>Cloud SQL</strong></td>
                                <td><code>gcloud sql instances list</code></td>
                                <td>Cloud SQLインスタンス一覧</td>
                            </tr>
                            <tr>
                                <td><strong>IAM</strong></td>
                                <td><code>gcloud projects get-iam-policy PROJECT_ID</code></td>
                                <td>IAMポリシーの取得</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- セクション5.6 -->
                    <h3 class="section-title">5.6 GCPと他クラウドプロバイダーのサービス比較</h3>

                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>カテゴリ</th>
                                <th>GCP</th>
                                <th>AWS</th>
                                <th>Azure</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>仮想マシン</strong></td>
                                <td>Compute Engine</td>
                                <td>EC2</td>
                                <td>Virtual Machines</td>
                            </tr>
                            <tr>
                                <td><strong>オブジェクトストレージ</strong></td>
                                <td>Cloud Storage</td>
                                <td>S3</td>
                                <td>Blob Storage</td>
                            </tr>
                            <tr>
                                <td><strong>リレーショナルDB</strong></td>
                                <td>Cloud SQL</td>
                                <td>RDS</td>
                                <td>Azure SQL Database</td>
                            </tr>
                            <tr>
                                <td><strong>NoSQL DB</strong></td>
                                <td>Firestore / Bigtable</td>
                                <td>DynamoDB</td>
                                <td>Cosmos DB</td>
                            </tr>
                            <tr>
                                <td><strong>コンテナ</strong></td>
                                <td>GKE / Cloud Run</td>
                                <td>EKS / ECS</td>
                                <td>AKS / Container Instances</td>
                            </tr>
                            <tr>
                                <td><strong>サーバーレス</strong></td>
                                <td>Cloud Functions</td>
                                <td>Lambda</td>
                                <td>Azure Functions</td>
                            </tr>
                            <tr>
                                <td><strong>ロードバランサー</strong></td>
                                <td>Cloud Load Balancing</td>
                                <td>ELB</td>
                                <td>Load Balancer</td>
                            </tr>
                            <tr>
                                <td><strong>DNS</strong></td>
                                <td>Cloud DNS</td>
                                <td>Route 53</td>
                                <td>Azure DNS</td>
                            </tr>
                            <tr>
                                <td><strong>CDN</strong></td>
                                <td>Cloud CDN</td>
                                <td>CloudFront</td>
                                <td>Azure CDN</td>
                            </tr>
                            <tr>
                                <td><strong>ビッグデータ</strong></td>
                                <td>BigQuery</td>
                                <td>Redshift</td>
                                <td>Synapse Analytics</td>
                            </tr>
                            <tr>
                                <td><strong>機械学習</strong></td>
                                <td>Vertex AI</td>
                                <td>SageMaker</td>
                                <td>Azure Machine Learning</td>
                            </tr>
                        </tbody>
                    </table>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>GCPのリソース階層を上位から順番に並べてください。</li>
                            <li>プロジェクトIDとプロジェクト番号の違いは何ですか？</li>
                            <li>プリエンプティブルVMとスポットVMの違いを説明してください。</li>
                            <li>Cloud Storageの4つのストレージクラスの使い分けを説明してください。</li>
                            <li>Cloud SQLがサポートするデータベースエンジンを3つ挙げてください。</li>
                            <li>Cloud SQLプロキシを使用する利点は何ですか？</li>
                            <li>gcloudとgsutilの違いは何ですか？</li>
                            <li>GCPの無料枠で使用できるCompute Engineインスタンスの条件を説明してください。</li>
                        </ol>

                        <h6>解答のポイント</h6>
                        <details>
                            <summary>クリックして解答例を表示</summary>
                            <ol>
                                <li><strong>リソース階層</strong>: 組織 → フォルダ → プロジェクト → リソース</li>
                                <li><strong>IDと番号</strong>: プロジェクトIDはユーザーが指定可能（変更不可）、プロジェクト番号はGCPが自動割り当て</li>
                                <li><strong>プリエンプティブルとスポット</strong>: プリエンプティブルは24時間制限あり、スポットは制限なしでより長時間実行可能</li>
                                <li><strong>ストレージクラス</strong>: Standard=頻繁アクセス、Nearline=月1回程度、Coldline=四半期1回、Archive=年1回未満</li>
                                <li><strong>DBエンジン</strong>: MySQL、PostgreSQL、SQL Server</li>
                                <li><strong>Cloud SQLプロキシ</strong>: SSL/TLSで暗号化された接続、IPアドレスのホワイトリスト不要、IAM認証</li>
                                <li><strong>gcloudとgsutil</strong>: gcloudはGCPリソース全般の管理、gsutilはCloud Storage専用</li>
                            </ol>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">5.7 本章のまとめ</h3>
                    <div class="info-box">
                        <h6>重要ポイント</h6>
                        <ul>
                            <li>GCPはプロジェクトを中心とした階層的なリソース管理構造を持つ</li>
                            <li>Compute Engineはカスタムマシンタイプで柔軟なスペック設定が可能</li>
                            <li>プリエンプティブルVMとスポットVMで大幅なコスト削減が可能（最大91%）</li>
                            <li>Cloud Storageは4つのストレージクラスでコストとパフォーマンスを最適化</li>
                            <li>Cloud SQLは自動バックアップ、ポイントインタイムリカバリ、高可用性構成を提供</li>
                            <li>Cloud ShellとgcloudコマンドでWebブラウザから即座にGCPを操作可能</li>
                            <li>GCP、AWS、Azureには対応するサービスが多く存在する</li>
                        </ul>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-5 mb-4">
                        <a href="cloud-computing-learning-material-4.html" class="btn btn-secondary">← 前の章へ</a>
                        <a href="cloud-computing-learning-material-6.html" class="btn btn-primary">次の章へ →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
