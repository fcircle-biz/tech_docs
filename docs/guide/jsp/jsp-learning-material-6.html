<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSP/Servlet初心者向け学習教材 - 第6章: JSPとJavaBeans</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        code {
            display: block;
            background-color: #f5f5f5;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .quiz-question {
            font-weight: 500;
            margin-bottom: 1rem;
        }
        .diagram {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            text-align: center;
        }
        .exercise {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        #table-of-contents .list-group-item {
            border: none;
            padding: 0.5rem 1rem;
        }
        #table-of-contents .list-group-item-action {
            color: #1976d2;
        }
        /* 選択された目次項目のスタイル */
        #table-of-contents .list-group-item-action.active,
        .list-group-item.active {
            color: white !important; /* テキストを白色にして青い背景に対してコントラストをつける */
            background-color: #1976d2;
            border-color: #1976d2;
        }
        .section-nav {
            padding-left: 1rem;
        }
        .inline-code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            display: inline;
        }
        footer {
            background-color: #1565c0;
            color: white;
            padding: 1rem 0;
            margin-top: 3rem;
        }
        .table-example {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
        }
        .table-example th {
            background-color: #e3f2fd;
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .table-example td {
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .example-result {
            background-color: #f1f8e9;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#tableOfContents">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">JSP/Servlet初心者向け学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#introduction">はじめに</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#chapter6">第6章: JSPとJavaBeans</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <!-- Sidebar - Table of Contents -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">目次</h5>
                        </div>
                        <div id="table-of-contents" class="list-group list-group-flush">
                            <a href="#introduction" class="list-group-item list-group-item-action">はじめに</a>
                            <a href="#chapter6" class="list-group-item list-group-item-action">第6章: JSPとJavaBeans</a>
                            <div class="section-nav">
                                <a href="#javabeans-intro" class="list-group-item list-group-item-action">6.1 JavaBeansの基本概念</a>
                                <a href="#javabeans-properties" class="list-group-item list-group-item-action">6.2 JavaBeansのプロパティとアクセサメソッド</a>
                                <a href="#creating-javabeans" class="list-group-item list-group-item-action">6.3 JavaBeansの作成方法</a>
                                <a href="#jsp-javabeans" class="list-group-item list-group-item-action">6.4 JSPでのJavaBeansの利用</a>
                                <a href="#usebean-tag" class="list-group-item list-group-item-action">6.5 useBeanタグの詳細</a>
                                <a href="#advanced-beans" class="list-group-item list-group-item-action">6.6 実践的なJavaBeansの活用</a>
                                <a href="#chapter6-quiz" class="list-group-item list-group-item-action">6.7 理解度確認テスト</a>
                            </div>
                            <a href="#next-steps" class="list-group-item list-group-item-action">次のステップ</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <section id="introduction">
                    <h1 class="display-5 mb-4">JSP/Servlet初心者向け学習教材</h1>
                    <p class="lead">この第6章では、JSPとJavaBeansの連携について学びます。JavaBeansの基本的な概念からJSPでの利用方法まで、実践的な例を通して理解を深めていきましょう。</p>

                    <div class="note">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>JavaBeansの基本概念と特徴</li>
                            <li>プロパティとアクセサメソッド（getter/setter）の理解</li>
                            <li>JavaBeansの作成方法</li>
                            <li>JSPでのJavaBeansの利用（useBeanタグなど）</li>
                            <li>実践的なJavaBeansの活用パターン</li>
                        </ul>
                    </div>
                </section>

                <section id="chapter6">
                    <h2 class="chapter-title">第6章：JSPとJavaBeans</h2>
                    <p>JSPとJavaBeansの連携は、Webアプリケーション開発において重要な役割を果たします。この章では、JavaBeansの基本から始め、JSPとの連携方法について詳しく学んでいきます。</p>

                    <section id="javabeans-intro">
                        <h3 class="section-title">6.1 JavaBeansの基本概念</h3>
                        <p>JavaBeansは、再利用可能なJavaコンポーネントの規約です。データの格納や処理のロジックをカプセル化するための標準的な方法を提供します。</p>

                        <h4>JavaBeansとは</h4>
                        <p>JavaBeansは、特定の規約に従ったJavaクラスです。以下の特徴を持ちます：</p>
                        <ul>
                            <li><strong>カプセル化</strong>：データとそれを操作するメソッドを一つのクラスにまとめる</li>
                            <li><strong>再利用性</strong>：異なるアプリケーションで同じコンポーネントを再利用できる</li>
                            <li><strong>保守性</strong>：ビジネスロジックとプレゼンテーションロジックを分離できる</li>
                        </ul>

                        <h4>JavaBeansの規約</h4>
                        <p>JavaBeansの規約には以下のものがあります：</p>
                        <ul>
                            <li>public で引数なしのコンストラクタを持つ</li>
                            <li>クラスが java.io.Serializable インターフェースを実装する（推奨）</li>
                            <li>プロパティへのアクセスはgetter/setterメソッドを通じて行う</li>
                            <li>命名規則に従ったメソッド名を使用する</li>
                        </ul>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- JavaBeansの基本概念図 -->
                                <rect x="50" y="50" width="500" height="200" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="10" />
                                <text x="300" y="80" text-anchor="middle" font-size="18" font-weight="bold">JavaBeans</text>
                                
                                <!-- JavaBeanの内部構造 -->
                                <rect x="100" y="100" width="400" height="120" fill="#fff" stroke="#1976d2" stroke-width="1" rx="5" />
                                
                                <!-- プロパティ部分 -->
                                <rect x="120" y="120" width="160" height="80" fill="#e8f5e9" stroke="#4caf50" stroke-width="1" rx="5" />
                                <text x="200" y="145" text-anchor="middle" font-size="14">プロパティ</text>
                                <text x="200" y="170" text-anchor="middle" font-size="12">private変数</text>
                                <text x="200" y="190" text-anchor="middle" font-size="12">カプセル化されたデータ</text>
                                
                                <!-- アクセサメソッド部分 -->
                                <rect x="320" y="120" width="160" height="80" fill="#fff8e1" stroke="#ffc107" stroke-width="1" rx="5" />
                                <text x="400" y="145" text-anchor="middle" font-size="14">アクセサメソッド</text>
                                <text x="400" y="170" text-anchor="middle" font-size="12">getter/setter</text>
                                <text x="400" y="190" text-anchor="middle" font-size="12">プロパティへのアクセス</text>
                                
                                <!-- 矢印など -->
                                <line x1="280" y1="160" x2="320" y2="160" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead)" />
                                <line x1="320" y1="140" x2="280" y2="140" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead)" />

                                <!-- 外部からのアクセス矢印 -->
                                <path d="M50,200 C30,200 30,120 50,120" fill="none" stroke="#1976d2" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)" />
                                <text x="20" y="160" text-anchor="middle" font-size="12" transform="rotate(-90, 20, 160)">外部からのアクセス</text>
                                
                                <defs>
                                    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図6.1: JavaBeansの基本構造</p>
                        </div>

                        <h4>JavaBeansのメリット</h4>
                        <p>JavaBeansを使用することで以下のメリットが得られます：</p>
                        <ul>
                            <li><strong>MVCパターンの実現</strong>：Model（データ）とView（表示）の分離</li>
                            <li><strong>コードの再利用</strong>：一度作成したBeansを複数のJSPで使い回せる</li>
                            <li><strong>保守性の向上</strong>：データロジックの変更がJSPに影響しにくい</li>
                            <li><strong>開発の効率化</strong>：役割分担が明確になり、チーム開発がしやすくなる</li>
                        </ul>

                        <div class="note">
                            <h5>JavaBeansとPOJO</h5>
                            <p>JavaBeansは、Plain Old Java Object (POJO) の一種ですが、より厳密な規約に従います。POJOは単純なJavaオブジェクトを指す一般的な用語であるのに対し、JavaBeansは特定の規約（引数なしコンストラクタ、プロパティ、getter/setter）に従ったPOJOを指します。</p>
                        </div>
                    </section>

                    <section id="javabeans-properties">
                        <h3 class="section-title">6.2 JavaBeansのプロパティとアクセサメソッド</h3>
                        <p>JavaBeansの核となるのは、「プロパティ」とそれを操作するための「アクセサメソッド」です。</p>

                        <h4>プロパティの種類</h4>
                        <p>JavaBeansのプロパティには主に以下の種類があります：</p>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>プロパティの種類</th>
                                    <th>説明</th>
                                    <th>メソッド</th>
                                </tr>
                                <tr>
                                    <td>単純プロパティ</td>
                                    <td>基本的なデータ型または参照型の値</td>
                                    <td>getXxx(), setXxx()</td>
                                </tr>
                                <tr>
                                    <td>インデックス付きプロパティ</td>
                                    <td>配列や List などのコレクション</td>
                                    <td>getXxx(int), setXxx(int, 値)</td>
                                </tr>
                                <tr>
                                    <td>論理型プロパティ</td>
                                    <td>boolean 型のプロパティ</td>
                                    <td>isXxx(), setXxx(boolean)</td>
                                </tr>
                                <tr>
                                    <td>読み取り専用プロパティ</td>
                                    <td>getter のみが存在するプロパティ</td>
                                    <td>getXxx()のみ</td>
                                </tr>
                                <tr>
                                    <td>書き込み専用プロパティ</td>
                                    <td>setter のみが存在するプロパティ</td>
                                    <td>setXxx()のみ</td>
                                </tr>
                            </table>
                        </div>

                        <h4>アクセサメソッドの命名規則</h4>
                        <p>アクセサメソッド（getter/setter）には以下の命名規則があります：</p>
                        <ul>
                            <li><strong>getter</strong>：「get」+ プロパティ名（先頭大文字）</li>
                            <li><strong>setter</strong>：「set」+ プロパティ名（先頭大文字）</li>
                            <li><strong>boolean型のgetter</strong>：「is」+ プロパティ名（先頭大文字）</li>
                        </ul>

                        <p>例えば、「name」というプロパティの場合：</p>
                        <code>// getter
public String getName() {
    return name;
}

// setter
public void setName(String name) {
    this.name = name;
}</code>

                        <p>また、「active」というboolean型プロパティの場合：</p>
                        <code>// getter（boolean型の場合はisで始まる）
public boolean isActive() {
    return active;
}

// setter（boolean型でもsetで始まる）
public void setActive(boolean active) {
    this.active = active;
}</code>

                        <div class="note">
                            <h5>プロパティ名の導出方法</h5>
                            <p>JavaBeansのプロパティ名は、アクセサメソッド名から次のように導出されます：</p>
                            <ol>
                                <li>メソッド名から「get」「set」「is」を削除する</li>
                                <li>残りの部分の最初の文字を小文字にする</li>
                            </ol>
                            <p>例えば、「getUserName()」というメソッドがあれば、プロパティ名は「userName」になります。</p>
                        </div>
                    </section>

                    <section id="creating-javabeans">
                        <h3 class="section-title">6.3 JavaBeansの作成方法</h3>
                        <p>実際にJavaBeansクラスを作成してみましょう。シンプルな例として、ユーザー情報を表すUserBeanを作成します。</p>

                        <h4>基本的なJavaBeansの例</h4>
                        <code>package com.example.beans;

import java.io.Serializable;

public class UserBean implements Serializable {
    
    // シリアルバージョンUID
    private static final long serialVersionUID = 1L;
    
    // プロパティ（privateフィールド）
    private String userId;
    private String userName;
    private String email;
    private int age;
    private boolean active;
    
    // 引数なしのコンストラクタ（必須）
    public UserBean() {
        // 初期化コード（必要に応じて）
    }
    
    // getter/setterメソッド（アクセサメソッド）
    public String getUserId() {
        return userId;
    }
    
    public void setUserId(String userId) {
        this.userId = userId;
    }
    
    public String getUserName() {
        return userName;
    }
    
    public void setUserName(String userName) {
        this.userName = userName;
    }
    
    public String getEmail() {
        return email;
    }
    
    public void setEmail(String email) {
        this.email = email;
    }
    
    public int getAge() {
        return age;
    }
    
    public void setAge(int age) {
        this.age = age;
    }
    
    public boolean isActive() {
        return active;
    }
    
    public void setActive(boolean active) {
        this.active = active;
    }
    
    // 必要に応じて追加メソッド
    public String getDisplayName() {
        return userName + " (" + userId + ")";
    }
}</code>

                        <p>上記のJavaBeansは、以下の要素を含んでいます：</p>
                        <ul>
                            <li><strong>Serializable インターフェースの実装</strong>：Bean の状態をシリアライズ可能にする</li>
                            <li><strong>private フィールド</strong>：カプセル化されたプロパティ</li>
                            <li><strong>引数なしのコンストラクタ</strong>：JavaBeans の規約で必須</li>
                            <li><strong>アクセサメソッド</strong>：各プロパティに対するgetter/setter</li>
                            <li><strong>追加のビジネスロジック</strong>：getDisplayName() のような便利なメソッド</li>
                        </ul>

                        <h4>複雑なプロパティを持つJavaBeansの例</h4>
                        <p>次に、より複雑なプロパティ（コレクションや別のBeanへの参照など）を持つJavaBeanの例を見てみましょう：</p>

                        <code>package com.example.beans;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

public class ProductCatalogBean implements Serializable {
    
    private static final long serialVersionUID = 1L;
    
    // コレクションプロパティ
    private List&lt;ProductBean&gt; products;
    
    // 参照プロパティ
    private CategoryBean category;
    
    // 配列プロパティ
    private String[] tags;
    
    public ProductCatalogBean() {
        // コレクションの初期化
        products = new ArrayList&lt;&gt;();
    }
    
    // コレクションプロパティのgetter/setter
    public List&lt;ProductBean&gt; getProducts() {
        return products;
    }
    
    public void setProducts(List&lt;ProductBean&gt; products) {
        this.products = products;
    }
    
    // インデックス付きプロパティのアクセサ
    public ProductBean getProduct(int index) {
        if (index >= 0 && index < products.size()) {
            return products.get(index);
        }
        return null;
    }
    
    public void setProduct(int index, ProductBean product) {
        if (index >= 0 && index < products.size()) {
            products.set(index, product);
        } else if (index == products.size()) {
            products.add(product);
        }
    }
    
    // 参照プロパティのgetter/setter
    public CategoryBean getCategory() {
        return category;
    }
    
    public void setCategory(CategoryBean category) {
        this.category = category;
    }
    
    // 配列プロパティのgetter/setter
    public String[] getTags() {
        return tags;
    }
    
    public void setTags(String[] tags) {
        this.tags = tags;
    }
    
    // ビジネスロジックメソッド
    public void addProduct(ProductBean product) {
        products.add(product);
    }
    
    public int getProductCount() {
        return products.size();
    }
}</code>

                        <div class="exercise">
                            <h5>演習 6.3.1: 基本的なJavaBeansの作成</h5>
                            <ol>
                                <li>書籍情報を表す <code>BookBean</code> クラスを作成してください。</li>
                                <li>少なくとも以下のプロパティを含めてください：
                                    <ul>
                                        <li>id (文字列型)</li>
                                        <li>title (文字列型)</li>
                                        <li>author (文字列型)</li>
                                        <li>price (数値型)</li>
                                        <li>inStock (論理型)</li>
                                    </ul>
                                </li>
                                <li>適切な getter/setter メソッドを実装してください。</li>
                                <li>「税込価格」を返す <code>getTaxIncludedPrice()</code> メソッドを追加してください（税率は10%とします）。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="jsp-javabeans">
                        <h3 class="section-title">6.4 JSPでのJavaBeansの利用</h3>
                        <p>JSPでJavaBeansを利用することで、MVCアーキテクチャの「モデル」部分を担当させることができます。JSPではJavaBeansを扱うための特殊なタグが用意されています。</p>

                        <h4>JSPの標準アクションタグ</h4>
                        <p>JSPでJavaBeansを利用するための主な標準アクションタグとして、以下のものがあります：</p>
                        <ul>
                            <li><strong>&lt;jsp:useBean&gt;</strong>：Beanのインスタンスを作成または取得する</li>
                            <li><strong>&lt;jsp:setProperty&gt;</strong>：Beanのプロパティに値を設定する</li>
                            <li><strong>&lt;jsp:getProperty&gt;</strong>：Beanのプロパティの値を取得する</li>
                        </ul>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 280" width="600" height="280">
                                <!-- JSPとJavaBeansの関係図 -->
                                <rect x="50" y="50" width="500" height="180" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="2" rx="10" />
                                <text x="300" y="80" text-anchor="middle" font-size="18" font-weight="bold">JSPとJavaBeansの連携</text>
                                
                                <!-- JSP部分 -->
                                <rect x="100" y="100" width="150" height="100" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="175" y="125" text-anchor="middle" font-size="16">JSP</text>
                                <text x="175" y="155" text-anchor="middle" font-size="12">&lt;jsp:useBean&gt;</text>
                                <text x="175" y="175" text-anchor="middle" font-size="12">&lt;jsp:setProperty&gt;</text>
                                <text x="175" y="195" text-anchor="middle" font-size="12">&lt;jsp:getProperty&gt;</text>
                                
                                <!-- JavaBeans部分 -->
                                <rect x="350" y="100" width="150" height="100" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5" />
                                <text x="425" y="125" text-anchor="middle" font-size="16">JavaBeans</text>
                                <text x="425" y="155" text-anchor="middle" font-size="12">プロパティ</text>
                                <text x="425" y="175" text-anchor="middle" font-size="12">getters/setters</text>
                                <text x="425" y="195" text-anchor="middle" font-size="12">ビジネスロジック</text>
                                
                                <!-- 連携を表す矢印 -->
                                <line x1="250" y1="125" x2="350" y2="125" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead2)" />
                                <text x="300" y="115" text-anchor="middle" font-size="10">インスタンス作成/取得</text>
                                
                                <line x1="250" y1="165" x2="350" y2="165" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead2)" />
                                <text x="300" y="155" text-anchor="middle" font-size="10">プロパティ設定</text>
                                
                                <line x1="350" y1="185" x2="250" y2="185" stroke="#4caf50" stroke-width="1.5" marker-end="url(#arrowhead3)" />
                                <text x="300" y="205" text-anchor="middle" font-size="10">プロパティ取得</text>
                                
                                <defs>
                                    <marker id="arrowhead2" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2" />
                                    </marker>
                                    <marker id="arrowhead3" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図6.2: JSPとJavaBeansの連携</p>
                        </div>

                        <h4>基本的な使用例</h4>
                        <p>以下に、JSPでJavaBeansを使用する基本的な例を示します：</p>

                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JavaBeansの利用例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;ユーザー情報&lt;/h1&gt;
    
    &lt;!-- Beanのインスタンスを作成または取得 --&gt;
    &lt;jsp:useBean id="user" class="com.example.beans.UserBean" scope="session" /&gt;
    
    &lt;!-- Beanのプロパティを設定 --&gt;
    &lt;jsp:setProperty name="user" property="userId" value="U001" /&gt;
    &lt;jsp:setProperty name="user" property="userName" value="山田太郎" /&gt;
    &lt;jsp:setProperty name="user" property="email" value="yamada@example.com" /&gt;
    &lt;jsp:setProperty name="user" property="age" value="30" /&gt;
    &lt;jsp:setProperty name="user" property="active" value="true" /&gt;
    
    &lt;!-- Beanのプロパティを取得して表示 --&gt;
    &lt;p&gt;ユーザーID: &lt;jsp:getProperty name="user" property="userId" /&gt;&lt;/p&gt;
    &lt;p&gt;ユーザー名: &lt;jsp:getProperty name="user" property="userName" /&gt;&lt;/p&gt;
    &lt;p&gt;メールアドレス: &lt;jsp:getProperty name="user" property="email" /&gt;&lt;/p&gt;
    &lt;p&gt;年齢: &lt;jsp:getProperty name="user" property="age" /&gt;&lt;/p&gt;
    &lt;p&gt;アクティブ: &lt;jsp:getProperty name="user" property="active" /&gt;&lt;/p&gt;
    
    &lt;!-- EL式でも同様にプロパティにアクセス可能 --&gt;
    &lt;h2&gt;EL式での表示&lt;/h2&gt;
    &lt;p&gt;表示名: ${user.displayName}&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>EL式との併用</h5>
                            <p>上記の例のように、JavaBeansは式言語（EL）と組み合わせて使用することも一般的です。EL式を使うと、<code>${user.userName}</code>のような簡潔な記法でBeanのプロパティにアクセスできます。内部的には対応するgetterメソッド（この場合は<code>getUserName()</code>）が呼び出されます。</p>
                        </div>

                        <h4>HTTPリクエストパラメータとJavaBeansの連携</h4>
                        <p>フォームから送信されたパラメータを自動的にJavaBeansのプロパティにセットすることができます：</p>

                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;フォームとJavaBeansの連携&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;ユーザー登録&lt;/h1&gt;
    
    &lt;!-- フォーム送信後の処理 --&gt;
    &lt;% if (request.getMethod().equals("POST")) { %&gt;
        &lt;jsp:useBean id="user" class="com.example.beans.UserBean" scope="session" /&gt;
        
        &lt;!-- 'property="*"' を使用すると、同名のパラメータが自動的にセットされる --&gt;
        &lt;jsp:setProperty name="user" property="*" /&gt;
        
        &lt;h2&gt;登録完了&lt;/h2&gt;
        &lt;p&gt;以下の情報で登録しました:&lt;/p&gt;
        &lt;p&gt;ユーザーID: ${user.userId}&lt;/p&gt;
        &lt;p&gt;ユーザー名: ${user.userName}&lt;/p&gt;
        &lt;p&gt;メールアドレス: ${user.email}&lt;/p&gt;
        &lt;p&gt;年齢: ${user.age}&lt;/p&gt;
    &lt;% } else { %&gt;
        &lt;!-- 登録フォーム --&gt;
        &lt;form method="post"&gt;
            &lt;div&gt;
                &lt;label for="userId"&gt;ユーザーID:&lt;/label&gt;
                &lt;input type="text" id="userId" name="userId" required&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;label for="userName"&gt;ユーザー名:&lt;/label&gt;
                &lt;input type="text" id="userName" name="userName" required&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;label for="email"&gt;メールアドレス:&lt;/label&gt;
                &lt;input type="email" id="email" name="email" required&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;label for="age"&gt;年齢:&lt;/label&gt;
                &lt;input type="number" id="age" name="age" required&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;button type="submit"&gt;登録&lt;/button&gt;
            &lt;/div&gt;
        &lt;/form&gt;
    &lt;% } %&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <p>上記の例では、フォームから送信されたパラメータが自動的にUserBeanのプロパティにマッピングされています。プロパティ名とフォームのname属性が一致している必要があります。</p>

                        <div class="exercise">
                            <h5>演習 6.4.1: JSPでJavaBeansを利用する</h5>
                            <ol>
                                <li>演習6.3.1で作成した <code>BookBean</code> を使用するJSPページを作成してください。</li>
                                <li>JSPでは以下の機能を実装してください：
                                    <ul>
                                        <li>フォームから書籍情報を入力できるようにする</li>
                                        <li>入力された情報を <code>BookBean</code> に格納する</li>
                                        <li>保存された書籍情報を表示する</li>
                                        <li>税込価格も表示する</li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </section>

                    <section id="usebean-tag">
                        <h3 class="section-title">6.5 useBeanタグの詳細</h3>
                        <p>useBeanタグは、JSPでJavaBeansを利用するための核となるタグです。詳細な使い方を見ていきましょう。</p>

                        <h4>useBeanタグの構文</h4>
                        <p>useBeanタグの基本構文は以下の通りです：</p>
                        <code>&lt;jsp:useBean id="beanName" class="package.BeanClassName" scope="scopeValue" /&gt;</code>

                        <p>主な属性について説明します：</p>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>属性</th>
                                    <th>説明</th>
                                    <th>値の例</th>
                                </tr>
                                <tr>
                                    <td>id</td>
                                    <td>JSPページ内でBeanを参照するための名前</td>
                                    <td>user, product, cart など</td>
                                </tr>
                                <tr>
                                    <td>class</td>
                                    <td>使用するBeanクラスの完全修飾名</td>
                                    <td>com.example.beans.UserBean</td>
                                </tr>
                                <tr>
                                    <td>type</td>
                                    <td>Beanを扱う際の型（スーパークラスやインターフェースも可）</td>
                                    <td>com.example.beans.User （インターフェース）</td>
                                </tr>
                                <tr>
                                    <td>scope</td>
                                    <td>Beanを保存するスコープ</td>
                                    <td>page, request, session, application</td>
                                </tr>
                                <tr>
                                    <td>beanName</td>
                                    <td>java.beans.Beans.instantiate()メソッドで使用されるBean名</td>
                                    <td>通常はclass属性と同じ</td>
                                </tr>
                            </table>
                        </div>

                        <h4>スコープについて</h4>
                        <p>useBeanタグのscope属性は、Beanがどのスコープで保存/検索されるかを指定します：</p>
                        <ul>
                            <li><strong>page</strong>：現在のJSPページ内でのみ有効。JSPが処理を終えると破棄される。</li>
                            <li><strong>request</strong>：現在のHTTPリクエスト内で有効。リクエストが完了すると破棄される。</li>
                            <li><strong>session</strong>：ユーザーのセッション内で有効。セッションが終了するまで保持される。</li>
                            <li><strong>application</strong>：Webアプリケーション全体で有効。アプリケーションが停止するまで保持される。</li>
                        </ul>

                        <div class="warning">
                            <h5>スコープ選択時の注意点</h5>
                            <p>広いスコープ（sessionやapplication）を使用すると、メモリ使用量が増加し、アプリケーションのパフォーマンスに影響を与える可能性があります。個人情報など機密データの場合は、広いスコープでの長期保存には注意が必要です。一般的には、必要最小限のスコープを選択するのがベストプラクティスです。</p>
                        </div>

                        <h4>useBeanタグの動作</h4>
                        <p>useBeanタグの動作フローは以下の通りです：</p>
                        <ol>
                            <li>指定されたスコープ内で、指定されたidのBeanインスタンスを検索</li>
                            <li>Bean インスタンスが見つかった場合：そのインスタンスを使用</li>
                            <li>見つからなかった場合：新しいインスタンスを作成し、指定されたスコープに保存</li>
                        </ol>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 350" width="600" height="350">
                                <!-- useBeanタグの動作フロー図 -->
                                <rect x="50" y="20" width="500" height="310" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="2" rx="10" />
                                <text x="300" y="50" text-anchor="middle" font-size="18" font-weight="bold">useBeanタグの動作フロー</text>
                                
                                <!-- フローチャート -->
                                <rect x="250" y="80" width="100" height="50" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="300" y="110" text-anchor="middle" font-size="14">開始</text>
                                
                                <line x1="300" y1="130" x2="300" y2="150" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                
                                <polygon points="300,160 400,200 300,240 200,200" fill="#fff8e1" stroke="#ffc107" stroke-width="2" />
                                <text x="300" y="205" text-anchor="middle" font-size="12">Beanが</text>
                                <text x="300" y="220" text-anchor="middle" font-size="12">存在するか？</text>
                                
                                <line x1="200" y1="200" x2="150" y2="200" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                <text x="180" y="190" text-anchor="middle" font-size="12">No</text>
                                
                                <rect x="50" y="175" width="100" height="50" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5" />
                                <text x="100" y="195" text-anchor="middle" font-size="12">新しいインスタンス</text>
                                <text x="100" y="210" text-anchor="middle" font-size="12">を作成</text>
                                
                                <line x1="100" y1="225" x2="100" y2="270" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                
                                <rect x="50" y="270" width="100" height="50" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5" />
                                <text x="100" y="290" text-anchor="middle" font-size="12">スコープに</text>
                                <text x="100" y="305" text-anchor="middle" font-size="12">保存</text>
                                
                                <line x1="150" y1="295" x2="225" y2="295" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                
                                <line x1="400" y1="200" x2="450" y2="200" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                <text x="420" y="190" text-anchor="middle" font-size="12">Yes</text>
                                
                                <rect x="450" y="175" width="100" height="50" fill="#e1f5fe" stroke="#0288d1" stroke-width="2" rx="5" />
                                <text x="500" y="195" text-anchor="middle" font-size="12">既存インスタンス</text>
                                <text x="500" y="210" text-anchor="middle" font-size="12">を取得</text>
                                
                                <line x1="500" y1="225" x2="500" y2="270" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                <line x1="500" y1="295" x2="375" y2="295" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead4)" />
                                
                                <rect x="225" y="270" width="150" height="50" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5" />
                                <text x="300" y="295" text-anchor="middle" font-size="14">Beanの参照を設定</text>
                                
                                <defs>
                                    <marker id="arrowhead4" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図6.3: useBeanタグの動作フロー</p>
                        </div>

                        <h4>useBeanタグの使用例</h4>
                        <p>以下に、より実践的なuseBeanタグの使用例を示します：</p>

                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;useBeanの詳細例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;useBeanの詳細例&lt;/h1&gt;
    
    &lt;!-- Bean定義とともに初期化ブロックを使用 --&gt;
    &lt;jsp:useBean id="user" class="com.example.beans.UserBean" scope="session"&gt;
        &lt;!-- このブロックはBeanが新しく作成された場合のみ実行される --&gt;
        &lt;jsp:setProperty name="user" property="userId" value="guest" /&gt;
        &lt;jsp:setProperty name="user" property="userName" value="ゲストユーザー" /&gt;
        &lt;jsp:setProperty name="user" property="email" value="guest@example.com" /&gt;
    &lt;/jsp:useBean&gt;
    
    &lt;!-- 条件によって異なるプロパティ設定 --&gt;
    &lt;% 
    String action = request.getParameter("action");
    if ("update".equals(action)) {
    %&gt;
        &lt;!-- パラメータ名と一致するプロパティのみ設定 --&gt;
        &lt;jsp:setProperty name="user" property="userName" param="name" /&gt;
        &lt;jsp:setProperty name="user" property="email" param="mail" /&gt;
        &lt;p&gt;ユーザー情報を更新しました。&lt;/p&gt;
    &lt;% } %&gt;
    
    &lt;!-- 特定のプロパティのみリクエストパラメータから設定 --&gt;
    &lt;jsp:useBean id="book" class="com.example.beans.BookBean" scope="request" /&gt;
    &lt;jsp:setProperty name="book" property="title" param="bookTitle" /&gt;
    &lt;jsp:setProperty name="book" property="price" param="bookPrice" /&gt;
    
    &lt;!-- 現在のBeanの情報表示 --&gt;
    &lt;h2&gt;現在のユーザー情報&lt;/h2&gt;
    &lt;p&gt;ID: ${user.userId}&lt;/p&gt;
    &lt;p&gt;名前: ${user.userName}&lt;/p&gt;
    &lt;p&gt;メール: ${user.email}&lt;/p&gt;
    
    &lt;!-- ユーザー情報更新フォーム --&gt;
    &lt;h2&gt;ユーザー情報更新&lt;/h2&gt;
    &lt;form method="post" action="?action=update"&gt;
        &lt;div&gt;
            &lt;label for="name"&gt;名前:&lt;/label&gt;
            &lt;input type="text" id="name" name="name" value="${user.userName}"&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label for="mail"&gt;メール:&lt;/label&gt;
            &lt;input type="email" id="mail" name="mail" value="${user.email}"&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;button type="submit"&gt;更新&lt;/button&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <p>上記の例では、以下のような高度なuseBeanの使い方を示しています：</p>
                        <ul>
                            <li>useBean タグのボディ部分に初期化ロジックを記述</li>
                            <li>パラメータ名とプロパティ名が異なる場合の setProperty でのマッピング</li>
                            <li>条件によるプロパティ設定の制御</li>
                        </ul>

                        <div class="exercise">
                            <h5>演習 6.5.1: useBeanの高度な使い方</h5>
                            <ol>
                                <li>買い物かごを表す <code>CartBean</code> クラスを作成してください。以下の機能を持たせてください：
                                    <ul>
                                        <li>商品のリスト（List&lt;ProductBean&gt;）を保持するプロパティ</li>
                                        <li>商品を追加するメソッド</li>
                                        <li>商品を削除するメソッド</li>
                                        <li>合計金額を計算するメソッド</li>
                                    </ul>
                                </li>
                                <li>JSPページで <code>CartBean</code> を session スコープで利用するページを作成してください。以下の機能を実装してください：
                                    <ul>
                                        <li>商品追加フォーム（商品名、価格、数量）</li>
                                        <li>カートの内容一覧表示</li>
                                        <li>合計金額の表示</li>
                                        <li>商品削除機能</li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </section>

                    <section id="advanced-beans">
                        <h3 class="section-title">6.6 実践的なJavaBeansの活用</h3>
                        <p>より実践的なシナリオでJavaBeansを活用する方法を見ていきましょう。</p>

                        <h4>MVCパターンでのJavaBeansの役割</h4>
                        <p>JavaBeansはMVC（Model-View-Controller）アーキテクチャにおいて、主に「Model」の役割を担います：</p>
                        <ul>
                            <li><strong>Model（JavaBeans）</strong>：データとビジネスロジックを保持</li>
                            <li><strong>View（JSP）</strong>：データの表示を担当</li>
                            <li><strong>Controller（Servlet）</strong>：ユーザーリクエストの処理とフロー制御</li>
                        </ul>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 300" width="600" height="300">
                                <!-- MVC図 -->
                                <rect x="50" y="20" width="500" height="260" fill="#f5f5f5" stroke="#9e9e9e" stroke-width="2" rx="10" />
                                <text x="300" y="50" text-anchor="middle" font-size="18" font-weight="bold">MVCパターンとJavaBeans</text>
                                
                                <!-- Controller部分 -->
                                <rect x="250" y="80" width="120" height="60" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="310" y="100" text-anchor="middle" font-size="16">Controller</text>
                                <text x="310" y="120" text-anchor="middle" font-size="12">(Servlet)</text>
                                
                                <!-- Model部分 -->
                                <rect x="100" y="180" width="120" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5" />
                                <text x="160" y="200" text-anchor="middle" font-size="16">Model</text>
                                <text x="160" y="220" text-anchor="middle" font-size="12">(JavaBeans)</text>
                                
                                <!-- View部分 -->
                                <rect x="400" y="180" width="120" height="60" fill="#fff8e1" stroke="#ffc107" stroke-width="2" rx="5" />
                                <text x="460" y="200" text-anchor="middle" font-size="16">View</text>
                                <text x="460" y="220" text-anchor="middle" font-size="12">(JSP)</text>
                                
                                <!-- リクエスト矢印 -->
                                <line x1="250" y1="95" x2="200" y2="95" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead5)" />
                                <text x="225" y="85" text-anchor="middle" font-size="10">リクエスト</text>
                                
                                <!-- 制御の流れ矢印 -->
                                <line x1="310" y1="140" x2="310" y2="160" stroke="#1976d2" stroke-width="1.5" />
                                <line x1="310" y1="160" x2="160" y2="160" stroke="#1976d2" stroke-width="1.5" />
                                <line x1="160" y1="160" x2="160" y2="180" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead5)" />
                                
                                <line x1="310" y1="160" x2="460" y2="160" stroke="#1976d2" stroke-width="1.5" />
                                <line x1="460" y1="160" x2="460" y2="180" stroke="#1976d2" stroke-width="1.5" marker-end="url(#arrowhead5)" />
                                
                                <!-- データの流れ矢印 -->
                                <line x1="220" y1="210" x2="400" y2="210" stroke="#4caf50" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead6)" />
                                <text x="310" y="200" text-anchor="middle" font-size="10">データ連携</text>
                                
                                <!-- レスポンス矢印 -->
                                <line x1="400" y1="230" x2="200" y2="230" stroke="#ffc107" stroke-width="1.5" stroke-dasharray="5,3" />
                                <line x1="200" y1="230" x2="200" y2="110" stroke="#ffc107" stroke-width="1.5" stroke-dasharray="5,3" />
                                <line x1="200" y1="110" x2="250" y2="110" stroke="#ffc107" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead7)" />
                                <text x="225" y="125" text-anchor="middle" font-size="10">レスポンス</text>
                                
                                <defs>
                                    <marker id="arrowhead5" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#1976d2" />
                                    </marker>
                                    <marker id="arrowhead6" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#4caf50" />
                                    </marker>
                                    <marker id="arrowhead7" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                                        <polygon points="0 0, 10 3.5, 0 7" fill="#ffc107" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図6.4: MVCパターンにおけるJavaBeansの役割</p>
                        </div>

                        <h4>実践的なMVCの例</h4>
                        <p>実際のWebアプリケーションでは、以下のようにMVCパターンを実装します：</p>

                        <p>1. JavaBeans（Model）：</p>
                        <code>package com.example.beans;

import java.io.Serializable;
import java.util.ArrayList;
import java.util.List;

public class ProductBean implements Serializable {
    private static final long serialVersionUID = 1L;
    
    private String id;
    private String name;
    private double price;
    private int stockQuantity;
    
    // コンストラクタ、getter/setterは省略
    
    // ビジネスロジック
    public boolean isInStock() {
        return stockQuantity > 0;
    }
    
    public double getDiscountedPrice(double discountRate) {
        return price * (1 - discountRate);
    }
}

public class ProductCatalogBean implements Serializable {
    private static final long serialVersionUID = 1L;
    
    private List&lt;ProductBean&gt; products = new ArrayList&lt;&gt;();
    
    // getter/setter
    
    // ビジネスロジック
    public void addProduct(ProductBean product) {
        products.add(product);
    }
    
    public ProductBean findProductById(String id) {
        for (ProductBean product : products) {
            if (product.getId().equals(id)) {
                return product;
            }
        }
        return null;
    }
    
    public List&lt;ProductBean&gt; getAvailableProducts() {
        List&lt;ProductBean&gt; availableProducts = new ArrayList&lt;&gt;();
        for (ProductBean product : products) {
            if (product.isInStock()) {
                availableProducts.add(product);
            }
        }
        return availableProducts;
    }
}</code>

                        <p>2. Servlet（Controller）：</p>
                        <code>package com.example.controllers;

import jakarta.servlet.ServletException;
import jakarta.servlet.annotation.WebServlet;
import jakarta.servlet.http.HttpServlet;
import jakarta.servlet.http.HttpServletRequest;
import jakarta.servlet.http.HttpServletResponse;
import jakarta.servlet.http.HttpSession;
import java.io.IOException;

import com.example.beans.ProductBean;
import com.example.beans.ProductCatalogBean;

@WebServlet("/products")
public class ProductController extends HttpServlet {
    
    @Override
    protected void doGet(HttpServletRequest request, HttpServletResponse response) 
            throws ServletException, IOException {
        
        // セッションからカタログを取得（または新規作成）
        HttpSession session = request.getSession();
        ProductCatalogBean catalog = (ProductCatalogBean) session.getAttribute("productCatalog");
        
        if (catalog == null) {
            catalog = new ProductCatalogBean();
            // サンプルデータの追加
            ProductBean p1 = new ProductBean();
            p1.setId("P001");
            p1.setName("ノートパソコン");
            p1.setPrice(98000);
            p1.setStockQuantity(10);
            
            ProductBean p2 = new ProductBean();
            p2.setId("P002");
            p2.setName("タブレット");
            p2.setPrice(45000);
            p2.setStockQuantity(5);
            
            catalog.addProduct(p1);
            catalog.addProduct(p2);
            
            session.setAttribute("productCatalog", catalog);
        }
        
        // アクションによって処理を分岐
        String action = request.getParameter("action");
        if ("detail".equals(action)) {
            String productId = request.getParameter("id");
            ProductBean product = catalog.findProductById(productId);
            request.setAttribute("product", product);
            request.getRequestDispatcher("/productDetail.jsp").forward(request, response);
        } else {
            // 在庫のある商品のみをリクエスト属性に設定
            request.setAttribute("availableProducts", catalog.getAvailableProducts());
            request.getRequestDispatcher("/productList.jsp").forward(request, response);
        }
    }
}</code>

                        <p>3. JSP（View）：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;商品一覧&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;商品一覧&lt;/h1&gt;
    
    &lt;table border="1"&gt;
        &lt;tr&gt;
            &lt;th&gt;ID&lt;/th&gt;
            &lt;th&gt;商品名&lt;/th&gt;
            &lt;th&gt;価格&lt;/th&gt;
            &lt;th&gt;在庫数&lt;/th&gt;
            &lt;th&gt;操作&lt;/th&gt;
        &lt;/tr&gt;
        &lt;c:forEach var="product" items="${availableProducts}"&gt;
            &lt;tr&gt;
                &lt;td&gt;${product.id}&lt;/td&gt;
                &lt;td&gt;${product.name}&lt;/td&gt;
                &lt;td&gt;${product.price}円&lt;/td&gt;
                &lt;td&gt;${product.stockQuantity}個&lt;/td&gt;
                &lt;td&gt;
                    &lt;a href="products?action=detail&amp;id=${product.id}"&gt;詳細&lt;/a&gt;
                &lt;/td&gt;
            &lt;/tr&gt;
        &lt;/c:forEach&gt;
    &lt;/table&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <p>4. 詳細ページJSP：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;商品詳細&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;商品詳細&lt;/h1&gt;
    
    &lt;jsp:useBean id="product" scope="request" class="com.example.beans.ProductBean" /&gt;
    
    &lt;div&gt;
        &lt;h2&gt;${product.name}&lt;/h2&gt;
        &lt;p&gt;商品ID: ${product.id}&lt;/p&gt;
        &lt;p&gt;価格: ${product.price}円&lt;/p&gt;
        &lt;p&gt;在庫数: ${product.stockQuantity}個&lt;/p&gt;
        
        &lt;!-- ビジネスロジックメソッドの呼び出し --&gt;
        &lt;p&gt;セール価格 (20%オフ): ${product.getDiscountedPrice(0.2)}円&lt;/p&gt;
        
        &lt;p&gt;
            &lt;a href="products"&gt;商品一覧に戻る&lt;/a&gt;
        &lt;/p&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>JavaBeansの実践的な使用パターン</h5>
                            <p>実際のアプリケーション開発では、JavaBeansは以下のようなパターンで使用されることが多いです：</p>
                            <ul>
                                <li><strong>フォームデータの保持</strong>：ユーザー入力を受け取るためのBean</li>
                                <li><strong>データ転送オブジェクト（DTO）</strong>：レイヤー間でデータを運ぶためのBean</li>
                                <li><strong>ビジネスオブジェクト</strong>：ビジネスロジックを含むBean</li>
                                <li><strong>データアクセスオブジェクト（DAO）</strong>：データベースアクセスを担当するBean</li>
                            </ul>
                        </div>

                        <div class="exercise">
                            <h5>演習 6.6.1: MVCパターンの実装</h5>
                            <ol>
                                <li>以下の機能を持つシンプルな掲示板アプリケーションを作成してください：
                                    <ul>
                                        <li>投稿を表す <code>PostBean</code> クラス（ID、タイトル、内容、投稿者、投稿日時などのプロパティを持つ）</li>
                                        <li>投稿リストを管理する <code>PostListBean</code> クラス（投稿の追加、検索などのメソッドを持つ）</li>
                                        <li>投稿の一覧表示と新規投稿を処理する <code>PostController</code> サーブレット</li>
                                        <li>投稿一覧を表示する <code>postList.jsp</code></li>
                                        <li>新規投稿フォームを表示する <code>postForm.jsp</code></li>
                                    </ul>
                                </li>
                                <li>MVCパターンに従って実装し、JavaBeansをモデルとして適切に活用してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="chapter6-quiz">
                        <h3 class="section-title">6.7 理解度確認テスト</h3>
                        <div class="quiz-container">
                            <h4>第6章の理解度チェック</h4>
                            <p>以下の問題に答えて、JSPとJavaBeansに関する理解度を確認しましょう。</p>
                            
                            <div class="quiz-question">
                                <p><strong>問題1:</strong> JavaBeansの規約として正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                                    <label class="form-check-label" for="q1a">
                                        引数付きのコンストラクタが必須である
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                    <label class="form-check-label" for="q1b">
                                        プロパティには直接アクセスするため、publicで宣言する
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                                        <label class="form-check-label" for="q1c">
                                        public で引数なしのコンストラクタを持つ
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                                        <label class="form-check-label" for="q1d">
                                        すべてのメソッドはstaticで宣言する必要がある
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題2:</strong> boolean型のプロパティ「active」に対するgetterメソッドの正しい命名は？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                                    <label class="form-check-label" for="q2a">
                                        getActive()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                    <label class="form-check-label" for="q2b">
                                        isActive()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                                        <label class="form-check-label" for="q2c">
                                        active()
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                                        <label class="form-check-label" for="q2d">
                                        returnActive()
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題3:</strong> JSPでJavaBeansを使用するタグで正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                                    <label class="form-check-label" for="q3a">
                                        &lt;jsp:bean&gt;, &lt;jsp:property&gt;, &lt;jsp:getValue&gt;
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                    <label class="form-check-label" for="q3b">
                                        &lt;jsp:useBean&gt;, &lt;jsp:setProperty&gt;, &lt;jsp:getProperty&gt;
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                                        <label class="form-check-label" for="q3c">
                                        &lt;bean:use&gt;, &lt;bean:set&gt;, &lt;bean:get&gt;
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                                        <label class="form-check-label" for="q3d">
                                        &lt;jsp:createBean&gt;, &lt;jsp:setValue&gt;, &lt;jsp:getValue&gt;
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題4:</strong> useBeanタグのscope属性で利用できないものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
                                    <label class="form-check-label" for="q4a">
                                        page
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                    <label class="form-check-label" for="q4b">
                                        request
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
                                        <label class="form-check-label" for="q4c">
                                        global
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
                                        <label class="form-check-label" for="q4d">
                                        application
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題5:</strong> MVCアーキテクチャにおいて、JavaBeansが主に担当する役割はどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
                                    <label class="form-check-label" for="q5a">
                                        Controller（制御）
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                    <label class="form-check-label" for="q5b">
                                        Model（モデル）
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
                                        <label class="form-check-label" for="q5c">
                                        View（ビュー）
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
                                        <label class="form-check-label" for="q5d">
                                        設定（Configuration）
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary mt-3" id="checkAnswers">回答を確認</button>
                            <div id="quizResults" class="mt-3 d-none">
                                <div class="alert alert-success">
                                    <h5>正解:</h5>
                                    <ol>
                                        <li>c（public で引数なしのコンストラクタを持つ）</li>
                                        <li>b（isActive()）</li>
                                        <li>b（&lt;jsp:useBean&gt;, &lt;jsp:setProperty&gt;, &lt;jsp:getProperty&gt;）</li>
                                        <li>c（global - 正しくは page, request, session, application）</li>
                                        <li>b（Model（モデル））</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="next-steps">
                        <h3 class="section-title">次のステップ</h3>
                        <p>この章では、JavaBeansの基本概念からJSPでの利用方法、MVCパターンでの役割まで学習しました。これらの知識を活用して、より整理されたWebアプリケーションを開発できるようになりました。</p>
                        <p>次の章では、JSPカスタムタグとJSTLについて学習します。これらを使うことで、より再利用性の高いビューコンポーネントを作成できるようになります。</p>
                        <div class="note">
                            <h5>推奨される追加学習</h5>
                            <ul>
                                <li><strong>JavaBeans API仕様</strong>：<a href="https://docs.oracle.com/javase/8/docs/api/java/beans/package-summary.html" target="_blank">JavaBeans API Documentation</a></li>
                                <li><strong>Jakarta EE Documentation</strong>：<a href="https://jakarta.ee/specifications/pages/" target="_blank">Jakarta Server Pages Specification</a></li>
                                <li><strong>デザインパターン</strong>：MVCパターンを含む、Javaでよく使われるデザインパターンについて学ぶ</li>
                            </ul>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">Copyright © 2025 F-Circle All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 理解度テストの回答確認ボタンの処理
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.getElementById('quizResults').classList.remove('d-none');
        });
    </script>
</body>
</html>