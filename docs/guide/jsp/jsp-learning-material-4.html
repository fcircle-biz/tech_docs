<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSP/Servlet初心者向け学習教材 - 第4章: ディレクティブとインポート</title>
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #1565c0;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #1565c0;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1565c0;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #1976d2;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        code {
            display: block;
            background-color: #f5f5f5;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 2rem 0;
        }
        .quiz-question {
            font-weight: 500;
            margin-bottom: 1rem;
        }
        .diagram {
            max-width: 100%;
            height: auto;
            margin: 1.5rem 0;
            text-align: center;
        }
        .exercise {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        .note {
            background-color: #e8f5e9;
            border-left: 4px solid #4caf50;
            padding: 1rem;
            margin: 1.5rem 0;
        }
        #table-of-contents .list-group-item {
            border: none;
            padding: 0.5rem 1rem;
        }
        #table-of-contents .list-group-item-action {
            color: #1976d2;
        }
        /* 選択された目次項目のスタイル */
        #table-of-contents .list-group-item-action.active,
        .list-group-item.active {
            color: white !important; /* テキストを白色にして青い背景に対してコントラストをつける */
            background-color: #1976d2;
            border-color: #1976d2;
        }
        .section-nav {
            padding-left: 1rem;
        }
        .inline-code {
            background-color: #f5f5f5;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-family: Consolas, Monaco, 'Andale Mono', monospace;
            display: inline;
        }
        footer {
            background-color: #1565c0;
            color: white;
            padding: 1rem 0;
            margin-top: 3rem;
        }
        .table-example {
            width: 100%;
            margin-bottom: 1rem;
            border-collapse: collapse;
        }
        .table-example th {
            background-color: #e3f2fd;
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .table-example td {
            border: 1px solid #b3e5fc;
            padding: 0.5rem;
            text-align: center;
        }
        .example-result {
            background-color: #f1f8e9;
            border-radius: 4px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .warning {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
            padding: 1rem;
            margin: 1.5rem 0;
        }
    </style>
</head>
<body data-bs-spy="scroll" data-bs-target="#tableOfContents">
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">JSP/Servlet初心者向け学習教材</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#introduction">はじめに</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#chapter4">第4章: ディレクティブとインポート</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container my-4">
        <div class="row">
            <!-- Sidebar - Table of Contents -->
            <div class="col-lg-3">
                <div class="sidebar">
                    <div class="card">
                        <div class="card-header bg-primary text-white">
                            <h5 class="mb-0">目次</h5>
                        </div>
                        <div id="table-of-contents" class="list-group list-group-flush">
                            <a href="#introduction" class="list-group-item list-group-item-action">はじめに</a>
                            <a href="#chapter4" class="list-group-item list-group-item-action">第4章: ディレクティブとインポート</a>
                            <div class="section-nav">
                                <a href="#page-directive" class="list-group-item list-group-item-action">4.1 page ディレクティブ</a>
                                <a href="#import-classes" class="list-group-item list-group-item-action">4.2 Javaクラスのインポート</a>
                                <a href="#include-directive" class="list-group-item list-group-item-action">4.3 include ディレクティブ</a>
                                <a href="#taglib-directive" class="list-group-item list-group-item-action">4.4 taglib ディレクティブ</a>
                                <a href="#error-handling" class="list-group-item list-group-item-action">4.5 例外処理(errorPage)</a>
                                <a href="#chapter4-quiz" class="list-group-item list-group-item-action">4.6 理解度確認テスト</a>
                            </div>
                            <a href="#next-steps" class="list-group-item list-group-item-action">次のステップ</a>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Main Content -->
            <div class="col-lg-9">
                <section id="introduction">
                    <h1 class="display-5 mb-4">JSP/Servlet初心者向け学習教材</h1>
                    <p class="lead">この第4章では、JSPのディレクティブとJavaクラスのインポート方法を学習します。効率的なJSPページ開発のための設定方法と例外処理のテクニックを理解しましょう。</p>

                    <div class="note">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>JSPページの動作を制御する page ディレクティブ</li>
                            <li>JavaクラスとJSPのインポート機能</li>
                            <li>コードの再利用を可能にする include ディレクティブ</li>
                            <li>カスタムタグを使用するための taglib ディレクティブ</li>
                            <li>JSPでの例外処理とエラーページの設定</li>
                        </ul>
                    </div>
                </section>

                <section id="chapter4">
                    <h2 class="chapter-title">第4章：ディレクティブとインポート</h2>
                    <p>JSPディレクティブは、JSPページの全体的な構造や動作を制御するための特別な指示です。ディレクティブを使うことで、JSPエンジンにページの処理方法を指示することができます。この章では、各種ディレクティブの使い方とJavaクラスのインポート方法、そして例外処理について学びます。</p>

                    <section id="page-directive">
                        <h3 class="section-title">4.1 page ディレクティブ</h3>
                        <p>page ディレクティブは、JSPページの全体的な特性を定義するために使用されます。このディレクティブを使用して、インポートするクラス、使用する文字コード、エラーページなどを指定できます。</p>

                        <h4>page ディレクティブの基本構文</h4>
                        <p>page ディレクティブは以下の形式で記述します:</p>
                        <code>&lt;%@ page attribute="value" %&gt;</code>

                        <h4>主な属性</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>属性</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                                <tr>
                                    <td>language</td>
                                    <td>JSPページで使用するプログラミング言語を指定</td>
                                    <td><span class="inline-code">language="java"</span></td>
                                </tr>
                                <tr>
                                    <td>contentType</td>
                                    <td>JSPの出力コンテンツタイプとエンコーディングを指定</td>
                                    <td><span class="inline-code">contentType="text/html; charset=UTF-8"</span></td>
                                </tr>
                                <tr>
                                    <td>pageEncoding</td>
                                    <td>JSPページ自体の文字エンコーディングを指定</td>
                                    <td><span class="inline-code">pageEncoding="UTF-8"</span></td>
                                </tr>
                                <tr>
                                    <td>import</td>
                                    <td>JSPページでインポートするクラスまたはパッケージを指定</td>
                                    <td><span class="inline-code">import="java.util.*, java.text.SimpleDateFormat"</span></td>
                                </tr>
                                <tr>
                                    <td>session</td>
                                    <td>JSPページでセッションを使用するかどうかを指定</td>
                                    <td><span class="inline-code">session="true"</span></td>
                                </tr>
                                <tr>
                                    <td>isELIgnored</td>
                                    <td>式言語（EL）を無視するかどうかを指定</td>
                                    <td><span class="inline-code">isELIgnored="false"</span></td>
                                </tr>
                                <tr>
                                    <td>errorPage</td>
                                    <td>例外発生時にリダイレクトするエラーページを指定</td>
                                    <td><span class="inline-code">errorPage="error.jsp"</span></td>
                                </tr>
                                <tr>
                                    <td>isErrorPage</td>
                                    <td>現在のページがエラーページかどうかを指定</td>
                                    <td><span class="inline-code">isErrorPage="true"</span></td>
                                </tr>
                                <tr>
                                    <td>buffer</td>
                                    <td>出力バッファのサイズを指定</td>
                                    <td><span class="inline-code">buffer="16kb"</span></td>
                                </tr>
                                <tr>
                                    <td>autoFlush</td>
                                    <td>バッファがいっぱいになった時に自動的にフラッシュするかどうかを指定</td>
                                    <td><span class="inline-code">autoFlush="true"</span></td>
                                </tr>
                            </table>
                        </div>

                        <h4>page ディレクティブの使用例</h4>
                        <p>以下は、page ディレクティブを使用したJSPページの例です：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" import="java.util.Date, java.text.SimpleDateFormat" session="true" errorPage="error.jsp" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Page ディレクティブの例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;現在の日時:&lt;/h1&gt;
    &lt;%
        SimpleDateFormat sdf = new SimpleDateFormat("yyyy年MM月dd日 HH時mm分ss秒");
        String formattedDate = sdf.format(new Date());
        out.println(formattedDate);
    %&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>複数のディレクティブ</h5>
                            <p>複数の page ディレクティブを記述することも可能です。例えば以下のように分けることもできます：</p>
                            <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ page import="java.util.Date, java.text.SimpleDateFormat" %&gt;
&lt;%@ page errorPage="error.jsp" %&gt;</code>
                            <p>これにより、コードの可読性が向上します。</p>
                        </div>

                        <div class="exercise">
                            <h5>演習 4.1.1: page ディレクティブの設定</h5>
                            <ol>
                                <li>新しいJSPファイル「dateDisplay.jsp」を作成してください。</li>
                                <li>page ディレクティブを使用して、適切なcontentType、pageEncoding、必要なインポート（java.time.LocalDateTimeなど）を設定してください。</li>
                                <li>現在の日時を表示し、曜日によって異なるメッセージを表示するJSPページを作成してください。</li>
                                <li>errorPageとして「customError.jsp」を指定してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="import-classes">
                        <h3 class="section-title">4.2 Javaクラスのインポート</h3>
                        <p>JSPページでJavaクラスを使用するには、そのクラスをインポートする必要があります。インポートには page ディレクティブの import 属性を使用します。</p>

                        <h4>インポートの基本</h4>
                        <p>Javaクラスをインポートするための基本構文：</p>
                        <code>&lt;%@ page import="package.ClassName" %&gt;</code>

                        <p>複数のクラスやパッケージをインポートする場合：</p>
                        <code>&lt;%@ page import="package1.Class1, package2.Class2, package3.*" %&gt;</code>

                        <h4>よく使用されるインポート</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>インポート文</th>
                                    <th>提供する機能</th>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">java.util.*</span></td>
                                    <td>コレクション（ArrayList, HashMap）、日付操作（Date, Calendar）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">java.text.*</span></td>
                                    <td>テキストフォーマット（SimpleDateFormat, DecimalFormat）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">java.time.*</span></td>
                                    <td>Java 8以降の日時API（LocalDate, LocalDateTime）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">java.sql.*</span></td>
                                    <td>データベース接続（Connection, Statement, ResultSet）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">jakarta.servlet.*</span></td>
                                    <td>サーブレットAPI（Servlet, ServletRequest）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">jakarta.servlet.http.*</span></td>
                                    <td>HTTPサーブレット（HttpServlet, HttpSession）など</td>
                                </tr>
                                <tr>
                                    <td><span class="inline-code">yourpackage.YourClass</span></td>
                                    <td>カスタムクラス</td>
                                </tr>
                            </table>
                        </div>

                        <h4>インポートの使用例</h4>
                        <p>以下は、様々なJavaクラスをインポートして使用する例です：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ page import="java.util.*, java.time.LocalDateTime, java.time.format.DateTimeFormatter" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;Javaクラスのインポート例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;様々なJavaクラスの使用例&lt;/h1&gt;
    
    &lt;h2&gt;1. ArrayListの使用&lt;/h2&gt;
    &lt;%
        List&lt;String&gt; fruits = new ArrayList&lt;&gt;();
        fruits.add("りんご");
        fruits.add("バナナ");
        fruits.add("オレンジ");
        
        out.println("&lt;ul&gt;");
        for (String fruit : fruits) {
            out.println("&lt;li&gt;" + fruit + "&lt;/li&gt;");
        }
        out.println("&lt;/ul&gt;");
    %&gt;
    
    &lt;h2&gt;2. 現代的な日時クラスの使用（Java 8+）&lt;/h2&gt;
    &lt;%
        LocalDateTime now = LocalDateTime.now();
        DateTimeFormatter formatter = DateTimeFormatter.ofPattern("yyyy年MM月dd日 HH時mm分ss秒");
        out.println("現在の日時: " + now.format(formatter));
    %&gt;
    
    &lt;h2&gt;3. HashMapの使用&lt;/h2&gt;
    &lt;%
        Map&lt;String, Integer&gt; scores = new HashMap&lt;&gt;();
        scores.put("国語", 85);
        scores.put("数学", 92);
        scores.put("英語", 78);
        
        out.println("&lt;table border='1'&gt;");
        out.println("&lt;tr&gt;&lt;th&gt;科目&lt;/th&gt;&lt;th&gt;点数&lt;/th&gt;&lt;/tr&gt;");
        for (Map.Entry&lt;String, Integer&gt; entry : scores.entrySet()) {
            out.println("&lt;tr&gt;&lt;td&gt;" + entry.getKey() + "&lt;/td&gt;&lt;td&gt;" + entry.getValue() + "&lt;/td&gt;&lt;/tr&gt;");
        }
        out.println("&lt;/table&gt;");
    %&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="note">
                            <h5>暗黙的なインポート</h5>
                            <p>JSPコンテナは、以下のパッケージを自動的にインポートします。これらのクラスは明示的にインポートしなくても使用できます。</p>
                            <ul>
                                <li>java.lang.*</li>
                                <li>jakarta.servlet.*</li>
                                <li>jakarta.servlet.http.*</li>
                                <li>jakarta.servlet.jsp.*</li>
                            </ul>
                            <p>ただし、明示的にインポートしておくと、コードの可読性が向上します。</p>
                        </div>

                        <div class="warning">
                            <h5>インポートの注意点</h5>
                            <p>同じ名前の複数のクラスをインポートすると、コンパイルエラーが発生する可能性があります。例えば、<code>java.util.Date</code>と<code>java.sql.Date</code>を同時にインポートすると競合が発生します。このような場合は、一方のクラスを完全修飾名で指定する必要があります：</p>
                            <code>&lt;%@ page import="java.util.Date" %&gt;
&lt;%
    Date utilDate = new Date(); // java.util.Date
    java.sql.Date sqlDate = new java.sql.Date(utilDate.getTime()); // 完全修飾名で指定
%&gt;</code>
                        </div>

                        <div class="exercise">
                            <h5>演習 4.2.1: 様々なJavaクラスのインポートと使用</h5>
                            <ol>
                                <li>新しいJSPファイル「classImport.jsp」を作成してください。</li>
                                <li>以下のクラスをインポートしてください：
                                    <ul>
                                        <li>java.util.Random</li>
                                        <li>java.time.LocalDate</li>
                                        <li>java.time.format.DateTimeFormatter</li>
                                        <li>java.util.Arrays</li>
                                    </ul>
                                </li>
                                <li>これらのクラスを使用して、以下の機能を持つJSPページを作成してください：
                                    <ul>
                                        <li>1〜100のランダムな数字を5つ生成し表示</li>
                                        <li>現在の日付を表示</li>
                                        <li>今日から一週間分の日付をリスト表示</li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </section>

                    <section id="include-directive">
                        <h3 class="section-title">4.3 include ディレクティブ</h3>
                        <p>include ディレクティブは、他のファイルの内容をJSPページに静的に含める（インクルードする）ために使用されます。これにより、コードの再利用性が向上し、ページの管理が容易になります。</p>

                        <h4>include ディレクティブの基本構文</h4>
                        <p>include ディレクティブは以下の形式で記述します：</p>
                        <code>&lt;%@ include file="ファイルパス" %&gt;</code>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 200" width="600" height="200">
                                <!-- メインJSPファイル -->
                                <rect x="50" y="50" width="200" height="100" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="150" y="90" text-anchor="middle" font-size="16">main.jsp</text>
                                <text x="150" y="110" text-anchor="middle" font-size="12">&lt;%@ include file="header.jsp" %&gt;</text>
                                <text x="150" y="130" text-anchor="middle" font-size="12">&lt;%@ include file="footer.jsp" %&gt;</text>

                                <!-- includeされるファイル -->
                                <rect x="350" y="20" width="150" height="70" fill="#fff8e1" stroke="#ffa000" stroke-width="2" rx="5" />
                                <text x="425" y="55" text-anchor="middle" font-size="16">header.jsp</text>
                                <text x="425" y="75" text-anchor="middle" font-size="12">(ヘッダーコンテンツ)</text>

                                <rect x="350" y="110" width="150" height="70" fill="#fff8e1" stroke="#ffa000" stroke-width="2" rx="5" />
                                <text x="425" y="145" text-anchor="middle" font-size="16">footer.jsp</text>
                                <text x="425" y="165" text-anchor="middle" font-size="12">(フッターコンテンツ)</text>

                                <!-- 矢印 -->
                                <line x1="250" y1="105" x2="350" y2="55" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />
                                <line x1="250" y1="125" x2="350" y2="145" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)" />

                                <defs>
                                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#1976d2" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図4.1: include ディレクティブの仕組み</p>
                        </div>

                        <h4>include ディレクティブの特徴</h4>
                        <ul>
                            <li><strong>静的インクルード</strong>：コンパイル時にインクルードされるため、変更があると再コンパイルが必要</li>
                            <li><strong>ファイルの内容がそのまま挿入</strong>：あたかも元のファイルに記述されていたかのように処理される</li>
                            <li><strong>変数の共有</strong>：インクルードするファイルとインクルードされるファイルで変数を共有できる</li>
                            <li><strong>用途</strong>：共通のヘッダー、フッター、メニュー、著作権表示などに適している</li>
                        </ul>

                        <h4>include ディレクティブの使用例</h4>
                        <p>以下は、include ディレクティブを使用したJSPページの例です。</p>

                        <p>ヘッダーファイル（header.jsp）：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JSP Include ディレクティブの例&lt;/title&gt;
    &lt;link rel="stylesheet" href="styles.css"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;header&gt;
        &lt;h1&gt;ウェブサイトのヘッダー&lt;/h1&gt;
        &lt;nav&gt;
            &lt;ul&gt;
                &lt;li&gt;&lt;a href="index.jsp"&gt;ホーム&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href="about.jsp"&gt;会社概要&lt;/a&gt;&lt;/li&gt;
                &lt;li&gt;&lt;a href="contact.jsp"&gt;お問い合わせ&lt;/a&gt;&lt;/li&gt;
            &lt;/ul&gt;
        &lt;/nav&gt;
    &lt;/header&gt;
    &lt;main&gt;</code>

                        <p>フッターファイル（footer.jsp）：</p>
                        <code>    &lt;/main&gt;
    &lt;footer&gt;
        &lt;p&gt;Copyright © 2025 F-Circle All rights reserved.&lt;/p&gt;
    &lt;/footer&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <p>メインページ（index.jsp）：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ include file="header.jsp" %&gt;

&lt;h2&gt;ようこそ！&lt;/h2&gt;
&lt;p&gt;これはinclude ディレクティブを使用した例です。&lt;/p&gt;
&lt;p&gt;ヘッダーとフッターが別ファイルから読み込まれています。&lt;/p&gt;

&lt;% 
    // 変数の定義（includeされたファイルでも使用可能）
    String companyName = "F-Circle";
    out.println("会社名: " + companyName);
%&gt;

&lt;%@ include file="footer.jsp" %&gt;</code>

                        <div class="note">
                            <h5>include ディレクティブと include アクションの違い</h5>
                            <p>JSPには、ファイルをインクルードする2つの方法があります：</p>
                            <ol>
                                <li><strong>include ディレクティブ</strong>: <code>&lt;%@ include file="..." %&gt;</code>
                                    <ul>
                                        <li>コンパイル時にインクルードされる（静的インクルード）</li>
                                        <li>変数の共有が可能</li>
                                        <li>ファイルの変更には再コンパイルが必要</li>
                                    </ul>
                                </li>
                                <li><strong>include アクション</strong>: <code>&lt;jsp:include page="..." /&gt;</code>
                                    <ul>
                                        <li>実行時にインクルードされる（動的インクルード）</li>
                                        <li>変数は共有されない（リクエスト属性を使用して値を渡す）</li>
                                        <li>ファイルの変更が即座に反映される</li>
                                    </ul>
                                </li>
                            </ol>
                            <p>用途に応じて適切な方法を選択してください。</p>
                        </div>

                        <div class="exercise">
                            <h5>演習 4.3.1: include ディレクティブの活用</h5>
                            <ol>
                                <li>共通のヘッダー（menu.jsp）、フッター（copyright.jsp）、サイドバー（sidebar.jsp）を作成してください。</li>
                                <li>これらのファイルをinclude ディレクティブを使って組み込む3つのページ（home.jsp、products.jsp、contact.jsp）を作成してください。</li>
                                <li>各ページには、そのページ特有のコンテンツを追加し、サイドバーには共通のメニューを表示してください。</li>
                                <li>共通変数をヘッダーで定義し、それをメインコンテンツで使用するようにしてみてください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="taglib-directive">
                        <h3 class="section-title">4.4 taglib ディレクティブ</h3>
                        <p>taglib ディレクティブは、JSPページでカスタムタグまたはJSTL（JSP Standard Tag Library）などのタグライブラリを使用するために使用されます。</p>

                        <h4>taglib ディレクティブの基本構文</h4>
                        <p>taglib ディレクティブは以下の形式で記述します：</p>
                        <code>&lt;%@ taglib prefix="接頭辞" uri="タグライブラリURI" %&gt;</code>

                        <h4>一般的なタグライブラリ</h4>
                        <div class="table-responsive">
                            <table class="table-example">
                                <tr>
                                    <th>タグライブラリ</th>
                                    <th>URI</th>
                                    <th>一般的な接頭辞</th>
                                    <th>説明</th>
                                </tr>
                                <tr>
                                    <td>JSTL Core</td>
                                    <td>http://java.sun.com/jsp/jstl/core</td>
                                    <td>c</td>
                                    <td>変数のサポート、フロー制御など</td>
                                </tr>
                                <tr>
                                    <td>JSTL Formatting</td>
                                    <td>http://java.sun.com/jsp/jstl/fmt</td>
                                    <td>fmt</td>
                                    <td>国際化、数値・日付フォーマットなど</td>
                                </tr>
                                <tr>
                                    <td>JSTL SQL</td>
                                    <td>http://java.sun.com/jsp/jstl/sql</td>
                                    <td>sql</td>
                                    <td>SQL操作</td>
                                </tr>
                                <tr>
                                    <td>JSTL Functions</td>
                                    <td>http://java.sun.com/jsp/jstl/functions</td>
                                    <td>fn</td>
                                    <td>文字列操作などの共通関数</td>
                                </tr>
                                <tr>
                                    <td>JSTL XML</td>
                                    <td>http://java.sun.com/jsp/jstl/xml</td>
                                    <td>x</td>
                                    <td>XML処理</td>
                                </tr>
                            </table>
                        </div>

                        <div class="note">
                            <h5>JSTL のインストール</h5>
                            <p>JSTLを使用するには、まずJSTLライブラリをプロジェクトに追加する必要があります。Maven を使用している場合は、pom.xml に以下の依存関係を追加します：</p>
                            <code>&lt;dependency&gt;
    &lt;groupId&gt;org.glassfish.web&lt;/groupId&gt;
    &lt;artifactId&gt;jakarta.servlet.jsp.jstl&lt;/artifactId&gt;
    &lt;version&gt;3.0.1&lt;/version&gt;
&lt;/dependency&gt;</code>
                            <p>または、<a href="https://mvnrepository.com/artifact/org.glassfish.web/jakarta.servlet.jsp.jstl/3.0.1" target="_blank">Maven Repository</a> からJARファイルをダウンロードし、プロジェクトのWEB-INF/libディレクトリに配置します。</p>
                        </div>

                        <h4>taglib ディレクティブの使用例</h4>
                        <p>以下は、JSTL Coreタグライブラリを使用した例です：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JSTL使用例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;JSTLを使ったフロー制御&lt;/h1&gt;
    
    &lt;!-- 変数の設定 --&gt;
    &lt;c:set var="score" value="85" /&gt;
    
    &lt;!-- 条件分岐 --&gt;
    &lt;h2&gt;条件分岐の例:&lt;/h2&gt;
    &lt;c:if test="${score >= 80}"&gt;
        &lt;p&gt;点数は80点以上です。優秀な成績です！&lt;/p&gt;
    &lt;/c:if&gt;
    
    &lt;c:choose&gt;
        &lt;c:when test="${score >= 90}"&gt;
            &lt;p&gt;評価: A（優）&lt;/p&gt;
        &lt;/c:when&gt;
        &lt;c:when test="${score >= 80}"&gt;
            &lt;p&gt;評価: B（良）&lt;/p&gt;
        &lt;/c:when&gt;
        &lt;c:when test="${score >= 70}"&gt;
            &lt;p&gt;評価: C（可）&lt;/p&gt;
        &lt;/c:when&gt;
        &lt;c:otherwise&gt;
            &lt;p&gt;評価: D（不可）&lt;/p&gt;
        &lt;/c:otherwise&gt;
    &lt;/c:choose&gt;
    
    &lt;!-- ループ処理 --&gt;
    &lt;h2&gt;ループの例:&lt;/h2&gt;
    &lt;ul&gt;
        &lt;c:forEach var="i" begin="1" end="5"&gt;
            &lt;li&gt;項目 ${i}&lt;/li&gt;
        &lt;/c:forEach&gt;
    &lt;/ul&gt;
    
    &lt;!-- 配列/コレクションの処理 --&gt;
    &lt;%
        String[] fruits = {"りんご", "バナナ", "オレンジ", "ぶどう", "いちご"};
        request.setAttribute("fruitsList", fruits);
    %&gt;
    
    &lt;h2&gt;配列の処理:&lt;/h2&gt;
    &lt;ul&gt;
        &lt;c:forEach var="fruit" items="${fruitsList}" varStatus="status"&gt;
            &lt;li&gt;${status.count}: ${fruit}&lt;/li&gt;
        &lt;/c:forEach&gt;
    &lt;/ul&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <h4>JSTLのフォーマットタグ使用例</h4>
                        <p>以下は、JSTL Formattingタグライブラリを使用した例です：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %&gt;
&lt;%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;JSTLフォーマット例&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;JSTL Formattingタグの使用例&lt;/h1&gt;
    
    &lt;%
        request.setAttribute("now", new java.util.Date());
        request.setAttribute("amount", 1234567.89);
    %&gt;
    
    &lt;h2&gt;日付のフォーマット:&lt;/h2&gt;
    &lt;p&gt;デフォルト: &lt;fmt:formatDate value="${now}" /&gt;&lt;/p&gt;
    &lt;p&gt;日付のみ: &lt;fmt:formatDate value="${now}" type="date" /&gt;&lt;/p&gt;
    &lt;p&gt;時刻のみ: &lt;fmt:formatDate value="${now}" type="time" /&gt;&lt;/p&gt;
    &lt;p&gt;日付と時刻: &lt;fmt:formatDate value="${now}" type="both" /&gt;&lt;/p&gt;
    &lt;p&gt;カスタムパターン: &lt;fmt:formatDate value="${now}" pattern="yyyy年MM月dd日 E曜日 HH時mm分ss秒" /&gt;&lt;/p&gt;
    
    &lt;h2&gt;数値のフォーマット:&lt;/h2&gt;
    &lt;p&gt;デフォルト: &lt;fmt:formatNumber value="${amount}" /&gt;&lt;/p&gt;
    &lt;p&gt;通貨: &lt;fmt:formatNumber value="${amount}" type="currency" currencySymbol="￥" /&gt;&lt;/p&gt;
    &lt;p&gt;パーセント: &lt;fmt:formatNumber value="${amount / 10000}" type="percent" /&gt;&lt;/p&gt;
    &lt;p&gt;カスタムパターン: &lt;fmt:formatNumber value="${amount}" pattern="#,###.##" /&gt;&lt;/p&gt;
    
    &lt;h2&gt;国際化:&lt;/h2&gt;
    &lt;fmt:setLocale value="en_US" /&gt;
    &lt;p&gt;英語（米国）表記: 
       &lt;fmt:formatDate value="${now}" type="both" dateStyle="full" timeStyle="full" /&gt;,
       &lt;fmt:formatNumber value="${amount}" type="currency" /&gt;
    &lt;/p&gt;
    
    &lt;fmt:setLocale value="fr_FR" /&gt;
    &lt;p&gt;フランス語表記: 
       &lt;fmt:formatDate value="${now}" type="both" dateStyle="full" timeStyle="full" /&gt;,
       &lt;fmt:formatNumber value="${amount}" type="currency" /&gt;
    &lt;/p&gt;
    
    &lt;fmt:setLocale value="ja_JP" /&gt;
    &lt;p&gt;日本語表記: 
       &lt;fmt:formatDate value="${now}" type="both" dateStyle="full" timeStyle="full" /&gt;,
       &lt;fmt:formatNumber value="${amount}" type="currency" /&gt;
    &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <div class="warning">
                            <h5>Jakarta EE 9以降のURI変更</h5>
                            <p>Jakarta EE 9以降（Tomcat 10以降）では、JSTLのURIが変更されています。以下の新しいURIを使用してください：</p>
                            <ul>
                                <li>Core: <span class="inline-code">jakarta.tags.core</span></li>
                                <li>Formatting: <span class="inline-code">jakarta.tags.fmt</span></li>
                                <li>SQL: <span class="inline-code">jakarta.tags.sql</span></li>
                                <li>Functions: <span class="inline-code">jakarta.tags.functions</span></li>
                                <li>XML: <span class="inline-code">jakarta.tags.xml</span></li>
                            </ul>
                            <p>例: <code>&lt;%@ taglib prefix="c" uri="jakarta.tags.core" %&gt;</code></p>
                        </div>

                        <div class="exercise">
                            <h5>演習 4.4.1: JSTLを使ったページの作成</h5>
                            <ol>
                                <li>JSTLライブラリをプロジェクトに追加してください。</li>
                                <li>学生の成績データを表示するJSPページを作成してください。学生データは以下の項目を含みます：
                                    <ul>
                                        <li>学生ID、氏名、科目ごとの点数、受験日</li>
                                    </ul>
                                </li>
                                <li>JSTLのCore（c）とFormatting（fmt）タグを使用して以下の機能を実装してください：
                                    <ul>
                                        <li>学生データの一覧表示（表形式）</li>
                                        <li>点数に応じた成績評価の表示（90点以上：A、80点以上：B、など）</li>
                                        <li>日付の適切なフォーマット表示</li>
                                        <li>合計点と平均点の計算と表示</li>
                                    </ul>
                                </li>
                            </ol>
                        </div>
                    </section>

                    <section id="error-handling">
                        <h3 class="section-title">4.5 例外処理(errorPage)</h3>
                        <p>JSPアプリケーションでは、実行時に様々な例外（Exception）が発生する可能性があります。page ディレクティブの errorPage 属性とisErrorPage 属性を使用することで、これらの例外を適切に処理し、ユーザーフレンドリーなエラーメッセージを表示することができます。</p>

                        <h4>errorPageとisErrorPageの基本</h4>
                        <ul>
                            <li><strong>errorPage</strong>：例外が発生した場合にリダイレクトするJSPページを指定</li>
                            <li><strong>isErrorPage</strong>：このJSPページがエラーページであることを示す（trueの場合、exception変数が自動的に使用可能になる）</li>
                        </ul>

                        <div class="diagram">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 200" width="600" height="200">
                                <!-- 通常ページ -->
                                <rect x="50" y="50" width="200" height="100" fill="#e3f2fd" stroke="#1976d2" stroke-width="2" rx="5" />
                                <text x="150" y="85" text-anchor="middle" font-size="16">normal.jsp</text>
                                <text x="150" y="110" text-anchor="middle" font-size="12">&lt;%@ page errorPage="error.jsp" %&gt;</text>
                                <text x="150" y="130" text-anchor="middle" font-size="12">例外発生！</text>

                                <!-- エラーページ -->
                                <rect x="350" y="50" width="200" height="100" fill="#ffebee" stroke="#f44336" stroke-width="2" rx="5" />
                                <text x="450" y="85" text-anchor="middle" font-size="16">error.jsp</text>
                                <text x="450" y="110" text-anchor="middle" font-size="12">&lt;%@ page isErrorPage="true" %&gt;</text>
                                <text x="450" y="130" text-anchor="middle" font-size="12">例外情報を表示</text>

                                <!-- 矢印 -->
                                <line x1="250" y1="100" x2="350" y2="100" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow2)" />
                                <text x="300" y="90" text-anchor="middle" font-size="12">リダイレクト</text>

                                <defs>
                                    <marker id="arrow2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                                        <path d="M0,0 L0,6 L9,3 z" fill="#1976d2" />
                                    </marker>
                                </defs>
                            </svg>
                            <p class="text-center">図4.2: errorPageとisErrorPageの関係</p>
                        </div>

                        <h4>例外処理の実装例</h4>
                        <p>以下は、例外処理を実装したJSPページの例です。</p>

                        <p>通常ページ（calculate.jsp）：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ page errorPage="errorHandler.jsp" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;計算ページ&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;割り算の計算&lt;/h1&gt;
    
    &lt;%
        // リクエストパラメータの取得
        String num1Str = request.getParameter("num1");
        String num2Str = request.getParameter("num2");
        
        if (num1Str != null && num2Str != null) {
            try {
                int num1 = Integer.parseInt(num1Str);
                int num2 = Integer.parseInt(num2Str);
                
                // 0で割ろうとすると、ArithmeticExceptionが発生
                int result = num1 / num2;
                out.println("&lt;p&gt;" + num1 + " ÷ " + num2 + " = " + result + "&lt;/p&gt;");
            } catch (NumberFormatException e) {
                // この例外はここでキャッチ
                out.println("&lt;p style='color: red;'&gt;数値を入力してください&lt;/p&gt;");
            }
            // ArithmeticExceptionは、errorPageでキャッチされる
        }
    %&gt;
    
    &lt;form method="get"&gt;
        &lt;label for="num1"&gt;数値1:&lt;/label&gt;
        &lt;input type="text" id="num1" name="num1" value="${param.num1}"&gt;
        &lt;br&gt;&lt;br&gt;
        
        &lt;label for="num2"&gt;数値2:&lt;/label&gt;
        &lt;input type="text" id="num2" name="num2" value="${param.num2}"&gt;
        &lt;br&gt;&lt;br&gt;
        
        &lt;input type="submit" value="計算"&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <p>エラーページ（errorHandler.jsp）：</p>
                        <code>&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8" %&gt;
&lt;%@ page isErrorPage="true" %&gt;
&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;エラーページ&lt;/title&gt;
    &lt;style&gt;
        .error-container {
            border: 2px solid #f44336;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
            background-color: #ffebee;
        }
        .error-type {
            color: #d32f2f;
            font-weight: bold;
        }
        .stack-trace {
            font-family: monospace;
            background-color: #f5f5f5;
            padding: 10px;
            overflow: auto;
            max-height: 300px;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h1&gt;エラーが発生しました&lt;/h1&gt;
    
    &lt;div class="error-container"&gt;
        &lt;h2&gt;エラー詳細:&lt;/h2&gt;
        &lt;p class="error-type"&gt;
            例外の種類: &lt;%= exception.getClass().getName() %&gt;
        &lt;/p&gt;
        &lt;p&gt;
            エラーメッセージ: &lt;%= exception.getMessage() %&gt;
        &lt;/p&gt;
        
        &lt;h3&gt;スタックトレース:&lt;/h3&gt;
        &lt;div class="stack-trace"&gt;
            &lt;%
                // スタックトレースの取得と表示
                java.io.StringWriter stringWriter = new java.io.StringWriter();
                java.io.PrintWriter printWriter = new java.io.PrintWriter(stringWriter);
                exception.printStackTrace(printWriter);
                out.println(stringWriter.toString().replace("\n", "&lt;br&gt;"));
            %&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    
    &lt;p&gt;
        &lt;a href="calculate.jsp"&gt;計算ページに戻る&lt;/a&gt;
    &lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</code>

                        <h4>web.xmlでのグローバルエラーページの設定</h4>
                        <p>web.xmlファイルでは、アプリケーション全体でのエラーページを設定することができます。これにより、各JSPファイルで個別にerrorPageを指定する必要がなくなります。</p>

                        <code>&lt;web-app xmlns="https://jakarta.ee/xml/ns/jakartaee"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="https://jakarta.ee/xml/ns/jakartaee https://jakarta.ee/xml/ns/jakartaee/web-app_5_0.xsd"
         version="5.0"&gt;

    &lt;!-- 特定の例外タイプに対するエラーページ --&gt;
    &lt;error-page&gt;
        &lt;exception-type&gt;java.lang.ArithmeticException&lt;/exception-type&gt;
        &lt;location&gt;/errorHandler.jsp&lt;/location&gt;
    &lt;/error-page&gt;
    
    &lt;error-page&gt;
        &lt;exception-type&gt;java.lang.NullPointerException&lt;/exception-type&gt;
        &lt;location&gt;/errorHandler.jsp&lt;/location&gt;
    &lt;/error-page&gt;
    
    &lt;!-- 特定のHTTPステータスコードに対するエラーページ --&gt;
    &lt;error-page&gt;
        &lt;error-code&gt;404&lt;/error-code&gt;
        &lt;location&gt;/error404.jsp&lt;/location&gt;
    &lt;/error-page&gt;
    
    &lt;error-page&gt;
        &lt;error-code&gt;500&lt;/error-code&gt;
        &lt;location&gt;/error500.jsp&lt;/location&gt;
    &lt;/error-page&gt;
    
    &lt;!-- すべての例外に対するデフォルトのエラーページ --&gt;
    &lt;error-page&gt;
        &lt;exception-type&gt;java.lang.Throwable&lt;/exception-type&gt;
        &lt;location&gt;/errorGeneral.jsp&lt;/location&gt;
    &lt;/error-page&gt;

&lt;/web-app&gt;</code>

                        <div class="note">
                            <h5>本番環境でのエラー処理のベストプラクティス</h5>
                            <p>本番環境でのエラー処理では、以下のようなベストプラクティスを考慮することが重要です：</p>
                            <ol>
                                <li><strong>ユーザーフレンドリーなメッセージ</strong>：技術的な詳細ではなく、ユーザーが理解できる簡潔なメッセージを表示する</li>
                                <li><strong>ログ記録</strong>：例外の詳細をログに記録し、後で分析できるようにする</li>
                                <li><strong>セキュリティ</strong>：スタックトレースなどの詳細情報を一般ユーザーに表示しない（潜在的な脆弱性が明らかになる可能性がある）</li>
                                <li><strong>回復オプション</strong>：ホームページに戻るなど、ユーザーが回復するための選択肢を提供する</li>
                                <li><strong>エラー通知</strong>：重大なエラーが発生した場合、管理者に通知する仕組みを実装する</li>
                            </ol>
                        </div>

                        <div class="exercise">
                            <h5>演習 4.5.1: 例外処理の実装</h5>
                            <ol>
                                <li>以下の機能を持つフォームページ（dataProcess.jsp）を作成してください：
                                    <ul>
                                        <li>年齢を入力するフォーム</li>
                                        <li>名前を入力するフォーム</li>
                                        <li>メールアドレスを入力するフォーム</li>
                                    </ul>
                                </li>
                                <li>入力された情報を処理するJSPページを作成し、以下のチェックを行なってください：
                                    <ul>
                                        <li>年齢が数値でない場合、NumberFormatExceptionが発生</li>
                                        <li>名前が空の場合、例外をスロー</li>
                                        <li>メールアドレスに@が含まれていない場合、例外をスロー</li>
                                    </ul>
                                </li>
                                <li>エラーページ（dataError.jsp）を作成し、isErrorPage="true"を使用して、例外情報を表示してください。</li>
                                <li>web.xmlファイルを編集して、アプリケーション全体のエラーハンドリングを設定してください。</li>
                            </ol>
                        </div>
                    </section>

                    <section id="chapter4-quiz">
                        <h3 class="section-title">4.6 理解度確認テスト</h3>
                        <div class="quiz-container">
                            <h4>第4章の理解度チェック</h4>
                            <p>以下の問題に答えて、第4章の内容の理解度を確認しましょう。</p>
                            
                            <div class="quiz-question">
                                <p><strong>問題1:</strong> JSPディレクティブについて正しい説明はどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1a" value="a">
                                    <label class="form-check-label" for="q1a">
                                        ディレクティブはJSPページの実行時にのみ処理される
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1b" value="b">
                                    <label class="form-check-label" for="q1b">
                                        ディレクティブはJSPページの変換時に処理され、JSPページの全体的な構造を制御する
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1c" value="c">
                                        <label class="form-check-label" for="q1c">
                                        ディレクティブはHTML内では使用できない
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q1" id="q1d" value="d">
                                        <label class="form-check-label" for="q1d">
                                        JSPページごとに1つのディレクティブしか使用できない
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題2:</strong> include ディレクティブと include アクションの違いについて正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2a" value="a">
                                    <label class="form-check-label" for="q2a">
                                        include ディレクティブは実行時にファイルを読み込み、include アクションはコンパイル時に読み込む
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2b" value="b">
                                    <label class="form-check-label" for="q2b">
                                        include ディレクティブはコンパイル時に処理され、include アクションは実行時に処理される
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2c" value="c">
                                        <label class="form-check-label" for="q2c">
                                        両方とも同じタイミングで処理されるが、構文が異なる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q2" id="q2d" value="d">
                                        <label class="form-check-label" for="q2d">
                                        include ディレクティブは標準的な機能だが、include アクションはカスタムタグライブラリが必要
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題3:</strong> page ディレクティブのerrorPage属性に関する説明で正しいものはどれですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3a" value="a">
                                    <label class="form-check-label" for="q3a">
                                        例外がスローされなくても、常にerrorPageで指定されたページにリダイレクトする
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3b" value="b">
                                    <label class="form-check-label" for="q3b">
                                        JSPでtry-catchブロックを使用している場合、errorPage属性は無視される
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3c" value="c">
                                        <label class="form-check-label" for="q3c">
                                        例外発生時に指定したJSPページにリダイレクトし、そのページではisErrorPage="true"を指定すると例外オブジェクトにアクセスできる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q3" id="q3d" value="d">
                                        <label class="form-check-label" for="q3d">
                                        errorPage属性は、HTMLエラーページのパスを指定するためのもので、JSPページは指定できない
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題4:</strong> taglib ディレクティブの目的は何ですか？</p>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4a" value="a">
                                    <label class="form-check-label" for="q4a">
                                        JSPページで使用するJavaクラスのインポートを指定する
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4b" value="b">
                                    <label class="form-check-label" for="q4b">
                                        JSPページでカスタムタグライブラリを使用するためのディレクティブ
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4c" value="c">
                                        <label class="form-check-label" for="q4c">
                                        エラーページを指定するためのディレクティブ
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q4" id="q4d" value="d">
                                        <label class="form-check-label" for="q4d">
                                        JSPページのMIMEタイプを指定するためのディレクティブ
                                    </label>
                                </div>
                            </div>
                            
                            <div class="quiz-question">
                                <p><strong>問題5:</strong> JSPページで以下のコードが実行された場合、どのJavaクラスがインポートされますか？</p>
                                <pre>&lt;%@ page import="java.util.*, java.text.SimpleDateFormat" %&gt;</pre>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5a" value="a">
                                    <label class="form-check-label" for="q5a">
                                        java.util.Arrayだけがインポートされる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5b" value="b">
                                    <label class="form-check-label" for="q5b">
                                        java.util.* と java.text.SimpleDateFormatがインポートされる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5c" value="c">
                                        <label class="form-check-label" for="q5c">
                                        java.util.SimpleDateFormat だけがインポートされる
                                    </label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="q5" id="q5d" value="d">
                                        <label class="form-check-label" for="q5d">
                                        java.* すべてのクラスがインポートされる
                                    </label>
                                </div>
                            </div>
                            
                            <button class="btn btn-primary mt-3" id="checkAnswers">回答を確認</button>
                            <div id="quizResults" class="mt-3 d-none">
                                <div class="alert alert-success">
                                    <h5>正解:</h5>
                                    <ol>
                                        <li>b（ディレクティブはJSPページの変換時に処理され、JSPページの全体的な構造を制御する）</li>
                                        <li>b（include ディレクティブはコンパイル時に処理され、include アクションは実行時に処理される）</li>
                                        <li>c（例外発生時に指定したJSPページにリダイレクトし、そのページではisErrorPage="true"を指定すると例外オブジェクトにアクセスできる）</li>
                                        <li>b（JSPページでカスタムタグライブラリを使用するためのディレクティブ）</li>
                                        <li>b（java.util.* と java.text.SimpleDateFormatがインポートされる）</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </section>

                    <section id="next-steps">
                        <h3 class="section-title">次のステップ</h3>
                        <p>この章では、JSPディレクティブとJavaクラスのインポート、例外処理について学びました。これらの知識は、効率的かつ堅牢なJSPページを作成するために重要です。</p>
                        <p>次の章では、JSPアクションタグとJavaBeansの使い方について学び、MVCアーキテクチャに基づいたWebアプリケーション開発の方法について詳しく見ていきます。</p>
                        <div class="note">
                            <h5>推奨される追加学習</h5>
                            <ul>
                                <li><strong>JSTLリファレンス</strong>：<a href="https://jakarta.ee/specifications/tags/" target="_blank">Jakarta Standard Tag Library</a></li>
                                <li><strong>エラー処理のベストプラクティス</strong>：<a href="https://www.owasp.org/index.php/Error_Handling" target="_blank">OWASP Error Handling</a></li>
                                <li><strong>Java例外処理</strong>：<a href="https://docs.oracle.com/javase/tutorial/essential/exceptions/" target="_blank">Java Exceptions Tutorial</a></li>
                            </ul>
                        </div>
                    </section>
                </section>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="text-center py-4">
        <div class="container">
            <p class="mb-0">Copyright © 2025 F-Circle All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS and Popper.js -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // 理解度テストの回答確認ボタンの処理
        document.getElementById('checkAnswers').addEventListener('click', function() {
            document.getElementById('quizResults').classList.remove('d-none');
        });
    </script>
</body>
</html>