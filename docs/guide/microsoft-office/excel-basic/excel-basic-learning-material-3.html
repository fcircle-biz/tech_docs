<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel基本操作学習教材 第3章 - フィルタとウィンドウ操作</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #0d6efd;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
        }

        /* タイトル */
        .chapter-title {
            color: #0d6efd;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0d6efd;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #495057;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0d6efd;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* コードハイライト */
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #0d6efd !important;
            color: white !important;
        }

        .nav-link {
            color: #495057;
        }

        .nav-link:hover {
            background-color: #e9ecef;
            color: #0d6efd;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>Excel基本操作学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-1.html">
                                第1章: 基本操作と表示設定
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-2.html">
                                第2章: セル操作と書式設定
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="excel-basic-learning-material-3.html">
                                第3章: フィルタとウィンドウ操作
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-4.html">
                                第4章: ページ設定と印刷
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-5.html">
                                第5章: オブジェクト操作
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-6.html">
                                第6章: 基本関数
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-7.html">
                                第7章: VLOOKUP関数と論理値
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="excel-basic-learning-material-8.html">
                                第8章: VBA基礎
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第3章: フィルタとウィンドウ操作</h1>
                </div>

                <div id="chapter3">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">大量データを効率的に表示・抽出する技術</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>ウィンドウ枠の固定による見出し行・列の常時表示</li>
                            <li>オートフィルタの設定と基本的な使い方</li>
                            <li>テキスト・数値・日付フィルタの活用方法</li>
                            <li>複数条件でのデータ抽出テクニック</li>
                            <li>色によるフィルタリング機能</li>
                            <li>フィルタ結果のコピーと集計方法</li>
                        </ul>
                    </div>

                    <!-- セクション1: ウィンドウ枠の固定 -->
                    <h3 class="section-title">3.1 ウィンドウ枠の固定による効率的な表示</h3>
                    <p>大量のデータを扱う際、スクロールしても見出し行や見出し列が見えなくなると、データの意味が分からなくなってしまいます。ウィンドウ枠の固定機能を使って、常に必要な情報が表示されるようにしましょう。</p>
                    
                    <h6>ウィンドウ枠固定の重要性</h6>
                    <div class="highlight">
                        <h6>なぜウィンドウ枠の固定が必要なのか？</h6>
                        <ul>
                            <li><strong>見出しの常時表示</strong>：データが何を意味するかを常に把握</li>
                            <li><strong>作業効率の向上</strong>：上下スクロール時に見出し行が見える</li>
                            <li><strong>データ入力の精度向上</strong>：正しい列にデータを入力しやすい</li>
                            <li><strong>大量データの分析</strong>：数百行・数十列のデータでも見やすい</li>
                        </ul>
                    </div>

                    <h6>ウィンドウ枠固定の種類</h6>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-primary">
                                <tr>
                                    <th>固定の種類</th>
                                    <th>機能</th>
                                    <th>効果</th>
                                    <th>使用場面</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>先頭行の固定</strong></td>
                                    <td>1行目（見出し行）を常に表示</td>
                                    <td>スクロールしても見出しが見える</td>
                                    <td>縦に長いデータの表示</td>
                                </tr>
                                <tr>
                                    <td><strong>先頭列の固定</strong></td>
                                    <td>A列（見出し列）を常に表示</td>
                                    <td>横スクロールしても左端が見える</td>
                                    <td>横に長いデータの表示</td>
                                </tr>
                                <tr>
                                    <td><strong>ウィンドウ枠の固定</strong></td>
                                    <td>指定した行・列の上・左を固定</td>
                                    <td>任意の位置で画面分割</td>
                                    <td>特定位置での固定が必要な場合</td>
                                </tr>
                                <tr>
                                    <td><strong>ウィンドウ枠固定の解除</strong></td>
                                    <td>すべての固定を解除</td>
                                    <td>通常の表示に戻る</td>
                                    <td>固定が不要になった場合</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h6>ウィンドウ枠固定の設定方法</h6>
                    <ul>
                        <li><strong>先頭行の固定</strong>：表示タブ → ウィンドウ枠の固定 → 先頭行の固定</li>
                        <li><strong>先頭列の固定</strong>：表示タブ → ウィンドウ枠の固定 → 先頭列の固定</li>
                        <li><strong>任意位置での固定</strong>：固定したい位置の右下のセルを選択 → 表示タブ → ウィンドウ枠の固定</li>
                    </ul>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 3-1: ウィンドウ枠の固定を体験する</h5>
                        <p>実際に大量データを作成して、ウィンドウ枠固定の効果を体験しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>以下のサンプルデータを作成します：
                                <ul>
                                    <li>A1:F1 → 「ID」「氏名」「部署」「役職」「入社年」「売上」</li>
                                    <li>A2以降に20行程度のサンプルデータを入力
                                        <ul>
                                            <li>A2: 001, B2: 田中太郎, C2: 営業部, D2: 主任, E2: 2020, F2: 5000000</li>
                                            <li>以下同様に20行作成（データは適当で構いません）</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li>まずはウィンドウ枠を固定せずに動作確認：
                                <ul>
                                    <li>セルA15程度までスクロールダウン</li>
                                    <li>見出し行が見えなくなることを確認</li>
                                </ul>
                            </li>
                            <li>セルA1をクリックして先頭に戻ります</li>
                            <li>表示タブ → ウィンドウ枠の固定 → 先頭行の固定 をクリック</li>
                            <li>再度下方向にスクロールして、今度は見出し行が固定されることを確認</li>
                            <li>さらに先頭列も固定してみます：
                                <ul>
                                    <li>表示タブ → ウィンドウ枠の固定 → ウィンドウ枠固定の解除</li>
                                    <li>セルB2をクリック（A列と1行目の両方を固定したい場合）</li>
                                    <li>表示タブ → ウィンドウ枠の固定 → ウィンドウ枠の固定</li>
                                </ul>
                            </li>
                            <li>右方向・下方向にスクロールして、A列と1行目の両方が固定されることを確認</li>
                        </ol>
                        <h6>確認ポイント</h6>
                        <p>固定されたウィンドウ枠は、境界線が太い実線で表示されます。この線より上・左の部分は常に表示されたままになります。</p>
                    </div>

                    <!-- セクション2: オートフィルタの基本 -->
                    <h3 class="section-title">3.2 オートフィルタの設定と基本操作</h3>
                    <p>オートフィルタは、Excelの最も強力なデータ抽出機能の一つです。大量のデータから必要な情報だけを素早く抽出できます。</p>

                    <h6>オートフィルタとは</h6>
                    <div class="highlight">
                        <h6>オートフィルタの特徴</h6>
                        <ul>
                            <li><strong>簡単設定</strong>：ワンクリックで有効化可能</li>
                            <li><strong>直感的操作</strong>：ドロップダウンメニューから選択</li>
                            <li><strong>複数条件</strong>：複数列で同時にフィルタリング可能</li>
                            <li><strong>元データ保持</strong>：元のデータは変更されない</li>
                            <li><strong>表示/非表示切替</strong>：フィルタのオン・オフが簡単</li>
                        </ul>
                    </div>

                    <h6>オートフィルタの設定手順</h6>
                    <ol>
                        <li>データ範囲内の任意のセルを選択</li>
                        <li>データタブ → フィルタ をクリック</li>
                        <li>見出し行に下向き矢印（ドロップダウン）が表示される</li>
                        <li>矢印をクリックしてフィルタメニューを表示</li>
                    </ol>

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-info">
                                <tr>
                                    <th>ステップ</th>
                                    <th>操作</th>
                                    <th>結果</th>
                                    <th>注意点</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>1</strong></td>
                                    <td>データ選択</td>
                                    <td>データ範囲内のセルがアクティブになる</td>
                                    <td>見出し行を含む範囲にする</td>
                                </tr>
                                <tr>
                                    <td><strong>2</strong></td>
                                    <td>データタブ → フィルタ</td>
                                    <td>フィルタ機能が有効化される</td>
                                    <td>リボンのデータタブを選択</td>
                                </tr>
                                <tr>
                                    <td><strong>3</strong></td>
                                    <td>ドロップダウン矢印表示</td>
                                    <td>見出し行に矢印が追加される</td>
                                    <td>全ての見出しセルに表示される</td>
                                </tr>
                                <tr>
                                    <td><strong>4</strong></td>
                                    <td>フィルタメニューアクセス</td>
                                    <td>フィルタ条件設定画面が開く</td>
                                    <td>設定したい列の矢印をクリック</td>
                                </tr>
                                <tr>
                                    <td><strong>5</strong></td>
                                    <td>条件選択・適用</td>
                                    <td>指定条件に合致する行のみ表示</td>
                                    <td>複数条件の組み合わせ可能</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h6>フィルタメニューの構成</h6>
                    <ul>
                        <li><strong>すべて選択</strong>：全項目の選択・選択解除</li>
                        <li><strong>個別項目</strong>：表示したい項目をチェック</li>
                        <li><strong>検索ボックス</strong>：項目名で検索</li>
                        <li><strong>条件フィルタ</strong>：テキスト・数値・日付フィルタ</li>
                    </ul>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 3-2: オートフィルタの基本操作</h5>
                        <p>前回作成したデータにオートフィルタを設定して、基本的な抽出を行いましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>前回作成したデータ（20行程度の従業員データ）を使用します</li>
                            <li>データ範囲内の任意のセル（例：B5）をクリック</li>
                            <li>データタブ → フィルタ をクリック</li>
                            <li>各見出しセルに下向き矢印が表示されることを確認</li>
                            <li>「部署」列のドロップダウン矢印をクリック</li>
                            <li>メニューの内容を確認：
                                <ul>
                                    <li>「すべて選択」チェックボックス</li>
                                    <li>部署名の一覧（営業部、経理部、開発部など）</li>
                                    <li>下部のテキストフィルタオプション</li>
                                </ul>
                            </li>
                            <li>「営業部」のみにチェックを入れて「OK」をクリック</li>
                            <li>結果を確認：
                                <ul>
                                    <li>営業部の行のみが表示される</li>
                                    <li>行番号が青色になる（フィルタ適用の表示）</li>
                                    <li>部署列の矢印にフィルタアイコンが表示される</li>
                                </ul>
                            </li>
                            <li>フィルタを解除：部署列のドロップダウン → すべて選択 → OK</li>
                        </ol>
                        <h6>学習ポイント</h6>
                        <p>フィルタが適用されると、行番号が青色になり、条件に一致しない行は一時的に非表示になります。データは削除されていないことを理解しましょう。</p>
                    </div>

                    <!-- セクション3: 条件フィルタの活用 -->
                    <h3 class="section-title">3.3 テキスト・数値・日付フィルタの詳細活用</h3>
                    <p>オートフィルタでは、単純な項目選択以外にも、条件を指定した高度なフィルタリングが可能です。データの種類に応じて最適なフィルタ方法を選択しましょう。</p>

                    <h6>テキストフィルタの種類</h6>
                    <ul>
                        <li><strong>次で始まる</strong>：指定した文字で始まる項目を抽出</li>
                        <li><strong>次で終わる</strong>：指定した文字で終わる項目を抽出</li>
                        <li><strong>次を含む</strong>：指定した文字を含む項目を抽出</li>
                        <li><strong>次と等しい</strong>：指定した文字と完全に一致する項目を抽出</li>
                        <li><strong>カスタムフィルタ</strong>：複雑な条件を組み合わせ</li>
                    </ul>

                    <h6>数値フィルタの種類</h6>
                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-success">
                                <tr>
                                    <th>フィルタ分類</th>
                                    <th>オプション</th>
                                    <th>説明</th>
                                    <th>使用例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="3"><strong>比較演算子</strong></td>
                                    <td>より大きい/小さい</td>
                                    <td>指定値との大小比較</td>
                                    <td>売上 &gt; 100万円</td>
                                </tr>
                                <tr>
                                    <td>以上/以下</td>
                                    <td>指定値を含む大小比較</td>
                                    <td>点数 ≥ 80点</td>
                                </tr>
                                <tr>
                                    <td>等しい/等しくない</td>
                                    <td>指定値との一致・不一致</td>
                                    <td>部門コード = 101</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>範囲指定</strong></td>
                                    <td>指定値の間</td>
                                    <td>最小値と最大値の間</td>
                                    <td>50 ≤ 年齢 ≤ 65</td>
                                </tr>
                                <tr>
                                    <td>指定値の間以外</td>
                                    <td>範囲外の値</td>
                                    <td>価格 &lt; 1000 または 価格 &gt; 5000</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>上位・下位</strong></td>
                                    <td>上位10項目</td>
                                    <td>大きい値から指定数</td>
                                    <td>売上上位10店舗</td>
                                </tr>
                                <tr>
                                    <td>下位10項目</td>
                                    <td>小さい値から指定数</td>
                                    <td>成績下位10名</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>平均との比較</strong></td>
                                    <td>平均より上</td>
                                    <td>平均値を超える項目</td>
                                    <td>平均売上を上回る月</td>
                                </tr>
                                <tr>
                                    <td>平均より下</td>
                                    <td>平均値を下回る項目</td>
                                    <td>平均点以下の生徒</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h6>日付フィルタの特徴</h6>
                    <div class="highlight">
                        <h6>便利な日付フィルタオプション</h6>
                        <ul>
                            <li><strong>今日</strong>：今日の日付のデータのみ</li>
                            <li><strong>昨日・明日</strong>：基準日からの相対日付</li>
                            <li><strong>今週・来週</strong>：週単位での期間指定</li>
                            <li><strong>今月・来月</strong>：月単位での期間指定</li>
                            <li><strong>今四半期・今年</strong>：四半期・年単位での期間指定</li>
                            <li><strong>カスタム期間</strong>：開始日と終了日を指定</li>
                        </ul>
                    </div>

                    <!-- 実習3 -->
                    <div class="exercise-container">
                        <h5>実習 3-3: 条件フィルタの実践</h5>
                        <p>様々な条件フィルタを使用して、データの高度な抽出を行いましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>売上データを追加で作成します：
                                <ul>
                                    <li>G1: 「売上日」として日付列を追加</li>
                                    <li>G2以降に2024年の様々な日付を入力（例：2024/1/15, 2024/2/20など）</li>
                                </ul>
                            </li>
                            <li>テキストフィルタの練習：
                                <ul>
                                    <li>氏名列のドロップダウン → テキストフィルタ → 次で始まる</li>
                                    <li>「田」と入力してOK（田中、田村など「田」で始まる名前を抽出）</li>
                                    <li>結果を確認後、フィルタを解除</li>
                                </ul>
                            </li>
                            <li>数値フィルタの練習：
                                <ul>
                                    <li>売上列のドロップダウン → 数値フィルタ → より大きい</li>
                                    <li>「3000000」と入力してOK（売上300万円超のデータを抽出）</li>
                                    <li>結果を確認後、フィルタを解除</li>
                                </ul>
                            </li>
                            <li>範囲フィルタの練習：
                                <ul>
                                    <li>売上列のドロップダウン → 数値フィルタ → 指定の値の間</li>
                                    <li>最小値：2000000、最大値：4000000と入力</li>
                                    <li>売上が200万円〜400万円の範囲のデータが抽出されることを確認</li>
                                </ul>
                            </li>
                            <li>日付フィルタの練習：
                                <ul>
                                    <li>売上日列のドロップダウン → 日付フィルタ → 今年</li>
                                    <li>今年のデータのみが表示されることを確認</li>
                                </ul>
                            </li>
                        </ol>
                        <h6>発展練習</h6>
                        <p>複数の条件を同時に適用してみましょう：部署が「営業部」かつ売上が300万円以上のデータを抽出してください。</p>
                    </div>

                    <!-- セクション4: 複数条件フィルタ -->
                    <h3 class="section-title">3.4 複数条件でのデータ抽出テクニック</h3>
                    <p>実際のビジネスでは、単一の条件ではなく、複数の条件を組み合わせてデータを抽出する必要があります。Excelの複数条件フィルタを効果的に活用しましょう。</p>

                    <h6>複数条件の種類</h6>
                    <ul>
                        <li><strong>AND条件</strong>：すべての条件を満たすデータ（例：営業部 かつ 売上300万円以上）</li>
                        <li><strong>OR条件</strong>：いずれかの条件を満たすデータ（例：営業部 または 開発部）</li>
                        <li><strong>複合条件</strong>：AND条件とOR条件を組み合わせ</li>
                    </ul>

                    <h6>カスタムフィルタの活用</h6>
                    <div class="warning">
                        <h6>カスタムフィルタの制限事項</h6>
                        <ul>
                            <li>1つの列につき最大2つの条件まで</li>
                            <li>3つ以上の条件が必要な場合は高度なフィルタを使用</li>
                            <li>異なる列の条件は自動的にAND条件で結合される</li>
                        </ul>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-bordered">
                            <thead class="table-warning">
                                <tr>
                                    <th>条件タイプ</th>
                                    <th>設定方法</th>
                                    <th>結合方式</th>
                                    <th>制限事項</th>
                                    <th>使用例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>同一列内の条件</strong></td>
                                    <td>カスタムフィルタ使用</td>
                                    <td>AND または OR で結合</td>
                                    <td>最大2条件まで</td>
                                    <td>売上 &gt; 100万 AND 売上 &lt; 500万</td>
                                </tr>
                                <tr>
                                    <td><strong>異なる列間の条件</strong></td>
                                    <td>各列でフィルタ設定</td>
                                    <td>自動的にAND結合</td>
                                    <td>すべて満たすデータのみ表示</td>
                                    <td>部署=営業 AND 地域=関東 AND 売上&gt;300万</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="highlight">
                        <h6>複数条件設定のコツ</h6>
                        <ul>
                            <li><strong>順序を意識</strong>: 絞り込み効果の高い条件から先に設定</li>
                            <li><strong>段階的な絞り込み</strong>: 一度に多くの条件を設定せず、段階的に絞り込む</li>
                            <li><strong>条件の確認</strong>: 設定した条件がフィルタアイコンに反映されているか確認</li>
                            <li><strong>解除の手順</strong>: 複数条件を一度に解除したい場合は「データ → フィルタ」で全解除</li>
                        </ul>
                    </div>

                    <!-- 実習4 -->
                    <div class="exercise-container">
                        <h5>実習 3-4: 複数条件フィルタの実践</h5>
                        <p>実際のビジネスシナリオを想定して、複数条件でのデータ抽出を行いましょう。</p>
                        <h6>シナリオ設定</h6>
                        <p>「営業部または開発部で、かつ売上が250万円以上400万円以下の従業員を抽出したい」</p>
                        <h6>手順</h6>
                        <ol>
                            <li>まず部署条件を設定：
                                <ul>
                                    <li>部署列のドロップダウンをクリック</li>
                                    <li>「すべて選択」のチェックを外す</li>
                                    <li>「営業部」と「開発部」のみにチェック</li>
                                    <li>OK をクリック</li>
                                </ul>
                            </li>
                            <li>次に売上条件を追加：
                                <ul>
                                    <li>売上列のドロップダウン → 数値フィルタ → 指定の値の間</li>
                                    <li>最小値：2500000、最大値：4000000 を入力</li>
                                    <li>OK をクリック</li>
                                </ul>
                            </li>
                            <li>結果の確認：
                                <ul>
                                    <li>営業部または開発部の従業員のみ表示</li>
                                    <li>かつ売上が250万円〜400万円の範囲</li>
                                    <li>両方の条件を満たすデータのみが表示される</li>
                                </ul>
                            </li>
                            <li>さらに複雑な条件を試す：
                                <ul>
                                    <li>役職列で「主任」または「課長」の条件を追加</li>
                                    <li>最終的に3つの条件すべてを満たすデータが抽出される</li>
                                </ul>
                            </li>
                            <li>フィルタ状況の確認：
                                <ul>
                                    <li>ドロップダウン矢印がフィルタアイコンに変わっている列を確認</li>
                                    <li>ステータスバーで「○件中○件を表示」を確認</li>
                                </ul>
                            </li>
                        </ol>
                        <h6>応用課題</h6>
                        <p>「入社年が2020年以降で、売上が部署平均より高い従業員」を抽出してみましょう。</p>
                    </div>

                    <!-- セクション5: 色によるフィルタリング -->
                    <h3 class="section-title">3.5 色によるフィルタリング機能</h3>
                    <p>Excelでは、セルの背景色や文字色によるフィルタリングも可能です。視覚的に分類されたデータを効率的に抽出できます。</p>

                    <h6>色フィルタの用途</h6>
                    <div class="highlight">
                        <h6>色フィルタが有効な場面</h6>
                        <ul>
                            <li><strong>優先度管理</strong>：赤＝緊急、黄＝注意、緑＝正常</li>
                            <li><strong>進捗管理</strong>：完了＝青、進行中＝黄、未着手＝灰色</li>
                            <li><strong>分類表示</strong>：カテゴリ別に色分けされたデータ</li>
                            <li><strong>条件付き書式との連携</strong>：自動で色付けされたデータの抽出</li>
                        </ul>
                    </div>

                    <h6>色フィルタの操作方法</h6>
                    <ol>
                        <li>色が設定されているデータでフィルタを有効化</li>
                        <li>該当列のドロップダウン → 色でフィルタ</li>
                        <li>セルの色別フィルタ または フォントの色別フィルタ を選択</li>
                        <li>表示したい色を選択してOK</li>
                    </ol>

                    <!-- 実習5 -->
                    <div class="exercise-container">
                        <h5>実習 3-5: 色フィルタの実践</h5>
                        <p>タスク管理表を作成して、色によるフィルタリングを体験しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>新しいシートにタスク管理表を作成：
                                <ul>
                                    <li>A1:D1 → 「タスク名」「担当者」「期限」「状況」</li>
                                    <li>A2以降に10行程度のタスクデータを入力</li>
                                </ul>
                            </li>
                            <li>状況列に色付けを行います：
                                <ul>
                                    <li>完了タスクのセル → 緑色の背景</li>
                                    <li>進行中タスクのセル → 黄色の背景</li>
                                    <li>未着手タスクのセル → 赤色の背景</li>
                                </ul>
                            </li>
                            <li>データにオートフィルタを設定</li>
                            <li>状況列のドロップダウン → 色でフィルタ → セルの色別フィルタ</li>
                            <li>緑色を選択して、完了タスクのみを表示</li>
                            <li>フィルタを変更して、今度は赤色（未着手）のタスクのみを表示</li>
                            <li>色フィルタと通常のフィルタを組み合わせ：
                                <ul>
                                    <li>担当者でフィルタをかけた後</li>
                                    <li>さらに色フィルタで進行中（黄色）のタスクを抽出</li>
                                </ul>
                            </li>
                        </ol>
                        <h6>学習ポイント</h6>
                        <p>色フィルタは通常のフィルタと組み合わせて使用できます。視覚的な分類と条件による分類を同時に活用することで、より精密なデータ抽出が可能になります。</p>
                    </div>

                    <!-- セクション6: フィルタ結果の活用 -->
                    <h3 class="section-title">3.6 フィルタ結果のコピーと集計</h3>
                    <p>フィルタで抽出したデータは、そのままコピーして他の場所に貼り付けたり、集計処理に使用したりできます。フィルタ結果を効果的に活用する方法を学びましょう。</p>

                    <h6>フィルタデータのコピー手順</h6>
                    <ol>
                        <li>フィルタを適用してデータを抽出</li>
                        <li>表示されているデータ範囲を選択</li>
                        <li>Ctrl + C でコピー</li>
                        <li>貼り付け先でCtrl + V で貼り付け</li>
                    </ol>

                    <div class="warning">
                        <h6>フィルタデータコピー時の注意点</h6>
                        <ul>
                            <li><strong>非表示行の扱い</strong>：非表示の行は自動的に除外されてコピーされる</li>
                            <li><strong>範囲選択の重要性</strong>：見出し行も含めて選択することを推奨</li>
                            <li><strong>書式の保持</strong>：元の書式も一緒にコピーされる</li>
                        </ul>
                    </div>

                    <h6>フィルタ結果での集計</h6>
                    <div class="highlight">
                        <h6>フィルタされたデータの集計方法</h6>
                        <ul>
                            <li><strong>ステータスバー確認</strong>：選択範囲の合計・平均・個数が自動表示</li>
                            <li><strong>SUBTOTAL関数</strong>：フィルタされたデータのみを集計</li>
                            <li><strong>AGGREGATE関数</strong>：より高度な集計（非表示行を自動除外）</li>
                        </ul>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-danger">
                                <tr>
                                    <th>活用方法</th>
                                    <th>具体的手法</th>
                                    <th>操作方法</th>
                                    <th>メリット</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td rowspan="2"><strong>データのコピー</strong></td>
                                    <td>表示行のみコピー</td>
                                    <td>範囲選択 → Ctrl+C → 貼り付け</td>
                                    <td>フィルタ条件に合致するデータのみ抽出</td>
                                </tr>
                                <tr>
                                    <td>書式も含めてコピー</td>
                                    <td>形式を選択して貼り付けで書式も含める</td>
                                    <td>見た目を保持したまま別シートに転記</td>
                                </tr>
                                <tr>
                                    <td rowspan="3"><strong>集計処理</strong></td>
                                    <td>SUBTOTAL関数</td>
                                    <td>=SUBTOTAL(109, 範囲)</td>
                                    <td>フィルタされたデータのみを集計</td>
                                </tr>
                                <tr>
                                    <td>ステータスバー情報</td>
                                    <td>範囲選択でステータスバー確認</td>
                                    <td>手軽に合計・平均・個数を確認</td>
                                </tr>
                                <tr>
                                    <td>AGGREGATE関数</td>
                                    <td>=AGGREGATE(9, 5, 範囲)</td>
                                    <td>非表示行を自動除外する高度な集計</td>
                                </tr>
                                <tr>
                                    <td rowspan="2"><strong>レポート作成</strong></td>
                                    <td>フィルタ済みデータでレポート</td>
                                    <td>条件設定 → グラフ作成・印刷</td>
                                    <td>特定条件のデータに絞った分析</td>
                                </tr>
                                <tr>
                                    <td>条件別集計表</td>
                                    <td>複数フィルタで段階別集計</td>
                                    <td>様々な観点からの比較分析</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- 実習6 -->
                    <div class="exercise-container">
                        <h5>実習 3-6: フィルタ結果の集計とレポート作成</h5>
                        <p>部署別売上レポートを作成して、フィルタ結果を活用した集計処理を学びましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>元データで営業部のみをフィルタ表示します</li>
                            <li>売上列（数値部分）を選択して、ステータスバーの情報を確認：
                                <ul>
                                    <li>合計、平均、個数が表示されることを確認</li>
                                </ul>
                            </li>
                            <li>SUBTOTAL関数を使用した集計表を作成：
                                <ul>
                                    <li>別の場所（例：H1）に「営業部売上集計」と入力</li>
                                    <li>H2に「合計」、I2に「=SUBTOTAL(9,F:F)」を入力</li>
                                    <li>H3に「平均」、I3に「=SUBTOTAL(1,F:F)」を入力</li>
                                    <li>H4に「個数」、I4に「=SUBTOTAL(3,F:F)」を入力</li>
                                </ul>
                            </li>
                            <li>フィルタを変更して動作確認：
                                <ul>
                                    <li>開発部でフィルタをかけ直す</li>
                                    <li>SUBTOTAL関数の結果が自動更新されることを確認</li>
                                </ul>
                            </li>
                            <li>フィルタ結果のコピー練習：
                                <ul>
                                    <li>開発部でフィルタされたデータ全体を選択</li>
                                    <li>新しいシートに貼り付けて「開発部レポート」を作成</li>
                                </ul>
                            </li>
                            <li>全フィルタ解除して元のデータに戻し、SUBTOTAL関数の値が変わることを確認</li>
                        </ol>
                        <h6>SUBTOTAL関数の引数</h6>
                        <ul>
                            <li>9: 合計 (SUM)</li>
                            <li>1: 平均 (AVERAGE)</li>
                            <li>3: データの個数 (COUNTA)</li>
                            <li>4: 最大値 (MAX)</li>
                            <li>5: 最小値 (MIN)</li>
                        </ul>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>ウィンドウ枠の固定で、A列と1行目の両方を固定したい場合、選択するセルは？</strong>
                                <br>a) A1  b) A2  c) B1  d) B2
                            </li>
                            <li>
                                <strong>オートフィルタを設定するために必要な操作は？</strong>
                                <br>a) 全データを選択してからデータタブ → フィルタ
                                <br>b) データ範囲内の任意のセルを選択してからデータタブ → フィルタ
                                <br>c) 見出し行のみを選択してからデータタブ → フィルタ
                                <br>d) 最初の列を選択してからデータタブ → フィルタ
                            </li>
                            <li>
                                <strong>フィルタが適用されている行の特徴は？</strong>
                                <br>a) 行番号が赤色になる  b) 行番号が青色になる  c) 行番号が太字になる  d) 行番号が点線になる
                            </li>
                            <li>
                                <strong>異なる列で複数の条件を設定した場合、それらの関係は？</strong>
                                <br>a) OR条件（いずれかを満たす）  b) AND条件（すべてを満たす）  c) XOR条件  d) 関係なし
                            </li>
                            <li>
                                <strong>フィルタされたデータのみを集計する関数は？</strong>
                                <br>a) SUM  b) AVERAGE  c) SUBTOTAL  d) COUNT
                            </li>
                        </ol>
                        
                        <div style="margin-top: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                            <strong>解答:</strong>
                            <br>1. d) B2（固定したい範囲の右下のセルを選択）
                            <br>2. b) データ範囲内の任意のセルを選択してからデータタブ → フィルタ
                            <br>3. b) 行番号が青色になる
                            <br>4. b) AND条件（すべてを満たす）
                            <br>5. c) SUBTOTAL
                        </div>
                    </div>

                    <!-- 章のまとめ -->
                    <div class="highlight">
                        <h5>第3章のまとめ</h5>
                        <p>この章では、大量データを効率的に表示・抽出するための技術について学習しました：</p>
                        <ul>
                            <li><strong>ウィンドウ枠の固定</strong>：見出し行・列の常時表示による視認性向上</li>
                            <li><strong>オートフィルタ</strong>：データタブ → フィルタで簡単設定、直感的な操作</li>
                            <li><strong>条件フィルタ</strong>：テキスト・数値・日付それぞれの特性を活かした抽出</li>
                            <li><strong>複数条件</strong>：AND条件による精密な抽出、カスタムフィルタの活用</li>
                            <li><strong>色フィルタ</strong>：視覚的分類との連携、条件付き書式との組み合わせ</li>
                            <li><strong>結果の活用</strong>：SUBTOTAL関数による集計、フィルタデータのコピー</li>
                        </ul>
                        <p>これらの技術により、数千行・数十列の大量データでも必要な情報を素早く見つけ、分析することができるようになります。日常業務での効率が大幅に向上するでしょう。</p>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="excel-basic-learning-material-2.html" class="btn btn-secondary">← 前の章：セル操作と書式設定</a>
                        <a href="excel-basic-learning-material-4.html" class="btn btn-primary">次の章：ページ設定と印刷 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2025 F-Circle All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>