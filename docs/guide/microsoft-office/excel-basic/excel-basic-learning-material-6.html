<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel基本操作学習教材 第6章 - 基本関数</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <!-- カスタムCSS -->
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #0d6efd; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; background-color: #f8f9fa; }
        .chapter-title { color: #0d6efd; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #0d6efd; padding-bottom: 0.5rem; }
        .section-title { color: #495057; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e3f2fd; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #0d6efd; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .code-block { background-color: #1e1e1e; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
        .nav-link.active { background-color: #0d6efd !important; color: white !important; }
        .nav-link { color: #495057; }
        .nav-link:hover { background-color: #e9ecef; color: #0d6efd; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand"><strong>Excel基本操作学習教材</strong></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-1.html">第1章: 基本操作と表示設定</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-2.html">第2章: セル操作と書式設定</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-3.html">第3章: フィルタとウィンドウ操作</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-4.html">第4章: ページ設定と印刷</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-5.html">第5章: オブジェクト操作</a></li>
                        <li class="nav-item"><a class="nav-link active" href="excel-basic-learning-material-6.html">第6章: 基本関数</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-7.html">第7章: VLOOKUP関数と論理値</a></li>
                        <li class="nav-item"><a class="nav-link" href="excel-basic-learning-material-8.html">第8章: VBA基礎</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第6章: 基本関数</h1>
                </div>

                <div id="chapter6">
                    <h2 class="chapter-title">Excel関数で計算を自動化する</h2>
                    
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Excel関数の基本概念と構文の理解</li>
                            <li>セル参照（相対参照・絶対参照）の使い分け</li>
                            <li>基本的な集計関数（SUM、AVERAGE、COUNT）</li>
                            <li>論理関数（IF、AND、OR）の活用</li>
                            <li>日付・時刻関数の実践的な使い方</li>
                            <li>文字列関数による文字操作</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.1 Excel関数の基本概念</h3>
                    <p>Excel関数は、あらかじめ用意された計算式のことで、複雑な計算や処理を簡単な記述で実行できます。関数を理解することで、Excelの真の力を引き出せます。</p>

                    <div class="highlight">
                        <h6>関数の基本構文</h6>
                        <pre class="code-block"><code>=関数名(引数1, 引数2, 引数3...)</code></pre>
                        <ul>
                            <li><strong>=（イコール）</strong>：数式の開始を示す</li>
                            <li><strong>関数名</strong>：実行したい処理の名前（SUM、AVERAGEなど）</li>
                            <li><strong>引数</strong>：関数に渡すデータや条件（カンマで区切る）</li>
                        </ul>
                    </div>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-primary">
                                <tr>
                                    <th>関数分類</th>
                                    <th>主要関数</th>
                                    <th>用途・機能</th>
                                    <th>使用例</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>数学・統計</strong></td>
                                    <td>SUM, AVERAGE, COUNT, MAX, MIN, ROUND</td>
                                    <td>合計、平均、個数、最大最小値、四捨五入</td>
                                    <td>売上集計、成績計算、データ分析</td>
                                </tr>
                                <tr>
                                    <td><strong>論理関数</strong></td>
                                    <td>IF, AND, OR, NOT, TRUE, FALSE</td>
                                    <td>条件判断と分岐処理</td>
                                    <td>合否判定、評価システム、条件付き計算</td>
                                </tr>
                                <tr>
                                    <td><strong>文字列関数</strong></td>
                                    <td>CONCATENATE, LEFT, RIGHT, MID, LEN, UPPER</td>
                                    <td>文字列の結合、抽出、変換</td>
                                    <td>氏名分離、メール作成、データ整形</td>
                                </tr>
                                <tr>
                                    <td><strong>日付・時刻</strong></td>
                                    <td>TODAY, NOW, DATE, YEAR, MONTH, DAY</td>
                                    <td>現在日時取得、日付要素抽出</td>
                                    <td>勤続年数計算、期限管理、年齢計算</td>
                                </tr>
                                <tr>
                                    <td><strong>検索・参照</strong></td>
                                    <td>VLOOKUP, HLOOKUP, INDEX, MATCH</td>
                                    <td>データ検索と参照</td>
                                    <td>マスタ検索、データ結合、値抽出</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <h3 class="section-title">6.2 セル参照の理解</h3>
                    <p>セル参照は関数の基礎となる重要な概念です。相対参照と絶対参照の違いを正しく理解しましょう。</p>

                    <div class="warning">
                        <h6>セル参照の種類</h6>
                        <ul>
                            <li><strong>相対参照（A1）</strong>：数式をコピーすると参照先が相対的に変化</li>
                            <li><strong>絶対参照（$A$1）</strong>：数式をコピーしても参照先が固定</li>
                            <li><strong>混合参照（$A1, A$1）</strong>：行または列のみ固定</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>実習 6-1: セル参照と基本関数</h5>
                        <p>売上データを使って基本的な集計関数を学習しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>以下のデータを入力：
                                <ul>
                                    <li>A1:D1 → 「商品」「単価」「数量」「金額」</li>
                                    <li>A2:D5 → 商品データ4行を入力</li>
                                </ul>
                            </li>
                            <li>D2に金額計算式を入力：<code>=B2*C2</code></li>
                            <li>D2をD5までコピー（相対参照の動作確認）</li>
                            <li>基本集計関数の実践：
                                <ul>
                                    <li>D6: <code>=SUM(D2:D5)</code> (合計)</li>
                                    <li>D7: <code>=AVERAGE(D2:D5)</code> (平均)</li>
                                    <li>D8: <code>=COUNT(D2:D5)</code> (個数)</li>
                                    <li>D9: <code>=MAX(D2:D5)</code> (最大値)</li>
                                    <li>D10: <code>=MIN(D2:D5)</code> (最小値)</li>
                                </ul>
                            </li>
                        </ol>
                    </div>

                    <h3 class="section-title">6.3 論理関数（IF、AND、OR）</h3>
                    <p>論理関数を使用することで、条件に応じて異なる処理を実行できます。ビジネスでは判断ロジックの自動化に不可欠です。</p>

                    <div class="highlight">
                        <h6>IF関数の基本構文</h6>
                        <pre class="code-block"><code>=IF(条件, 条件が真の場合の値, 条件が偽の場合の値)</code></pre>
                        <p>例：<code>=IF(A1>=80, "合格", "不合格")</code></p>
                    </div>

                    <div class="exercise-container">
                        <h5>実習 6-2: 論理関数の活用</h5>
                        <p>売上実績に基づく評価システムを作成しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>売上データに「評価」列（E列）を追加</li>
                            <li>E2に評価式を入力：<code>=IF(D2>=10000, "優秀", "標準")</code></li>
                            <li>複数条件の評価式に変更：
                                <pre class="code-block"><code>=IF(D2>=15000, "優秀", IF(D2>=10000, "良好", "要改善"))</code></pre>
                            </li>
                            <li>AND関数を使った複合条件：
                                <pre class="code-block"><code>=IF(AND(D2>=10000, C2>=5), "ボーナス対象", "対象外")</code></pre>
                            </li>
                        </ol>
                    </div>

                    <h3 class="section-title">6.4 日付・時刻関数</h3>
                    <p>日付・時刻関数は、期限管理、経過日数計算、年齢計算など、ビジネスで頻繁に使用される関数群です。</p>

                    <div class="table-responsive">
                        <table class="table table-bordered table-striped">
                            <thead class="table-primary">
                                <tr>
                                    <th>機能分類</th>
                                    <th>関数名</th>
                                    <th>構文例</th>
                                    <th>使用用途</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td><strong>現在日時取得</strong></td>
                                    <td>TODAY, NOW</td>
                                    <td>=TODAY()<br>=NOW()</td>
                                    <td>現在の日付取得、現在の日時取得</td>
                                </tr>
                                <tr>
                                    <td><strong>日付作成</strong></td>
                                    <td>DATE</td>
                                    <td>=DATE(年,月,日)</td>
                                    <td>指定した年月日の日付データ作成</td>
                                </tr>
                                <tr>
                                    <td><strong>日付要素抽出</strong></td>
                                    <td>YEAR, MONTH, DAY</td>
                                    <td>=YEAR(日付)<br>=MONTH(日付)<br>=DAY(日付)</td>
                                    <td>日付から年、月、日の値を個別に抽出</td>
                                </tr>
                                <tr>
                                    <td><strong>期間計算</strong></td>
                                    <td>DATEDIF</td>
                                    <td>=DATEDIF(開始,終了,単位)</td>
                                    <td>2つの日付間の期間計算（年数、月数、日数）</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div class="exercise-container">
                        <h5>実習 6-3: 日付関数の実践</h5>
                        <p>従業員の勤続年数と年齢を計算するシステムを作成しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>従業員データを作成：
                                <ul>
                                    <li>A1:D1 → 「氏名」「入社日」「生年月日」「勤続年数」</li>
                                    <li>サンプルデータを3-5行入力</li>
                                </ul>
                            </li>
                            <li>勤続年数の計算（D2）：
                                <pre class="code-block"><code>=DATEDIF(B2, TODAY(), "Y")&"年"&DATEDIF(B2, TODAY(), "YM")&"ヶ月"</code></pre>
                            </li>
                            <li>年齢計算も追加（E列）：
                                <pre class="code-block"><code>=DATEDIF(C2, TODAY(), "Y")</code></pre>
                            </li>
                        </ol>
                    </div>

                    <h3 class="section-title">6.5 文字列関数</h3>
                    <p>文字列関数は、テキストデータの操作や書式設定に使用します。データ整形や表示調整に重要な役割を果たします。</p>

                    <div class="exercise-container">
                        <h5>実習 6-4: 文字列関数の活用</h5>
                        <p>氏名データから姓と名を分離し、メール形式を作成しましょう。</p>
                        <h6>手順</h6>
                        <ol>
                            <li>氏名データ（「田中太郎」「佐藤花子」等）をA列に入力</li>
                            <li>姓の抽出（B列）：<code>=LEFT(A2, 2)</code></li>
                            <li>名の抽出（C列）：<code>=RIGHT(A2, LEN(A2)-2)</code></li>
                            <li>メールアドレス作成（D列）：
                                <pre class="code-block"><code>=LOWER(C2&"."&B2&"@company.co.jp")</code></pre>
                            </li>
                        </ol>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>絶対参照を示す記号は？</strong><br>a) & b) $ c) # d) %</li>
                            <li><strong>=IF(A1>100, "大", "小")の意味は？</strong><br>a) A1が100より大きければ「大」、そうでなければ「小」<br>b) A1が100以上なら「大」、そうでなければ「小」<br>c) A1が100なら「大」、そうでなければ「小」<br>d) 常に「大」を表示</li>
                            <li><strong>今日の日付を自動表示する関数は？</strong><br>a) DATE() b) NOW() c) TODAY() d) DAY()</li>
                            <li><strong>文字列を結合する関数は？</strong><br>a) JOIN() b) CONCATENATE() c) MERGE() d) COMBINE()</li>
                            <li><strong>範囲の平均値を求める関数は？</strong><br>a) MEAN() b) AVG() c) AVERAGE() d) MEDIAN()</li>
                        </ol>
                        <div style="margin-top: 20px; padding: 10px; background-color: #f8f9fa; border-radius: 5px;">
                            <strong>解答:</strong><br>1. b) $<br>2. a) A1が100より大きければ「大」、そうでなければ「小」<br>3. c) TODAY()<br>4. b) CONCATENATE()<br>5. c) AVERAGE()
                        </div>
                    </div>

                    <div class="highlight">
                        <h5>第6章のまとめ</h5>
                        <p>Excel関数の基礎を学習しました。これらの関数を組み合わせることで、複雑な計算や条件判断を自動化できます：</p>
                        <ul>
                            <li><strong>基本関数</strong>：SUM、AVERAGE、COUNTによる基本集計</li>
                            <li><strong>論理関数</strong>：IF、AND、ORによる条件処理</li>
                            <li><strong>日付関数</strong>：TODAY、DATEDIFによる期間計算</li>
                            <li><strong>文字列関数</strong>：LEFT、RIGHT、CONCATENATEによる文字操作</li>
                            <li><strong>セル参照</strong>：相対・絶対参照の適切な使い分け</li>
                        </ul>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="excel-basic-learning-material-5.html" class="btn btn-secondary">← 前の章：オブジェクト操作</a>
                        <a href="excel-basic-learning-material-7.html" class="btn btn-primary">次の章：VLOOKUP関数と論理値 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2025 F-Circle All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>