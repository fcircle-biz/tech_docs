<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>React学習教材 第10章 - 高度なトピック</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #61DAFB; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #61DAFB; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #61DAFB; padding-bottom: 0.5rem; }
        .section-title { color: #00b4d8; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e0f7fa; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #61DAFB; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .code-block { background-color: #1e1e1e; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
        .nav-link.active { background-color: #61DAFB !important; color: white !important; }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand"><strong>React学習教材</strong></a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-1.html">第1章: React入門と環境構築</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-2.html">第2章: JSXとコンポーネントの基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-3.html">第3章: PropsとState - データの管理</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-4.html">第4章: イベント処理とユーザーインタラクション</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-5.html">第5章: リストとキー</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-6.html">第6章: React Hooks - useEffectとライフサイクル</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-7.html">第7章: フォームとバリデーション</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-8.html">第8章: APIとの連携</a></li>
                        <li class="nav-item"><a class="nav-link" href="react-learning-material-9.html">第9章: React Routerとナビゲーション</a></li>
                        <li class="nav-item"><a class="nav-link active" href="react-learning-material-10.html">第10章: 高度なトピック</a></li>
                    </ul>
                </div>
            </nav>

            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第10章: 高度なトピック - Context API、パフォーマンス最適化、テスト</h1>
                </div>

                <div id="chapter10">
                    <h2 class="chapter-title">より高度なReactテクニック</h2>

                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Context APIを使用したグローバル状態管理</li>
                            <li>useContextフックの使い方を習得する</li>
                            <li>カスタムフックの作成方法を学ぶ</li>
                            <li>React.memoによるコンポーネントのメモ化</li>
                            <li>useMemoとuseCallbackフックの活用</li>
                            <li>コード分割（lazy、Suspense）の実装</li>
                            <li>React Testing Libraryの基礎</li>
                            <li>デプロイの準備とビルド最適化</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.1 Context API - グローバル状態管理</h3>
                    <p>Context APIは、Propsを何階層も渡すことなく、コンポーネントツリー全体でデータを共有する仕組みです。テーマ、ユーザー情報、言語設定などのグローバルな状態管理に適しています。</p>

                    <div class="exercise-container">
                        <h5>実習 10-1: Context APIの基本</h5>
                        <h6>Contextの作成と使用</h6>
                        <pre class="code-block"><code class="language-javascript">import { createContext, useContext, useState } from 'react';

// 1. Contextの作成
const ThemeContext = createContext();

// 2. Providerコンポーネント
function ThemeProvider({ children }) {
  const [theme, setTheme] = useState('light');

  const toggleTheme = () => {
    setTheme(prev => prev === 'light' ? 'dark' : 'light');
  };

  return (
    &lt;ThemeContext.Provider value={{ theme, toggleTheme }}&gt;
      {children}
    &lt;/ThemeContext.Provider&gt;
  );
}

// 3. カスタムフックの作成（オプション）
function useTheme() {
  const context = useContext(ThemeContext);
  if (!context) {
    throw new Error('useTheme must be used within ThemeProvider');
  }
  return context;
}

// 4. Contextを使用するコンポーネント
function Header() {
  const { theme, toggleTheme } = useTheme();

  return (
    &lt;header style={{
      background: theme === 'light' ? '#fff' : '#333',
      color: theme === 'light' ? '#000' : '#fff'
    }}&gt;
      &lt;h1&gt;現在のテーマ: {theme}&lt;/h1&gt;
      &lt;button onClick={toggleTheme}&gt;テーマ切替&lt;/button&gt;
    &lt;/header&gt;
  );
}

// 5. アプリケーション全体をProviderでラップ
function App() {
  return (
    &lt;ThemeProvider&gt;
      &lt;Header /&gt;
      {/* その他のコンポーネント */}
    &lt;/ThemeProvider&gt;
  );
}</code></pre>
                    </div>

                    <h3 class="section-title">10.2 カスタムフックの作成</h3>
                    <p>カスタムフックは、ロジックを再利用可能な関数として抽出する強力な機能です。"use"で始まる名前の関数として作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 10-2: 実用的なカスタムフック</h5>
                        <h6>useLocalStorageフック</h6>
                        <pre class="code-block"><code class="language-javascript">import { useState, useEffect } from 'react';

function useLocalStorage(key, initialValue) {
  // ローカルストレージから初期値を取得
  const [value, setValue] = useState(() => {
    try {
      const item = window.localStorage.getItem(key);
      return item ? JSON.parse(item) : initialValue;
    } catch (error) {
      console.error(error);
      return initialValue;
    }
  });

  // 値が変更されたらローカルストレージに保存
  useEffect(() => {
    try {
      window.localStorage.setItem(key, JSON.stringify(value));
    } catch (error) {
      console.error(error);
    }
  }, [key, value]);

  return [value, setValue];
}

// 使用例
function Settings() {
  const [username, setUsername] = useLocalStorage('username', '');
  const [fontSize, setFontSize] = useLocalStorage('fontSize', 16);

  return (
    &lt;div&gt;
      &lt;input
        value={username}
        onChange={(e) => setUsername(e.target.value)}
        placeholder="ユーザー名"
      /&gt;
      &lt;input
        type="number"
        value={fontSize}
        onChange={(e) => setFontSize(Number(e.target.value))}
      /&gt;
      &lt;p style={{ fontSize: `${fontSize}px` }}&gt;
        こんにちは、{username}さん！
      &lt;/p&gt;
    &lt;/div&gt;
  );
}</code></pre>
                    </div>

                    <h3 class="section-title">10.3 パフォーマンス最適化</h3>

                    <h4>React.memo - コンポーネントのメモ化</h4>
                    <p>React.memoは、Propsが変更されない限りコンポーネントの再レンダリングをスキップします。</p>

                    <pre class="code-block"><code class="language-javascript">import { memo } from 'react';

// メモ化されたコンポーネント
const ExpensiveComponent = memo(function ExpensiveComponent({ data }) {
  console.log('ExpensiveComponent レンダリング');
  // 重い計算処理
  return &lt;div&gt;{data}&lt;/div&gt;;
});

function Parent() {
  const [count, setCount] = useState(0);
  const [data] = useState('固定データ');

  return (
    &lt;div&gt;
      &lt;button onClick={() => setCount(count + 1)}&gt;カウント: {count}&lt;/button&gt;
      {/* dataが変わらなければ再レンダリングされない */}
      &lt;ExpensiveComponent data={data} /&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <h4>useMemoとuseCallback</h4>

                    <pre class="code-block"><code class="language-javascript">import { useState, useMemo, useCallback } from 'react';

function OptimizedComponent() {
  const [count, setCount] = useState(0);
  const [items] = useState([1, 2, 3, 4, 5]);

  // useMemo: 計算結果をメモ化
  const expensiveCalculation = useMemo(() => {
    console.log('計算実行');
    return items.reduce((sum, item) => sum + item, 0);
  }, [items]); // itemsが変わった時のみ再計算

  // useCallback: 関数をメモ化
  const handleClick = useCallback(() => {
    console.log('クリックされました');
  }, []); // 依存配列が空なので、常に同じ関数参照

  return (
    &lt;div&gt;
      &lt;p&gt;カウント: {count}&lt;/p&gt;
      &lt;p&gt;合計: {expensiveCalculation}&lt;/p&gt;
      &lt;button onClick={() => setCount(count + 1)}&gt;増やす&lt;/button&gt;
      &lt;button onClick={handleClick}&gt;クリック&lt;/button&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <h3 class="section-title">10.4 コード分割とLazy Loading</h3>
                    <p>大規模なアプリケーションでは、初期ロードを高速化するためにコード分割が重要です。</p>

                    <pre class="code-block"><code class="language-javascript">import { lazy, Suspense } from 'react';

// 遅延ロード
const HeavyComponent = lazy(() => import('./HeavyComponent'));
const AdminPanel = lazy(() => import('./AdminPanel'));

function App() {
  return (
    &lt;div&gt;
      &lt;h1&gt;メインアプリ&lt;/h1&gt;

      {/* Suspenseでラップ */}
      &lt;Suspense fallback={&lt;div&gt;読み込み中...&lt;/div&gt;}&gt;
        &lt;HeavyComponent /&gt;
      &lt;/Suspense&gt;

      &lt;Suspense fallback={&lt;p&gt;管理画面をロード中...&lt;/p&gt;}&gt;
        &lt;AdminPanel /&gt;
      &lt;/Suspense&gt;
    &lt;/div&gt;
  );
}</code></pre>

                    <h3 class="section-title">10.5 テストの基礎</h3>
                    <p>React Testing Libraryを使用したコンポーネントテストの基本を学びます。</p>

                    <h4>テストライブラリのインストール</h4>
                    <pre class="code-block"><code class="language-bash">npm install --save-dev @testing-library/react @testing-library/jest-dom</code></pre>

                    <div class="exercise-container">
                        <h5>実習 10-3: 基本的なコンポーネントテスト</h5>
                        <pre class="code-block"><code class="language-javascript">// Button.js
export function Button({ onClick, children }) {
  return &lt;button onClick={onClick}&gt;{children}&lt;/button&gt;;
}

// Button.test.js
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from './Button';

describe('Buttonコンポーネント', () => {
  test('ボタンがレンダリングされる', () => {
    render(&lt;Button&gt;クリック&lt;/Button&gt;);
    expect(screen.getByText('クリック')).toBeInTheDocument();
  });

  test('クリック時にハンドラーが呼ばれる', () => {
    const handleClick = jest.fn();
    render(&lt;Button onClick={handleClick}&gt;クリック&lt;/Button&gt;);

    const button = screen.getByText('クリック');
    fireEvent.click(button);

    expect(handleClick).toHaveBeenCalledTimes(1);
  });
});</code></pre>
                    </div>

                    <h3 class="section-title">10.6 本番環境へのデプロイ</h3>

                    <h4>ビルドコマンド</h4>
                    <pre class="code-block"><code class="language-bash"># 本番用ビルド
npm run build

# ビルドされたファイルは build/ フォルダに生成される</code></pre>

                    <h4>デプロイ先の選択肢</h4>
                    <ul>
                        <li><strong>Vercel</strong>：Reactアプリに最適、簡単デプロイ</li>
                        <li><strong>Netlify</strong>：静的サイトホスティング、CI/CD統合</li>
                        <li><strong>GitHub Pages</strong>：無料ホスティング</li>
                        <li><strong>AWS S3 + CloudFront</strong>：スケーラブル、エンタープライズ向け</li>
                    </ul>

                    <div class="highlight">
                        <h6>学習の次のステップ</h6>
                        <p>この章でReactの基礎学習を完了しました！さらに学習を進めるためのオプション：</p>
                        <ul>
                            <li><strong>Next.js</strong>：サーバーサイドレンダリングとSEO最適化</li>
                            <li><strong>TypeScript</strong>：型安全性の導入</li>
                            <li><strong>Redux/Zustand</strong>：大規模な状態管理</li>
                            <li><strong>React Native</strong>：モバイルアプリ開発</li>
                        </ul>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>Context APIはどのような場面で使用しますか？</li>
                            <li>カスタムフックの命名規則は何ですか？</li>
                            <li>React.memoは何のために使用しますか？</li>
                            <li>useMemoとuseCallbackの違いは何ですか？</li>
                            <li>コード分割を行う主な目的は何ですか？</li>
                        </ol>

                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>Propsのバケツリレーを避け、グローバルな状態（テーマ、ユーザー情報等）を共有する場合</li>
                                <li>"use"で始まる名前にする必要がある（例：useLocalStorage）</li>
                                <li>Propsが変わらない場合にコンポーネントの再レンダリングをスキップし、パフォーマンスを最適化する</li>
                                <li>useMemoは値（計算結果）をメモ化、useCallbackは関数をメモ化する</li>
                                <li>初期ロードを高速化し、必要なコードのみを必要な時にロードするため</li>
                            </ol>
                        </details>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="react-learning-material-9.html" class="btn btn-secondary">← 前の章</a>
                        <a href="../README.html" class="btn btn-success">学習を完了する</a>
                    </div>

                    <div class="alert alert-success mt-4">
                        <h4>おめでとうございます！</h4>
                        <p>React学習教材の全10章を完了しました。これでReactアプリケーション開発の基礎が身についたはずです。実際のプロジェクトで経験を積んでいきましょう！</p>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>
