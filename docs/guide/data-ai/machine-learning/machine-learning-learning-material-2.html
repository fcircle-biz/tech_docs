<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>機械学習学習教材 第2章 - 機械学習の基礎概念</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        .navbar {
            background-color: #00897B;
        }

        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
            padding: 1rem;
        }

        .chapter-title {
            color: #00897B;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 3px solid #00897B;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #26a69a;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            padding-left: 0.5rem;
            border-left: 4px solid #26a69a;
        }

        .quiz-container {
            background-color: #e0f2f1;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #00897B;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #fff9c4;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #fbc02d;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .code-block {
            background-color: #1e1e1e;
            color: white;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }

        .nav-link.active {
            background-color: #00897B !important;
            color: white !important;
            border-radius: 5px;
        }

        .nav-link {
            color: #333;
            transition: all 0.3s;
        }

        .nav-link:hover {
            background-color: #e0f2f1;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="README.html">
                <strong>機械学習学習教材</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-1.html">
                                第1章: 機械学習の概要と環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="machine-learning-learning-material-2.html">
                                第2章: 機械学習の基礎概念
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-3.html">
                                第3章: データの前処理
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-4.html">
                                第4章: 教師あり学習：回帰
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-5.html">
                                第5章: 教師あり学習：分類
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-6.html">
                                第6章: モデルの評価と検証
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-7.html">
                                第7章: 特徴量エンジニアリング
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-8.html">
                                第8章: アンサンブル学習
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-9.html">
                                第9章: 教師なし学習
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="machine-learning-learning-material-10.html">
                                第10章: 実践プロジェクト開発
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第2章: 機械学習の基礎概念</h1>
                </div>

                <div id="chapter2">
                    <h2 class="chapter-title">機械学習の核心を理解する</h2>

                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>機械学習の学習プロセスとモデルの作成方法</li>
                            <li>特徴量（説明変数）とラベル（目的変数）の役割</li>
                            <li>訓練データとテストデータの重要性と分割方法</li>
                            <li>過学習と汎化能力の関係性</li>
                            <li>バイアスとバリアンスのトレードオフ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.1 機械学習の学習プロセス</h3>

                    <p>
                        機械学習において、<strong>「学習」とはデータからパターンを抽出し、モデルを構築するプロセス</strong>のことを指します。
                        このプロセスは、人間が新しいスキルを習得する過程と似ています。
                    </p>

                    <h4>学習プロセスの全体像</h4>

                    <div class="mermaid">
                        flowchart TD
                            A["データ収集"] --> B["データの前処理<br/>（欠損値処理、正規化など）"]
                            B --> C["訓練データと<br/>テストデータに分割"]
                            C --> D["モデルの選択<br/>（アルゴリズムの決定）"]
                            D --> E["訓練データで学習<br/>（パラメータの最適化）"]
                            E --> F["テストデータで評価<br/>（未知データでの性能確認）"]
                            F --> G{"性能は<br/>十分？"}
                            G -->|No| H["モデルの改善<br/>（ハイパーパラメータ調整）"]
                            H --> E
                            G -->|Yes| I["モデルの完成<br/>本番環境へデプロイ"]
                    </div>

                    <h4>学習のメカニズム</h4>

                    <p>
                        機械学習モデルは、<strong>損失関数（Loss Function）</strong>を最小化するように学習します。
                        損失関数とは、「モデルの予測値」と「実際の正解値」の差を数値化したものです。
                    </p>

                    <div class="highlight">
                        <h6>学習の基本原理</h6>
                        <ol>
                            <li><strong>初期状態</strong>: モデルはランダムな予測を行う（ほぼ正解しない）</li>
                            <li><strong>誤差の計算</strong>: 予測と正解の差（損失）を計算</li>
                            <li><strong>パラメータの更新</strong>: 誤差が小さくなるようにモデルのパラメータ（重み）を調整</li>
                            <li><strong>繰り返し</strong>: 2〜3を繰り返し、徐々に精度を向上</li>
                            <li><strong>収束</strong>: 誤差がこれ以上小さくならない状態に到達（学習完了）</li>
                        </ol>
                    </div>

                    <h3 class="section-title">2.2 特徴量とラベル</h3>

                    <p>
                        機械学習では、データは<strong>特徴量（Features）</strong>と<strong>ラベル（Label）</strong>に分けて扱います。
                        この区別を理解することは、機械学習の基本中の基本です。
                    </p>

                    <h4>特徴量（Features / 説明変数 / 入力変数）</h4>

                    <p>
                        <strong>特徴量</strong>とは、予測や分類を行うための「手がかり」となる情報です。
                        モデルに入力するデータの特性を表す変数のことで、予測の根拠となります。
                    </p>

                    <div class="highlight">
                        <h6>具体例：住宅価格の予測</h6>
                        <p>住宅価格を予測する場合の特徴量：</p>
                        <ul>
                            <li>面積（平方メートル）</li>
                            <li>築年数</li>
                            <li>部屋数</li>
                            <li>駅からの距離（分）</li>
                            <li>階数</li>
                            <li>周辺施設の充実度</li>
                        </ul>
                        <p>これらの情報を組み合わせて、価格を予測します。</p>
                    </div>

                    <h4>ラベル（Label / 目的変数 / 出力変数）</h4>

                    <p>
                        <strong>ラベル</strong>とは、モデルが予測したい「答え」のことです。
                        教師あり学習では、訓練データにこのラベルが含まれており、モデルはこれを正解として学習します。
                    </p>

                    <div class="highlight">
                        <h6>具体例：住宅価格の予測（続き）</h6>
                        <p>
                            <strong>ラベル</strong>: 住宅の販売価格（例：3500万円）<br>
                            <strong>モデルの目標</strong>: 特徴量から、このラベル（価格）を正確に予測すること
                        </p>
                    </div>

                    <h4>特徴量とラベルの関係</h4>

                    <div class="mermaid">
                        flowchart LR
                            subgraph Input["入力（特徴量）"]
                                F1["面積: 80㎡"]
                                F2["築年数: 5年"]
                                F3["駅距離: 10分"]
                                F4["部屋数: 3部屋"]
                            end

                            subgraph Model["機械学習モデル"]
                                M["学習済みモデル"]
                            end

                            subgraph Output["出力（ラベル）"]
                                L["予測価格:<br/>3500万円"]
                            end

                            F1 & F2 & F3 & F4 --> M --> L
                    </div>

                    <h4>特徴量の種類</h4>

                    <ul>
                        <li>
                            <strong>数値型特徴量</strong>: 連続的または離散的な数値
                            <ul>
                                <li>例：年齢、収入、身長、温度</li>
                            </ul>
                        </li>
                        <li>
                            <strong>カテゴリ型特徴量</strong>: カテゴリやラベルを表す
                            <ul>
                                <li>例：性別（男/女）、職業（会社員/自営業/学生）、商品カテゴリ</li>
                            </ul>
                        </li>
                        <li>
                            <strong>テキスト型特徴量</strong>: 自然言語のテキスト
                            <ul>
                                <li>例：商品レビュー、ツイート、記事本文</li>
                            </ul>
                        </li>
                        <li>
                            <strong>画像型特徴量</strong>: ピクセル値の集合
                            <ul>
                                <li>例：写真、レントゲン画像</li>
                            </ul>
                        </li>
                    </ul>

                    <div class="exercise-container">
                        <h5>実習 2-1: 特徴量とラベルの理解</h5>
                        <p>
                            以下のコードで、住宅価格予測の例を使って特徴量とラベルの概念を確認しましょう。
                        </p>

                        <h6>実習コード</h6>
                        <pre class="code-block"><code class="language-python">import pandas as pd
import numpy as np

# サンプルデータの作成（住宅情報）
data = {
    '面積(㎡)': [50, 70, 80, 100, 120, 60, 90, 75],
    '築年数': [25, 10, 5, 2, 0, 15, 3, 8],
    '駅距離(分)': [20, 10, 5, 3, 5, 15, 8, 12],
    '部屋数': [1, 2, 3, 3, 4, 2, 3, 2],
    '価格(万円)': [1500, 2800, 3500, 4500, 5500, 2200, 4000, 3000]
}

df = pd.DataFrame(data)

print("=== 住宅データ ===")
print(df)

# 特徴量とラベルの分離
# X: 特徴量（Features） - 予測に使う情報
X = df[['面積(㎡)', '築年数', '駅距離(分)', '部屋数']]

# y: ラベル（Label） - 予測したい値
y = df['価格(万円)']

print("\n=== 特徴量（X）===")
print(X.head())

print("\n=== ラベル（y）===")
print(y.head())

print(f"\n特徴量の形状: {X.shape}")  # (サンプル数, 特徴量の数)
print(f"ラベルの形状: {y.shape}")    # (サンプル数,)</code></pre>

                        <h6>学習ポイント</h6>
                        <ul>
                            <li><strong>特徴量（X）</strong>は複数の列を持つ2次元データ</li>
                            <li><strong>ラベル（y）</strong>は1列のみの1次元データ</li>
                            <li>機械学習では、通常Xを大文字、yを小文字で表記する慣習がある</li>
                            <li>shape属性でデータの次元（行数、列数）を確認できる</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.3 訓練データとテストデータ</h3>

                    <p>
                        機械学習モデルを正しく評価するためには、データを<strong>訓練データ（Training Data）</strong>と
                        <strong>テストデータ（Test Data）</strong>に分割することが不可欠です。
                    </p>

                    <h4>なぜデータを分割するのか？</h4>

                    <p>
                        モデルの最終的な目標は、<strong>「未知のデータに対しても正確に予測できること」</strong>です。
                        訓練データだけで評価すると、モデルが訓練データを丸暗記しているだけかもしれません。
                        これを避けるため、別のデータセット（テストデータ）で性能を評価します。
                    </p>

                    <div class="highlight">
                        <h6>人間の学習に例えると</h6>
                        <p>
                            <strong>訓練データ</strong>: 教科書や問題集で学習する<br>
                            <strong>テストデータ</strong>: 本番の試験問題（これまで見たことがない問題）<br>
                            <br>
                            教科書の問題が解けるだけでは不十分で、初見の問題でも解けるかが重要です。
                            機械学習も同じで、未知のデータに対する性能（汎化性能）が評価の基準となります。
                        </p>
                    </div>

                    <h4>訓練データとテストデータの役割</h4>

                    <div class="mermaid">
                        flowchart TD
                            A["全データ"] --> B["訓練データ<br/>（Training Data）<br/>70-80%"]
                            A --> C["テストデータ<br/>（Test Data）<br/>20-30%"]

                            B --> D["モデルの学習<br/>パラメータの最適化"]
                            D --> E["学習済みモデル"]

                            E --> F["テストデータで評価"]
                            C --> F

                            F --> G["汎化性能の測定<br/>（未知データへの適用力）"]
                    </div>

                    <ul>
                        <li>
                            <strong>訓練データ（Training Data）</strong>
                            <ul>
                                <li>モデルがパターンを学習するためのデータ</li>
                                <li>通常、全データの70〜80%を割り当てる</li>
                                <li>このデータでモデルのパラメータ（重み）を調整</li>
                            </ul>
                        </li>
                        <li>
                            <strong>テストデータ（Test Data）</strong>
                            <ul>
                                <li>モデルの汎化性能を評価するためのデータ</li>
                                <li>通常、全データの20〜30%を割り当てる</li>
                                <li>学習には一切使用せず、最終評価のみに使用</li>
                            </ul>
                        </li>
                    </ul>

                    <div class="warning">
                        <h6>重要な注意点</h6>
                        <p>
                            <strong>テストデータは学習に使ってはいけません！</strong><br>
                            テストデータを学習に使用すると、そのデータに対して不正に高い精度が出てしまい、
                            本当の汎化性能を測定できなくなります。これを「データリーク（Data Leakage）」と呼びます。
                        </p>
                    </div>

                    <div class="exercise-container">
                        <h5>実習 2-2: データの分割</h5>
                        <p>
                            scikit-learnの<code>train_test_split</code>関数を使って、
                            データを訓練データとテストデータに分割してみましょう。
                        </p>

                        <h6>実習コード</h6>
                        <pre class="code-block"><code class="language-python">from sklearn.model_selection import train_test_split

# 前の実習で作成したXとyを使用
# データを訓練データとテストデータに分割（テストデータ: 30%）
X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.3,      # テストデータの割合（30%）
    random_state=42     # 乱数シード（再現性のため）
)

print("=== データ分割の結果 ===")
print(f"訓練データ（X_train）: {X_train.shape}")
print(f"テストデータ（X_test）: {X_test.shape}")
print(f"訓練ラベル（y_train）: {y_train.shape}")
print(f"テストラベル（y_test）: {y_test.shape}")

print("\n=== 訓練データの内容（先頭3件）===")
print(X_train.head(3))

print("\n=== テストデータの内容 ===")
print(X_test)</code></pre>

                        <h6>学習ポイント</h6>
                        <ul>
                            <li><strong>test_size=0.3</strong>: 全データの30%をテストデータとして確保</li>
                            <li><strong>random_state=42</strong>: 乱数シードを固定し、同じ分割結果を再現可能に</li>
                            <li>分割はランダムに行われるため、データのバイアスを軽減</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.4 過学習と汎化</h3>

                    <p>
                        機械学習で最も重要な概念の一つが<strong>過学習（Overfitting）</strong>と<strong>汎化（Generalization）</strong>です。
                        良いモデルとは、訓練データだけでなく、未知のデータに対しても高い性能を発揮できるモデルのことです。
                    </p>

                    <h4>汎化能力とは</h4>

                    <p>
                        <strong>汎化能力</strong>とは、モデルが訓練データには含まれない新しいデータに対しても正確に予測できる能力のことです。
                        機械学習の最終目標は、この汎化能力を高めることにあります。
                    </p>

                    <h4>過学習（Overfitting）の問題</h4>

                    <p>
                        <strong>過学習</strong>とは、モデルが訓練データに過剰に適合してしまい、
                        訓練データには高い精度を示すものの、テストデータでは性能が大きく低下する現象です。
                        モデルが訓練データの「ノイズ」まで学習してしまった状態と言えます。
                    </p>

                    <div class="highlight">
                        <h6>過学習の具体例</h6>
                        <p>
                            <strong>状況</strong>: 試験勉強で過去問を丸暗記した学生<br>
                            <strong>訓練データでの性能</strong>: 過去問は完璧に解ける（100点）<br>
                            <strong>テストデータでの性能</strong>: 本番の試験では全く解けない（低得点）<br>
                            <strong>問題点</strong>: 本質的な理解ではなく、問題と答えの丸暗記になっている
                        </p>
                    </div>

                    <h4>適合不足（Underfitting）の問題</h4>

                    <p>
                        一方、<strong>適合不足（Underfitting）</strong>とは、モデルが十分に学習できておらず、
                        訓練データでもテストデータでも性能が低い状態です。モデルが単純すぎてデータのパターンを捉えきれていません。
                    </p>

                    <div class="mermaid">
                        flowchart TD
                            A["モデルの複雑さ"] --> B["低い<br/>（単純なモデル）"]
                            A --> C["適切<br/>（バランスの取れたモデル）"]
                            A --> D["高い<br/>（複雑なモデル）"]

                            B --> E["適合不足<br/>（Underfitting）"]
                            C --> F["良好な汎化性能<br/>（理想的な状態）"]
                            D --> G["過学習<br/>（Overfitting）"]

                            E --> E1["訓練データ: 低精度<br/>テストデータ: 低精度"]
                            F --> F1["訓練データ: 高精度<br/>テストデータ: 高精度"]
                            G --> G1["訓練データ: 非常に高精度<br/>テストデータ: 低精度"]
                    </div>

                    <h4>過学習を防ぐ方法</h4>

                    <ul>
                        <li>
                            <strong>データ量を増やす</strong>
                            <ul>
                                <li>より多くのデータで学習することで、パターンの本質を捉えやすくなる</li>
                            </ul>
                        </li>
                        <li>
                            <strong>特徴量を減らす</strong>
                            <ul>
                                <li>不要な特徴量を削除し、モデルをシンプルに保つ</li>
                            </ul>
                        </li>
                        <li>
                            <strong>正則化（Regularization）</strong>
                            <ul>
                                <li>モデルの複雑さにペナルティを課し、過度な複雑化を防ぐ</li>
                            </ul>
                        </li>
                        <li>
                            <strong>交差検証（Cross-Validation）</strong>
                            <ul>
                                <li>複数の訓練・テスト分割で評価し、汎化性能を正確に測定</li>
                            </ul>
                        </li>
                        <li>
                            <strong>早期終了（Early Stopping）</strong>
                            <ul>
                                <li>学習を適切なタイミングで停止し、過学習を防ぐ</li>
                            </ul>
                        </li>
                    </ul>

                    <h3 class="section-title">2.5 バイアス・バリアンストレードオフ</h3>

                    <p>
                        <strong>バイアス（Bias）</strong>と<strong>バリアンス（Variance）</strong>は、
                        モデルの誤差を分析する際の重要な概念です。この2つのバランスを取ることが、高性能なモデルを作る鍵となります。
                    </p>

                    <h4>バイアス（Bias）とは</h4>

                    <p>
                        <strong>バイアス</strong>とは、モデルの予測値と真の値の平均的なズレを表します。
                        バイアスが高いと、モデルが単純すぎてデータの複雑なパターンを捉えられていない（適合不足）状態です。
                    </p>

                    <div class="highlight">
                        <h6>高バイアスの例</h6>
                        <p>
                            複雑な曲線的なデータに対して、直線（線形モデル）でフィットしようとする場合、
                            モデルが単純すぎて真のパターンを捉えきれず、予測精度が低くなります。
                        </p>
                    </div>

                    <h4>バリアンス（Variance）とは</h4>

                    <p>
                        <strong>バリアンス</strong>とは、異なる訓練データでモデルを学習した際の予測値のばらつきを表します。
                        バリアンスが高いと、モデルが訓練データに過剰に適合し、データの微小な変動に敏感になっている（過学習）状態です。
                    </p>

                    <div class="highlight">
                        <h6>高バリアンスの例</h6>
                        <p>
                            訓練データの細かいノイズまで学習してしまった複雑なモデルは、
                            少しデータが変わるだけで予測結果が大きく変動し、汎化性能が低下します。
                        </p>
                    </div>

                    <h4>バイアス・バリアンストレードオフ</h4>

                    <p>
                        理想的なモデルは、<strong>バイアスとバリアンスの両方が低い</strong>状態ですが、実際にはこの2つはトレードオフの関係にあります。
                    </p>

                    <div class="mermaid">
                        flowchart LR
                            A["単純なモデル"] -->|複雑化| B["適切なモデル"]
                            B -->|過度に複雑化| C["複雑なモデル"]

                            A --> A1["高バイアス<br/>低バリアンス<br/>（適合不足）"]
                            B --> B1["低バイアス<br/>低バリアンス<br/>（理想的）"]
                            C --> C1["低バイアス<br/>高バリアンス<br/>（過学習）"]
                    </div>

                    <table class="table table-bordered mt-3">
                        <thead class="table-light">
                            <tr>
                                <th>状態</th>
                                <th>バイアス</th>
                                <th>バリアンス</th>
                                <th>訓練誤差</th>
                                <th>テスト誤差</th>
                                <th>問題</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>適合不足</strong></td>
                                <td>高</td>
                                <td>低</td>
                                <td>大きい</td>
                                <td>大きい</td>
                                <td>モデルが単純すぎる</td>
                            </tr>
                            <tr class="table-success">
                                <td><strong>理想的</strong></td>
                                <td>低</td>
                                <td>低</td>
                                <td>小さい</td>
                                <td>小さい</td>
                                <td>なし（目標とする状態）</td>
                            </tr>
                            <tr>
                                <td><strong>過学習</strong></td>
                                <td>低</td>
                                <td>高</td>
                                <td>非常に小さい</td>
                                <td>大きい</td>
                                <td>モデルが複雑すぎる</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>バランスを取るための戦略</h4>

                    <ul>
                        <li><strong>モデルの複雑さを調整</strong>: シンプルすぎず、複雑すぎないモデルを選択</li>
                        <li><strong>正則化パラメータの調整</strong>: ペナルティの強さを適切に設定</li>
                        <li><strong>交差検証で評価</strong>: 複数のデータ分割で汎化性能を確認</li>
                        <li><strong>学習曲線の確認</strong>: 訓練誤差とテスト誤差の推移を可視化</li>
                    </ul>

                    <div class="exercise-container">
                        <h5>実習 2-3: 過学習の視覚的理解</h5>
                        <p>
                            多項式回帰を使って、モデルの複雑さと過学習の関係を視覚的に確認しましょう。
                        </p>

                        <h6>実習コード</h6>
                        <pre class="code-block"><code class="language-python">import matplotlib.pyplot as plt
from sklearn.preprocessing import PolynomialFeatures
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

# サンプルデータの生成
np.random.seed(42)
X_sample = np.sort(np.random.rand(20, 1) * 10, axis=0)
y_sample = np.sin(X_sample).ravel() + np.random.randn(20) * 0.3

# 異なる次数の多項式でフィッティング
degrees = [1, 3, 15]  # 低次、適切、高次
plt.figure(figsize=(15, 4))

for i, degree in enumerate(degrees):
    # 多項式特徴量の生成
    poly = PolynomialFeatures(degree=degree)
    X_poly = poly.fit_transform(X_sample)

    # モデルの学習
    model = LinearRegression()
    model.fit(X_poly, y_sample)

    # 予測用の滑らかな曲線
    X_plot = np.linspace(0, 10, 100).reshape(-1, 1)
    X_plot_poly = poly.transform(X_plot)
    y_plot = model.predict(X_plot_poly)

    # 訓練誤差の計算
    y_pred = model.predict(X_poly)
    mse = mean_squared_error(y_sample, y_pred)

    # グラフ描画
    plt.subplot(1, 3, i + 1)
    plt.scatter(X_sample, y_sample, color='blue', s=30, label='訓練データ')
    plt.plot(X_plot, y_plot, color='red', linewidth=2, label=f'予測曲線（次数={degree}）')
    plt.xlabel('x')
    plt.ylabel('y')
    plt.title(f'多項式次数: {degree}\n訓練MSE: {mse:.3f}')
    plt.legend()
    plt.grid(True, alpha=0.3)

plt.tight_layout()
plt.show()</code></pre>

                        <h6>結果の解釈</h6>
                        <ul>
                            <li><strong>次数=1（左）</strong>: 単純すぎて曲線を捉えられない（適合不足）</li>
                            <li><strong>次数=3（中央）</strong>: データの傾向をうまく捉えている（適切）</li>
                            <li><strong>次数=15（右）</strong>: 訓練データに過度にフィットし、ノイズまで学習（過学習）</li>
                        </ul>
                    </div>

                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>
                                <strong>特徴量とラベルの違いを説明してください。</strong>
                                <details>
                                    <summary>解答を表示</summary>
                                    <p>
                                        特徴量は予測や分類の「手がかり」となる入力情報で、モデルに与えるデータの特性です。
                                        ラベルは予測したい「答え」で、教師あり学習では正解データとして使用されます。
                                        例：住宅価格予測では、面積や築年数が特徴量、価格がラベルです。
                                    </p>
                                </details>
                            </li>
                            <li>
                                <strong>なぜデータを訓練データとテストデータに分割する必要があるのですか？</strong>
                                <details>
                                    <summary>解答を表示</summary>
                                    <p>
                                        モデルの汎化性能（未知のデータに対する予測精度）を正しく評価するためです。
                                        訓練データだけで評価すると、モデルがデータを丸暗記しているだけの可能性があり、
                                        真の性能が測定できません。テストデータで評価することで、実用的な予測能力を確認できます。
                                    </p>
                                </details>
                            </li>
                            <li>
                                <strong>過学習とはどのような状態ですか？どうすれば防げますか？</strong>
                                <details>
                                    <summary>解答を表示</summary>
                                    <p>
                                        過学習とは、モデルが訓練データに過剰に適合し、訓練データでは高精度だがテストデータでは低精度になる状態です。
                                        防ぐ方法：1) データ量を増やす、2) 特徴量を減らす、3) 正則化を適用、4) 交差検証で評価、5) 早期終了を使用
                                    </p>
                                </details>
                            </li>
                            <li>
                                <strong>バイアスとバリアンスのトレードオフを簡単に説明してください。</strong>
                                <details>
                                    <summary>解答を表示</summary>
                                    <p>
                                        バイアスはモデルの単純さによる誤差、バリアンスはモデルの複雑さによるばらつきです。
                                        単純なモデルはバイアスが高く、複雑なモデルはバリアンスが高くなります。
                                        理想は両方を低く保つことですが、実際にはトレードオフの関係にあり、適切なバランスを見つけることが重要です。
                                    </p>
                                </details>
                            </li>
                            <li>
                                <strong>適合不足と過学習の違いを、訓練誤差とテスト誤差の観点から説明してください。</strong>
                                <details>
                                    <summary>解答を表示</summary>
                                    <p>
                                        <strong>適合不足</strong>: 訓練誤差もテスト誤差も大きい（モデルが単純すぎる）<br>
                                        <strong>過学習</strong>: 訓練誤差は非常に小さいが、テスト誤差は大きい（モデルが複雑すぎる）<br>
                                        理想的な状態は、訓練誤差もテスト誤差も小さく、かつ両者の差が小さいことです。
                                    </p>
                                </details>
                            </li>
                        </ol>
                    </div>

                    <h3 class="section-title">2.6 まとめ</h3>

                    <p>
                        この章では、機械学習の基礎となる重要な概念を学びました。これらの概念は、今後の章でも繰り返し登場します。
                    </p>

                    <div class="highlight">
                        <h6>重要ポイント</h6>
                        <ul>
                            <li><strong>学習プロセス</strong>: モデルは損失関数を最小化するようにパラメータを調整して学習</li>
                            <li><strong>特徴量とラベル</strong>: 特徴量は入力（手がかり）、ラベルは出力（答え）</li>
                            <li><strong>データ分割</strong>: 訓練データで学習、テストデータで汎化性能を評価</li>
                            <li><strong>汎化能力</strong>: 未知のデータに対する予測精度が機械学習の最終目標</li>
                            <li><strong>過学習</strong>: 訓練データに過剰適合し、テストデータで性能が低下する現象</li>
                            <li><strong>バイアス・バリアンス</strong>: 単純すぎると高バイアス、複雑すぎると高バリアンス</li>
                        </ul>
                    </div>

                    <p>
                        次の第3章では、機械学習の成否を大きく左右する「データの前処理」について学びます。
                        欠損値処理、正規化、カテゴリカル変数のエンコーディングなど、実践的な技術を習得します。
                    </p>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="machine-learning-learning-material-1.html" class="btn btn-secondary">← 前の章</a>
                        <a href="machine-learning-learning-material-3.html" class="btn btn-primary">次の章 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>