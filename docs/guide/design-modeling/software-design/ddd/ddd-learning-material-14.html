<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>DDD学習教材 第14章 - 実践演習 - ECサイトをDDDで設計する</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // DDD - Indigo (設計手法用)
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fas fa-project-diagram text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">DDD学習教材</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-cubes text-[9px]"></i>
                                <span>設計・モデリング</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>所要時間 約20.5時間</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="../" class="hover:text-primary-600 transition-colors">設計・モデリング</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第14章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                     bg-primary-100 text-primary-700">
                            第14章
                        </span>
                        <span class="text-sm text-slate-500">
                            <i class="fas fa-clock mr-1"></i>所要時間: 2時間
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">実践演習 - ECサイトをDDDで設計する</h1>
                    <p class="text-slate-600">これまで学んだ知識を総合して、ECサイトの注文管理システムをDDDで設計する演習を行います。ユビキタス言語の定義、ドメインモデルの作成、集約の設計、リポジトリの実装まで、一連の流れを実践します。</p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200
                            rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ECサイトの注文管理システムをDDDで設計する実践的な流れを理解する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ユビキタス言語を定義し、ドメインモデルを作成する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>エンティティ、値オブジェクト、集約を適切に設計する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>リポジトリとドメインサービスを実装し、実践的なコードを書く</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション1: 演習の概要 -->
                <section class="prose prose-slate max-w-none">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.1 演習の概要
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        この章では、ECサイトの注文管理システムを題材に、DDDの設計プロセスを一通り体験します。実際のプロジェクトでDDDを適用する際の流れを理解し、これまで学んだ知識を実践で活用できるようになりましょう。
                    </p>

                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-shopping-cart text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-2 break-words">題材: ECサイトの注文管理システム</h3>
                                <p class="text-emerald-900 mb-3">
                                    お客様が商品をカートに追加し、注文を確定して、配送を待つ一連の流れを管理するシステムです。
                                </p>
                                <ul class="space-y-2 text-emerald-900">
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>商品管理</strong>: 商品の登録、在庫管理</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>カート管理</strong>: 商品の追加、削除、数量変更</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>注文管理</strong>: 注文の確定、キャンセル、ステータス管理</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>配送管理</strong>: 配送先の登録、配送状況の追跡</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 設計の流れ -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-route text-primary-500"></i>
                            DDD設計の流れ
                        </h3>
                        <div class="mermaid">
flowchart TD
    A[要件の理解] --> B[ユビキタス言語の定義]
    B --> C[ドメインモデルの作成]
    C --> D[エンティティと値オブジェクトの識別]
    D --> E[集約の境界を決定]
    E --> F[リポジトリの設計]
    F --> G[ドメインサービスの抽出]
    G --> H[実装とテスト]

    style A fill:#e0e7ff,stroke:#6366f1
    style B fill:#c7d2fe,stroke:#6366f1
    style C fill:#c7d2fe,stroke:#6366f1
    style D fill:#c7d2fe,stroke:#6366f1
    style E fill:#a5b4fc,stroke:#6366f1
    style F fill:#a5b4fc,stroke:#6366f1
    style G fill:#a5b4fc,stroke:#6366f1
    style H fill:#818cf8,stroke:#4f46e5
                        </div>
                    </div>
                </section>

                <!-- セクション2: ユビキタス言語の定義 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.2 ユビキタス言語の定義
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        まず、チーム全体で共有する用語を定義します。開発者とビジネス担当者が同じ言葉を使うことで、認識のズレを防ぎます。
                    </p>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-book text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">用語集</h3>
                                <div class="space-y-3 text-purple-900">
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">注文（Order）</p>
                                        <p class="text-sm mt-1">お客様が商品を購入する意思を確定したもの。注文番号で識別され、注文明細、配送先、支払い方法などの情報を持つ。</p>
                                    </div>
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">注文明細（OrderItem）</p>
                                        <p class="text-sm mt-1">注文に含まれる個々の商品。商品、数量、単価を持つ。</p>
                                    </div>
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">商品（Product）</p>
                                        <p class="text-sm mt-1">販売対象の商品。商品コードで識別され、名前、価格、在庫数などの情報を持つ。</p>
                                    </div>
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">カート（Cart）</p>
                                        <p class="text-sm mt-1">お客様が注文前に商品を一時的に保管する場所。注文確定時にカートの内容が注文明細に変換される。</p>
                                    </div>
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">配送先（ShippingAddress）</p>
                                        <p class="text-sm mt-1">商品を配送する住所。郵便番号、都道府県、市区町村、番地、建物名などを含む。</p>
                                    </div>
                                    <div class="bg-purple-100 rounded-lg p-3">
                                        <p class="font-medium">注文ステータス（OrderStatus）</p>
                                        <p class="text-sm mt-1">注文の現在の状態。「注文受付済み」「決済完了」「出荷準備中」「配送中」「配送完了」「キャンセル済み」など。</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">ユビキタス言語のポイント</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    用語の定義は、ビジネス担当者と開発者が一緒に作成します。「この言葉は現場でどう使われているか」を確認し、コード上の名前と一致させることが重要です。例えば、「注文」をOrderと命名し、OrderItemを「注文明細」と呼ぶように統一します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション3: ドメインモデルの作成 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.3 ドメインモデルの作成
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ユビキタス言語を元に、ビジネスの概念とその関係を図で表現します。UMLクラス図を使って、主要な概念とその関係性を可視化します。
                    </p>

                    <!-- クラス図 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-diagram-project text-primary-500"></i>
                            注文管理のドメインモデル
                        </h3>
                        <div class="mermaid">
classDiagram
    class Order {
        +OrderId id
        +OrderStatus status
        +ShippingAddress shippingAddress
        +Money totalAmount
        +List~OrderItem~ items
        +placeOrder()
        +cancel()
        +ship()
    }

    class OrderItem {
        +Product product
        +Quantity quantity
        +Money unitPrice
        +Money subtotal()
    }

    class Product {
        +ProductId id
        +ProductName name
        +Money price
        +StockQuantity stock
        +reduceStock(quantity)
        +increaseStock(quantity)
    }

    class Cart {
        +CartId id
        +List~CartItem~ items
        +addItem(product, quantity)
        +removeItem(product)
        +clear()
    }

    class CartItem {
        +Product product
        +Quantity quantity
    }

    class ShippingAddress {
        +PostalCode postalCode
        +Prefecture prefecture
        +City city
        +Street street
        +Building building
    }

    class Money {
        +amount
        +currency
        +add(money)
        +multiply(rate)
    }

    class OrderId {
        +value
    }

    class ProductId {
        +value
    }

    Order "1" *-- "1..*" OrderItem
    Order "1" *-- "1" ShippingAddress
    OrderItem "1" --> "1" Product
    Cart "1" *-- "0..*" CartItem
    CartItem "1" --> "1" Product
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">ドメインモデルの読み取り方</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    この図から、「注文（Order）は1つ以上の注文明細（OrderItem）を持つ」「注文明細は1つの商品（Product）を参照する」「注文は1つの配送先（ShippingAddress）を持つ」といった関係性が読み取れます。また、MoneyやOrderIdなどは値オブジェクトとして設計します。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション4: エンティティと値オブジェクトの識別 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.4 エンティティと値オブジェクトの識別
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ドメインモデルの各概念が、エンティティか値オブジェクトかを判断します。「識別子が重要か」「不変か」を基準に分類します。
                    </p>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 my-6">
                        <!-- エンティティ -->
                        <div class="bg-gradient-to-br from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5">
                            <h4 class="font-semibold text-blue-800 mb-3 flex items-center gap-2">
                                <i class="fas fa-fingerprint text-blue-600"></i>
                                エンティティ（識別子が重要）
                            </h4>
                            <ul class="space-y-2 text-blue-900 text-sm">
                                <li class="flex items-start gap-2">
                                    <span class="text-blue-600">●</span>
                                    <span><strong>Order（注文）</strong>: 注文番号で識別。同じ注文番号の注文は同一。内容が変わっても同一性は保たれる。</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-blue-600">●</span>
                                    <span><strong>Product（商品）</strong>: 商品コードで識別。価格や在庫が変わっても同一商品。</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-blue-600">●</span>
                                    <span><strong>Cart（カート）</strong>: カートIDで識別。ユーザーごとに一意。</span>
                                </li>
                            </ul>
                        </div>

                        <!-- 値オブジェクト -->
                        <div class="bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5">
                            <h4 class="font-semibold text-emerald-800 mb-3 flex items-center gap-2">
                                <i class="fas fa-cube text-emerald-600"></i>
                                値オブジェクト（値自体が意味を持つ）
                            </h4>
                            <ul class="space-y-2 text-emerald-900 text-sm">
                                <li class="flex items-start gap-2">
                                    <span class="text-emerald-600">●</span>
                                    <span><strong>Money（金額）</strong>: 金額と通貨の組み合わせ。不変。同じ金額なら交換可能。</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-emerald-600">●</span>
                                    <span><strong>ShippingAddress（配送先）</strong>: 住所の組み合わせ。同じ住所なら同一。</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-emerald-600">●</span>
                                    <span><strong>OrderId、ProductId</strong>: 識別子も値オブジェクトとして設計し、型安全性を高める。</span>
                                </li>
                                <li class="flex items-start gap-2">
                                    <span class="text-emerald-600">●</span>
                                    <span><strong>Quantity（数量）</strong>: 数値だけでなく、ビジネスルール（正の数のみ）を含む。</span>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- 値オブジェクトの実装例 -->
                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: Money（金額）値オブジェクト</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># Money値オブジェクト
class Money:
    def __init__(self, amount: int, currency: str = "JPY"):
        if amount < 0:
            raise ValueError("金額は0以上である必要があります")
        self._amount = amount  # 不変
        self._currency = currency

    @property
    def amount(self) -> int:
        return self._amount

    def add(self, other: 'Money') -> 'Money':
        # 通貨が異なる場合はエラー
        if self._currency != other._currency:
            raise ValueError("異なる通貨同士は加算できません")
        return Money(self._amount + other._amount, self._currency)

    def multiply(self, rate: int) -> 'Money':
        return Money(self._amount * rate, self._currency)

    def __eq__(self, other) -> bool:
        # 値による等価性
        return (self._amount == other._amount and
                self._currency == other._currency)</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション5: 集約の境界を決定 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.5 集約の境界を決定
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        どのオブジェクトをまとめて管理するかを決定します。整合性の境界を明確にし、集約ルートを特定します。
                    </p>

                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-layer-group text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-2 break-words">集約の設計</h3>
                                <ul class="space-y-3 text-emerald-900">
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <p class="font-medium">Order集約（集約ルート: Order）</p>
                                            <p class="text-sm mt-1">OrderとOrderItemをまとめて管理。注文明細は注文なしで存在できない。注文の合計金額は常に整合性が保たれる。</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <p class="font-medium">Product集約（集約ルート: Product）</p>
                                            <p class="text-sm mt-1">商品は単独で存在し、在庫管理のルールを持つ。在庫の増減は必ずProductを通じて行う。</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <p class="font-medium">Cart集約（集約ルート: Cart）</p>
                                            <p class="text-sm mt-1">CartとCartItemをまとめて管理。カートアイテムはカートなしで存在できない。</p>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <!-- 集約の境界図 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-border-all text-primary-500"></i>
                            集約の境界
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph Order_Agg["Order集約"]
        Order[Order<br/>集約ルート]
        OrderItem1[OrderItem]
        OrderItem2[OrderItem]
        ShippingAddr[ShippingAddress<br/>値オブジェクト]
        Order --> OrderItem1
        Order --> OrderItem2
        Order --> ShippingAddr
    end

    subgraph Product_Agg["Product集約"]
        Product[Product<br/>集約ルート]
        Stock[StockQuantity<br/>値オブジェクト]
        Product --> Stock
    end

    subgraph Cart_Agg["Cart集約"]
        Cart[Cart<br/>集約ルート]
        CartItem1[CartItem]
        CartItem2[CartItem]
        Cart --> CartItem1
        Cart --> CartItem2
    end

    OrderItem1 -.参照.-> Product
    OrderItem2 -.参照.-> Product
    CartItem1 -.参照.-> Product
    CartItem2 -.参照.-> Product

    style Order fill:#818cf8,stroke:#4f46e5,color:#fff
    style Product fill:#818cf8,stroke:#4f46e5,color:#fff
    style Cart fill:#818cf8,stroke:#4f46e5,color:#fff
                        </div>
                    </div>

                    <div class="bg-red-50 border-l-4 border-red-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-exclamation-triangle text-red-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-red-900 font-medium break-words">集約設計の重要ルール</p>
                                <p class="text-red-800 text-sm mt-1 break-words">
                                    集約の外から集約の内部エンティティ（OrderItem）を直接操作してはいけません。必ず集約ルート（Order）を経由します。例えば、注文明細を追加する場合は<code>order.addItem(product, quantity)</code>のように、Orderのメソッドを呼び出します。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Order集約の実装例 -->
                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: Order集約</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># Order集約ルート
class Order:
    def __init__(self, order_id: OrderId, customer_id: CustomerId):
        self._id = order_id
        self._customer_id = customer_id
        self._items = []  # OrderItemのリスト
        self._status = OrderStatus.PENDING
        self._shipping_address = None

    def add_item(self, product: Product, quantity: Quantity) -> None:
        # ビジネスルール: 在庫チェック
        if not product.has_stock(quantity):
            raise ValueError("在庫不足です")

        # 注文明細を追加
        item = OrderItem(product, quantity, product.price)
        self._items.append(item)

    def place_order(self, shipping_address: ShippingAddress) -> None:
        # ビジネスルール: 注文確定時のチェック
        if len(self._items) == 0:
            raise ValueError("注文明細が空です")

        self._shipping_address = shipping_address
        self._status = OrderStatus.CONFIRMED

    def total_amount(self) -> Money:
        # 合計金額を計算（整合性を保証）
        total = Money(0)
        for item in self._items:
            total = total.add(item.subtotal())
        return total</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション6: リポジトリの設計 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.6 リポジトリの設計
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        集約をデータベースに保存・取得するためのリポジトリを設計します。集約ルートごとにリポジトリを作成し、永続化の詳細を隠蔽します。
                    </p>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: OrderRepositoryインターフェース</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># リポジトリインターフェース（ドメイン層）
from abc import ABC, abstractmethod

class OrderRepository(ABC):
    @abstractmethod
    def save(self, order: Order) -> None:
        """注文を保存する"""
        pass

    @abstractmethod
    def find_by_id(self, order_id: OrderId) -> Order:
        """注文IDで注文を取得する"""
        pass

    @abstractmethod
    def find_by_customer(self, customer_id: CustomerId) -> List[Order]:
        """顧客IDで注文一覧を取得する"""
        pass

    @abstractmethod
    def delete(self, order: Order) -> None:
        """注文を削除する"""
        pass</code></pre>
                                </div>
                                <p class="text-purple-800 text-sm mt-3">
                                    インターフェースはドメイン層に配置し、実装（SQLやNoSQLへのアクセス）はインフラストラクチャ層に配置します。これにより、ドメイン層は永続化技術に依存しません。
                                </p>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: OrderRepository実装（インフラストラクチャ層）</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># リポジトリ実装（インフラストラクチャ層）
class SqlOrderRepository(OrderRepository):
    def __init__(self, db_session):
        self._db_session = db_session

    def save(self, order: Order) -> None:
        # ORMを使って保存（実装の詳細）
        # OrderエンティティをDBテーブルにマッピング
        order_record = self._to_record(order)
        self._db_session.add(order_record)
        self._db_session.commit()

    def find_by_id(self, order_id: OrderId) -> Order:
        # DBから取得してドメインオブジェクトに変換
        record = self._db_session.query(OrderRecord)\
                    .filter_by(id=order_id.value).first()
        if record is None:
            raise ValueError("注文が見つかりません")
        return self._to_domain(record)

    def _to_record(self, order: Order):
        # ドメインオブジェクト → DBレコード
        pass

    def _to_domain(self, record) -> Order:
        # DBレコード → ドメインオブジェクト
        pass</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション7: ドメインサービスの抽出 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.7 ドメインサービスの抽出
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        複数の集約にまたがる処理や、特定のエンティティに属さないビジネスロジックをドメインサービスとして抽出します。
                    </p>

                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-cogs text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-2 break-words">ドメインサービスの例</h3>
                                <ul class="space-y-2 text-emerald-900">
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <p class="font-medium">OrderService（注文処理サービス）</p>
                                            <p class="text-sm mt-1">カートから注文への変換処理。複数の集約（Cart、Order、Product）を協調させる。</p>
                                        </div>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check-circle text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <div>
                                            <p class="font-medium">StockReservationService（在庫引当サービス）</p>
                                            <p class="text-sm mt-1">注文確定時に商品の在庫を引き当てる処理。Productの在庫を減らし、Orderに紐づける。</p>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: OrderService</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># ドメインサービス
class OrderService:
    def __init__(self,
                 order_repo: OrderRepository,
                 cart_repo: CartRepository,
                 product_repo: ProductRepository):
        self._order_repo = order_repo
        self._cart_repo = cart_repo
        self._product_repo = product_repo

    def place_order(self,
                    cart_id: CartId,
                    shipping_address: ShippingAddress) -> Order:
        # カートを取得
        cart = self._cart_repo.find_by_id(cart_id)

        # 注文を作成
        order = Order(OrderId.generate(), cart.customer_id)

        # カートの内容を注文明細に変換
        for cart_item in cart.items:
            product = self._product_repo.find_by_id(cart_item.product_id)

            # 在庫を引き当てる
            product.reduce_stock(cart_item.quantity)
            self._product_repo.save(product)

            # 注文明細を追加
            order.add_item(product, cart_item.quantity)

        # 注文を確定
        order.place_order(shipping_address)
        self._order_repo.save(order)

        # カートをクリア
        cart.clear()
        self._cart_repo.save(cart)

        return order</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション8: アプリケーション層の設計 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.8 アプリケーション層の設計
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ユースケースを実現するアプリケーションサービスを作成します。ドメインサービスやリポジトリを組み合わせて、ビジネスプロセスを実行します。
                    </p>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-code text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実装例: PlaceOrderApplicationService</h3>
                                <div class="code-block-wrapper">
                                    <button class="copy-btn" onclick="copyCode(this)">
                                        <i class="fas fa-copy"></i>
                                    </button>
                                    <pre><code class="language-python"># アプリケーションサービス（アプリケーション層）
class PlaceOrderApplicationService:
    def __init__(self, order_service: OrderService):
        self._order_service = order_service

    def execute(self, command: PlaceOrderCommand) -> OrderDto:
        # コマンドから値オブジェクトを構築
        cart_id = CartId(command.cart_id)
        shipping_address = ShippingAddress(
            postal_code=command.postal_code,
            prefecture=command.prefecture,
            city=command.city,
            street=command.street
        )

        # ドメインサービスを呼び出し
        order = self._order_service.place_order(cart_id, shipping_address)

        # DTOに変換して返却
        return self._to_dto(order)

    def _to_dto(self, order: Order) -> OrderDto:
        # ドメインオブジェクト → DTO
        return OrderDto(
            order_id=order.id.value,
            status=order.status.name,
            total_amount=order.total_amount().amount
        )</code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション9: 実装のまとめ -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        14.9 実装の全体像
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        これまでの設計を統合し、レイヤードアーキテクチャで実装します。各層の役割を明確にし、依存関係を正しく保ちます。
                    </p>

                    <!-- レイヤー図 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-layer-group text-primary-500"></i>
                            レイヤードアーキテクチャ
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph Presentation["プレゼンテーション層"]
        API[REST API Controller]
    end

    subgraph Application["アプリケーション層"]
        AppService[PlaceOrderApplicationService]
        Command[PlaceOrderCommand]
        DTO[OrderDto]
    end

    subgraph Domain["ドメイン層"]
        DomainService[OrderService]
        Entity[Order, Product]
        VO[Money, ShippingAddress]
        RepoInterface[OrderRepository<br/>インターフェース]
    end

    subgraph Infrastructure["インフラストラクチャ層"]
        RepoImpl[SqlOrderRepository<br/>実装]
        DB[(Database)]
    end

    API --> AppService
    AppService --> Command
    AppService --> DomainService
    AppService --> DTO
    DomainService --> Entity
    DomainService --> VO
    DomainService --> RepoInterface
    RepoInterface -.実装.-> RepoImpl
    RepoImpl --> DB

    style Domain fill:#818cf8,stroke:#4f46e5,color:#fff
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">依存関係の方向</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    依存関係は常に「外側の層→内側の層」です。ドメイン層は他の層に依存しません。インフラストラクチャ層はドメイン層のインターフェースを実装しますが、ドメイン層はインフラストラクチャ層を知りません（依存性逆転の原則）。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200
                            rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-4">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. ユビキタス言語を定義する目的は何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            開発者とビジネス担当者が同じ言葉を使うことで、認識のズレを防ぎ、正確なソフトウェアを作るためです。用語をコードの命名と一致させることで、コードがビジネスの意図を正確に表現できるようになります。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. 「Money」や「ShippingAddress」を値オブジェクトとして設計する理由は何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            これらは識別子ではなく、値自体が意味を持つためです。不変性を保ち、ビジネスルール（例: 金額は0以上）を値オブジェクト内にカプセル化することで、コードの品質と安全性が向上します。同じ金額や住所なら交換可能（等価性）という性質も表現できます。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. Order集約において、OrderItemを直接操作せず、必ずOrderを経由する理由は何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            集約ルートが整合性を保証するためです。例えば、注文の合計金額は注文明細の合計と常に一致する必要があります。集約ルートを経由することで、ビジネスルールが確実に適用され、データの整合性が保たれます。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q4. ドメインサービス（OrderService）とアプリケーションサービス（PlaceOrderApplicationService）の違いは何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            ドメインサービスはビジネスロジックを含み、複数の集約を協調させます。アプリケーションサービスはユースケースを実現し、ドメインサービスやリポジトリを組み合わせますが、ビジネスロジックは含みません。アプリケーションサービスはDTOへの変換やトランザクション管理も担当します。
                                        </p>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 実習課題 -->
                <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200
                            rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-pencil-alt text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-purple-800 mb-4 break-words">実習課題</h3>
                            <div class="space-y-4 text-purple-900">
                                <div>
                                    <p class="font-medium mb-2">課題1: 商品レビュー機能の追加</p>
                                    <p class="text-sm">
                                        商品にレビューを投稿できる機能を追加してください。Review集約を設計し、Rating（評価値オブジェクト）やComment（コメント値オブジェクト）を含めます。ReviewRepositoryとReviewServiceも実装してください。
                                    </p>
                                </div>
                                <div>
                                    <p class="font-medium mb-2">課題2: 注文キャンセル処理の実装</p>
                                    <p class="text-sm">
                                        注文をキャンセルする処理を実装してください。注文ステータスを「キャンセル済み」に変更し、引き当てた在庫を戻す処理をドメインサービスとして実装します。キャンセル可能な条件（例: 出荷前のみ）も考慮してください。
                                    </p>
                                </div>
                                <div>
                                    <p class="font-medium mb-2">課題3: ドメインイベントの発行</p>
                                    <p class="text-sm">
                                        注文確定時に「OrderPlacedEvent」を発行し、在庫管理システムや通知システムに通知する仕組みを実装してください。イベントの発行、購読の仕組みを設計してください。
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 章のまとめ -->
                <div class="bg-gradient-to-r from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-6 my-8">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-clipboard-check text-primary-500"></i>
                        この章のまとめ
                    </h3>
                    <ul class="space-y-2 text-slate-700">
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>ECサイトの注文管理システムをDDDで設計する一連の流れを体験しました</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>ユビキタス言語を定義し、ドメインモデルを作成することで、ビジネスの概念を可視化しました</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>エンティティ（Order、Product）と値オブジェクト（Money、ShippingAddress）を適切に区別しました</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>集約の境界を決定し、集約ルートを通じて整合性を保証する設計を実装しました</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>リポジトリで永続化の詳細を隠蔽し、ドメインサービスで複数集約の協調処理を実現しました</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>レイヤードアーキテクチャで各層の役割を明確にし、依存関係を正しく管理しました</span>
                        </li>
                    </ul>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="ddd-learning-material-13.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600
                                  transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">ドメインイベント</span>
                        </div>
                    </a>
                    <a href="ddd-learning-material-15.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">既存システムへのDDD適用</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="https://github.com/fcircle-biz/tech_docs" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
