<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>DDD学習教材 第12章 - レイヤードアーキテクチャ - DDDを支える構造</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // DDD - Indigo (設計手法用)
                        primary: {
                            50: '#eef2ff',
                            100: '#e0e7ff',
                            200: '#c7d2fe',
                            300: '#a5b4fc',
                            400: '#818cf8',
                            500: '#6366f1',
                            600: '#4f46e5',
                            700: '#4338ca',
                            800: '#3730a3',
                            900: '#312e81',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fas fa-project-diagram text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">DDD学習教材</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-cubes text-[9px]"></i>
                                <span>設計・モデリング</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>推奨 45分</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="https://fcircle-biz.github.io/tech_docs/" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="../" class="hover:text-primary-600 transition-colors">設計・モデリング</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第12章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                     bg-primary-100 text-primary-700">
                            第12章
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">レイヤードアーキテクチャ - DDDを支える構造</h1>
                    <p class="text-slate-600">DDDを実装するためのアーキテクチャパターンを学びます。プレゼンテーション層、アプリケーション層、ドメイン層、インフラストラクチャ層の役割と依存関係を理解し、各層に何を配置すべきかを習得します。</p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200
                            rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>レイヤードアーキテクチャの基本構造と各層の責務を理解する</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>依存性逆転の原則を使ってドメイン層の独立性を保つ方法を学ぶ</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>各層に配置すべきクラス・コンポーネントを適切に判断できるようになる</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>レイヤードアーキテクチャの代替パターン（ヘキサゴナル、クリーンアーキテクチャ）について知る</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション1: レイヤードアーキテクチャとは -->
                <section class="prose prose-slate max-w-none">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.1 レイヤードアーキテクチャとは
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        <strong>レイヤードアーキテクチャ（層状アーキテクチャ）</strong>は、システムを複数の階層（レイヤー）に分割し、各層に明確な責務を持たせるアーキテクチャパターンです。DDDでは、ドメインモデルを他の技術的な詳細から分離し、純粋に保つために使用されます。
                    </p>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        典型的なDDDのレイヤードアーキテクチャは、以下の4つの層から構成されます：
                    </p>

                    <!-- レイヤー構造図 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-layer-group text-primary-500"></i>
                            4層のレイヤードアーキテクチャ
                        </h3>
                        <div class="mermaid">
flowchart TD
    subgraph Presentation["プレゼンテーション層"]
        P1[UI / コントローラー<br/>ユーザーとの接点]
    end

    subgraph Application["アプリケーション層"]
        A1[アプリケーションサービス<br/>ユースケースの実行]
    end

    subgraph Domain["ドメイン層"]
        D1[エンティティ / 値オブジェクト<br/>集約 / ドメインサービス<br/>ビジネスルールの中核]
    end

    subgraph Infrastructure["インフラストラクチャ層"]
        I1[リポジトリ実装<br/>データベース / 外部API<br/>技術的な詳細]
    end

    Presentation --> Application
    Application --> Domain
    Application --> Infrastructure
    Infrastructure -.実装.-> Domain

    style Presentation fill:#e0e7ff
    style Application fill:#c7d2fe
    style Domain fill:#6366f1,color:#fff
    style Infrastructure fill:#a5b4fc
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-info-circle text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">依存の方向</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    重要なのは、依存の方向が「上から下」であることです。プレゼンテーション層はアプリケーション層に依存し、アプリケーション層はドメイン層に依存します。逆方向の依存は許されません。これにより、ドメイン層が技術的な詳細から独立し、純粋にビジネスロジックに専念できます。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション2: 各層の責務 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.2 各層の責務と配置すべきもの
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        各層には明確な責務があり、適切な要素を配置する必要があります。それぞれの層について詳しく見ていきましょう。
                    </p>

                    <!-- プレゼンテーション層 -->
                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-desktop text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-purple-800 mb-2 break-words">プレゼンテーション層（Presentation Layer）</h3>
                                <p class="text-purple-900 mb-3 break-words">
                                    ユーザーとシステムの接点となる層です。ユーザーからの入力を受け取り、結果を表示します。
                                </p>
                                <div class="bg-purple-100 rounded-lg p-3 mb-3">
                                    <h4 class="font-semibold text-purple-800 mb-2 text-sm">配置すべきもの</h4>
                                    <ul class="space-y-1 text-purple-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <span class="text-purple-600">●</span>
                                            <span>Webコントローラー（Controller / Handler）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-purple-600">●</span>
                                            <span>ビュー（HTML / テンプレート / React/Vueコンポーネント）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-purple-600">●</span>
                                            <span>DTO（Data Transfer Object）の定義</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-purple-600">●</span>
                                            <span>入力のバリデーション（形式チェック）</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-purple-100 rounded-lg p-3">
                                    <h4 class="font-semibold text-purple-800 mb-2 text-sm">責務</h4>
                                    <ul class="space-y-1 text-purple-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-purple-600 mt-1 flex-shrink-0"></i>
                                            <span>ユーザーの入力を受け取る</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-purple-600 mt-1 flex-shrink-0"></i>
                                            <span>アプリケーション層のサービスを呼び出す</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-purple-600 mt-1 flex-shrink-0"></i>
                                            <span>結果をユーザーに表示する</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- アプリケーション層 -->
                    <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-cogs text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-blue-800 mb-2 break-words">アプリケーション層（Application Layer）</h3>
                                <p class="text-blue-900 mb-3 break-words">
                                    ユースケースを実現する層です。ドメインオブジェクトを組み合わせて、アプリケーションの機能を提供します。
                                </p>
                                <div class="bg-blue-100 rounded-lg p-3 mb-3">
                                    <h4 class="font-semibold text-blue-800 mb-2 text-sm">配置すべきもの</h4>
                                    <ul class="space-y-1 text-blue-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <span class="text-blue-600">●</span>
                                            <span>アプリケーションサービス（Use Case実装）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-blue-600">●</span>
                                            <span>トランザクション管理</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-blue-600">●</span>
                                            <span>ドメインイベントのディスパッチ</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-blue-600">●</span>
                                            <span>外部システムとの連携（APIクライアント）</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-blue-100 rounded-lg p-3">
                                    <h4 class="font-semibold text-blue-800 mb-2 text-sm">責務</h4>
                                    <ul class="space-y-1 text-blue-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-blue-600 mt-1 flex-shrink-0"></i>
                                            <span>ドメインオブジェクトを取得・操作する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-blue-600 mt-1 flex-shrink-0"></i>
                                            <span>トランザクション境界を定義する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-blue-600 mt-1 flex-shrink-0"></i>
                                            <span>ビジネスロジックは含まない（ドメイン層に委譲）</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ドメイン層 -->
                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-gem text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-2 break-words">ドメイン層（Domain Layer）</h3>
                                <p class="text-emerald-900 mb-3 break-words">
                                    ビジネスロジックの中核となる層です。DDDの戦術的パターンを使って、ドメインモデルを実装します。
                                </p>
                                <div class="bg-emerald-100 rounded-lg p-3 mb-3">
                                    <h4 class="font-semibold text-emerald-800 mb-2 text-sm">配置すべきもの</h4>
                                    <ul class="space-y-1 text-emerald-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>エンティティ（Entity）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>値オブジェクト（Value Object）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>集約（Aggregate）とルート</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>ドメインサービス（Domain Service）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>リポジトリインターフェース</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>ファクトリ（Factory）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-emerald-600">●</span>
                                            <span>ドメインイベント</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-emerald-100 rounded-lg p-3">
                                    <h4 class="font-semibold text-emerald-800 mb-2 text-sm">責務</h4>
                                    <ul class="space-y-1 text-emerald-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                            <span>ビジネスルールを実装する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                            <span>不変条件を保護する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                            <span>技術的な詳細から独立している</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- インフラストラクチャ層 -->
                    <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-database text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-orange-800 mb-2 break-words">インフラストラクチャ層（Infrastructure Layer）</h3>
                                <p class="text-orange-900 mb-3 break-words">
                                    技術的な詳細を扱う層です。データベース、外部API、ファイルシステムなどとの連携を担当します。
                                </p>
                                <div class="bg-orange-100 rounded-lg p-3 mb-3">
                                    <h4 class="font-semibold text-orange-800 mb-2 text-sm">配置すべきもの</h4>
                                    <ul class="space-y-1 text-orange-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <span class="text-orange-600">●</span>
                                            <span>リポジトリ実装（Repository Implementation）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-orange-600">●</span>
                                            <span>ORM設定（Entity Framework, Hibernate, SQLAlchemy等）</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-orange-600">●</span>
                                            <span>データベースマイグレーション</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-orange-600">●</span>
                                            <span>外部APIクライアント実装</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <span class="text-orange-600">●</span>
                                            <span>メール送信、ファイルI/O</span>
                                        </li>
                                    </ul>
                                </div>
                                <div class="bg-orange-100 rounded-lg p-3">
                                    <h4 class="font-semibold text-orange-800 mb-2 text-sm">責務</h4>
                                    <ul class="space-y-1 text-orange-900 text-sm">
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-orange-600 mt-1 flex-shrink-0"></i>
                                            <span>ドメイン層のインターフェースを実装する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-orange-600 mt-1 flex-shrink-0"></i>
                                            <span>永続化の詳細を処理する</span>
                                        </li>
                                        <li class="flex items-start gap-2">
                                            <i class="fas fa-check text-orange-600 mt-1 flex-shrink-0"></i>
                                            <span>外部システムとの通信を行う</span>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション3: 依存性逆転の原則 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.3 依存性逆転の原則（DIP）でドメイン層を守る
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ドメイン層はシステムの中核であり、技術的な詳細に依存してはいけません。しかし、ドメイン層は永続化（データベース保存）などのインフラストラクチャ機能を必要とします。この矛盾をどう解決するのでしょうか？
                    </p>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        答えは<strong>依存性逆転の原則（Dependency Inversion Principle / DIP）</strong>です。ドメイン層がインターフェースを定義し、インフラストラクチャ層がそれを実装することで、依存の方向を逆転させます。
                    </p>

                    <!-- DIPの図 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-arrows-alt-h text-primary-500"></i>
                            依存性逆転の原則
                        </h3>
                        <div class="mermaid">
flowchart TB
    subgraph Domain["ドメイン層"]
        OrderRepository[&lt;&lt;interface&gt;&gt;<br/>OrderRepository]
        Order[Order<br/>エンティティ]
    end

    subgraph Infrastructure["インフラストラクチャ層"]
        OrderRepositoryImpl[OrderRepositoryImpl<br/>リポジトリ実装]
        Database[(Database)]
    end

    Order -.定義.-> OrderRepository
    OrderRepositoryImpl -.実装.-> OrderRepository
    OrderRepositoryImpl --> Database

    style Domain fill:#6366f1,color:#fff
    style Infrastructure fill:#a5b4fc
    style OrderRepository fill:#e0e7ff,stroke:#6366f1,color:#000
                        </div>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-emerald-900 font-medium break-words">ポイント</p>
                                <p class="text-emerald-800 text-sm mt-1 break-words">
                                    ドメイン層は「こういう機能が欲しい」というインターフェースを定義するだけで、実装の詳細は知りません。インフラストラクチャ層がそのインターフェースに従って実装を提供します。これにより、ドメイン層は技術的な詳細から独立し、テストも容易になります。
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- コード例 -->
                    <div class="code-block-wrapper">
                        <div class="code-block-header">
                            <span class="code-block-title">ドメイン層: インターフェース定義</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-python"># domain/repository/order_repository.py
from abc import ABC, abstractmethod
from domain.model.order import Order

class OrderRepository(ABC):
    """注文リポジトリのインターフェース（ドメイン層で定義）"""

    @abstractmethod
    def save(self, order: Order) -> None:
        """注文を保存する"""
        pass

    @abstractmethod
    def find_by_id(self, order_id: str) -> Order:
        """IDで注文を取得する"""
        pass</code></pre>
                    </div>

                    <div class="code-block-wrapper mt-4">
                        <div class="code-block-header">
                            <span class="code-block-title">インフラストラクチャ層: 実装</span>
                            <button class="code-copy-btn" onclick="copyCode(this)">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                        <pre><code class="language-python"># infrastructure/repository/order_repository_impl.py
from domain.repository.order_repository import OrderRepository
from domain.model.order import Order
from infrastructure.database import db_session

class OrderRepositoryImpl(OrderRepository):
    """注文リポジトリの実装（インフラストラクチャ層）"""

    def save(self, order: Order) -> None:
        # データベース保存の詳細実装
        db_session.add(order)
        db_session.commit()

    def find_by_id(self, order_id: str) -> Order:
        # データベース検索の詳細実装
        return db_session.query(Order).filter_by(id=order_id).first()</code></pre>
                    </div>
                </section>

                <!-- セクション4: 実践例 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.4 実践例: ECサイトのレイヤー構成
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ECサイトの注文機能を例に、各層がどのように連携するか見てみましょう。
                    </p>

                    <!-- フォルダ構成 -->
                    <div class="bg-slate-100 rounded-xl p-6 my-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-folder-tree text-primary-500"></i>
                            プロジェクト構成例
                        </h3>
                        <pre class="bg-slate-800 text-slate-100 p-4 rounded-lg overflow-x-auto text-sm">
ecommerce/
├── presentation/              # プレゼンテーション層
│   ├── controllers/
│   │   └── order_controller.py
│   └── dto/
│       └── order_dto.py
├── application/               # アプリケーション層
│   └── services/
│       └── order_service.py
├── domain/                    # ドメイン層
│   ├── model/
│   │   ├── order.py          # 集約ルート
│   │   ├── order_item.py     # エンティティ
│   │   └── money.py          # 値オブジェクト
│   ├── repository/
│   │   └── order_repository.py  # インターフェース
│   └── service/
│       └── pricing_service.py   # ドメインサービス
└── infrastructure/            # インフラストラクチャ層
    ├── repository/
    │   └── order_repository_impl.py
    └── database/
        └── models.py         # ORMモデル</pre>
                    </div>

                    <!-- 実習: リクエストの流れ -->
                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200
                                rounded-xl p-5 my-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg
                                        flex items-center justify-center">
                                <i class="fas fa-pencil-alt text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-purple-800 mb-3 break-words">実習: 注文作成のリクエストフロー</h3>
                                <p class="text-purple-900 mb-4 break-words">
                                    ユーザーが注文を作成する際、各層がどのように連携するか追ってみましょう。
                                </p>

                                <!-- フローチャート -->
                                <div class="bg-purple-100 rounded-lg p-4 mb-4">
                                    <div class="mermaid">
sequenceDiagram
    participant User as ユーザー
    participant Controller as コントローラー<br/>プレゼンテーション層
    participant AppService as アプリケーション<br/>サービス
    participant Domain as Order集約<br/>ドメイン層
    participant Repo as Repository実装<br/>インフラ層
    participant DB as Database

    User->>Controller: POST /orders
    Controller->>AppService: createOrder(dto)
    AppService->>Domain: new Order(...)
    Domain->>Domain: ビジネスルール検証
    AppService->>Repo: save(order)
    Repo->>DB: INSERT
    DB-->>Repo: OK
    Repo-->>AppService: void
    AppService-->>Controller: OrderDto
    Controller-->>User: 200 OK
                                    </div>
                                </div>

                                <!-- 各ステップの詳細 -->
                                <div class="bg-purple-100 rounded-lg p-3">
                                    <h4 class="font-semibold text-purple-800 mb-2 text-sm">各層の役割</h4>
                                    <ol class="space-y-2 text-purple-900 text-sm">
                                        <li><strong>プレゼンテーション層:</strong> HTTPリクエストを受け取り、DTOに変換</li>
                                        <li><strong>アプリケーション層:</strong> トランザクション開始、Orderエンティティ生成、リポジトリで保存</li>
                                        <li><strong>ドメイン層:</strong> ビジネスルール検証（在庫チェック、価格計算など）</li>
                                        <li><strong>インフラストラクチャ層:</strong> データベースへの永続化</li>
                                    </ol>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション5: 代替アーキテクチャ -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.5 レイヤードアーキテクチャの代替パターン
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        レイヤードアーキテクチャは伝統的で理解しやすい構造ですが、いくつかの代替パターンも存在します。DDDと相性の良いアーキテクチャを紹介します。
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 my-6">
                        <!-- ヘキサゴナルアーキテクチャ -->
                        <div class="bg-blue-50 border border-blue-200 rounded-lg p-4">
                            <h4 class="font-semibold text-blue-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-hexagon"></i>
                                ヘキサゴナルアーキテクチャ
                            </h4>
                            <p class="text-blue-900 text-sm mb-2">
                                <strong>別名:</strong> ポート＆アダプターアーキテクチャ
                            </p>
                            <p class="text-blue-900 text-sm mb-2">
                                ドメインを中心に配置し、外部とのやり取りを「ポート（インターフェース）」と「アダプター（実装）」で管理します。レイヤードアーキテクチャよりもドメインの独立性を強調します。
                            </p>
                            <p class="text-blue-800 text-xs">
                                <strong>特徴:</strong> UIやDBを交換可能に、テストが容易
                            </p>
                        </div>

                        <!-- クリーンアーキテクチャ -->
                        <div class="bg-emerald-50 border border-emerald-200 rounded-lg p-4">
                            <h4 class="font-semibold text-emerald-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-circle-notch"></i>
                                クリーンアーキテクチャ
                            </h4>
                            <p class="text-emerald-900 text-sm mb-2">
                                <strong>提唱者:</strong> Robert C. Martin（Uncle Bob）
                            </p>
                            <p class="text-emerald-900 text-sm mb-2">
                                同心円状の層構造で、内側の層ほど抽象度が高く、外側の層ほど具体的な実装になります。依存の方向は常に内側に向かいます。
                            </p>
                            <p class="text-emerald-800 text-xs">
                                <strong>特徴:</strong> フレームワーク非依存、高いテスタビリティ
                            </p>
                        </div>

                        <!-- オニオンアーキテクチャ -->
                        <div class="bg-purple-50 border border-purple-200 rounded-lg p-4">
                            <h4 class="font-semibold text-purple-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-layer-group"></i>
                                オニオンアーキテクチャ
                            </h4>
                            <p class="text-purple-900 text-sm mb-2">
                                <strong>提唱者:</strong> Jeffrey Palermo
                            </p>
                            <p class="text-purple-900 text-sm mb-2">
                                クリーンアーキテクチャと似た概念で、ドメインモデルを中心に据え、外側の層が内側の層に依存する構造です。
                            </p>
                            <p class="text-purple-800 text-xs">
                                <strong>特徴:</strong> DDDと相性が良い、依存関係が明確
                            </p>
                        </div>

                        <!-- CQRS -->
                        <div class="bg-orange-50 border border-orange-200 rounded-lg p-4">
                            <h4 class="font-semibold text-orange-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-code-branch"></i>
                                CQRS（Command Query Responsibility Segregation）
                            </h4>
                            <p class="text-orange-900 text-sm mb-2">
                                <strong>概念:</strong> コマンド（更新）とクエリ（参照）の責務分離
                            </p>
                            <p class="text-orange-900 text-sm mb-2">
                                読み込みと書き込みで異なるモデルを使用し、複雑なクエリとビジネスロジックを分離します。DDDと組み合わせて使うことが多いです。
                            </p>
                            <p class="text-orange-800 text-xs">
                                <strong>特徴:</strong> パフォーマンス最適化、複雑なクエリに対応
                            </p>
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg overflow-hidden">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div class="flex-1 min-w-0">
                                <p class="text-blue-900 font-medium break-words">どれを選ぶべきか</p>
                                <p class="text-blue-800 text-sm mt-1 break-words">
                                    初心者にはレイヤードアーキテクチャが理解しやすくお勧めです。慣れてきたら、プロジェクトの要件に応じてヘキサゴナルやクリーンアーキテクチャを検討しましょう。重要なのは「ドメイン層を技術的な詳細から独立させる」という基本原則です。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション6: よくある落とし穴 -->
                <section class="prose prose-slate max-w-none mt-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        12.6 よくある落とし穴とベストプラクティス
                    </h2>

                    <!-- トラブルシューティングカード -->
                    <div class="bg-gradient-to-r from-orange-50 to-amber-50 border border-orange-200
                                rounded-xl p-5 my-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-orange-500 rounded-lg
                                        flex items-center justify-center">
                                <i class="fas fa-exclamation-triangle text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-orange-800 mb-4 break-words">よくある落とし穴</h3>

                                <div class="space-y-4">
                                    <!-- 落とし穴1 -->
                                    <div class="bg-orange-100 rounded-lg p-3">
                                        <h4 class="font-semibold text-orange-800 mb-1 flex items-center gap-2">
                                            <i class="fas fa-times-circle text-orange-600"></i>
                                            ドメイン層に技術的な詳細が漏れる
                                        </h4>
                                        <p class="text-orange-900 text-sm mb-2">
                                            ドメイン層のエンティティに、ORMのアノテーションやデータベース固有のコードを書いてしまう。
                                        </p>
                                        <p class="text-orange-800 text-xs">
                                            <strong>対策:</strong> ドメイン層はピュアなビジネスロジックのみ。永続化の詳細はインフラストラクチャ層で処理する。
                                        </p>
                                    </div>

                                    <!-- 落とし穴2 -->
                                    <div class="bg-orange-100 rounded-lg p-3">
                                        <h4 class="font-semibold text-orange-800 mb-1 flex items-center gap-2">
                                            <i class="fas fa-times-circle text-orange-600"></i>
                                            アプリケーション層に肥大化したビジネスロジック
                                        </h4>
                                        <p class="text-orange-900 text-sm mb-2">
                                            アプリケーションサービスに複雑なビジネスルールを書いてしまう（トランザクションスクリプトパターン）。
                                        </p>
                                        <p class="text-orange-800 text-xs">
                                            <strong>対策:</strong> ビジネスロジックはドメイン層のエンティティやドメインサービスに配置する。アプリケーション層は「オーケストレーション」のみ。
                                        </p>
                                    </div>

                                    <!-- 落とし穴3 -->
                                    <div class="bg-orange-100 rounded-lg p-3">
                                        <h4 class="font-semibold text-orange-800 mb-1 flex items-center gap-2">
                                            <i class="fas fa-times-circle text-orange-600"></i>
                                            層を飛び越えた依存
                                        </h4>
                                        <p class="text-orange-900 text-sm mb-2">
                                            プレゼンテーション層から直接リポジトリを呼び出すなど、層をスキップした依存を作ってしまう。
                                        </p>
                                        <p class="text-orange-800 text-xs">
                                            <strong>対策:</strong> 必ず隣接する層を経由する。依存の方向を守る。
                                        </p>
                                    </div>

                                    <!-- 落とし穴4 -->
                                    <div class="bg-orange-100 rounded-lg p-3">
                                        <h4 class="font-semibold text-orange-800 mb-1 flex items-center gap-2">
                                            <i class="fas fa-times-circle text-orange-600"></i>
                                            貧血ドメインモデル
                                        </h4>
                                        <p class="text-orange-900 text-sm mb-2">
                                            エンティティがゲッター/セッターだけで、ロジックがアプリケーション層に集中している。
                                        </p>
                                        <p class="text-orange-800 text-xs">
                                            <strong>対策:</strong> エンティティに振る舞いを持たせる。「データ」ではなく「振る舞いを持つオブジェクト」として設計する。
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ベストプラクティス -->
                    <div class="bg-gradient-to-r from-emerald-50 to-teal-50 border border-emerald-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-emerald-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-check-circle text-white"></i>
                            </div>
                            <div>
                                <h3 class="text-lg font-semibold text-emerald-800 mb-3 break-words">ベストプラクティス</h3>
                                <ul class="space-y-2 text-emerald-900">
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>依存の方向を守る:</strong> 常に上から下、外から内への依存にする</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>ドメイン層を純粋に保つ:</strong> フレームワーク非依存、技術非依存にする</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>アプリケーション層は薄く:</strong> オーケストレーションとトランザクション管理のみ</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>インターフェースを活用:</strong> DIPでドメイン層とインフラストラクチャ層を分離</span>
                                    </li>
                                    <li class="flex items-start gap-2">
                                        <i class="fas fa-check text-emerald-600 mt-1 flex-shrink-0"></i>
                                        <span><strong>ドメインモデルにロジックを集約:</strong> 貧血モデルを避ける</span>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200
                            rounded-xl p-5 my-8 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4 break-words">理解度確認クイズ</h3>
                            <ol class="space-y-4">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q1. レイヤードアーキテクチャの4つの層を挙げてください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            ① プレゼンテーション層（Presentation Layer）<br>
                                            ② アプリケーション層（Application Layer）<br>
                                            ③ ドメイン層（Domain Layer）<br>
                                            ④ インフラストラクチャ層（Infrastructure Layer）
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q2. 依存性逆転の原則（DIP）を使う理由は何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            ドメイン層を技術的な詳細（データベース、フレームワークなど）から独立させるためです。ドメイン層がインターフェースを定義し、インフラストラクチャ層がそれを実装することで、依存の方向を逆転させ、ドメイン層の純粋性を保ちます。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q3. アプリケーション層の主な責務は何ですか？ビジネスロジックを含めるべきですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            アプリケーション層の主な責務は、ユースケースの実行（オーケストレーション）とトランザクション管理です。ビジネスロジックは含めるべきではなく、ドメイン層に委譲します。アプリケーション層は「何をするか」を定義し、「どうやるか（ビジネスルール）」はドメイン層に任せます。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q4. ドメイン層に配置すべきではないものは何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            ORMのアノテーション、データベース固有のコード、フレームワーク固有のコード、UIコンポーネント、HTTPリクエスト/レスポンスの処理など、技術的な詳細はドメイン層に配置すべきではありません。ドメイン層はビジネスロジックのみに専念します。
                                        </p>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2 break-words">Q5. 「貧血ドメインモデル」とは何ですか？それはなぜ避けるべきですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700 break-words">
                                            回答を表示
                                        </summary>
                                        <p class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3 break-words">
                                            貧血ドメインモデルとは、エンティティがゲッター/セッターだけで振る舞いを持たず、ビジネスロジックがアプリケーション層やサービス層に集中している状態です。これを避けるべき理由は、ドメインモデルがデータの入れ物になってしまい、DDDの「ドメインモデルにビジネスルールを集約する」という原則に反するためです。オブジェクト指向の利点も失われます。
                                        </p>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 章のまとめ -->
                <div class="bg-gradient-to-r from-slate-50 to-slate-100 border border-slate-200 rounded-xl p-6 my-8">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-clipboard-check text-primary-500"></i>
                        この章のまとめ
                    </h3>
                    <ul class="space-y-2 text-slate-700">
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>レイヤードアーキテクチャは、システムを4つの層（プレゼンテーション、アプリケーション、ドメイン、インフラストラクチャ）に分割する</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>各層には明確な責務があり、依存の方向は上から下（外から内）のみ</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>依存性逆転の原則（DIP）を使って、ドメイン層を技術的な詳細から独立させる</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>アプリケーション層は薄く保ち、ビジネスロジックはドメイン層に配置する（貧血モデルを避ける）</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1 flex-shrink-0"></i>
                            <span>ヘキサゴナル、クリーンアーキテクチャなどの代替パターンも存在し、プロジェクトに応じて選択する</span>
                        </li>
                    </ul>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="ddd-learning-material-11.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600
                                  transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">コンテキストマップ</span>
                        </div>
                    </a>
                    <a href="ddd-learning-material-13.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">ドメインイベント</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="https://github.com/fcircle-biz/tech_docs" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
