<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UML学習教材 第10章 - 実践的なシステム設計演習</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; padding-top: 56px; }
        .navbar { background-color: #2c3e50; }
        .sidebar { position: sticky; top: 70px; height: calc(100vh - 70px); overflow-y: auto; }
        .chapter-title { color: #2c3e50; margin-top: 1.5rem; margin-bottom: 1rem; border-bottom: 2px solid #2c3e50; padding-bottom: 0.5rem; }
        .section-title { color: #34495e; margin-top: 1.2rem; margin-bottom: 0.8rem; }
        .quiz-container { background-color: #e8f4f8; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #2c3e50; }
        .exercise-container { background-color: #f3e5f5; border-radius: 8px; padding: 1.5rem; margin: 1.5rem 0; border-left: 4px solid #9c27b0; }
        .highlight { background-color: #ffecb3; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #ffc107; }
        .warning { background-color: #ffebee; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #f44336; }
        .code-block { background-color: #1e1e1e; color: white; border-radius: 5px; padding: 1rem; margin: 1rem 0; }
        .nav-link.active { background-color: #2c3e50 !important; color: white !important; }
        .concept-box { background-color: #e8f5e8; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #4caf50; }
        .project-box { background-color: #e3f2fd; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #2196f3; }
        .success-box { background-color: #e8f5e8; border-radius: 8px; padding: 1rem; margin: 1rem 0; border-left: 4px solid #4caf50; }
    </style>
</head>
<body>
    <!-- ナビゲーション -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand"><strong>UML学習教材</strong></a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>学習章</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-1.html">第1章: UML入門と基本概念</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-2.html">第2章: クラス図の基礎</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-3.html">第3章: ユースケース図とアクター</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-4.html">第4章: シーケンス図による相互作用モデリング</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-5.html">第5章: アクティビティ図によるワークフロー設計</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-6.html">第6章: ステートマシン図による状態遷移モデリング</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-7.html">第7章: コンポーネント図とデプロイメント図</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-8.html">第8章: その他の重要な図と高度な技法</a></li>
                        <li class="nav-item"><a class="nav-link" href="uml-learning-material-9.html">第9章: UMLツールの実践活用</a></li>
                        <li class="nav-item"><a class="nav-link active" href="uml-learning-material-10.html">第10章: 実践的なシステム設計演習</a></li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">第10章: 実践的なシステム設計演習</h1>
                </div>

                <div id="chapter10">
                    <h2 class="chapter-title">統合的なUMLモデリング実践</h2>
                    
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>要件分析からシステム実装まで一貫したUMLモデリング手法</li>
                            <li>複数のUML図を組み合わせた統合的なシステム設計</li>
                            <li>ECサイト、図書館管理システム、SNSアプリケーションの設計演習</li>
                            <li>ドメイン駆動設計（DDD）とUMLの実践的な組み合わせ</li>
                            <li>マイクロサービスアーキテクチャのUMLによる設計</li>
                            <li>アジャイル開発におけるUMLの効果的な活用方法</li>
                            <li>設計レビューと品質評価のためのUMLチェックリスト</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.1 統合的設計プロセスの概要</h3>
                    <p>実際のシステム開発では、単独のUML図ではなく、複数の図を組み合わせて包括的なシステム設計を行います。</p>
                    
                    <div class="concept-box">
                        <h6>統合的設計プロセスの段階</h6>
                        <ol>
                            <li><strong>要件定義</strong>：ユースケース図による機能要件の整理</li>
                            <li><strong>概念設計</strong>：クラス図による概念モデルの構築</li>
                            <li><strong>動的設計</strong>：シーケンス図、アクティビティ図による振る舞い設計</li>
                            <li><strong>詳細設計</strong>：ステートマシン図による状態管理の詳細化</li>
                            <li><strong>アーキテクチャ設計</strong>：コンポーネント図、デプロイメント図によるシステム構造</li>
                            <li><strong>実装支援</strong>：コード生成とリバースエンジニアリング</li>
                        </ol>
                    </div>

                    <div class="mermaid">
                        graph TD
                            A[要件分析] --> B[ユースケース図]
                            B --> C[概念モデリング]
                            C --> D[クラス図]
                            D --> E[動的モデリング]
                            E --> F[シーケンス図]
                            E --> G[アクティビティ図]
                            F --> H[詳細設計]
                            G --> H
                            H --> I[ステートマシン図]
                            H --> J[アーキテクチャ設計]
                            J --> K[コンポーネント図]
                            J --> L[デプロイメント図]
                            K --> M[実装]
                            L --> M
                    </div>

                    <h3 class="section-title">10.2 演習1: Eコマースサイトの設計</h3>
                    <p>オンラインショッピングサイトを題材に、要件分析から実装設計まで一貫したUMLモデリングを実践します。</p>

                    <div class="project-box">
                        <h6>プロジェクト概要：「マイショップ」</h6>
                        <p><strong>目標</strong>：中小企業向けのオンラインショッピングサイト構築</p>
                        <p><strong>主要機能</strong>：</p>
                        <ul>
                            <li>商品カタログ管理（商品登録、在庫管理、カテゴリ分類）</li>
                            <li>顧客管理（会員登録、ログイン、プロフィール管理）</li>
                            <li>注文処理（カート機能、決済、配送管理）</li>
                            <li>管理者機能（売上分析、顧客管理、商品管理）</li>
                        </ul>
                        <p><strong>非機能要件</strong>：</p>
                        <ul>
                            <li>同時アクセス数：1000ユーザー</li>
                            <li>レスポンス時間：3秒以内</li>
                            <li>可用性：99.9%（月間ダウンタイム43分以内）</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>演習 10-1: Eコマースサイトの要件分析とユースケース設計</h5>
                        <p>「マイショップ」の要件を分析し、包括的なユースケース図を作成しましょう。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>ステークホルダーの識別（顧客、管理者、配送業者、決済代行会社）</li>
                            <li>主要ユースケースの抽出</li>
                            <li>アクター間の関係とユースケース間の関係の定義</li>
                            <li>システム境界の明確化</li>
                        </ol>
                        
                        <h6>PlantUMLによるユースケース図例</h6>
                        <pre class="code-block"><code class="language-bash">@startuml Eコマースユースケース図
left to right direction

' アクター定義
actor "一般顧客" as Customer
actor "会員顧客" as Member  
actor "ショップ管理者" as Admin
actor "決済システム" as Payment
actor "配送システム" as Delivery

' 汎化関係
Member --|> Customer

' システム境界
rectangle "マイショップシステム" {
  ' 顧客向け機能
  usecase "商品検索" as Search
  usecase "商品詳細表示" as ViewProduct
  usecase "会員登録" as Register
  usecase "ログイン" as Login
  usecase "商品をカートに追加" as AddToCart
  usecase "注文処理" as PlaceOrder
  usecase "決済処理" as ProcessPayment
  usecase "注文履歴確認" as ViewOrders
  usecase "商品レビュー投稿" as PostReview
  
  ' 管理者機能
  usecase "商品管理" as ManageProducts
  usecase "顧客管理" as ManageCustomers  
  usecase "注文管理" as ManageOrders
  usecase "売上分析" as SalesAnalysis
  usecase "在庫管理" as ManageInventory
}

' アクターとユースケースの関係
Customer --> Search
Customer --> ViewProduct
Customer --> Register

Member --> Login
Member --> AddToCart
Member --> PlaceOrder
Member --> ViewOrders
Member --> PostReview

Admin --> ManageProducts
Admin --> ManageCustomers
Admin --> ManageOrders
Admin --> SalesAnalysis
Admin --> ManageInventory

' システム間連携
PlaceOrder --> Payment : 決済依頼
ProcessPayment --> Delivery : 配送依頼

' include/extend関係
PlaceOrder ..> Login : include
PlaceOrder ..> ProcessPayment : include
ViewProduct <.. PostReview : extend
@enduml</code></pre>
                        
                        <h6>設計のポイント</h6>
                        <ul>
                            <li>一般顧客と会員顧客の区別によるアクセス制御</li>
                            <li>外部システム（決済、配送）との連携点の明確化</li>
                            <li>include/extend関係による機能の構造化</li>
                            <li>将来の拡張性を考慮したシステム境界の設定</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>演習 10-2: ドメインモデルの設計（クラス図）</h5>
                        <p>Eコマースサイトのコアとなるドメインオブジェクトと、それらの関係をクラス図で表現しましょう。</p>
                        
                        <h6>PlantUMLによるドメインモデル例</h6>
                        <pre class="code-block"><code class="language-bash">@startuml Eコマースドメインモデル
!theme plain

' エンティティクラス
class Customer {
  -customerId : Long
  -firstName : String
  -lastName : String  
  -email : String
  -passwordHash : String
  -registeredDate : Date
  -isActive : boolean
  +authenticate(password : String) : boolean
  +updateProfile(info : ProfileInfo) : void
}

class Product {
  -productId : Long
  -name : String
  -description : String
  -price : BigDecimal
  -stockQuantity : int
  -categoryId : Long
  -isActive : boolean
  +updateStock(quantity : int) : void
  +isAvailable() : boolean
  +calculateDiscountPrice(discount : Discount) : BigDecimal
}

class Category {
  -categoryId : Long
  -name : String
  -description : String
  -parentCategoryId : Long
  +getSubCategories() : List<Category>
  +getAllProducts() : List<Product>
}

class ShoppingCart {
  -cartId : Long
  -customerId : Long
  -createdDate : Date
  -lastModified : Date
  +addItem(product : Product, quantity : int) : void
  +removeItem(product : Product) : void
  +calculateTotal() : BigDecimal
  +clear() : void
}

class CartItem {
  -cartItemId : Long
  -cartId : Long
  -productId : Long
  -quantity : int
  -unitPrice : BigDecimal
  +getSubTotal() : BigDecimal
}

class Order {
  -orderId : Long
  -customerId : Long
  -orderDate : Date
  -status : OrderStatus
  -totalAmount : BigDecimal
  -shippingAddress : Address
  -billingAddress : Address
  +addItem(product : Product, quantity : int, price : BigDecimal) : void
  +calculateTotal() : BigDecimal
  +updateStatus(status : OrderStatus) : void
}

class OrderItem {
  -orderItemId : Long
  -orderId : Long
  -productId : Long
  -quantity : int
  -unitPrice : BigDecimal
  +getSubTotal() : BigDecimal
}

class Payment {
  -paymentId : Long
  -orderId : Long
  -amount : BigDecimal
  -paymentMethod : PaymentMethod
  -status : PaymentStatus
  -processedDate : Date
  +process() : boolean
  +refund(amount : BigDecimal) : boolean
}

' 列挙型
enum OrderStatus {
  PENDING
  CONFIRMED
  SHIPPED  
  DELIVERED
  CANCELLED
}

enum PaymentStatus {
  PENDING
  COMPLETED
  FAILED
  REFUNDED
}

enum PaymentMethod {
  CREDIT_CARD
  BANK_TRANSFER
  COD
  E_WALLET
}

' 値オブジェクト
class Address {
  -postalCode : String
  -prefecture : String
  -city : String
  -addressLine1 : String
  -addressLine2 : String
  +getFullAddress() : String
}

' 関係性
Customer ||--o{ ShoppingCart : has
Customer ||--o{ Order : places
ShoppingCart ||--o{ CartItem : contains
Order ||--o{ OrderItem : contains
Order ||--|| Payment : has

Product ||--o{ CartItem : referenced by
Product ||--o{ OrderItem : referenced by
Category ||--o{ Product : contains
Category ||--o{ Category : parent-child

Order ||--|| Address : shipping
Order ||--|| Address : billing

' 制約
note right of Order
{constraint}
totalAmount = sum of all OrderItems
end note

note right of Product  
{constraint}
stockQuantity >= 0
end note
@enduml</code></pre>
                        
                        <h6>設計における重要なポイント</h6>
                        <ul>
                            <li><strong>ドメイン駆動設計</strong>：ビジネスロジックがエンティティに集約されている</li>
                            <li><strong>不変条件</strong>：制約ノートでビジネスルールを明確化</li>
                            <li><strong>値オブジェクト</strong>：Addressのような不変で等価性のあるオブジェクト</li>
                            <li><strong>列挙型活用</strong>：状態管理の型安全性確保</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>演習 10-3: 注文処理のシーケンス図</h5>
                        <p>複雑な注文処理フローを詳細なシーケンス図で表現し、システム間の相互作用を明確にしましょう。</p>
                        
                        <h6>PlantUMLによるシーケンス図例</h6>
                        <pre class="code-block"><code class="language-bash">@startuml 注文処理シーケンス図
participant "顧客" as Customer
participant "Web UI" as UI
participant "注文サービス" as OrderService
participant "商品サービス" as ProductService
participant "在庫サービス" as InventoryService
participant "決済サービス" as PaymentService
participant "顧客サービス" as CustomerService
participant "通知サービス" as NotificationService
database "注文DB" as OrderDB
database "商品DB" as ProductDB

Customer -> UI: 注文確定ボタンクリック
UI -> OrderService: 注文処理開始

' 顧客認証確認
OrderService -> CustomerService: 顧客情報取得
CustomerService --> OrderService: 顧客データ

' 在庫確認処理（並行）
par 商品ごとの在庫確認
  loop カート内商品ごと
    OrderService -> ProductService: 商品情報取得
    ProductService -> ProductDB: 商品データ取得
    ProductDB --> ProductService: 商品情報
    ProductService --> OrderService: 商品データ
    
    OrderService -> InventoryService: 在庫確認要求
    InventoryService --> OrderService: 在庫確認結果
  end
end

' 在庫確認結果の評価
alt すべての商品が在庫あり
  ' 注文オブジェクト作成
  OrderService -> OrderService: 注文オブジェクト生成
  OrderService -> OrderDB: 注文データ保存
  OrderDB --> OrderService: 保存完了
  
  ' 在庫引き当て
  loop 注文商品ごと
    OrderService -> InventoryService: 在庫引き当て
    InventoryService --> OrderService: 引き当て完了
  end
  
  ' 決済処理
  OrderService -> PaymentService: 決済処理要求
  
  alt 決済成功
    PaymentService --> OrderService: 決済完了
    
    ' 注文確定
    OrderService -> OrderService: 注文ステータス更新（確定）
    OrderService -> OrderDB: ステータス更新
    
    ' 確認メール送信（非同期）
    OrderService ->> NotificationService: 注文確認メール送信
    
    OrderService --> UI: 注文完了レスポンス
    UI --> Customer: 注文完了画面表示
    
    ' バックグラウンド処理
    note over NotificationService
      バックグラウンドで
      メール送信処理
    end note
    
  else 決済失敗
    PaymentService --> OrderService: 決済失敗
    
    ' 在庫引き当て取り消し
    loop 注文商品ごと
      OrderService -> InventoryService: 引き当て取り消し
      InventoryService --> OrderService: 取り消し完了
    end
    
    ' 注文キャンセル
    OrderService -> OrderService: 注文ステータス更新（キャンセル）
    OrderService -> OrderDB: ステータス更新
    
    OrderService --> UI: 決済エラーレスポンス
    UI --> Customer: 決済失敗画面表示
  end
  
else 在庫不足商品あり
  OrderService --> UI: 在庫不足エラー
  UI --> Customer: 在庫不足通知
end

' エラーハンドリング
note over OrderService
エラー発生時は
トランザクションロールバック
end note
@enduml</code></pre>
                        
                        <h6>設計のポイント</h6>
                        <ul>
                            <li><strong>マイクロサービス連携</strong>：各サービスが独立した責任を持つ</li>
                            <li><strong>分散トランザクション</strong>：Sagaパターンによる整合性保証</li>
                            <li><strong>非同期処理</strong>：メール送信などのノンブロッキング処理</li>
                            <li><strong>例外処理</strong>：在庫不足、決済失敗時の適切なロールバック</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.3 演習2: 図書館管理システムの設計</h3>
                    <p>公共図書館の管理システムを題材に、状態管理と複雑なビジネスルールを含むシステム設計を行います。</p>

                    <div class="project-box">
                        <h6>プロジェクト概要：「デジタル図書館システム」</h6>
                        <p><strong>主要機能</strong>：</p>
                        <ul>
                            <li>蔵書管理（図書登録、分類、検索、廃棄）</li>
                            <li>貸出管理（予約、貸出、返却、延滞管理）</li>
                            <li>利用者管理（登録、更新、利用統計）</li>
                            <li>相互貸借（他図書館との連携）</li>
                        </ul>
                        <p><strong>複雑なビジネスルール</strong>：</p>
                        <ul>
                            <li>図書の状態遷移（利用可能→予約済み→貸出中→延滞→利用可能）</li>
                            <li>利用者の貸出制限（一般：5冊、学生：10冊、研究者：20冊）</li>
                            <li>予約優先度（予約日時順、ただし研究者優先）</li>
                            <li>延滞時のペナルティ（延滞日数に応じた貸出停止期間）</li>
                        </ul>
                    </div>

                    <div class="exercise-container">
                        <h5>演習 10-4: 図書の状態遷移モデリング</h5>
                        <p>図書館の図書が持つ複雑な状態遷移をステートマシン図で正確にモデリングしましょう。</p>
                        
                        <h6>PlantUMLによるステートマシン図例</h6>
                        <pre class="code-block"><code class="language-bash">@startuml 図書状態遷移図
[*] --> 受入処理中 : 新規図書登録

受入処理中 --> 利用可能 : 登録処理完了
受入処理中 --> 廃棄 : 登録取り消し

state 利用可能 {
  利用可能 : entry/利用可能フラグ設定
  利用可能 : do/検索インデックス更新
  利用可能 --> 予約済み : 予約受付 [予約枠あり]
  利用可能 --> 貸出中 : 直接貸出
  利用可能 --> メンテナンス : 修理・点検
  利用可能 --> 行方不明 : 所在確認不可
}

state 予約済み {
  予約済み : entry/予約者に通知
  予約済み : do/予約期限監視
  
  state 予約管理 {
    [*] --> 予約確定
    予約確定 --> 予約期限切れ : 取置期限経過
    予約確定 --> 貸出準備 : 予約者来館
    予約期限切れ --> 次順位確認 : 次の予約者チェック
  }
  
  予約済み --> 利用可能 : 予約キャンセル / 次順位なし
  予約済み --> 貸出中 : 貸出実行
}

state 貸出中 {
  貸出中 : entry/返却期限設定
  貸出中 : do/返却期限監視
  
  貸出中 --> 利用可能 : 返却 [延滞なし]
  貸出中 --> 延滞中 : 返却期限経過
  貸出中 --> 紛失 : 利用者が紛失届
  貸出中 --> 更新 : 貸出期間延長 [延長可能]
  
  state 更新 {
    更新 : 延長処理
    更新 --> 貸出中 : 延長完了
  }
}

state 延滞中 {
  延滞中 : entry/延滞通知送信
  延滞中 : do/延滞料金計算
  延滞中 : exit/利用者ペナルティ設定
  
  延滞中 --> 利用可能 : 返却 / 延滞料金支払い
  延滞中 --> 紛失 : 紛失扱い
}

メンテナンス --> 利用可能 : 修理完了
メンテナンス --> 廃棄 : 修理不能

行方不明 --> 利用可能 : 発見
行方不明 --> 廃棄 : 捜索期限経過

紛失 --> 利用可能 : 弁償図書受領
紛失 --> 廃棄 : 弁償完了

廃棄 --> [*] : 除籍処理完了

' 並行状態：予約管理
state 図書情報 {
  --
  [*] --> 通常版
  通常版 --> 改訂版 : 新版入荷
  改訂版 --> 通常版 : 旧版指定貸出
}

' 制約条件
note right of 予約済み
{constraint}
予約者数 <= 最大予約数
予約期限 <= 7日間
end note

note right of 貸出中
{constraint}  
返却期限 = 貸出日 + 貸出期間
一般利用者: 14日間
学生: 30日間  
研究者: 90日間
end note

note right of 延滞中
{constraint}
延滞料金 = 延滞日数 × 1日あたり料金
ペナルティ期間 = 延滞日数 × 2
end note
@enduml</code></pre>
                        
                        <h6>設計のポイント</h6>
                        <ul>
                            <li><strong>複合状態活用</strong>：予約管理内での詳細な状態分岐</li>
                            <li><strong>並行状態</strong>：図書情報の版管理と物理状態の独立管理</li>
                            <li><strong>制約の明示</strong>：ビジネスルールをOCL風の制約で表現</li>
                            <li><strong>アクション定義</strong>：entry/do/exitアクションによる副作用の明確化</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.4 演習3: SNSアプリケーションの設計</h3>
                    <p>現代的なSNSアプリケーションを題材に、スケーラビリティと性能を考慮したマイクロサービス設計を行います。</p>

                    <div class="exercise-container">
                        <h5>演習 10-5: マイクロサービスアーキテクチャの設計</h5>
                        <p>SNSアプリケーション「SocialConnect」のマイクロサービス構成をコンポーネント図とデプロイメント図で設計しましょう。</p>
                        
                        <h6>PlantUMLによるマイクロサービス構成例</h6>
                        <pre class="code-block"><code class="language-bash">@startuml SNSマイクロサービス構成
!include <awslib/AWSCommon>
!include <awslib/Compute/all>
!include <awslib/Database/all>
!include <awslib/Storage/all>

' フロントエンド層
package "Frontend Services" {
  [Web Application] as WebApp
  [Mobile Application] as MobileApp  
  [Admin Dashboard] as AdminDash
}

' API Gateway層
package "API Gateway" {
  [API Gateway] as Gateway
  [Authentication] as Auth
  [Rate Limiting] as RateLimit
  [Load Balancer] as LB
}

' コアサービス層
package "Core Services" {
  [User Service] as UserSvc
  [Profile Service] as ProfileSvc
  [Post Service] as PostSvc
  [Timeline Service] as TimelineSvc
  [Follow Service] as FollowSvc
  [Like Service] as LikeSvc
  [Comment Service] as CommentSvc
  [Notification Service] as NotifSvc
}

' メディア・検索サービス層  
package "Media & Search Services" {
  [Media Service] as MediaSvc
  [Search Service] as SearchSvc
  [Analytics Service] as AnalyticsSvc
  [Recommendation Service] as RecommendSvc
}

' データ層
package "Data Layer" {
  database "User Database" as UserDB
  database "Post Database" as PostDB
  database "Timeline Cache" as TimelineCache
  database "Media Storage" as MediaStorage
  database "Search Index" as SearchIndex
  database "Analytics DB" as AnalyticsDB
}

' メッセージングシステム
package "Messaging" {
  [Event Bus] as EventBus
  [Message Queue] as MessageQ
  [Real-time Push] as PushSvc
}

' 監視・運用
package "Operations" {
  [Service Discovery] as Discovery
  [Config Management] as ConfigMgmt  
  [Monitoring] as Monitor
  [Logging] as Logging
  [Tracing] as Tracing
}

' フロントエンド → API Gateway
WebApp --> Gateway
MobileApp --> Gateway
AdminDash --> Gateway

' API Gateway内部
Gateway --> Auth
Gateway --> RateLimit
Gateway --> LB

' API Gateway → サービス
LB --> UserSvc
LB --> ProfileSvc  
LB --> PostSvc
LB --> TimelineSvc
LB --> FollowSvc
LB --> LikeSvc
LB --> CommentSvc

' サービス間通信（同期）
TimelineSvc --> PostSvc : HTTP/REST
TimelineSvc --> FollowSvc : HTTP/REST
ProfileSvc --> UserSvc : HTTP/REST
RecommendSvc --> PostSvc : HTTP/REST
RecommendSvc --> FollowSvc : HTTP/REST

' サービス間通信（非同期）
PostSvc ..> EventBus : Post Created Event
LikeSvc ..> EventBus : Like Event
CommentSvc ..> EventBus : Comment Event
FollowSvc ..> EventBus : Follow Event

EventBus ..> NotifSvc : Events
EventBus ..> AnalyticsSvc : Events
EventBus ..> TimelineSvc : Events

' データアクセス
UserSvc --> UserDB
ProfileSvc --> UserDB
PostSvc --> PostDB
TimelineSvc --> TimelineCache
FollowSvc --> UserDB
LikeSvc --> PostDB  
CommentSvc --> PostDB
MediaSvc --> MediaStorage
SearchSvc --> SearchIndex
AnalyticsSvc --> AnalyticsDB

' 通知・メッセージング
NotifSvc --> PushSvc
NotifSvc --> MessageQ

' サービス運用
UserSvc --> Discovery
PostSvc --> Discovery
TimelineSvc --> Discovery
UserSvc --> ConfigMgmt
PostSvc --> ConfigMgmt
TimelineSvc --> ConfigMgmt

' 監視
Monitor --> UserSvc
Monitor --> PostSvc  
Monitor --> TimelineSvc
Logging --> UserSvc
Logging --> PostSvc
Tracing --> UserSvc
Tracing --> PostSvc

' ノート
note right of TimelineSvc
キャッシュ戦略:
- 個人タイムライン: Redis
- フォロワー多数: 非同期生成
- リアルタイム更新: WebSocket
end note

note right of PostSvc
データ分散:
- 投稿データ: シャーディング
- 画像・動画: CDN配信
- 検索インデックス: Elasticsearch
end note

note right of EventBus
メッセージング:
- Apache Kafka使用
- 順序保証、耐久性確保
- 各サービスは独立してスケール
end note
@enduml</code></pre>
                        
                        <h6>設計のポイント</h6>
                        <ul>
                            <li><strong>ドメイン分離</strong>：各サービスが明確な責任境界を持つ</li>
                            <li><strong>データ分散</strong>：サービスごとに専用データストアを持つ</li>
                            <li><strong>非同期通信</strong>：Event Busによる疎結合な連携</li>
                            <li><strong>可観測性</strong>：監視、ログ、トレーシングの統合</li>
                            <li><strong>スケーラビリティ</strong>：各サービスが独立してスケール可能</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.5 アジャイル開発でのUML活用</h3>
                    <p>アジャイル開発環境では、UMLを軽量かつ効果的に活用する工夫が必要です。</p>

                    <div class="concept-box">
                        <h6>アジャイルでのUML活用ポイント</h6>
                        <ul>
                            <li><strong>Just Enough Design</strong>：必要十分なモデリング</li>
                            <li><strong>継続的更新</strong>：コードとモデルの同期維持</li>
                            <li><strong>コミュニケーションツール</strong>：設計議論の可視化</li>
                            <li><strong>自動化</strong>：CI/CDでのモデル更新・検証</li>
                        </ul>
                    </div>

                    <h3 class="section-title">10.6 品質評価とレビュー</h3>
                    <p>設計品質を客観的に評価するためのチェックリストとメトリクスです。</p>

                    <div class="success-box">
                        <h6>UML設計品質チェックリスト</h6>
                        <h7><strong>全体設計</strong></h7>
                        <ul>
                            <li>□ 要件とモデルの対応が明確である</li>
                            <li>□ 図間の整合性が保たれている</li>
                            <li>□ 抽象化レベルが適切である</li>
                            <li>□ 将来の拡張性が考慮されている</li>
                        </ul>
                        
                        <h7><strong>クラス設計</strong></h7>
                        <ul>
                            <li>□ 単一責任原則に従っている</li>
                            <li>□ カプセル化が適切に行われている</li>
                            <li>□ 継承関係が論理的に正しい</li>
                            <li>□ インターフェース分離ができている</li>
                        </ul>
                        
                        <h7><strong>動的設計</strong></h7>
                        <ul>
                            <li>□ シーケンスが論理的に正しい</li>
                            <li>□ 例外処理が考慮されている</li>
                            <li>□ 並行性の問題が検討されている</li>
                            <li>□ 性能要件が反映されている</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h6>よくある設計上の問題</h6>
                        <ul>
                            <li><strong>神クラス</strong>：一つのクラスに責任が集中しすぎる</li>
                            <li><strong>循環依存</strong>：パッケージやクラス間の循環参照</li>
                            <li><strong>密結合</strong>：変更の影響が広範囲に波及する設計</li>
                            <li><strong>過度なモデリング</strong>：実装に不要な詳細まで記述</li>
                            <li><strong>整合性の欠如</strong>：図間での矛盾や不整合</li>
                        </ul>
                    </div>

                    <div class="quiz-container">
                        <h5>総合演習: システム設計の統合評価</h5>
                        <p>これまで学習したUMLの知識を活用して、以下のシステムの設計を行ってください。</p>
                        
                        <h6>課題：「スマートホーム管理システム」</h6>
                        <p><strong>要件</strong>：</p>
                        <ul>
                            <li>IoTデバイス管理（照明、エアコン、セキュリティカメラ、スマートロック）</li>
                            <li>自動制御（スケジュール、センサー連動、機械学習による予測制御）</li>
                            <li>モバイルアプリ・音声制御対応</li>
                            <li>クラウド連携とエッジコンピューティング</li>
                        </ul>
                        
                        <h6>作成する成果物</h6>
                        <ol>
                            <li>ユースケース図（住人、訪問者、保守業者のアクター含む）</li>
                            <li>クラス図（IoTデバイス階層、制御ルール、学習モデル）</li>
                            <li>シーケンス図（自動制御の実行フロー）</li>
                            <li>ステートマシン図（デバイスの状態遷移）</li>
                            <li>コンポーネント図（エッジ・クラウド構成）</li>
                            <li>デプロイメント図（ネットワーク構成含む）</li>
                        </ol>
                        
                        <h6>評価観点</h6>
                        <ul>
                            <li>IoT特有の制約（低電力、通信不安定）が考慮されているか</li>
                            <li>セキュリティ要件が適切にモデリングされているか</li>
                            <li>スケーラビリティが考慮されているか</li>
                            <li>図間の整合性が保たれているか</li>
                        </ul>
                    </div>

                    <div class="success-box">
                        <h5>UML学習の完了おめでとうございます！</h5>
                        <p>この学習教材を通じて、UMLの基礎から実践的な活用まで幅広い知識を身につけました。</p>
                        
                        <h6>次のステップ</h6>
                        <ul>
                            <li><strong>実プロジェクトでの実践</strong>：学んだ知識を実際の開発で活用</li>
                            <li><strong>専門分野の深掘り</strong>：ドメイン駆動設計、マイクロサービス設計の学習</li>
                            <li><strong>ツールスキルの向上</strong>：高度なモデリングツールの習得</li>
                            <li><strong>チーム内での普及</strong>：UMLを活用した設計文化の構築</li>
                        </ul>
                        
                        <p>継続的な学習と実践により、UMLを効果的に活用できる設計者として成長していってください。</p>
                    </div>

                    <div class="d-flex justify-content-between mt-4">
                        <a href="uml-learning-material-9.html" class="btn btn-secondary">← 前の章</a>
                        <span class="text-muted">学習完了</span>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <script>hljs.highlightAll();</script>
    <script>mermaid.initialize({startOnLoad: true, theme: 'default'});</script>
</body>
</html>