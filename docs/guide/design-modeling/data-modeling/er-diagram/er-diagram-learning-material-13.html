<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" id="viewport-meta">
    <title>ER図学習教材 第13章 - 実践演習2：既存システムからER図を読み解く</title>

    <!-- ダークモード早期適用（フラッシュ防止） -->
    <script>
        (function() {
            const saved = localStorage.getItem('darkMode');
            const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
            if (saved === 'dark' || (saved === null && prefersDark)) {
                document.documentElement.classList.add('dark');
            }
        })();
    </script>

    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // ER図 - Sky カラーテーマ
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        }
                    },
                    fontFamily: {
                        sans: ['"Noto Sans JP"', 'sans-serif'],
                    }
                }
            }
        }
    </script>

    <!-- Google Fonts - Noto Sans JP -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- カスタムスタイル -->
    <link rel="stylesheet" href="styles.css">
</head>
<body class="font-sans bg-slate-50 text-slate-800 antialiased">
    <!-- ヘッダー/ナビゲーションバー -->
    <header class="fixed top-0 left-0 right-0 z-50 text-white header-rich header-rich-shadow">
        <nav class="w-full px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="flex items-center justify-between py-3">
                <!-- 左側: ロゴとタイトルセクション -->
                <div class="flex items-center gap-4">
                    <!-- アイコン -->
                    <div class="relative group">
                        <div class="absolute inset-0 bg-gradient-to-br from-yellow-400/30 to-orange-400/30 rounded-2xl blur-lg group-hover:blur-xl transition-all"></div>
                        <div class="relative w-14 h-14 bg-white/10 rounded-xl flex items-center justify-center backdrop-blur-sm border border-white/20">
                            <i class="fas fa-project-diagram text-3xl icon-rotate-hover drop-shadow-lg"></i>
                        </div>
                    </div>

                    <!-- タイトルとメタ情報 -->
                    <div class="flex flex-col gap-1">
                        <div class="flex items-center gap-2">
                            <span class="text-xl font-bold tracking-wide drop-shadow-md">ER図学習教材</span>
                            <span class="hidden sm:inline-flex items-center gap-1 px-2 py-0.5 bg-white/20 rounded-md text-[10px] font-semibold uppercase tracking-wider">
                                <i class="fas fa-star text-yellow-300 text-[8px]"></i>
                                初級
                            </span>
                        </div>
                        <div class="flex items-center gap-3 text-[11px] text-white/90 font-medium">
                            <div class="flex items-center gap-1">
                                <i class="fas fa-code text-[9px]"></i>
                                <span>データモデリング</span>
                            </div>
                            <div class="hidden sm:flex items-center gap-1">
                                <i class="fas fa-clock text-[9px]"></i>
                                <span>推奨 50分</span>
                            </div>
                            <div class="hidden lg:flex items-center gap-1">
                                <i class="fas fa-language text-[9px]"></i>
                                <span>日本語</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 右側: サイドバートグルボタン -->
                <button id="sidebar-toggle-btn" class="w-10 h-10 flex items-center justify-center rounded-lg hover:bg-white/20 transition-all active:scale-95" title="サイドバーの表示/非表示">
                    <i class="fas fa-bars text-lg"></i>
                </button>
            </div>
        </nav>
    </header>

    <!-- メインレイアウト -->
    <div class="flex min-h-screen pt-20">
        <!-- サイドバーはsidebar-content.jsで動的に生成されます -->

        <!-- メインコンテンツ -->
        <main class="flex-1 min-w-0">
            <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-10 py-6">
                <!-- パンくずリスト -->
                <nav class="flex items-center gap-2 text-sm text-slate-500 mb-6">
                    <a href="#" class="hover:text-primary-600 transition-colors">ホーム</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <a href="#" class="hover:text-primary-600 transition-colors">ER図</a>
                    <i class="fas fa-chevron-right text-xs"></i>
                    <span class="text-slate-700">第13章</span>
                </nav>

                <!-- 章ヘッダー -->
                <header class="mb-6">
                    <div class="flex items-center gap-3 mb-2">
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium
                                     bg-primary-100 text-primary-700">
                            第13章
                        </span>
                    </div>
                    <h1 class="text-2xl sm:text-3xl font-bold text-slate-900 mb-2">実践演習2 - 既存システムからER図を読み解く</h1>
                    <p class="text-slate-600">実務では既存のER図を読む機会も多くあります。ER図から設計意図や業務フローを理解する力を養いましょう。</p>
                </header>

                <!-- 学習目標カード -->
                <div class="bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200
                            rounded-xl p-5 mb-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-amber-400 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-lightbulb text-white"></i>
                        </div>
                        <div>
                            <h2 class="text-lg font-semibold text-amber-800 mb-3">この章で学ぶこと</h2>
                            <ul class="space-y-2">
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>既存のER図から業務内容を推測する方法を学ぶ</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ECサイト、SNS、業務システムなど実際のシステムのER図を読み解く</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>設計の良し悪しを判断する視点を身につける</span>
                                </li>
                                <li class="flex items-start gap-2 text-amber-900">
                                    <i class="fas fa-check-circle text-amber-500 mt-1 flex-shrink-0"></i>
                                    <span>ER図からデータフローや業務プロセスを可視化する</span>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- セクション 13.1 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.1 ER図を読み解く意義
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        実務では、自分でER図を一から設計するよりも、<strong>既存のER図を読み解く機会の方が多い</strong>場合があります。
                        新しいプロジェクトに参加したとき、システムの保守・改修を担当するとき、他部署から仕様を引き継ぐとき...
                        既存のER図を正しく理解できるかどうかが、業務を円滑に進められるかのカギになります。
                    </p>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">ER図を読み解くスキルの重要性</p>
                                <ul class="text-emerald-800 text-sm mt-2 space-y-1 list-disc list-inside">
                                    <li>システムの全体像を素早く把握できる</li>
                                    <li>業務フローや仕様を、文章だけより正確に理解できる</li>
                                    <li>データベースの改修ポイントや影響範囲を見極められる</li>
                                    <li>設計の問題点や改善余地に気づける</li>
                                </ul>
                            </div>
                        </div>
                    </div>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3 mt-6">ER図を読む際の基本ステップ</h3>
                    <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-6 mb-4">
                        <div class="space-y-3">
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 w-8 h-8 bg-blue-500 text-white rounded flex items-center justify-center font-bold">1</div>
                                <div>
                                    <p class="font-medium text-slate-800">エンティティを特定</p>
                                    <p class="text-slate-600 text-sm">どのようなデータが管理されているかを把握する</p>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 w-8 h-8 bg-emerald-500 text-white rounded flex items-center justify-center font-bold">2</div>
                                <div>
                                    <p class="font-medium text-slate-800">リレーションシップを確認</p>
                                    <p class="text-slate-600 text-sm">エンティティ同士の関係性とカーディナリティをチェックする</p>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 w-8 h-8 bg-purple-500 text-white rounded flex items-center justify-center font-bold">3</div>
                                <div>
                                    <p class="font-medium text-slate-800">主キー・外部キーを追う</p>
                                    <p class="text-slate-600 text-sm">データの識別方法と結合ポイントを理解する</p>
                                </div>
                            </div>
                            <div class="flex items-start gap-3">
                                <div class="flex-shrink-0 w-8 h-8 bg-amber-500 text-white rounded flex items-center justify-center font-bold">4</div>
                                <div>
                                    <p class="font-medium text-slate-800">業務フローを推測</p>
                                    <p class="text-slate-600 text-sm">ER図からシステムの振る舞いを想像する</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.2 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.2 演習1: ECサイトのER図を読み解く
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        オンラインショッピングサイトのER図を例に、読み解きの練習をしてみましょう。
                        以下のER図は、典型的なECサイトのデータ構造を表しています。
                    </p>

                    <div class="bg-slate-100 border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-shopping-cart text-blue-500"></i>
                            ECサイトのER図
                        </h3>
                        <div class="mermaid">
erDiagram
    CUSTOMER ||--o{ ORDER : places
    ORDER ||--|{ ORDER_ITEM : contains
    PRODUCT ||--o{ ORDER_ITEM : "ordered as"
    CATEGORY ||--o{ PRODUCT : includes
    CUSTOMER ||--o{ REVIEW : writes
    PRODUCT ||--o{ REVIEW : "reviewed by"

    CUSTOMER {
        int customer_id PK
        string email
        string name
        string password_hash
        date registered_at
        string address
    }

    CATEGORY {
        int category_id PK
        string category_name
        string description
    }

    PRODUCT {
        int product_id PK
        int category_id FK
        string product_name
        decimal price
        int stock_quantity
        text description
    }

    ORDER {
        int order_id PK
        int customer_id FK
        date order_date
        decimal total_amount
        string status
        string shipping_address
    }

    ORDER_ITEM {
        int order_item_id PK
        int order_id FK
        int product_id FK
        int quantity
        decimal unit_price
    }

    REVIEW {
        int review_id PK
        int customer_id FK
        int product_id FK
        int rating
        text comment
        date posted_at
    }
</div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-question-circle text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3">考えてみよう</h3>
                                <ol class="space-y-3 mb-4">
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                        <span>このER図から、どのような業務機能が実現されていると推測できますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                        <span>一人の顧客が複数の商品を注文するとき、データはどのように記録されますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                        <span>ORDER_ITEMエンティティはなぜ必要ですか？直接ORDERとPRODUCTを結べない理由は？</span>
                                    </li>
                                </ol>
                                <details class="mt-4">
                                    <summary class="cursor-pointer text-purple-600 hover:text-purple-700 font-medium">
                                        <i class="fas fa-lightbulb mr-2"></i>解説を表示
                                    </summary>
                                    <div class="mt-3 pl-4 text-purple-800 bg-purple-100 rounded-lg p-4">
                                        <p class="mb-3"><strong>1. 実現されている業務機能</strong></p>
                                        <ul class="list-disc list-inside space-y-1 mb-4">
                                            <li>顧客登録・ログイン機能（CUSTOMER）</li>
                                            <li>商品カテゴリ管理・商品検索（CATEGORY, PRODUCT）</li>
                                            <li>注文機能（ORDER, ORDER_ITEM）</li>
                                            <li>レビュー投稿・閲覧（REVIEW）</li>
                                        </ul>
                                        <p class="mb-3"><strong>2. 複数商品の注文データの記録</strong></p>
                                        <p class="mb-4">1つのORDERに対して、複数のORDER_ITEMが紐づきます。各ORDER_ITEMが1つの商品（PRODUCT）を参照し、数量や単価を保持します。</p>
                                        <p class="mb-3"><strong>3. ORDER_ITEMが必要な理由</strong></p>
                                        <p>ORDERとPRODUCTは多対多の関係です。1つの注文に複数の商品が含まれ、1つの商品は複数の注文で購入されます。多対多の関係を解消するために<strong>中間テーブル</strong>であるORDER_ITEMが必要になります。また、注文時の単価（unit_price）を記録できるため、商品の価格変更があっても過去の注文データに影響しません。</p>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.3 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.3 演習2: SNSのER図を読み解く
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        次はソーシャルネットワーキングサービス（SNS）のER図を見てみましょう。
                        ユーザー、投稿、フォロー関係などがどのように表現されているかを確認します。
                    </p>

                    <div class="bg-slate-100 border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-users text-purple-500"></i>
                            SNSのER図
                        </h3>
                        <div class="mermaid">
erDiagram
    USER ||--o{ POST : creates
    USER ||--o{ COMMENT : writes
    POST ||--o{ COMMENT : "has comments"
    USER ||--o{ LIKE : gives
    POST ||--o{ LIKE : receives
    USER ||--o{ FOLLOW : "follows (follower)"
    USER ||--o{ FOLLOW : "is followed (following)"

    USER {
        int user_id PK
        string username
        string email
        string password_hash
        string bio
        string avatar_url
        date created_at
    }

    POST {
        int post_id PK
        int user_id FK
        text content
        string image_url
        date posted_at
        int like_count
    }

    COMMENT {
        int comment_id PK
        int post_id FK
        int user_id FK
        text content
        date commented_at
    }

    LIKE {
        int like_id PK
        int user_id FK
        int post_id FK
        date liked_at
    }

    FOLLOW {
        int follow_id PK
        int follower_id FK
        int following_id FK
        date followed_at
    }
</div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-question-circle text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3">考えてみよう</h3>
                                <ol class="space-y-3 mb-4">
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                        <span>FOLLOWエンティティには、なぜfollower_idとfollowing_idの2つの外部キーがありますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                        <span>「あるユーザーをフォローしている人の一覧」を取得するには、どのデータを参照しますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                        <span>LIKEとCOMMENTは構造が似ています。どちらも「誰がどの投稿に対して」という関係を表していますが、何が違いますか？</span>
                                    </li>
                                </ol>
                                <details class="mt-4">
                                    <summary class="cursor-pointer text-purple-600 hover:text-purple-700 font-medium">
                                        <i class="fas fa-lightbulb mr-2"></i>解説を表示
                                    </summary>
                                    <div class="mt-3 pl-4 text-purple-800 bg-purple-100 rounded-lg p-4">
                                        <p class="mb-3"><strong>1. FOLLOWの2つの外部キー</strong></p>
                                        <p class="mb-4">FOLLOWは<strong>自己参照</strong>のリレーションシップです。follower_id（フォローする人）とfollowing_id（フォローされる人）は、どちらもUSERテーブルの同じuser_idを参照しています。これにより「ユーザーAがユーザーBをフォローする」という関係を記録できます。</p>
                                        <p class="mb-3"><strong>2. フォロワー一覧の取得</strong></p>
                                        <p class="mb-4">「ユーザーAをフォローしている人の一覧」を取得するには、FOLLOWテーブルでfollowing_id = Aのレコードを検索し、そのfollower_idからUSERテーブルを参照します。</p>
                                        <p class="mb-3"><strong>3. LIKEとCOMMENTの違い</strong></p>
                                        <p>LIKEは「いいね」のON/OFF状態を記録するだけなので、contentフィールドがありません。一方、COMMENTはテキスト内容（content）を保持します。LIKEはシンプルなアクション、COMMENTはユーザーの意見を記録するという目的の違いがあります。</p>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>

                    <div class="bg-blue-50 border-l-4 border-blue-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-lightbulb text-blue-600 mt-1"></i>
                            <div>
                                <p class="text-blue-900 font-medium">自己参照リレーションシップのヒント</p>
                                <p class="text-blue-800 text-sm mt-1">
                                    FOLLOWのように、同じテーブル内で関係性を表現する場合は「自己参照」と呼ばれます。
                                    組織図（上司・部下）、SNSのフォロー関係、商品の関連商品など、実務でよく登場するパターンです。
                                </p>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.4 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.4 演習3: 業務システムのER図を読み解く
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        最後に、企業の社員管理システムのER図を見てみましょう。
                        部署、プロジェクト、役職といった業務上の概念がどのように表現されているかを確認します。
                    </p>

                    <div class="bg-slate-100 border border-slate-200 rounded-xl p-6 mb-6">
                        <h3 class="font-semibold text-slate-800 mb-4 flex items-center gap-2">
                            <i class="fas fa-building text-emerald-500"></i>
                            社員管理システムのER図
                        </h3>
                        <div class="mermaid">
erDiagram
    DEPARTMENT ||--o{ EMPLOYEE : employs
    EMPLOYEE ||--o{ PROJECT_ASSIGNMENT : assigned
    PROJECT ||--o{ PROJECT_ASSIGNMENT : has
    ROLE ||--o{ EMPLOYEE : "has role"

    DEPARTMENT {
        int department_id PK
        string department_name
        int manager_id FK
        string location
    }

    ROLE {
        int role_id PK
        string role_name
        int salary_grade
    }

    EMPLOYEE {
        int employee_id PK
        int department_id FK
        int role_id FK
        string name
        string email
        date hire_date
        decimal salary
    }

    PROJECT {
        int project_id PK
        string project_name
        date start_date
        date end_date
        string status
    }

    PROJECT_ASSIGNMENT {
        int assignment_id PK
        int employee_id FK
        int project_id FK
        date assigned_date
        int allocated_hours
    }
</div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-6 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-question-circle text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3">考えてみよう</h3>
                                <ol class="space-y-3 mb-4">
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">1</span>
                                        <span>DEPARTMENTのmanager_idは何を表していますか？なぜEMPLOYEEへの外部キーになっていますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">2</span>
                                        <span>一人の社員が複数のプロジェクトに参加する場合、どのようにデータが記録されますか？</span>
                                    </li>
                                    <li class="flex items-start gap-3 text-purple-900">
                                        <span class="flex-shrink-0 w-6 h-6 bg-purple-200 rounded-full flex items-center justify-center text-sm font-medium">3</span>
                                        <span>このER図から、どのような業務レポートが作成できますか？（例を2つ挙げてください）</span>
                                    </li>
                                </ol>
                                <details class="mt-4">
                                    <summary class="cursor-pointer text-purple-600 hover:text-purple-700 font-medium">
                                        <i class="fas fa-lightbulb mr-2"></i>解説を表示
                                    </summary>
                                    <div class="mt-3 pl-4 text-purple-800 bg-purple-100 rounded-lg p-4">
                                        <p class="mb-3"><strong>1. DEPARTMENTのmanager_id</strong></p>
                                        <p class="mb-4">manager_idは「その部署の責任者である社員」を指します。部署マネージャー自身もEMPLOYEEテーブルに登録されているため、EMPLOYEEへの外部キーとなっています。これにより「営業部のマネージャーは山田太郎さん」のような関係を記録できます。</p>
                                        <p class="mb-3"><strong>2. 複数プロジェクトへの参加</strong></p>
                                        <p class="mb-4">EMPLOYEEとPROJECTは多対多の関係です。PROJECT_ASSIGNMENTが中間テーブルとなり、1人の社員が複数のプロジェクトに参加できます。各アサインメントには割り当て時間（allocated_hours）も記録されます。</p>
                                        <p class="mb-3"><strong>3. 作成可能なレポート例</strong></p>
                                        <ul class="list-disc list-inside space-y-1">
                                            <li>部署別の社員数と平均給与（DEPARTMENT, EMPLOYEE）</li>
                                            <li>プロジェクトごとの参加メンバー一覧（PROJECT, PROJECT_ASSIGNMENT, EMPLOYEE）</li>
                                            <li>役職別の人数分布（ROLE, EMPLOYEE）</li>
                                            <li>社員の稼働状況（複数プロジェクトの合計時間）（PROJECT_ASSIGNMENT）</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.5 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.5 ER図から業務フローを可視化する
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        ER図を読み解く際には、<strong>データの静的な構造</strong>だけでなく、<strong>業務プロセスの流れ</strong>も推測することが重要です。
                        エンティティ間のリレーションシップから、どのような順序でデータが生成・更新されるかを想像してみましょう。
                    </p>

                    <h3 class="text-lg font-semibold text-slate-700 mb-3">例: ECサイトの注文フロー</h3>
                    <div class="bg-slate-100 border border-slate-200 rounded-xl p-6 mb-6">
                        <div class="mermaid">
flowchart TD
    A[顧客がサイトにアクセス] --> B{会員登録済み？}
    B -->|いいえ| C[CUSTOMERレコード作成]
    B -->|はい| D[ログイン]
    C --> D
    D --> E[商品を検索・閲覧<br/>CATEGORY, PRODUCT]
    E --> F[カートに追加]
    F --> G{注文確定？}
    G -->|いいえ| E
    G -->|はい| H[ORDERレコード作成]
    H --> I[各商品をORDER_ITEMに記録]
    I --> J[在庫数を減算<br/>PRODUCT.stock_quantity]
    J --> K[注文完了]
    K --> L[商品到着後、レビュー投稿<br/>REVIEWレコード作成]
</div>
                        <p class="text-slate-600 text-sm mt-4">
                            <i class="fas fa-info-circle text-blue-500 mr-1"></i>
                            ER図から業務フローを推測することで、システムの動きをより深く理解できます。
                        </p>
                    </div>

                    <div class="bg-emerald-50 border-l-4 border-emerald-500 p-4 my-6 rounded-r-lg">
                        <div class="flex items-start gap-3">
                            <i class="fas fa-star text-emerald-600 mt-1"></i>
                            <div>
                                <p class="text-emerald-900 font-medium">業務フロー推測のコツ</p>
                                <ul class="text-emerald-800 text-sm mt-2 space-y-1 list-disc list-inside">
                                    <li>外部キーの依存関係から、「どちらが先に作られるか」を考える</li>
                                    <li>タイムスタンプ属性（created_at, posted_atなど）から時系列を推測する</li>
                                    <li>ステータス属性（status）から、状態遷移を想像する</li>
                                    <li>カーディナリティから、「1つに対して複数」の関係を意識する</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- セクション 13.6 -->
                <section class="prose prose-slate max-w-none mb-8">
                    <h2 class="flex items-center gap-3 text-xl font-semibold text-slate-800
                               border-l-4 border-primary-500 pl-4 mb-4">
                        13.6 設計の良し悪しを判断する視点
                    </h2>
                    <p class="text-slate-600 leading-relaxed mb-4">
                        既存のER図を読むときには、「このデータ構造は適切か？」という視点を持つことも大切です。
                        以下のチェックポイントを意識してみましょう。
                    </p>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                        <div class="bg-gradient-to-br from-emerald-50 to-teal-50 border border-emerald-200 rounded-lg p-4">
                            <h4 class="font-semibold text-emerald-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-check-circle text-emerald-600"></i>
                                良い設計の特徴
                            </h4>
                            <ul class="text-emerald-900 text-sm space-y-1 list-disc list-inside">
                                <li>正規化されており、データの重複がない</li>
                                <li>主キーが明確で一意性が保証されている</li>
                                <li>外部キー制約が適切に設定されている</li>
                                <li>エンティティ名・属性名が分かりやすい</li>
                                <li>業務ルールがデータ構造に反映されている</li>
                            </ul>
                        </div>

                        <div class="bg-gradient-to-br from-red-50 to-rose-50 border border-red-200 rounded-lg p-4">
                            <h4 class="font-semibold text-red-800 mb-2 flex items-center gap-2">
                                <i class="fas fa-exclamation-triangle text-red-600"></i>
                                問題のある設計の兆候
                            </h4>
                            <ul class="text-red-900 text-sm space-y-1 list-disc list-inside">
                                <li>同じデータが複数の場所に重複している</li>
                                <li>NULL値が多すぎる属性がある</li>
                                <li>多対多を中間テーブルで解消していない</li>
                                <li>属性名が曖昧（data1, value2など）</li>
                                <li>1つのエンティティに属性が多すぎる</li>
                            </ul>
                        </div>
                    </div>

                    <div class="bg-gradient-to-r from-purple-50 to-fuchsia-50 border border-purple-200 rounded-xl p-5 mb-4 overflow-hidden">
                        <div class="flex items-start gap-4">
                            <div class="flex-shrink-0 w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center">
                                <i class="fas fa-clipboard-check text-white"></i>
                            </div>
                            <div class="flex-1 min-w-0">
                                <h3 class="text-lg font-semibold text-purple-800 mb-3">実習 13-1: ER図の問題点を見つけよう</h3>
                                <p class="text-purple-900 mb-4">以下の簡易ER図には、いくつかの設計上の問題があります。どこが問題か、どう改善すべきか考えてみましょう。</p>

                                <div class="bg-white rounded-lg p-4 mb-4 border border-purple-200">
                                    <pre class="text-sm text-slate-700">ORDER (注文)
- order_id (主キー)
- customer_name (顧客名)
- customer_email (顧客メール)
- customer_address (顧客住所)
- product_name (商品名)
- product_price (商品価格)
- quantity (数量)
- order_date (注文日)</pre>
                                </div>

                                <details class="mt-4">
                                    <summary class="cursor-pointer text-purple-600 hover:text-purple-700 font-medium">
                                        <i class="fas fa-lightbulb mr-2"></i>問題点と改善案を表示
                                    </summary>
                                    <div class="mt-3 pl-4 text-purple-800 bg-purple-100 rounded-lg p-4">
                                        <p class="mb-3"><strong>問題点1: 顧客情報が重複している</strong></p>
                                        <p class="mb-3">同じ顧客が複数回注文すると、customer_name, customer_email, customer_addressが毎回記録され、データが重複します。住所変更時にすべての注文レコードを更新する必要があります。</p>

                                        <p class="mb-3"><strong>問題点2: 複数商品の注文に対応できない</strong></p>
                                        <p class="mb-3">1つのORDERレコードに1つの商品しか記録できません。複数商品を注文する場合、複数のORDERレコードが必要になり、注文をまとめて管理できません。</p>

                                        <p class="mb-3"><strong>改善案</strong></p>
                                        <ul class="list-disc list-inside space-y-1">
                                            <li>CUSTOMERエンティティを分離し、顧客情報を一元管理</li>
                                            <li>PRODUCTエンティティを分離し、商品情報を一元管理</li>
                                            <li>ORDER_ITEMエンティティを追加し、注文と商品の多対多を解消</li>
                                            <li>結果：CUSTOMER ← ORDER ← ORDER_ITEM → PRODUCT の構造になる</li>
                                        </ul>
                                    </div>
                                </details>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- 理解度確認クイズ -->
                <div class="bg-gradient-to-r from-blue-50 to-cyan-50 border border-blue-200
                            rounded-xl p-5 my-6 overflow-hidden">
                    <div class="flex items-start gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-blue-500 rounded-lg
                                    flex items-center justify-center">
                            <i class="fas fa-question text-white"></i>
                        </div>
                        <div class="flex-1 min-w-0">
                            <h3 class="text-lg font-semibold text-blue-800 mb-4">理解度確認クイズ</h3>
                            <ol class="space-y-4">
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2">Q1. 既存のER図を読み解くとき、最初に確認すべき要素は何ですか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3">
                                            <p>最初に確認すべきは<strong>エンティティ（どんなデータが管理されているか）</strong>です。</p>
                                            <p class="mt-1">各エンティティが何を表しているかを理解してから、リレーションシップ、主キー・外部キー、業務フローの順に読み解いていくと、全体像を把握しやすくなります。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2">Q2. SNSのFOLLOWエンティティのように、同じテーブル内で関係を表現する手法を何と呼びますか？</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3">
                                            <p><strong>自己参照（Self-Reference）リレーションシップ</strong>と呼びます。</p>
                                            <p class="mt-1">1つのエンティティが自分自身と関係を持つ場合に使われます。例：FOLLOWのfollower_idとfollowing_idは、どちらもUSERテーブルのuser_idを参照します。組織図の上司・部下関係、商品の関連商品などでもよく使われるパターンです。</p>
                                        </div>
                                    </details>
                                </li>
                                <li class="text-blue-900">
                                    <p class="font-medium mb-2">Q3. ER図から業務フローを推測する際に役立つ属性の例を2つ挙げてください。</p>
                                    <details class="mt-2">
                                        <summary class="cursor-pointer text-blue-600 hover:text-blue-700">
                                            回答を表示
                                        </summary>
                                        <div class="mt-2 pl-4 text-blue-800 bg-blue-100 rounded-lg p-3">
                                            <ol class="list-decimal list-inside space-y-1">
                                                <li><strong>タイムスタンプ属性</strong>：created_at, posted_at, order_dateなど。データが作成された時系列を把握できます。</li>
                                                <li><strong>ステータス属性</strong>：status, state, order_statusなど。データの状態遷移（例：注文中→発送済み→配達完了）を推測できます。</li>
                                            </ol>
                                            <p class="mt-2">これらの属性から、業務プロセスの流れや状態変化を読み取ることができます。</p>
                                        </div>
                                    </details>
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>

                <!-- 章のまとめ -->
                <div class="bg-gradient-to-r from-slate-50 to-blue-50 border border-slate-200 rounded-xl p-6 my-8">
                    <h3 class="text-lg font-semibold text-slate-800 mb-4 flex items-center gap-2">
                        <i class="fas fa-bookmark text-primary-500"></i>
                        第13章のまとめ
                    </h3>
                    <ul class="space-y-2 text-slate-700">
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>実務では既存のER図を読み解く機会が多く、素早く全体像を把握するスキルが重要</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>ER図を読む際は、<strong>エンティティ → リレーションシップ → 主キー・外部キー → 業務フロー</strong>の順に確認する</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>ECサイト、SNS、業務システムなど、実際のシステムのER図を読み解くことで実践力が身につく</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>自己参照リレーションシップ、中間テーブル、タイムスタンプ属性など、実務でよく使われるパターンを理解する</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>ER図から業務フローを推測し、データの静的構造と動的な振る舞いの両面を理解する</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="fas fa-check text-primary-500 mt-1"></i>
                            <span>設計の良し悪しを判断する視点を持ち、問題点に気づける力を養う</span>
                        </li>
                    </ul>
                </div>

                <!-- 章間ナビゲーション -->
                <nav class="flex items-center justify-between pt-6 mt-6 border-t border-slate-200">
                    <a href="er-diagram-learning-material-12.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-slate-100 hover:bg-slate-200 transition-colors">
                        <i class="fas fa-arrow-left text-slate-400 group-hover:text-slate-600 transition-transform group-hover:-translate-x-1"></i>
                        <div>
                            <span class="text-xs text-slate-500 block">前の章</span>
                            <span class="text-slate-700 font-medium">第12章: 実践演習1</span>
                        </div>
                    </a>
                    <a href="er-diagram-learning-material-14.html"
                       class="group flex items-center gap-3 px-4 py-3 rounded-xl
                              bg-primary-500 hover:bg-primary-600 text-white transition-colors">
                        <div class="text-right">
                            <span class="text-xs text-primary-100 block">次の章</span>
                            <span class="font-medium">第14章: ER図とUMLの関係</span>
                        </div>
                        <i class="fas fa-arrow-right transition-transform group-hover:translate-x-1"></i>
                    </a>
                </nav>
            </div>
        </main>
    </div>

    <!-- フッター -->
    <footer class="bg-slate-800 text-slate-300">
        <div class="max-w-screen-2xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex flex-col md:flex-row items-center justify-between gap-4">
                <p class="text-sm text-center md:text-left">
                    &copy; 2025 F-Circle. All rights reserved.<br>
                    本資料はAIツールを活用し、人間による編集・監修のもと作成されています。
                </p>
                <div class="flex items-center gap-4">
                    <a href="#" class="hover:text-white transition-colors">
                        <i class="fab fa-github text-xl"></i>
                    </a>
                </div>
            </div>
        </div>
    </footer>

    <!-- スクロールトップボタン -->
    <button id="scroll-top-btn"
            class="fixed bottom-6 right-6 w-12 h-12 bg-primary-500 text-white rounded-full
                   shadow-lg hover:bg-primary-600 transition-all duration-300
                   opacity-0 invisible translate-y-4"
            onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- サイドバー生成 -->
    <script src="sidebar-content.js"></script>

    <!-- 共通JavaScript -->
    <script src="main.js"></script>

    <!-- 描画ツール -->
    <script src="drawing-tool.js"></script>
</body>
</html>
