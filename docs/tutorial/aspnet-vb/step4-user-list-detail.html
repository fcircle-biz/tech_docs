<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET(VB) å®Ÿè·µãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ« Step 4 - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ - ASP.NETç³»ãƒ†ãƒ¼ãƒ */
        .navbar {
            background-color: #1976d2;
        }

        .navbar-brand, .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500;
        }

        .navbar-nav .nav-link:hover {
            color: #bbdefb !important;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: white;
            border-right: 1px solid #dee2e6;
        }

        .sidebar .nav-link {
            color: #495057;
            font-weight: 500;
        }

        .sidebar .nav-link:hover {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .sidebar .nav-link.active {
            background-color: #1976d2 !important;
            color: white !important;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #1976d2;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1976d2;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }

        /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .step-number {
            background-color: #1976d2;
            color: white;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET VB ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«TOP</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ç›®æ¬¡
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="step1-environment-setup.html">Step 1: ç’°å¢ƒæ§‹ç¯‰ã¨ASP.NETåŸºç¤</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-connection.html">Step 2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¨æ¥ç¶š</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-user-registration.html">Step 3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ©Ÿèƒ½</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="step4-user-list-detail.html">Step 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»è©³ç´°è¡¨ç¤º</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-update-delete.html">Step 5: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°ãƒ»å‰Šé™¤</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-testing-debug.html">Step 6: å‹•ä½œç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»è©³ç´°è¡¨ç¤ºæ©Ÿèƒ½</h1>
                    <div class="badge bg-primary">æ‰€è¦æ™‚é–“: 2.5æ™‚é–“</div>
                </div>

                <div id="step4">
                    <h2 class="chapter-title">GridViewã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>GridViewã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã«ã‚ˆã‚‹åŸºæœ¬çš„ãªãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</li>
                            <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‹ã‚‰ã®SELECTã‚¯ã‚¨ãƒªã¨ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°</li>
                            <li>ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ï¼ˆQueryStringï¼‰ã«ã‚ˆã‚‹ãƒšãƒ¼ã‚¸é–“ãƒ‡ãƒ¼ã‚¿å—ã‘æ¸¡ã—</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ã®å®Ÿè£…</li>
                            <li>For Eachæ–‡ã¨Ifæ–‡ã«ã‚ˆã‚‹æ¡ä»¶å‡¦ç†</li>
                            <li>å‹å¤‰æ›ï¼ˆStringâ‡”Integerï¼‰ã¨nullå€¤ã®å‡¦ç†</li>
                            <li>åŸºæœ¬çš„ãªã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</li>
                        </ul>
                    </div>

                    <h3 class="section-title">4.1 UserDAOã‚¯ãƒ©ã‚¹ã®æ¤œç´¢æ©Ÿèƒ½æ‹¡å¼µ</h3>
                    <p>ã¾ãšã€æ¤œç´¢æ©Ÿèƒ½ã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ã«å¯¾å¿œã™ã‚‹ãŸã‚ã«UserDAOã‚¯ãƒ©ã‚¹ã‚’æ‹¡å¼µã—ã¾ã™ã€‚</p>
                    
                    <!-- å®Ÿç¿’1 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 4-1: UserDAOã‚¯ãƒ©ã‚¹ã«æ¤œç´¢æ©Ÿèƒ½ã‚’è¿½åŠ </h5>
                        <p>æ¤œç´¢æ¡ä»¶ã«ã‚ˆã‚‹çµã‚Šè¾¼ã¿è¡¨ç¤ºã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ã‚’UserDAOã‚¯ãƒ©ã‚¹ã«å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        
                        <h6>App_Code/UserDAO.vb ã«è¿½åŠ ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰</h6>
                        <pre><code>''' &lt;summary&gt;
''' æ¤œç´¢æ¡ä»¶ã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ï¼ˆãƒšãƒ¼ã‚¸ãƒ³ã‚°å¯¾å¿œï¼‰
''' &lt;/summary&gt;
''' &lt;param name="searchKeyword"&gt;æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼åã€æ°åã€ãƒ¡ãƒ¼ãƒ«ã§éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ï¼‰&lt;/param&gt;
''' &lt;param name="pageSize"&gt;1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®è¡¨ç¤ºä»¶æ•°&lt;/param&gt;
''' &lt;param name="pageIndex"&gt;ãƒšãƒ¼ã‚¸ç•ªå·ï¼ˆ0ã‹ã‚‰é–‹å§‹ï¼‰&lt;/param&gt;
''' &lt;returns&gt;æ¤œç´¢çµæœã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ&lt;/returns&gt;
Public Shared Function SearchUsers(Optional searchKeyword As String = "", 
                                   Optional pageSize As Integer = 10, 
                                   Optional pageIndex As Integer = 0) As SearchResult
    
    Dim result As New SearchResult()
    result.Users = New List(Of User)()
    
    Try
        Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
            connection.Open()
            
            ' æ¤œç´¢æ¡ä»¶ã®æ§‹ç¯‰
            Dim whereClause As String = ""
            Dim parameters As New List(Of SqlParameter)()
            
            If Not String.IsNullOrEmpty(searchKeyword?.Trim()) Then
                whereClause = "WHERE username LIKE @Keyword OR full_name LIKE @Keyword OR email LIKE @Keyword"
                parameters.Add(New SqlParameter("@Keyword", $"%{searchKeyword.Trim()}%"))
            End If
            
            ' ç·ä»¶æ•°ã®å–å¾—
            Dim countQuery As String = $"SELECT COUNT(*) FROM users {whereClause}"
            Using countCommand As New SqlCommand(countQuery, connection)
                For Each param In parameters
                    countCommand.Parameters.Add(New SqlParameter(param.ParameterName, param.Value))
                Next
                result.TotalCount = CInt(countCommand.ExecuteScalar())
            End Using
            
            ' ãƒ‡ãƒ¼ã‚¿ã®å–å¾—ï¼ˆãƒšãƒ¼ã‚¸ãƒ³ã‚°ä»˜ãï¼‰
            Dim offset As Integer = pageIndex * pageSize
            Dim dataQuery As String = $"
                SELECT id, username, email, full_name, birth_date, created_at, updated_at 
                FROM users 
                {whereClause}
                ORDER BY created_at DESC 
                OFFSET @Offset ROWS 
                FETCH NEXT @PageSize ROWS ONLY"
            
            Using dataCommand As New SqlCommand(dataQuery, connection)
                ' æ¤œç´¢ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¿½åŠ 
                For Each param In parameters
                    dataCommand.Parameters.Add(New SqlParameter(param.ParameterName, param.Value))
                Next
                
                ' ãƒšãƒ¼ã‚¸ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®è¿½åŠ 
                dataCommand.Parameters.AddWithValue("@Offset", offset)
                dataCommand.Parameters.AddWithValue("@PageSize", pageSize)
                
                Using reader As SqlDataReader = dataCommand.ExecuteReader()
                    While reader.Read()
                        Dim user As New User() With {
                            .Id = reader.GetInt32("id"),
                            .Username = reader.GetString("username"),
                            .Email = reader.GetString("email"),
                            .FullName = reader.GetString("full_name"),
                            .BirthDate = If(reader.IsDBNull("birth_date"), Nothing, reader.GetDateTime("birth_date")),
                            .CreatedAt = reader.GetDateTime("created_at"),
                            .UpdatedAt = reader.GetDateTime("updated_at")
                        }
                        result.Users.Add(user)
                    End While
                End Using
            End Using
            
            ' ãƒšãƒ¼ã‚¸ãƒ³ã‚°æƒ…å ±ã®è¨ˆç®—
            result.PageSize = pageSize
            result.PageIndex = pageIndex
            result.TotalPages = Math.Ceiling(result.TotalCount / pageSize)
            result.HasNextPage = (pageIndex + 1) < result.TotalPages
            result.HasPreviousPage = pageIndex > 0
            
        End Using
        
    Catch ex As SqlException
        System.Diagnostics.Debug.WriteLine($"æ¤œç´¢SQL ã‚¨ãƒ©ãƒ¼ (ã‚¨ãƒ©ãƒ¼ç•ªå·: {ex.Number}): {ex.Message}")
        Throw New Exception($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã§ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚", ex)
        
    Catch ex As Exception
        System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {ex.Message}")
        Throw New Exception("ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", ex)
    End Try
    
    Return result
End Function

''' &lt;summary&gt;
''' å¹´é½¢åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼çµ±è¨ˆã®å–å¾—
''' &lt;/summary&gt;
''' &lt;returns&gt;å¹´ä»£åˆ¥ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°&lt;/returns&gt;
Public Shared Function GetUserStatistics() As Dictionary(Of String, Integer)
    Dim statistics As New Dictionary(Of String, Integer)()
    
    Try
        Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
            connection.Open()
            
            Dim query As String = "
                SELECT 
                    CASE 
                        WHEN birth_date IS NULL THEN 'å¹´é½¢ä¸æ˜'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 20 THEN '10ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 30 THEN '20ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 40 THEN '30ä»£'  
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 50 THEN '40ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 60 THEN '50ä»£'
                        ELSE '60ä»£ä»¥ä¸Š'
                    END AS AgeGroup,
                    COUNT(*) AS UserCount
                FROM users 
                GROUP BY 
                    CASE 
                        WHEN birth_date IS NULL THEN 'å¹´é½¢ä¸æ˜'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 20 THEN '10ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 30 THEN '20ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 40 THEN '30ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 50 THEN '40ä»£'
                        WHEN DATEDIFF(YEAR, birth_date, GETDATE()) < 60 THEN '50ä»£'
                        ELSE '60ä»£ä»¥ä¸Š'
                    END
                ORDER BY UserCount DESC"
            
            Using command As New SqlCommand(query, connection)
                Using reader As SqlDataReader = command.ExecuteReader()
                    While reader.Read()
                        Dim ageGroup As String = reader.GetString("AgeGroup")
                        Dim userCount As Integer = reader.GetInt32("UserCount")
                        statistics(ageGroup) = userCount
                    End While
                End Using
            End Using
        End Using
        
    Catch ex As Exception
        System.Diagnostics.Debug.WriteLine($"çµ±è¨ˆå–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}")
        ' ã‚¨ãƒ©ãƒ¼æ™‚ã¯ç©ºã®è¾æ›¸ã‚’è¿”ã™
    End Try
    
    Return statistics
End Function</code></pre>
                        
                        <h6>App_Code/SearchResult.vbï¼ˆæ–°è¦ä½œæˆï¼‰</h6>
                        <pre><code>''' &lt;summary&gt;
''' æ¤œç´¢çµæœã¨ãƒšãƒ¼ã‚¸ãƒ³ã‚°æƒ…å ±ã‚’æ ¼ç´ã™ã‚‹ã‚¯ãƒ©ã‚¹
''' &lt;/summary&gt;
Public Class SearchResult
    ''' &lt;summary&gt;
    ''' æ¤œç´¢çµæœã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ
    ''' &lt;/summary&gt;
    Public Property Users As List(Of User)
    
    ''' &lt;summary&gt;
    ''' ç·ä»¶æ•°
    ''' &lt;/summary&gt;
    Public Property TotalCount As Integer
    
    ''' &lt;summary&gt;
    ''' 1ãƒšãƒ¼ã‚¸ã‚ãŸã‚Šã®è¡¨ç¤ºä»¶æ•°
    ''' &lt;/summary&gt;
    Public Property PageSize As Integer
    
    ''' &lt;summary&gt;
    ''' ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ï¼ˆ0ã‹ã‚‰é–‹å§‹ï¼‰
    ''' &lt;/summary&gt;
    Public Property PageIndex As Integer
    
    ''' &lt;summary&gt;
    ''' ç·ãƒšãƒ¼ã‚¸æ•°
    ''' &lt;/summary&gt;
    Public Property TotalPages As Integer
    
    ''' &lt;summary&gt;
    ''' æ¬¡ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹ã‹
    ''' &lt;/summary&gt;
    Public Property HasNextPage As Boolean
    
    ''' &lt;summary&gt;
    ''' å‰ãƒšãƒ¼ã‚¸ãŒå­˜åœ¨ã™ã‚‹ã‹
    ''' &lt;/summary&gt;
    Public Property HasPreviousPage As Boolean
    
    ''' &lt;summary&gt;
    ''' ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    ''' &lt;/summary&gt;
    Public Sub New()
        Users = New List(Of User)()
        TotalCount = 0
        PageSize = 10
        PageIndex = 0
        TotalPages = 0
        HasNextPage = False
        HasPreviousPage = False
    End Sub
    
    ''' &lt;summary&gt;
    ''' ç¾åœ¨ã®ãƒšãƒ¼ã‚¸ç•ªå·ï¼ˆ1ã‹ã‚‰é–‹å§‹ï¼‰
    ''' &lt;/summary&gt;
    Public ReadOnly Property CurrentPage As Integer
        Get
            Return PageIndex + 1
        End Get
    End Property
    
    ''' &lt;summary&gt;
    ''' è¡¨ç¤ºé–‹å§‹ä½ç½®ï¼ˆ1ã‹ã‚‰é–‹å§‹ï¼‰
    ''' &lt;/summary&gt;
    Public ReadOnly Property StartIndex As Integer
        Get
            If TotalCount = 0 Then
                Return 0
            Else
                Return (PageIndex * PageSize) + 1
            End If
        End Get
    End Property
    
    ''' &lt;summary&gt;
    ''' è¡¨ç¤ºçµ‚äº†ä½ç½®
    ''' &lt;/summary&gt;
    Public ReadOnly Property EndIndex As Integer
        Get
            Return Math.Min(StartIndex + Users.Count - 1, TotalCount)
        End Get
    End Property
End Class</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <ul>
                            <li>SearchUsersãƒ¡ã‚½ãƒƒãƒ‰ãŒæ­£å¸¸ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹</li>
                            <li>æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã«ã‚ˆã‚‹éƒ¨åˆ†ä¸€è‡´æ¤œç´¢ãŒå‹•ä½œã™ã‚‹</li>
                            <li>ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ãŒæ­£ã—ãå®Ÿè£…ã•ã‚Œã‚‹</li>
                            <li>SearchResultã‚¯ãƒ©ã‚¹ã§ãƒšãƒ¼ã‚¸ãƒ³ã‚°æƒ…å ±ãŒç®¡ç†ã•ã‚Œã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">4.2 ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ç”»é¢ã®å®Ÿè£…</h3>
                    <p>GridViewã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã¨æ¤œç´¢æ©Ÿèƒ½ã‚’å‚™ãˆãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ç”»é¢ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

                    <!-- å®Ÿç¿’2 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 4-2: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ç”»é¢ï¼ˆList.aspxï¼‰ã®ä½œæˆ</h5>
                        <p>GridViewã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã€æ¤œç´¢æ©Ÿèƒ½ã€ãƒšãƒ¼ã‚¸ãƒ³ã‚°æ©Ÿèƒ½ã‚’å«ã‚€ä¸€è¦§ç”»é¢ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        
                        <h6>Users/List.aspx</h6>
                        <pre><code>&lt;%@ Page Title="ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§" Language="vb" MasterPageFile="~/Site.Master" AutoEventWireup="false" CodeBehind="List.aspx.vb" Inherits="UserManagementApp.List" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server"&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="d-flex justify-content-between align-items-center mb-4"&gt;
        &lt;h2 class="text-primary"&gt;
            &lt;i class="fas fa-users"&gt;&lt;/i&gt; ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
        &lt;/h2&gt;
        &lt;a href="Create.aspx" class="btn btn-success btn-lg"&gt;
            &lt;i class="fas fa-plus"&gt;&lt;/i&gt; æ–°è¦ç™»éŒ²
        &lt;/a&gt;
    &lt;/div&gt;

    &lt;!-- ç·ä»¶æ•°è¡¨ç¤º --&gt;
    &lt;div class="mb-3"&gt;
        &lt;asp:Label ID="lblTotalCount" runat="server" CssClass="text-muted"&gt;&lt;/asp:Label&gt;
    &lt;/div&gt;

    &lt;!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ --&gt;
    &lt;asp:Panel ID="pnlMessage" runat="server" Visible="false"&gt;
        &lt;asp:Label ID="lblMessage" runat="server" CssClass="alert d-block"&gt;&lt;/asp:Label&gt;
    &lt;/asp:Panel&gt;

    &lt;!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ†ãƒ¼ãƒ–ãƒ« --&gt;
    &lt;div class="card"&gt;
        &lt;div class="card-body"&gt;
            &lt;asp:GridView ID="gvUsers" runat="server" 
                          CssClass="table table-striped table-hover" 
                          AutoGenerateColumns="False"
                          OnRowDataBound="gvUsers_RowDataBound"
                          EmptyDataText="ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒã‚ã‚Šã¾ã›ã‚“ã€‚"&gt;
                
                &lt;Columns&gt;
                    &lt;asp:BoundField DataField="Id" HeaderText="ID" ItemStyle-Width="60px" HeaderStyle-CssClass="text-center" ItemStyle-CssClass="text-center" /&gt;
                    
                    &lt;asp:TemplateField HeaderText="ãƒ¦ãƒ¼ã‚¶ãƒ¼å"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;asp:LinkButton ID="lnkUsername" runat="server" 
                                            Text='&lt;%# Eval("Username") %&gt;' 
                                            CssClass="text-decoration-none fw-bold"
                                            OnClick="lnkUsername_Click"
                                            CommandArgument='&lt;%# Eval("Id") %&gt;' /&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                    
                    &lt;asp:BoundField DataField="FullName" HeaderText="æ°å" /&gt;
                    &lt;asp:BoundField DataField="Email" HeaderText="ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹" /&gt;
                    
                    &lt;asp:TemplateField HeaderText="ç”Ÿå¹´æœˆæ—¥" ItemStyle-Width="120px"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;%# If(Eval("BirthDate") Is Nothing OrElse IsDBNull(Eval("BirthDate")), 
                                    "æœªè¨­å®š", 
                                    Convert.ToDateTime(Eval("BirthDate")).ToString("yyyy/MM/dd")) %&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                    
                    &lt;asp:TemplateField HeaderText="å¹´é½¢" ItemStyle-Width="60px" HeaderStyle-CssClass="text-center" ItemStyle-CssClass="text-center"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;%# GetAge(Eval("BirthDate")) %&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                    
                    &lt;asp:TemplateField HeaderText="ç™»éŒ²æ—¥" ItemStyle-Width="100px"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;%# Convert.ToDateTime(Eval("CreatedAt")).ToString("yyyy/MM/dd") %&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                    
                    &lt;asp:TemplateField HeaderText="æ“ä½œ" ItemStyle-Width="120px" HeaderStyle-CssClass="text-center" ItemStyle-CssClass="text-center"&gt;
                        &lt;ItemTemplate&gt;
                            &lt;asp:LinkButton ID="lnkDetail" runat="server" 
                                            Text="è©³ç´°" 
                                            CssClass="btn btn-sm btn-outline-primary me-1"
                                            OnClick="lnkDetail_Click"
                                            CommandArgument='&lt;%# Eval("Id") %&gt;' /&gt;
                            &lt;asp:LinkButton ID="lnkEdit" runat="server" 
                                            Text="ç·¨é›†" 
                                            CssClass="btn btn-sm btn-outline-secondary"
                                            OnClick="lnkEdit_Click"
                                            CommandArgument='&lt;%# Eval("Id") %&gt;' /&gt;
                        &lt;/ItemTemplate&gt;
                    &lt;/asp:TemplateField&gt;
                &lt;/Columns&gt;
                
                &lt;EmptyDataRowStyle CssClass="text-center text-muted" /&gt;
            &lt;/asp:GridView&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- æ“ä½œãƒœã‚¿ãƒ³ --&gt;
    &lt;div class="mt-4 text-center"&gt;
        &lt;asp:Button ID="btnRefresh" runat="server" Text="ä¸€è¦§ã‚’æ›´æ–°" 
                    CssClass="btn btn-outline-primary" OnClick="btnRefresh_Click" /&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                        
                        <h6>Users/List.aspx.vb</h6>
                        <pre><code>Public Class List
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            ' åˆæœŸè¡¨ç¤ºæ™‚ã®å‡¦ç†
            InitializePage()
            LoadUsers()
        End If
    End Sub

    Private Sub InitializePage()
        ' ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚¨ãƒªã‚¢ã‚’éè¡¨ç¤ºã«
        pnlMessage.Visible = False
    End Sub

    Protected Sub gvUsers_RowDataBound(sender As Object, e As GridViewRowEventArgs) Handles gvUsers.RowDataBound
        ' è¡Œã®ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰æ™‚ã®å‡¦ç†ï¼ˆå¿…è¦ã«å¿œã˜ã¦ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºï¼‰
        If e.Row.RowType = DataControlRowType.DataRow Then
            ' ãƒã‚¦ã‚¹ã‚ªãƒ¼ãƒãƒ¼åŠ¹æœã‚’è¿½åŠ 
            e.Row.Attributes("onmouseover") = "this.style.backgroundColor='#f0f8ff'"
            e.Row.Attributes("onmouseout") = "this.style.backgroundColor=''"
        End If
    End Sub

    Protected Sub lnkUsername_Click(sender As Object, e As EventArgs)
        Try
            Dim lnk As LinkButton = CType(sender, LinkButton)
            Dim userId As Integer = Convert.ToInt32(lnk.CommandArgument)
            
            Response.Redirect($"Detail.aspx?id={userId}")
            
        Catch ex As Exception
            ShowMessage($"ãƒšãƒ¼ã‚¸é·ç§»ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub lnkDetail_Click(sender As Object, e As EventArgs)
        Try
            Dim lnk As LinkButton = CType(sender, LinkButton)
            Dim userId As Integer = Convert.ToInt32(lnk.CommandArgument)
            
            Response.Redirect($"Detail.aspx?id={userId}")
            
        Catch ex As Exception
            ShowMessage($"è©³ç´°ãƒšãƒ¼ã‚¸é·ç§»ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub lnkEdit_Click(sender As Object, e As EventArgs)
        Try
            Dim lnk As LinkButton = CType(sender, LinkButton)
            Dim userId As Integer = Convert.ToInt32(lnk.CommandArgument)
            
            Response.Redirect($"Edit.aspx?id={userId}")
            
        Catch ex As Exception
            ShowMessage($"ç·¨é›†ãƒšãƒ¼ã‚¸é·ç§»ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub btnRefresh_Click(sender As Object, e As EventArgs) Handles btnRefresh.Click
        Try
            LoadUsers()
            ShowMessage("ä¸€è¦§ã‚’æ›´æ–°ã—ã¾ã—ãŸã€‚", "alert-success")
            
        Catch ex As Exception
            ShowMessage($"æ›´æ–°å‡¦ç†ã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Private Sub LoadUsers()
        Try
            ' å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—
            Dim users As List(Of User) = UserDAO.GetAllUsers()
            
            ' GridViewã«ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‰
            gvUsers.DataSource = users
            gvUsers.DataBind()
            
            ' ç·ä»¶æ•°ã®è¡¨ç¤º
            lblTotalCount.Text = $"ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: {users.Count}ä»¶"
            
        Catch ex As Exception
            ShowMessage($"ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: {ex.Message}", "alert-danger")
            
            ' ã‚¨ãƒ©ãƒ¼æ™‚ã¯ç©ºã®GridViewã‚’è¡¨ç¤º
            gvUsers.DataSource = New List(Of User)()
            gvUsers.DataBind()
            lblTotalCount.Text = "ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ"
        End Try
    End Sub

    Private Sub ShowMessage(message As String, cssClass As String)
        lblMessage.Text = message
        lblMessage.CssClass = $"alert {cssClass} d-block"
        pnlMessage.Visible = True
    End Sub

    ''' &lt;summary&gt;
    ''' å¹´é½¢è¨ˆç®—ã®ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã‹ã‚‰ä½¿ç”¨ï¼‰
    ''' &lt;/summary&gt;
    Protected Function GetAge(birthDate As Object) As String
        If birthDate Is Nothing OrElse IsDBNull(birthDate) Then
            Return "-"
        End If
        
        Try
            Dim birth As DateTime = Convert.ToDateTime(birthDate)
            Dim age As Integer = DateTime.Today.Year - birth.Year
            
            ' èª•ç”Ÿæ—¥å‰ã®å ´åˆã¯1æ­³æ¸›ã‚‰ã™
            If DateTime.Today < birth.AddYears(age) Then
                age -= 1
            End If
            
            Return $"{age}æ­³"
            
        Catch
            Return "-"
        End Try
    End Function
End Class</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <ul>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãŒGridViewã§ç¾ã—ãè¡¨ç¤ºã•ã‚Œã‚‹</li>
                            <li>ç™»éŒ²ã•ã‚Œã¦ã„ã‚‹å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®åŸºæœ¬æƒ…å ±ãŒç¢ºèªã§ãã‚‹</li>
                            <li>è©³ç´°ãƒ»ç·¨é›†ãƒšãƒ¼ã‚¸ã¸ã®ãƒªãƒ³ã‚¯ãŒå‹•ä½œã™ã‚‹</li>
                            <li>ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ãŒè¡¨ç¤ºã•ã‚Œã‚‹</li>
                            <li>ä¸€è¦§æ›´æ–°ãƒœã‚¿ãƒ³ãŒå‹•ä½œã™ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">4.3 ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ã®å®Ÿè£…</h3>
                    <p>ã‚¯ã‚¨ãƒªã‚¹ãƒˆãƒªãƒ³ã‚°ã§ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å—ã‘å–ã‚Šã€è©³ç´°æƒ…å ±ã‚’è¡¨ç¤ºã™ã‚‹ç”»é¢ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

                    <!-- å®Ÿç¿’3 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 4-3: ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ï¼ˆDetail.aspxï¼‰ã®ä½œæˆ</h5>
                        <p>QueryStringã«ã‚ˆã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿å—ã‘å–ã‚Šã¨è©³ç´°æƒ…å ±è¡¨ç¤ºã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        
                        <h6>Users/Detail.aspx</h6>
                        <pre><code>&lt;%@ Page Title="ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°" Language="vb" MasterPageFile="~/Site.Master" AutoEventWireup="false" CodeBehind="Detail.aspx.vb" Inherits="UserManagementApp.Detail" %&gt;

&lt;asp:Content ID="Content1" ContentPlaceHolderID="head" runat="server"&gt;
&lt;/asp:Content&gt;

&lt;asp:Content ID="Content2" ContentPlaceHolderID="MainContent" runat="server"&gt;
    &lt;div class="row justify-content-center"&gt;
        &lt;div class="col-lg-8"&gt;
            &lt;!-- ãƒ‘ãƒ³ããšãƒŠãƒ“ --&gt;
            &lt;nav aria-label="breadcrumb" class="mb-3"&gt;
                &lt;ol class="breadcrumb"&gt;
                    &lt;li class="breadcrumb-item"&gt;&lt;a href="../Default.aspx"&gt;ãƒ›ãƒ¼ãƒ &lt;/a&gt;&lt;/li&gt;
                    &lt;li class="breadcrumb-item"&gt;&lt;a href="List.aspx"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§&lt;/a&gt;&lt;/li&gt;
                    &lt;li class="breadcrumb-item active" aria-current="page"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°&lt;/li&gt;
                &lt;/ol&gt;
            &lt;/nav&gt;

            &lt;!-- ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤ºã‚¨ãƒªã‚¢ --&gt;
            &lt;asp:Panel ID="pnlError" runat="server" Visible="false"&gt;
                &lt;div class="alert alert-danger"&gt;
                    &lt;asp:Label ID="lblError" runat="server"&gt;&lt;/asp:Label&gt;
                &lt;/div&gt;
            &lt;/asp:Panel&gt;

            &lt;!-- ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ã‚«ãƒ¼ãƒ‰ --&gt;
            &lt;asp:Panel ID="pnlUserDetail" runat="server" Visible="false"&gt;
                &lt;div class="card shadow"&gt;
                    &lt;div class="card-header bg-primary text-white"&gt;
                        &lt;h3 class="card-title mb-0"&gt;
                            &lt;i class="fas fa-user"&gt;&lt;/i&gt; ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°æƒ…å ±
                        &lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        &lt;div class="row"&gt;
                            &lt;!-- åŸºæœ¬æƒ…å ± --&gt;
                            &lt;div class="col-md-6"&gt;
                                &lt;h5 class="text-primary mb-3"&gt;åŸºæœ¬æƒ…å ±&lt;/h5&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ID&lt;/label&gt;
                                    &lt;div class="form-control-plaintext fw-bold"&gt;
                                        &lt;asp:Label ID="lblUserId" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼å&lt;/label&gt;
                                    &lt;div class="form-control-plaintext fw-bold text-primary"&gt;
                                        &lt;asp:Label ID="lblUsername" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;æ°å&lt;/label&gt;
                                    &lt;div class="form-control-plaintext fw-bold"&gt;
                                        &lt;asp:Label ID="lblFullName" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹&lt;/label&gt;
                                    &lt;div class="form-control-plaintext"&gt;
                                        &lt;asp:Label ID="lblEmail" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                            
                            &lt;!-- è©³ç´°æƒ…å ± --&gt;
                            &lt;div class="col-md-6"&gt;
                                &lt;h5 class="text-primary mb-3"&gt;è©³ç´°æƒ…å ±&lt;/h5&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;ç”Ÿå¹´æœˆæ—¥&lt;/label&gt;
                                    &lt;div class="form-control-plaintext"&gt;
                                        &lt;asp:Label ID="lblBirthDate" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;å¹´é½¢&lt;/label&gt;
                                    &lt;div class="form-control-plaintext"&gt;
                                        &lt;asp:Label ID="lblAge" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;ç™»éŒ²æ—¥æ™‚&lt;/label&gt;
                                    &lt;div class="form-control-plaintext"&gt;
                                        &lt;asp:Label ID="lblCreatedAt" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                                
                                &lt;div class="mb-3"&gt;
                                    &lt;label class="form-label text-muted"&gt;æœ€çµ‚æ›´æ–°æ—¥æ™‚&lt;/label&gt;
                                    &lt;div class="form-control-plaintext"&gt;
                                        &lt;asp:Label ID="lblUpdatedAt" runat="server"&gt;&lt;/asp:Label&gt;
                                    &lt;/div&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                        
                        &lt;hr /&gt;
                        
                        &lt;!-- æ“ä½œãƒœã‚¿ãƒ³ --&gt;
                        &lt;div class="d-flex justify-content-between"&gt;
                            &lt;div&gt;
                                &lt;asp:Button ID="btnEdit" runat="server" Text="ç·¨é›†" 
                                            CssClass="btn btn-warning btn-lg" OnClick="btnEdit_Click" /&gt;
                                &lt;asp:Button ID="btnDelete" runat="server" Text="å‰Šé™¤" 
                                            CssClass="btn btn-danger btn-lg ms-2" OnClick="btnDelete_Click"
                                            OnClientClick="return confirm('æœ¬å½“ã«å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿã“ã®æ“ä½œã¯å–ã‚Šæ¶ˆã›ã¾ã›ã‚“ã€‚');" /&gt;
                            &lt;/div&gt;
                            
                            &lt;div&gt;
                                &lt;a href="List.aspx" class="btn btn-secondary btn-lg"&gt;ä¸€è¦§ã«æˆ»ã‚‹&lt;/a&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/asp:Panel&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/asp:Content&gt;</code></pre>
                        
                        <h6>Users/Detail.aspx.vb</h6>
                        <pre><code>Public Class Detail
    Inherits System.Web.UI.Page

    Private Property CurrentUserId As Integer
        Get
            Return If(ViewState("UserId"), 0)
        End Get
        Set(value As Integer)
            ViewState("UserId") = value
        End Set
    End Property

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            LoadUserDetail()
        End If
    End Sub

    Private Sub LoadUserDetail()
        Try
            ' QueryStringã‹ã‚‰ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å–å¾—
            Dim userIdParam As String = Request.QueryString("id")
            
            If String.IsNullOrEmpty(userIdParam) Then
                ShowError("ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãŒæŒ‡å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚")
                Return
            End If
            
            Dim userId As Integer
            If Not Integer.TryParse(userIdParam, userId) OrElse userId <= 0 Then
                ShowError("ç„¡åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§ã™ã€‚")
                Return
            End If
            
            CurrentUserId = userId
            
            ' ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—
            Dim user As User = UserDAO.GetUserById(userId)
            
            If user Is Nothing Then
                ShowError($"ID: {userId} ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚")
                Return
            End If
            
            ' ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®è¡¨ç¤º
            DisplayUserInfo(user)
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}")
            ShowError($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ: {ex.Message}")
        End Try
    End Sub

    Private Sub DisplayUserInfo(user As User)
        Try
            ' åŸºæœ¬æƒ…å ±ã®è¡¨ç¤º
            lblUserId.Text = user.Id.ToString()
            lblUsername.Text = Server.HtmlEncode(user.Username)
            lblFullName.Text = Server.HtmlEncode(user.FullName)
            lblEmail.Text = Server.HtmlEncode(user.Email)
            
            ' ç”Ÿå¹´æœˆæ—¥ã¨å¹´é½¢ã®è¡¨ç¤º
            If user.BirthDate.HasValue Then
                lblBirthDate.Text = user.BirthDate.Value.ToString("yyyyå¹´MMæœˆddæ—¥")
                lblAge.Text = CalculateAge(user.BirthDate.Value).ToString() + "æ­³"
            Else
                lblBirthDate.Text = "æœªè¨­å®š"
                lblAge.Text = "-"
            End If
            
            ' æ—¥æ™‚æƒ…å ±ã®è¡¨ç¤º
            lblCreatedAt.Text = user.CreatedAt.ToString("yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†")
            lblUpdatedAt.Text = user.UpdatedAt.ToString("yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†")
            
            ' è©³ç´°ãƒ‘ãƒãƒ«ã‚’è¡¨ç¤º
            pnlUserDetail.Visible = True
            pnlError.Visible = False
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±è¡¨ç¤ºã‚¨ãƒ©ãƒ¼: {ex.Message}")
            ShowError("ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®è¡¨ç¤ºã«å¤±æ•—ã—ã¾ã—ãŸã€‚")
        End Try
    End Sub

    Protected Sub btnEdit_Click(sender As Object, e As EventArgs) Handles btnEdit.Click
        Try
            If CurrentUserId > 0 Then
                Response.Redirect($"Edit.aspx?id={CurrentUserId}")
            Else
                ShowError("ç·¨é›†å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚")
            End If
            
        Catch ex As Exception
            ShowError($"ç·¨é›†ãƒšãƒ¼ã‚¸ã¸ã®é·ç§»ã«å¤±æ•—ã—ã¾ã—ãŸ: {ex.Message}")
        End Try
    End Sub

    Protected Sub btnDelete_Click(sender As Object, e As EventArgs) Handles btnDelete.Click
        Try
            If CurrentUserId <= 0 Then
                ShowError("å‰Šé™¤å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼IDãŒå–å¾—ã§ãã¾ã›ã‚“ã€‚")
                Return
            End If
            
            ' ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤å‡¦ç†ï¼ˆStep 5ã§å®Ÿè£…äºˆå®šï¼‰
            ' UserDAO.DeleteUser(CurrentUserId)
            
            ' æš«å®šçš„ãªå‡¦ç†ï¼ˆStep 5ã¾ã§ï¼‰
            ShowError("å‰Šé™¤æ©Ÿèƒ½ã¯Step 5ã§å®Ÿè£…äºˆå®šã§ã™ã€‚")
            
        Catch ex As Exception
            ShowError($"ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å‰Šé™¤ã«å¤±æ•—ã—ã¾ã—ãŸ: {ex.Message}")
        End Try
    End Sub

    Private Sub ShowError(message As String)
        lblError.Text = Server.HtmlEncode(message)
        pnlError.Visible = True
        pnlUserDetail.Visible = False
    End Sub

    Private Function CalculateAge(birthDate As DateTime) As Integer
        Dim age As Integer = DateTime.Today.Year - birthDate.Year
        
        ' èª•ç”Ÿæ—¥å‰ã®å ´åˆã¯1æ­³æ¸›ã‚‰ã™
        If DateTime.Today < birthDate.AddYears(age) Then
            age -= 1
        End If
        
        Return age
    End Function
End Class</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <ul>
                            <li>QueryStringã§ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’æ­£ã—ãå—ã‘å–ã‚‹</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°æƒ…å ±ãŒç¾ã—ãè¡¨ç¤ºã•ã‚Œã‚‹</li>
                            <li>ç„¡åŠ¹ãªIDã‚„å­˜åœ¨ã—ãªã„ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°</li>
                            <li>å¹´é½¢è¨ˆç®—ãŒæ­£ç¢ºã«å‹•ä½œã™ã‚‹</li>
                            <li>ç·¨é›†ãƒ»å‰Šé™¤ãƒœã‚¿ãƒ³ã®ãƒšãƒ¼ã‚¸é·ç§»</li>
                            <li>ãƒ‘ãƒ³ããšãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹ä½¿ã„ã‚„ã™ã•</li>
                        </ul>
                    </div>

                    <div class="info">
                        <h6>ğŸ’¡ GridViewã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã®åŸºæœ¬æ©Ÿèƒ½</h6>
                        <ul>
                            <li><strong>ãƒ‡ãƒ¼ã‚¿ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°:</strong> DataSourceãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã§ç°¡å˜ã«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</li>
                            <li><strong>ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ:</strong> TemplateFieldã§æŸ”è»Ÿãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ</li>
                            <li><strong>ã‚¤ãƒ™ãƒ³ãƒˆå‡¦ç†:</strong> RowDataBoundã‚¤ãƒ™ãƒ³ãƒˆã§ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</li>
                            <li><strong>ã‚¹ã‚¿ã‚¤ãƒªãƒ³ã‚°:</strong> CSSã‚¯ãƒ©ã‚¹ã«ã‚ˆã‚‹è¦‹ãŸç›®ã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º</li>
                            <li><strong>åŸºæœ¬è¡¨ç¤º:</strong> AutoGenerateColumns="False"ã§åˆ—åˆ¶å¾¡</li>
                        </ul>
                    </div>

                    <!-- ç†è§£åº¦ç¢ºèª -->
                    <div class="quiz-container">
                        <h5>ASP.NETãƒ»VB.NETç†è§£åº¦ã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>GridViewã§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«æœ€ä½é™å¿…è¦ãªãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>QueryStringã§ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å–å¾—ã™ã‚‹VB.NETæ§‹æ–‡ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</li>
                            <li>For Eachæ–‡ã‚’ä½¿ã£ã¦List(Of User)ã®å…¨è¦ç´ ã‚’å‡¦ç†ã™ã‚‹ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</li>
                            <li>VB.NETã§æ–‡å­—åˆ—ã‚’æ•´æ•°ã«å¤‰æ›ã™ã‚‹å®‰å…¨ãªæ–¹æ³•ã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>GridViewã®TemplateFieldã®ç”¨é€”ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>Response.Redirectãƒ¡ã‚½ãƒƒãƒ‰ã®ç”¨é€”ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>DataSourceï¼ˆãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ï¼‰</li>
                                <li><code>Dim value As String = Request.QueryString("paramName")</code></li>
                                <li><code>For Each user As User In userList<br>&nbsp;&nbsp;&nbsp;&nbsp;' å‡¦ç†<br>Next</code></li>
                                <li>Integer.TryParse()ãƒ¡ã‚½ãƒƒãƒ‰ã€Convert.ToInt32()ãƒ¡ã‚½ãƒƒãƒ‰</li>
                                <li>è‡ªç”±ãªãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã§ãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ï¼ˆãƒªãƒ³ã‚¯ãƒœã‚¿ãƒ³ã€è¤‡æ•°é …ç›®ã®çµ„ã¿åˆã‚ã›ãªã©ï¼‰</li>
                                <li>åˆ¥ã®ãƒšãƒ¼ã‚¸ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã‚‹ãŸã‚ï¼ˆè©³ç´°ç”»é¢ã‚„ç·¨é›†ç”»é¢ã¸ã®é·ç§»ãªã©ï¼‰</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step3-user-registration.html" class="btn btn-secondary">â† å‰ã®ã‚¹ãƒ†ãƒƒãƒ—</a>
                        <a href="step5-user-update-delete.html" class="btn btn-primary">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°ãƒ»å‰Šé™¤ â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>