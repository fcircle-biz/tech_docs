<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET(VB) å®Ÿè·µãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ« Step 2 - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¨æ¥ç¶š</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ - ASP.NETç³»ãƒ†ãƒ¼ãƒ */
        .navbar {
            background-color: #1976d2;
        }

        .navbar-brand, .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500;
        }

        .navbar-nav .nav-link:hover {
            color: #bbdefb !important;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: white;
            border-right: 1px solid #dee2e6;
        }

        .sidebar .nav-link {
            color: #495057;
            font-weight: 500;
        }

        .sidebar .nav-link:hover {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .sidebar .nav-link.active {
            background-color: #1976d2 !important;
            color: white !important;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #1976d2;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1976d2;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }

        /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .step-number {
            background-color: #1976d2;
            color: white;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET VB ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«TOP</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ç›®æ¬¡
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="step1-environment-setup.html">Step 1: ç’°å¢ƒæ§‹ç¯‰ã¨ASP.NETåŸºç¤</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="step2-database-connection.html">Step 2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¨æ¥ç¶š</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-user-registration.html">Step 3: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ©Ÿèƒ½</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-list-detail.html">Step 4: ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§ãƒ»è©³ç´°è¡¨ç¤º</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-update-delete.html">Step 5: ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°ãƒ»å‰Šé™¤</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-testing-debug.html">Step 6: å‹•ä½œç¢ºèªã¨ãƒ‡ãƒãƒƒã‚°</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 2: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆã¨æ¥ç¶š</h1>
                    <div class="badge bg-primary">æ‰€è¦æ™‚é–“: 2.5æ™‚é–“</div>
                </div>

                <div id="step2">
                    <h2 class="chapter-title">SQL Serverãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®æ§‹ç¯‰ã¨ADO.NETæ¥ç¶š</h2>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ -->
                    <div class="highlight">
                        <h5>ã“ã®ã‚¹ãƒ†ãƒƒãƒ—ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li>Docker SQL Serverã‚³ãƒ³ãƒ†ãƒŠã®è©³ç´°è¨­å®šã¨ç®¡ç†</li>
                            <li>SSMS(æ—¥æœ¬èªç‰ˆ)ã«ã‚ˆã‚‹åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«è¨­è¨ˆ</li>
                            <li>ADO.NETã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šï¼ˆSqlConnectionã€SqlCommandï¼‰</li>
                            <li>VB.NETã§ã®ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚¯ãƒ©ã‚¹ï¼ˆDAOï¼‰ã®å®Ÿè£…</li>
                            <li>ä¾‹å¤–å‡¦ç†ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹</li>
                            <li>æ¥ç¶šæ–‡å­—åˆ—ã®ç®¡ç†ã¨Web.configè¨­å®š</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.1 SQL Serverã‚³ãƒ³ãƒ†ãƒŠã®è©³ç´°è¨­å®š</h3>
                    <p>Step 1ã§èµ·å‹•ã—ãŸSQL Serverã‚³ãƒ³ãƒ†ãƒŠã‚’æœ¬æ ¼é‹ç”¨å‘ã‘ã«è¨­å®šã—ã€æ°¸ç¶šåŒ–ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å¼·åŒ–ã—ã¾ã™ã€‚</p>
                    
                    <h4><span class="step-number">1</span>ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–ã®ãŸã‚ã®ãƒœãƒªãƒ¥ãƒ¼ãƒ è¨­å®š</h4>
                    <p>ã‚³ãƒ³ãƒ†ãƒŠã‚’å‰Šé™¤ã—ã¦ã‚‚ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆå¤±ã—ãªã„ã‚ˆã†ã€Dockerãƒœãƒªãƒ¥ãƒ¼ãƒ ã‚’è¨­å®šã—ã¾ã™ã€‚</p>
                    <pre><code># æ—¢å­˜ã‚³ãƒ³ãƒ†ãƒŠã®åœæ­¢ãƒ»å‰Šé™¤
docker stop sqlserver2019
docker rm sqlserver2019

# æ°¸ç¶šåŒ–ãƒœãƒªãƒ¥ãƒ¼ãƒ ä»˜ãã§SQL Serverã‚’èµ·å‹•
docker run -e "ACCEPT_EULA=Y" -e "MSSQL_SA_PASSWORD=YourPassword123!" `
   -p 1433:1433 --name sqlserver2019 `
   -v sqlserver_data:/var/opt/mssql `
   -d mcr.microsoft.com/mssql/server:2019-latest

# ãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ç¢ºèª
docker volume ls
docker volume inspect sqlserver_data</code></pre>

                    <h4><span class="step-number">2</span>æ¥ç¶šãƒ†ã‚¹ãƒˆã¨ã‚³ãƒ³ãƒ†ãƒŠç®¡ç†</h4>
                    <pre><code># ã‚³ãƒ³ãƒ†ãƒŠã®çŠ¶æ…‹ç¢ºèª
docker ps -a

# ãƒ­ã‚°ã®ç¢ºèª
docker logs sqlserver2019

# ã‚³ãƒ³ãƒ†ãƒŠå†…ã§SQL Serverã®çŠ¶æ…‹ç¢ºèª
docker exec -it sqlserver2019 /opt/mssql-tools/bin/sqlcmd `
   -S localhost -U SA -P "YourPassword123!" `
   -Q "SELECT @@VERSION;"

# ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã®ç¢ºèª
docker stats sqlserver2019</code></pre>

                    <div class="info">
                        <h6>ğŸ’¡ Dockerç®¡ç†ã®ãƒã‚¤ãƒ³ãƒˆ</h6>
                        <ul>
                            <li><strong>è‡ªå‹•èµ·å‹•è¨­å®š:</strong> <code>--restart unless-stopped</code> ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§PCå†èµ·å‹•æ™‚ã‚‚è‡ªå‹•èµ·å‹•</li>
                            <li><strong>ãƒ¡ãƒ¢ãƒªåˆ¶é™:</strong> <code>--memory=2g</code> ã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’åˆ¶é™</li>
                            <li><strong>ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—:</strong> å®šæœŸçš„ã«ãƒœãƒªãƒ¥ãƒ¼ãƒ ã®ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‚’ä½œæˆ</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.2 SSMSã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­è¨ˆ</h3>
                    <p>SQL Server Management Studio (SSMS) æ—¥æœ¬èªç‰ˆã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ç”¨ã®ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’è¨­è¨ˆãƒ»ä½œæˆã—ã¾ã™ã€‚</p>

                    <h4><span class="step-number">1</span>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ä½œæˆ</h4>
                    <ol>
                        <li>SSMSã‚’èµ·å‹•ã—ã€SQL Serverã«æ¥ç¶š</li>
                        <li>ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚¨ã‚¯ã‚¹ãƒ—ãƒ­ãƒ¼ãƒ©ãƒ¼ã§ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã‚’å³ã‚¯ãƒªãƒƒã‚¯</li>
                        <li>ã€Œæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã‚’é¸æŠ</li>
                        <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å: <code>UserManagementDB</code></li>
                        <li>è¨­å®šã‚’ç¢ºèªã—ã¦ã€ŒOKã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                    </ol>

                    <h4><span class="step-number">2</span>usersãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ</h4>
                    <p>æ–°ã—ã„ã‚¯ã‚¨ãƒªã‚¦ã‚£ãƒ³ãƒ‰ã‚¦ã§ä»¥ä¸‹ã®SQLã‚’å®Ÿè¡Œ:</p>
                    <pre><code>USE UserManagementDB;
GO

-- usersãƒ†ãƒ¼ãƒ–ãƒ«ã®ä½œæˆ
CREATE TABLE users (
    id INT IDENTITY(1,1) PRIMARY KEY,
    username NVARCHAR(50) NOT NULL UNIQUE,
    email NVARCHAR(100) NOT NULL,
    full_name NVARCHAR(100) NOT NULL,
    birth_date DATE,
    created_at DATETIME2 DEFAULT GETDATE(),
    updated_at DATETIME2 DEFAULT GETDATE()
);

-- ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã®ä½œæˆï¼ˆãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼‰
CREATE INDEX IX_users_username ON users(username);
CREATE INDEX IX_users_email ON users(email);

-- ãƒ†ãƒ¼ãƒ–ãƒ«æ§‹é€ ã®ç¢ºèª
SELECT 
    COLUMN_NAME,
    DATA_TYPE,
    CHARACTER_MAXIMUM_LENGTH,
    IS_NULLABLE,
    COLUMN_DEFAULT
FROM INFORMATION_SCHEMA.COLUMNS 
WHERE TABLE_NAME = 'users' 
ORDER BY ORDINAL_POSITION;</code></pre>

                    <h4><span class="step-number">3</span>ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥</h4>
                    <pre><code>-- ãƒ†ã‚¹ãƒˆç”¨ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã®æŒ¿å…¥
INSERT INTO users (username, email, full_name, birth_date) VALUES
('taro_tanaka', 'taro@example.com', 'ç”°ä¸­å¤ªéƒ', '1990-05-15'),
('hanako_sato', 'hanako@example.com', 'ä½è—¤èŠ±å­', '1985-08-22'),
('jiro_suzuki', 'jiro@example.com', 'éˆ´æœ¨æ¬¡éƒ', '1992-12-03'),
('yuki_takahashi', 'yuki@example.com', 'é«˜æ©‹é›ª', '1988-03-18'),
('ichiro_yamada', 'ichiro@example.com', 'å±±ç”°ä¸€éƒ', '1995-11-30');

-- ãƒ‡ãƒ¼ã‚¿ã®ç¢ºèª
SELECT id, username, email, full_name, birth_date, 
       created_at, updated_at 
FROM users 
ORDER BY created_at;</code></pre>

                    <!-- å®Ÿç¿’1 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 2-1: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ</h5>
                        <p>ASP.NETã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‚‰SQL Serverã«æ¥ç¶šã™ã‚‹ãŸã‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>æ‰‹é †</h6>
                        <ol>
                            <li>Visual Studioã§UserManagementAppãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’é–‹ã</li>
                            <li>App_Codeãƒ•ã‚©ãƒ«ãƒ€ã‚’ä½œæˆï¼ˆå­˜åœ¨ã—ãªã„å ´åˆï¼‰</li>
                            <li>DatabaseConfig.vbãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ</li>
                            <li>Web.configã«æ¥ç¶šæ–‡å­—åˆ—ã‚’è¿½åŠ </li>
                        </ol>
                        
                        <h6>App_Code/DatabaseConfig.vb</h6>
                        <pre><code>Imports System.Configuration
Imports System.Data.SqlClient

''' &lt;summary&gt;
''' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«é–¢ã™ã‚‹è¨­å®šã‚’ç®¡ç†ã™ã‚‹ã‚¯ãƒ©ã‚¹
''' &lt;/summary&gt;
Public Class DatabaseConfig
    
    ''' &lt;summary&gt;
    ''' æ¥ç¶šæ–‡å­—åˆ—ã‚’å–å¾—ã™ã‚‹
    ''' &lt;/summary&gt;
    ''' &lt;returns&gt;SQL Serveræ¥ç¶šæ–‡å­—åˆ—&lt;/returns&gt;
    Public Shared Function GetConnectionString() As String
        Try
            ' Web.configã‹ã‚‰æ¥ç¶šæ–‡å­—åˆ—ã‚’å–å¾—
            Dim connectionString As String = ConfigurationManager.ConnectionStrings("DefaultConnection").ConnectionString
            
            If String.IsNullOrEmpty(connectionString) Then
                Throw New InvalidOperationException("æ¥ç¶šæ–‡å­—åˆ—ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚Web.configã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚")
            End If
            
            Return connectionString
            
        Catch ex As Exception
            ' ãƒ­ã‚°å‡ºåŠ›ï¼ˆå®Ÿéš›ã®å®Ÿè£…ã§ã¯é©åˆ‡ãªãƒ­ã‚°å‡ºåŠ›ã‚’è¡Œã†ï¼‰
            System.Diagnostics.Debug.WriteLine($"æ¥ç¶šæ–‡å­—åˆ—å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Throw New Exception("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šè¨­å®šã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", ex)
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã®ãƒ†ã‚¹ãƒˆ
    ''' &lt;/summary&gt;
    ''' &lt;returns&gt;æ¥ç¶šãƒ†ã‚¹ãƒˆçµæœï¼ˆTrue: æˆåŠŸ, False: å¤±æ•—ï¼‰&lt;/returns&gt;
    Public Shared Function TestConnection() As Boolean
        Try
            Using connection As New SqlConnection(GetConnectionString())
                connection.Open()
                
                ' ç°¡å˜ãªã‚¯ã‚¨ãƒªã§ãƒ†ã‚¹ãƒˆ
                Using command As New SqlCommand("SELECT 1", connection)
                    Dim result As Object = command.ExecuteScalar()
                    Return result IsNot Nothing AndAlso CInt(result) = 1
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Return False
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®å­˜åœ¨ç¢ºèª
    ''' &lt;/summary&gt;
    ''' &lt;param name="databaseName"&gt;ç¢ºèªã™ã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å&lt;/param&gt;
    ''' &lt;returns&gt;å­˜åœ¨ç¢ºèªçµæœ&lt;/returns&gt;
    Public Shared Function DatabaseExists(databaseName As String) As Boolean
        Try
            Using connection As New SqlConnection(GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT COUNT(*) FROM sys.databases WHERE name = @DatabaseName"
                Using command As New SqlCommand(query, connection)
                    command.Parameters.AddWithValue("@DatabaseName", databaseName)
                    
                    Dim count As Integer = CInt(command.ExecuteScalar())
                    Return count > 0
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å­˜åœ¨ç¢ºèªã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Return False
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ†ãƒ¼ãƒ–ãƒ«ã®å­˜åœ¨ç¢ºèª
    ''' &lt;/summary&gt;
    ''' &lt;param name="tableName"&gt;ç¢ºèªã™ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«å&lt;/param&gt;
    ''' &lt;returns&gt;å­˜åœ¨ç¢ºèªçµæœ&lt;/returns&gt;
    Public Shared Function TableExists(tableName As String) As Boolean
        Try
            Using connection As New SqlConnection(GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT COUNT(*) FROM INFORMATION_SCHEMA.TABLES WHERE TABLE_NAME = @TableName"
                Using command As New SqlCommand(query, connection)
                    command.Parameters.AddWithValue("@TableName", tableName)
                    
                    Dim count As Integer = CInt(command.ExecuteScalar())
                    Return count > 0
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ†ãƒ¼ãƒ–ãƒ«å­˜åœ¨ç¢ºèªã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Return False
        End Try
    End Function
End Class</code></pre>
                        
                        <h6>Web.config (æ¥ç¶šæ–‡å­—åˆ—ã®è¿½åŠ )</h6>
                        <pre><code>&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;configuration&gt;
  &lt;connectionStrings&gt;
    &lt;add name="DefaultConnection" 
         connectionString="Server=localhost,1433;Database=UserManagementDB;User Id=sa;Password=YourPassword123!;TrustServerCertificate=True;" 
         providerName="System.Data.SqlClient" /&gt;
  &lt;/connectionStrings&gt;
  
  &lt;appSettings&gt;
    &lt;add key="DatabaseConnectionTimeout" value="30" /&gt;
    &lt;add key="EnableDatabaseLogging" value="true" /&gt;
  &lt;/appSettings&gt;

  &lt;system.web&gt;
    &lt;compilation debug="true" targetFramework="4.8" /&gt;
    &lt;httpRuntime targetFramework="4.8" /&gt;
  &lt;/system.web&gt;
&lt;/configuration&gt;</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <ul>
                            <li>DatabaseConfig.vbãŒæ­£å¸¸ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹</li>
                            <li>Web.configã®æ¥ç¶šæ–‡å­—åˆ—ãŒæ­£ã—ãè¨­å®šã•ã‚Œã‚‹</li>
                            <li>TestConnection()ãƒ¡ã‚½ãƒƒãƒ‰ãŒTrueã‚’è¿”ã™</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.3 UserDAOã‚¯ãƒ©ã‚¹ã®å®Ÿè£…</h3>
                    <p>ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆï¼ˆDAOï¼‰ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®æ“ä½œã‚’è¡Œã†ã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <!-- å®Ÿç¿’2 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 2-2: UserDAOã‚¯ãƒ©ã‚¹ã®åŸºæœ¬å®Ÿè£…</h5>
                        <p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®usersãƒ†ãƒ¼ãƒ–ãƒ«ã«å¯¾ã™ã‚‹CRUDæ“ä½œã‚’è¡Œã†DAOã‚¯ãƒ©ã‚¹ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        
                        <h6>App_Code/UserDAO.vb</h6>
                        <pre><code>Imports System.Data.SqlClient
Imports System.Data

''' &lt;summary&gt;
''' ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¡¨ã™ãƒ‡ãƒ¼ã‚¿ã‚¯ãƒ©ã‚¹
''' &lt;/summary&gt;
Public Class User
    Public Property Id As Integer
    Public Property Username As String
    Public Property Email As String
    Public Property FullName As String
    Public Property BirthDate As Date?
    Public Property CreatedAt As DateTime
    Public Property UpdatedAt As DateTime
    
    ''' &lt;summary&gt;
    ''' ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    ''' &lt;/summary&gt;
    Public Sub New()
        ' åˆæœŸå€¤è¨­å®š
        Id = 0
        Username = ""
        Email = ""
        FullName = ""
        BirthDate = Nothing
        CreatedAt = DateTime.Now
        UpdatedAt = DateTime.Now
    End Sub
    
    ''' &lt;summary&gt;
    ''' ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    ''' &lt;/summary&gt;
    Public Sub New(username As String, email As String, fullName As String, Optional birthDate As Date? = Nothing)
        Me.New()
        Me.Username = username
        Me.Email = email
        Me.FullName = fullName
        Me.BirthDate = birthDate
    End Sub
    
    ''' &lt;summary&gt;
    ''' ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®æ–‡å­—åˆ—è¡¨ç¾
    ''' &lt;/summary&gt;
    Public Overrides Function ToString() As String
        Return $"{Id}: {FullName} ({Username})"
    End Function
End Class

''' &lt;summary&gt;
''' ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆ
''' &lt;/summary&gt;
Public Class UserDAO
    
    ''' &lt;summary&gt;
    ''' å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—ã™ã‚‹
    ''' &lt;/summary&gt;
    ''' &lt;returns&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒªã‚¹ãƒˆ&lt;/returns&gt;
    Public Shared Function GetAllUsers() As List(Of User)
        Dim users As New List(Of User)()
        
        Try
            Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT id, username, email, full_name, birth_date, created_at, updated_at FROM users ORDER BY created_at DESC"
                
                Using command As New SqlCommand(query, connection)
                    Using reader As SqlDataReader = command.ExecuteReader()
                        While reader.Read()
                            Dim user As New User() With {
                                .Id = reader.GetInt32("id"),
                                .Username = reader.GetString("username"),
                                .Email = reader.GetString("email"),
                                .FullName = reader.GetString("full_name"),
                                .BirthDate = If(reader.IsDBNull("birth_date"), Nothing, reader.GetDateTime("birth_date")),
                                .CreatedAt = reader.GetDateTime("created_at"),
                                .UpdatedAt = reader.GetDateTime("updated_at")
                            }
                            users.Add(user)
                        End While
                    End Using
                End Using
            End Using
            
        Catch ex As SqlException
            ' SQL Serverå›ºæœ‰ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
            System.Diagnostics.Debug.WriteLine($"SQL ã‚¨ãƒ©ãƒ¼ (ã‚¨ãƒ©ãƒ¼ç•ªå·: {ex.Number}): {ex.Message}")
            Throw New Exception($"ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸã€‚ã‚¨ãƒ©ãƒ¼ç•ªå·: {ex.Number}", ex)
            
        Catch ex As Exception
            ' ãã®ä»–ã®ã‚¨ãƒ©ãƒ¼å‡¦ç†
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Throw New Exception("ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", ex)
        End Try
        
        Return users
    End Function
    
    ''' &lt;summary&gt;
    ''' IDã«ã‚ˆã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—
    ''' &lt;/summary&gt;
    ''' &lt;param name="userId"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ID&lt;/param&gt;
    ''' &lt;returns&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼ˆè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯Nothingï¼‰&lt;/returns&gt;
    Public Shared Function GetUserById(userId As Integer) As User
        Try
            Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT id, username, email, full_name, birth_date, created_at, updated_at FROM users WHERE id = @UserId"
                
                Using command As New SqlCommand(query, connection)
                    command.Parameters.AddWithValue("@UserId", userId)
                    
                    Using reader As SqlDataReader = command.ExecuteReader()
                        If reader.Read() Then
                            Return New User() With {
                                .Id = reader.GetInt32("id"),
                                .Username = reader.GetString("username"),
                                .Email = reader.GetString("email"),
                                .FullName = reader.GetString("full_name"),
                                .BirthDate = If(reader.IsDBNull("birth_date"), Nothing, reader.GetDateTime("birth_date")),
                                .CreatedAt = reader.GetDateTime("created_at"),
                                .UpdatedAt = reader.GetDateTime("updated_at")
                            }
                        Else
                            Return Nothing
                        End If
                    End Using
                End Using
            End Using
            
        Catch ex As SqlException
            System.Diagnostics.Debug.WriteLine($"SQL ã‚¨ãƒ©ãƒ¼ (ID: {userId}): {ex.Message}")
            Throw New Exception($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ID: {userId}", ex)
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼ (ID: {userId}): {ex.Message}")
            Throw New Exception($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ID: {userId}", ex)
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ã‚ˆã‚‹æ¤œç´¢
    ''' &lt;/summary&gt;
    ''' &lt;param name="username"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼å&lt;/param&gt;
    ''' &lt;returns&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ï¼ˆè¦‹ã¤ã‹ã‚‰ãªã„å ´åˆã¯Nothingï¼‰&lt;/returns&gt;
    Public Shared Function GetUserByUsername(username As String) As User
        If String.IsNullOrEmpty(username) Then
            Return Nothing
        End If
        
        Try
            Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT id, username, email, full_name, birth_date, created_at, updated_at FROM users WHERE username = @Username"
                
                Using command As New SqlCommand(query, connection)
                    command.Parameters.AddWithValue("@Username", username.Trim())
                    
                    Using reader As SqlDataReader = command.ExecuteReader()
                        If reader.Read() Then
                            Return New User() With {
                                .Id = reader.GetInt32("id"),
                                .Username = reader.GetString("username"),
                                .Email = reader.GetString("email"),
                                .FullName = reader.GetString("full_name"),
                                .BirthDate = If(reader.IsDBNull("birth_date"), Nothing, reader.GetDateTime("birth_date")),
                                .CreatedAt = reader.GetDateTime("created_at"),
                                .UpdatedAt = reader.GetDateTime("updated_at")
                            }
                        Else
                            Return Nothing
                        End If
                    End Using
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼åæ¤œç´¢ã‚¨ãƒ©ãƒ¼ ({username}): {ex.Message}")
            Throw New Exception($"ãƒ¦ãƒ¼ã‚¶ãƒ¼åã«ã‚ˆã‚‹æ¤œç´¢ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼å: {username}", ex)
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã®å–å¾—
    ''' &lt;/summary&gt;
    ''' &lt;returns&gt;ç·ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°&lt;/returns&gt;
    Public Shared Function GetUserCount() As Integer
        Try
            Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT COUNT(*) FROM users"
                
                Using command As New SqlCommand(query, connection)
                    Return CInt(command.ExecuteScalar())
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}")
            Throw New Exception("ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸã€‚", ex)
        End Try
    End Function
    
    ''' &lt;summary&gt;
    ''' ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®é‡è¤‡ãƒã‚§ãƒƒã‚¯
    ''' &lt;/summary&gt;
    ''' &lt;param name="username"&gt;ãƒã‚§ãƒƒã‚¯ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼å&lt;/param&gt;
    ''' &lt;param name="excludeUserId"&gt;é™¤å¤–ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼IDï¼ˆæ›´æ–°æ™‚ã«ä½¿ç”¨ï¼‰&lt;/param&gt;
    ''' &lt;returns&gt;é‡è¤‡ã—ã¦ã„ã‚‹å ´åˆTrue&lt;/returns&gt;
    Public Shared Function IsUsernameExists(username As String, Optional excludeUserId As Integer = 0) As Boolean
        If String.IsNullOrEmpty(username) Then
            Return False
        End If
        
        Try
            Using connection As New SqlConnection(DatabaseConfig.GetConnectionString())
                connection.Open()
                
                Dim query As String = "SELECT COUNT(*) FROM users WHERE username = @Username"
                If excludeUserId > 0 Then
                    query &= " AND id != @ExcludeUserId"
                End If
                
                Using command As New SqlCommand(query, connection)
                    command.Parameters.AddWithValue("@Username", username.Trim())
                    If excludeUserId > 0 Then
                        command.Parameters.AddWithValue("@ExcludeUserId", excludeUserId)
                    End If
                    
                    Return CInt(command.ExecuteScalar()) > 0
                End Using
            End Using
            
        Catch ex As Exception
            System.Diagnostics.Debug.WriteLine($"ãƒ¦ãƒ¼ã‚¶ãƒ¼åé‡è¤‡ãƒã‚§ãƒƒã‚¯ã‚¨ãƒ©ãƒ¼ ({username}): {ex.Message}")
            Throw New Exception($"ãƒ¦ãƒ¼ã‚¶ãƒ¼åã®é‡è¤‡ãƒã‚§ãƒƒã‚¯ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼å: {username}", ex)
        End Try
    End Function
End Class</code></pre>
                        
                        <h6>æœŸå¾…ã•ã‚Œã‚‹çµæœ</h6>
                        <ul>
                            <li>UserDAOã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã‚‹</li>
                            <li>GetAllUsers()ãƒ¡ã‚½ãƒƒãƒ‰ã§ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒå–å¾—ã§ãã‚‹</li>
                            <li>GetUserById()ãƒ¡ã‚½ãƒƒãƒ‰ã§ç‰¹å®šãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå–å¾—ã§ãã‚‹</li>
                            <li>é©åˆ‡ãªä¾‹å¤–å‡¦ç†ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã‚‹</li>
                        </ul>
                    </div>

                    <h3 class="section-title">2.4 æ¥ç¶šãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã®ä½œæˆ</h3>
                    <p>å®Ÿè£…ã—ãŸDAOã‚¯ãƒ©ã‚¹ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚</p>

                    <!-- å®Ÿç¿’3 -->
                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 2-3: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ã®å®Ÿè£…</h5>
                        <p>DAOã‚¯ãƒ©ã‚¹ã®å„æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚</p>
                        
                        <h6>DatabaseTest.aspx</h6>
                        <pre><code>&lt;%@ Page Language="vb" AutoEventWireup="false" CodeBehind="DatabaseTest.aspx.vb" Inherits="UserManagementApp.DatabaseTest" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ&lt;/title&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div class="container mt-5"&gt;
            &lt;h1 class="text-primary"&gt;ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆ&lt;/h1&gt;
            
            &lt;div class="row mt-4"&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;div class="card"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;æ¥ç¶šãƒ†ã‚¹ãƒˆ&lt;/h5&gt;
                            &lt;asp:Button ID="btnTestConnection" runat="server" Text="æ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œ" CssClass="btn btn-primary" OnClick="btnTestConnection_Click" /&gt;
                            &lt;asp:Button ID="btnGetUserCount" runat="server" Text="ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°å–å¾—" CssClass="btn btn-info ms-2" OnClick="btnGetUserCount_Click" /&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                
                &lt;div class="col-md-6"&gt;
                    &lt;div class="card"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢&lt;/h5&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="txtUserId" class="form-label"&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼ID:&lt;/label&gt;
                                &lt;asp:TextBox ID="txtUserId" runat="server" CssClass="form-control" placeholder="ä¾‹: 1"&gt;&lt;/asp:TextBox&gt;
                            &lt;/div&gt;
                            &lt;asp:Button ID="btnSearchById" runat="server" Text="IDæ¤œç´¢" CssClass="btn btn-success" OnClick="btnSearchById_Click" /&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="row mt-4"&gt;
                &lt;div class="col-12"&gt;
                    &lt;div class="card"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§&lt;/h5&gt;
                            &lt;asp:Button ID="btnGetAllUsers" runat="server" Text="å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—" CssClass="btn btn-warning mb-3" OnClick="btnGetAllUsers_Click" /&gt;
                            &lt;asp:GridView ID="gvUsers" runat="server" CssClass="table table-striped" AutoGenerateColumns="False"&gt;
                                &lt;Columns&gt;
                                    &lt;asp:BoundField DataField="Id" HeaderText="ID" /&gt;
                                    &lt;asp:BoundField DataField="Username" HeaderText="ãƒ¦ãƒ¼ã‚¶ãƒ¼å" /&gt;
                                    &lt;asp:BoundField DataField="Email" HeaderText="ãƒ¡ãƒ¼ãƒ«" /&gt;
                                    &lt;asp:BoundField DataField="FullName" HeaderText="æ°å" /&gt;
                                    &lt;asp:BoundField DataField="BirthDate" HeaderText="ç”Ÿå¹´æœˆæ—¥" DataFormatString="{0:yyyy/MM/dd}" /&gt;
                                    &lt;asp:BoundField DataField="CreatedAt" HeaderText="ä½œæˆæ—¥æ™‚" DataFormatString="{0:yyyy/MM/dd HH:mm}" /&gt;
                                &lt;/Columns&gt;
                            &lt;/asp:GridView&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="row mt-4"&gt;
                &lt;div class="col-12"&gt;
                    &lt;div class="card"&gt;
                        &lt;div class="card-body"&gt;
                            &lt;h5 class="card-title"&gt;ãƒ†ã‚¹ãƒˆçµæœ&lt;/h5&gt;
                            &lt;asp:Panel ID="pnlResults" runat="server" CssClass="mt-3"&gt;
                                &lt;asp:Label ID="lblResults" runat="server" CssClass="alert d-block"&gt;&lt;/asp:Label&gt;
                            &lt;/asp:Panel&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                        <h6>DatabaseTest.aspx.vb</h6>
                        <pre><code>Public Class DatabaseTest
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        If Not IsPostBack Then
            pnlResults.Visible = False
        End If
    End Sub

    Protected Sub btnTestConnection_Click(sender As Object, e As EventArgs) Handles btnTestConnection.Click
        Try
            Dim isConnected As Boolean = DatabaseConfig.TestConnection()
            
            If isConnected Then
                ShowMessage("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæˆåŠŸï¼", "alert-success")
                
                ' è¿½åŠ æƒ…å ±ã®è¡¨ç¤º
                Dim dbExists As Boolean = DatabaseConfig.DatabaseExists("UserManagementDB")
                Dim tableExists As Boolean = DatabaseConfig.TableExists("users")
                
                Dim additionalInfo As String = $"
                    &lt;br&gt;&lt;strong&gt;è©³ç´°æƒ…å ±:&lt;/strong&gt;
                    &lt;br&gt;â€¢ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ 'UserManagementDB': {If(dbExists, "å­˜åœ¨", "æœªä½œæˆ")}
                    &lt;br&gt;â€¢ ãƒ†ãƒ¼ãƒ–ãƒ« 'users': {If(tableExists, "å­˜åœ¨", "æœªä½œæˆ")}"
                
                lblResults.Text &= additionalInfo
            Else
                ShowMessage("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã«å¤±æ•—ã—ã¾ã—ãŸã€‚è¨­å®šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚", "alert-danger")
            End If
            
        Catch ex As Exception
            ShowMessage($"æ¥ç¶šãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub btnGetUserCount_Click(sender As Object, e As EventArgs) Handles btnGetUserCount.Click
        Try
            Dim userCount As Integer = UserDAO.GetUserCount()
            ShowMessage($"ç™»éŒ²ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°: {userCount}äºº", "alert-info")
            
        Catch ex As Exception
            ShowMessage($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub btnSearchById_Click(sender As Object, e As EventArgs) Handles btnSearchById.Click
        Try
            Dim userIdText As String = txtUserId.Text.Trim()
            
            If String.IsNullOrEmpty(userIdText) Then
                ShowMessage("ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", "alert-warning")
                Return
            End If
            
            Dim userId As Integer
            If Not Integer.TryParse(userIdText, userId) Then
                ShowMessage("æœ‰åŠ¹ãªãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚", "alert-warning")
                Return
            End If
            
            Dim user As User = UserDAO.GetUserById(userId)
            
            If user IsNot Nothing Then
                Dim userInfo As String = $"
                    &lt;strong&gt;ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±:&lt;/strong&gt;
                    &lt;br&gt;â€¢ ID: {user.Id}
                    &lt;br&gt;â€¢ ãƒ¦ãƒ¼ã‚¶ãƒ¼å: {user.Username}
                    &lt;br&gt;â€¢ æ°å: {user.FullName}
                    &lt;br&gt;â€¢ ãƒ¡ãƒ¼ãƒ«: {user.Email}
                    &lt;br&gt;â€¢ ç”Ÿå¹´æœˆæ—¥: {If(user.BirthDate.HasValue, user.BirthDate.Value.ToString("yyyyå¹´MMæœˆddæ—¥"), "æœªè¨­å®š")}
                    &lt;br&gt;â€¢ ä½œæˆæ—¥: {user.CreatedAt:yyyyå¹´MMæœˆddæ—¥ HHæ™‚mmåˆ†}"
                
                ShowMessage(userInfo, "alert-success")
            Else
                ShowMessage($"ID: {userId} ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚", "alert-warning")
            End If
            
        Catch ex As Exception
            ShowMessage($"ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¤œç´¢ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert-danger")
        End Try
    End Sub

    Protected Sub btnGetAllUsers_Click(sender As Object, e As EventArgs) Handles btnGetAllUsers.Click
        Try
            Dim users As List(Of User) = UserDAO.GetAllUsers()
            
            gvUsers.DataSource = users
            gvUsers.DataBind()
            
            ShowMessage($"å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’å–å¾—ã—ã¾ã—ãŸã€‚({users.Count}ä»¶)", "alert-success")
            
        Catch ex As Exception
            ShowMessage($"å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã‚¨ãƒ©ãƒ¼: {ex.Message}", "alert-danger")
            gvUsers.DataSource = Nothing
            gvUsers.DataBind()
        End Try
    End Sub

    Private Sub ShowMessage(message As String, cssClass As String)
        lblResults.Text = message
        lblResults.CssClass = $"alert {cssClass} d-block"
        pnlResults.Visible = True
    End Sub
End Class</code></pre>
                        
                        <h6>ãƒ†ã‚¹ãƒˆæ‰‹é †</h6>
                        <ol>
                            <li>DatabaseTest.aspxã‚’ãƒ–ãƒ©ã‚¦ã‚¶ã§é–‹ã</li>
                            <li>ã€Œæ¥ç¶šãƒ†ã‚¹ãƒˆå®Ÿè¡Œã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º</li>
                            <li>ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°å–å¾—ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ ã€Œ5äººã€ã¨è¡¨ç¤º</li>
                            <li>ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã€Œ1ã€ã‚’å…¥åŠ›ã—ã¦ã€ŒIDæ¤œç´¢ã€ â†’ ç”°ä¸­å¤ªéƒã®æƒ…å ±è¡¨ç¤º</li>
                            <li>ã€Œå…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼å–å¾—ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ â†’ GridViewã«ãƒ‡ãƒ¼ã‚¿è¡¨ç¤º</li>
                        </ol>
                    </div>

                    <div class="warning">
                        <h6>âš ï¸ ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°</h6>
                        <ul>
                            <li><strong>æ¥ç¶šã‚¨ãƒ©ãƒ¼:</strong> Docker SQLã‚³ãƒ³ãƒ†ãƒŠãŒèµ·å‹•ã—ã¦ã„ã‚‹ã‹ç¢ºèª</li>
                            <li><strong>ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œãªã„:</strong> Step 2.2ã§ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ã‚’æŒ¿å…¥ã—ãŸã‹ç¢ºèª</li>
                            <li><strong>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼:</strong> Web.configã®æ¥ç¶šæ–‡å­—åˆ—è¨­å®šã‚’ç¢ºèª</li>
                            <li><strong>æ¨©é™ã‚¨ãƒ©ãƒ¼:</strong> SQL Serverã®saèªè¨¼ãŒæœ‰åŠ¹ã«ãªã£ã¦ã„ã‚‹ã‹ç¢ºèª</li>
                        </ul>
                    </div>

                    <!-- ç†è§£åº¦ç¢ºèª -->
                    <div class="quiz-container">
                        <h5>ASP.NETãƒ»VB.NETç†è§£åº¦ã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>ADO.NETã§SQL Serverã«æ¥ç¶šã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã™ã‚‹ä¸»è¦ãªã‚¯ãƒ©ã‚¹åã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>VB.NETã§Try-Catchæ–‡ã‚’ä½¿ã£ãŸä¾‹å¤–å‡¦ç†ã®åŸºæœ¬æ§‹æ–‡ã‚’æ›¸ã„ã¦ãã ã•ã„ã€‚</li>
                            <li>Web.configãƒ•ã‚¡ã‚¤ãƒ«ã§æ¥ç¶šæ–‡å­—åˆ—ã‚’å®šç¾©ã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³åã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>SqlCommand.Parameters.AddWithValue()ãƒ¡ã‚½ãƒƒãƒ‰ã‚’ä½¿ã†ç†ç”±ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                            <li>VB.NETã§ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã™ã‚‹éš›ã«ä½¿ç”¨ã™ã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>Usingã‚¹ãƒ†ãƒ¼ãƒˆãƒ¡ãƒ³ãƒˆã®ç”¨é€”ã¨åˆ©ç‚¹ã‚’èª¬æ˜ã—ã¦ãã ã•ã„ã€‚</li>
                        </ol>
                        <details>
                            <summary>è§£ç­”ä¾‹</summary>
                            <ol>
                                <li>SqlConnectionã€SqlCommand</li>
                                <li><code>Try<br>&nbsp;&nbsp;&nbsp;&nbsp;' å‡¦ç†<br>Catch ex As Exception<br>&nbsp;&nbsp;&nbsp;&nbsp;' ã‚¨ãƒ©ãƒ¼å‡¦ç†<br>End Try</code></li>
                                <li>&lt;connectionStrings&gt;</li>
                                <li>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³æ”»æ’ƒã‚’é˜²ããŸã‚ï¼ˆãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿åŒ–ã‚¯ã‚¨ãƒªï¼‰</li>
                                <li>Class</li>
                                <li>ãƒªã‚½ãƒ¼ã‚¹ã®è‡ªå‹•è§£æ”¾ã€‚usingæ–‡ã‚’æŠœã‘ã‚‹éš›ã«è‡ªå‹•çš„ã«Dispose()ãŒå‘¼ã°ã‚Œã‚‹</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step1-environment-setup.html" class="btn btn-secondary">â† å‰ã®ã‚¹ãƒ†ãƒƒãƒ—</a>
                        <a href="step3-user-registration.html" class="btn btn-primary">æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—: ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²æ©Ÿèƒ½ â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>