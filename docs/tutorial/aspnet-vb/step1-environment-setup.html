<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET(VB) 実践チュートリアル Step 1 - 環境構築とASP.NET基礎</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション - ASP.NET系テーマ */
        .navbar {
            background-color: #1976d2;
        }

        .navbar-brand, .navbar-nav .nav-link {
            color: white !important;
            font-weight: 500;
        }

        .navbar-nav .nav-link:hover {
            color: #bbdefb !important;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: white;
            border-right: 1px solid #dee2e6;
        }

        .sidebar .nav-link {
            color: #495057;
            font-weight: 500;
        }

        .sidebar .nav-link:hover {
            background-color: #e3f2fd;
            color: #1976d2;
        }

        .sidebar .nav-link.active {
            background-color: #1976d2 !important;
            color: white !important;
        }

        /* タイトル */
        .chapter-title {
            color: #1976d2;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #1976d2;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #42a5f5;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e3f2fd;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #1976d2;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        .info {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #4caf50;
        }

        /* コードブロック */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .step-number {
            background-color: #1976d2;
            color: white;
            border-radius: 50%;
            width: 2rem;
            height: 2rem;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 0.5rem;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET VB チュートリアル</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">チュートリアルTOP</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        チュートリアル目次
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="step1-environment-setup.html">Step 1: 環境構築とASP.NET基礎</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-connection.html">Step 2: データベース設計と接続</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-user-registration.html">Step 3: ユーザー登録機能</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-list-detail.html">Step 4: ユーザー一覧・詳細表示</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-update-delete.html">Step 5: ユーザー更新・削除</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-testing-debug.html">Step 6: 動作確認とデバッグ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 1: 環境構築とASP.NET基礎</h1>
                    <div class="badge bg-primary">所要時間: 2時間</div>
                </div>

                <div id="step1">
                    <h2 class="chapter-title">開発環境の構築とASP.NET Web Formsの基礎</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>このステップで学ぶこと</h5>
                        <ul>
                            <li>Visual Studio Community 2022の設定とプロジェクト作成</li>
                            <li>SQL Server LocalDBまたはSQL Server Expressの構築</li>
                            <li>ASP.NET Web Formsの基本概念とページライフサイクル</li>
                            <li>VB.NETの基本構文（変数、配列、制御構造）</li>
                            <li>サーバーコントロールの基本的な使い方</li>
                            <li>ASP.NETプロジェクトの構成と設定ファイル</li>
                        </ul>
                    </div>

                    <h3 class="section-title">1.1 このチュートリアルで学ぶ技術スタック</h3>
                    <p>本チュートリアルは.NETエコシステムにおけるWeb開発の学習プランの一部として位置づけられます。</p>

                    <h4>Web開発技術の学習プラン</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>ステップ</th>
                                <th>Javaエコシステム</th>
                                <th>.NETエコシステム</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1. 言語の基本</td>
                                <td>Java構文、OOP、例外処理</td>
                                <td><span class="badge bg-primary">✓</span> <strong>VB構文、OOP、例外処理</strong></td>
                            </tr>
                            <tr>
                                <td>2. 画面出力の基礎</td>
                                <td><strong>JSP</strong> + Servlet（軽く）</td>
                                <td><span class="badge bg-primary">✓</span> <strong>ASP.NET Web Forms</strong>（このチュートリアル）</td>
                            </tr>
                            <tr>
                                <td>3. データベース接続</td>
                                <td>JDBC + SQL基礎</td>
                                <td><span class="badge bg-primary">✓</span> <strong>ADO.NET + SQL基礎</strong></td>
                            </tr>
                            <tr>
                                <td>4. モダンなWeb開発</td>
                                <td><strong>Spring Boot + MVC + Thymeleaf</strong></td>
                                <td><span class="badge bg-secondary">次のステップ</span> ASP.NET Core MVC / Razor Pages</td>
                            </tr>
                            <tr>
                                <td>5. データ操作の進化系</td>
                                <td>JPA / Hibernate（ORM）</td>
                                <td><span class="badge bg-secondary">次のステップ</span> Entity Framework Core（ORM）</td>
                            </tr>
                            <tr>
                                <td>6. 認証・セキュリティ</td>
                                <td>Spring Security</td>
                                <td><span class="badge bg-secondary">次のステップ</span> ASP.NET Identity</td>
                            </tr>
                            <tr>
                                <td>7. Web+APサーバー</td>
                                <td><strong>Tomcat</strong>（アプリケーションサーバー）</td>
                                <td><span class="badge bg-primary">✓</span> <strong>IIS</strong>（インターネットインフォメーションサービス）</td>
                            </tr>
                            <tr>
                                <td>8. 補足技術</td>
                                <td>Git, REST API, JSON形式</td>
                                <td><span class="badge bg-secondary">共通</span> 同左（Git / REST / JSON）</td>
                            </tr>
                        </tbody>
                    </table>

                    <div class="info">
                        <h6>💡 このチュートリアルの位置づけ</h6>
                        <p>このASP.NET VB チュートリアルでは、<strong>ステップ1〜3</strong>の内容を.NETエコシステムで実践的に学習します。</p>
                        <ul>
                            <li><strong>VB.NET言語基礎</strong>: 変数、配列、制御構造、オブジェクト指向</li>
                            <li><strong>ASP.NET Web Forms</strong>: サーバーコントロール、ページライフサイクル、イベント処理</li>
                            <li><strong>ADO.NET</strong>: SQL Server接続、CRUD操作、パラメータ化クエリ</li>
                        </ul>
                        <p>完了後は、より現代的な<strong>ASP.NET Core</strong>や<strong>Entity Framework</strong>の学習に進むことをお勧めします。</p>
                    </div>

                    <h3 class="section-title">1.2 Visual Studio Community 2022のインストールと設定</h3>
                    <p>ASP.NET開発のメイン開発環境であるVisual Studio Community 2022をセットアップします。</p>
                    
                    <h4><span class="step-number">1</span>Visual Studio Community 2022のダウンロードとインストール</h4>
                    <ol>
                        <li><a href="https://visualstudio.microsoft.com/ja/vs/community/" target="_blank">Visual Studio Community 2022</a>から無料版をダウンロード</li>
                        <li>ダウンロードしたインストーラー（vs_community.exe）を実行</li>
                        <li>Visual Studio Installerが起動したら、<strong>「ワークロード」タブ</strong>で以下を選択:
                            <ul>
                                <li><strong>✓ ASP.NETとWeb開発</strong>（必須）</li>
                                <li><strong>✓ .NET デスクトップ開発</strong>（推奨）</li>
                                <li><strong>✓ データの保存と処理</strong>（推奨）</li>
                            </ul>
                        </li>
                        <li>ワークロード選択後、右側の<strong>「インストール詳細」</strong>画面で以下の項目をチェック:
                            <ul>
                                <li><strong>✓ .NET Framework プロジェクトと項目テンプレート</strong></li>
                                <li><strong>✓ 追加のプロジェクト テンプレート (以前のバージョン)</strong></li>
                            </ul>
                        </li>
                        <li><strong>「個別のコンポーネント」タブ</strong>で以下の項目をチェック:
                            <ul>
                                <li><strong>✓ .NET Framework 4.8 SDK</strong></li>
                                <li><strong>✓ .NET Framework 4.8 Targeting Pack</strong></li>
                                <li><strong>✓ ASP.NET Web Forms</strong></li>
                                <li><strong>✓ SQL Server Express LocalDB</strong></li>
                                <li><strong>✓ Visual Studio SDK</strong>（オプション）</li>
                            </ul>
                        </li>
                        <li>右下の「インストール」ボタンをクリック（インストールサイズを確認）</li>
                        <li>インストール完了まで待機（通常20-40分程度）</li>
                        <li>インストール完了後、「起動」ボタンでVisual Studio 2022を起動</li>
                        <li>初回起動時のアカウント登録画面では「後で行う」または「スキップ」を選択</li>
                        <li>開発設定で「Visual Basic開発設定」を選択（推奨）</li>
                        <li>配色テーマは「青」または「淡色」を選択（お好みで）</li>
                    </ol>

                    <div class="warning">
                        <h6>⚠️ 重要：ASP.NET Web Forms テンプレートを有効にするために</h6>
                        <p><strong>「ASP.NETとWeb開発」ワークロード</strong>と<strong>「.NET Framework 4.8 SDK」</strong>の両方が必須です。これらがインストールされていないと、「ASP.NET Web アプリケーション (.NET Framework)」テンプレートが表示されません。</p>
                    </div>

                    <div class="info">
                        <h6>💡 ポイント</h6>
                        <p>Visual Studio Communityは個人開発・学習目的であれば無料で使用できます。プロフェッショナル版と同等の多くの機能が利用可能です。</p>
                    </div>

                    <!-- 実習1 -->
                    <div class="exercise-container">
                        <h5>実習 1-1: ASP.NET Web Formsプロジェクトの作成</h5>
                        <p>初めてのASP.NET Web Formsアプリケーションを作成し、基本的な構造を理解しましょう。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Visual Studio 2022を起動</li>
                            <li>「新しいプロジェクトの作成」を選択</li>
                            <li>「ASP.NET Web アプリケーション (.NET Framework)」を選択</li>
                            <li>プロジェクト名: <code>UserManagementApp</code></li>
                            <li>場所: <code>C:\Projects\UserManagementApp</code></li>
                            <li>フレームワーク: <code>.NET Framework 4.8</code>を選択</li>
                            <li>テンプレート: <code>Web Forms</code>を選択</li>
                            <li>認証: <code>認証なし</code>を選択</li>
                            <li><strong>詳細設定</strong>で「<strong>HTTPS用の構成</strong>」のチェックを<strong>外す</strong></li>
                            <li>「作成」ボタンをクリック</li>
                        </ol>
                        
                        <h6>確認項目</h6>
                        <ul>
                            <li>ソリューションエクスプローラーにプロジェクト構造が表示される</li>
                            <li>Default.aspx ファイルが存在する</li>
                            <li>Web.config ファイルが存在する</li>
                            <li>App_Data フォルダが存在する</li>
                        </ul>
                        
                        <h6>プロジェクト構造の理解</h6>
                        <pre><code>UserManagementApp/
├── Default.aspx          # デフォルトページ（マークアップ）
├── Default.aspx.vb       # デフォルトページ（コードビハインド）
├── Site.Master           # マスターページ（共通レイアウト）
├── Site.Master.vb        # マスターページのコードビハインド
├── Web.config            # アプリケーション設定ファイル
├── Global.asax           # アプリケーションイベント
├── Global.asax.vb        # アプリケーションイベントのコード
├── App_Data/             # データファイル用フォルダ
├── App_Code/             # 共通クラス用フォルダ
├── Content/              # CSS、画像等
└── Scripts/              # JavaScript ファイル</code></pre>
                    </div>

                    <h3 class="section-title">1.4 SQL Server LocalDBの確認と設定</h3>
                    <p>Visual Studio 2022には SQL Server LocalDB が含まれているため、簡単にデータベース環境を利用できます。先ほど作成したプロジェクトを使用してデータベース接続を確認します。</p>

                    <div class="info">
                        <h6>💡 LocalDBとは</h6>
                        <p><strong>SQL Server LocalDB</strong>は、開発者向けの軽量版SQL Serverです。フルインストールなしで使用でき、必要な時だけ起動されるため、学習に最適です。</p>
                    </div>

                    <h4><span class="step-number">1</span>LocalDBの起動</h4>
                    <p>まず、LocalDBインスタンスが起動していることを確認します。</p>
                    <ol>
                        <li>Windows キーを押して「cmd」と入力し、コマンドプロンプトを開く</li>
                        <li>以下のコマンドでLocalDBの状態を確認:
                            <pre><code>sqllocaldb info</code></pre>
                        </li>
                        <li>MSSQLLocalDBが表示されない場合は、以下のコマンドで起動:
                            <pre><code>sqllocaldb start MSSQLLocalDB</code></pre>
                        </li>
                        <li>起動確認のため再度状態を確認:
                            <pre><code>sqllocaldb info MSSQLLocalDB</code></pre>
                        </li>
                    </ol>

                    <h4><span class="step-number">2</span>Visual Studioでの接続確認</h4>
                    <p>作成したUserManagementAppプロジェクトでデータベース接続を確認します。</p>
                    <ol>
                        <li>Visual Studio でUserManagementAppプロジェクトが開いていることを確認</li>
                        <li>「表示」メニュー →「サーバーエクスプローラー」を選択</li>
                        <li>サーバーエクスプローラーで「データ接続」を右クリック</li>
                        <li>「接続の追加」を選択</li>
                        <li>「データソースの選択」で「Microsoft SQL Server」を選択し「続行」</li>
                        <li>「接続の追加」ダイアログで以下を入力:
                            <ul>
                                <li><strong>サーバー名:</strong> <code>(localdb)\MSSQLLocalDB</code></li>
                                <li><strong>認証:</strong> 「Windows認証を使用する」を選択</li>
                                <li><strong>データベース名:</strong> 「master」を選択（既定値）</li>
                            </ul>
                        </li>
                        <li>「接続テスト」ボタンをクリック</li>
                        <li>「接続テストに成功しました」メッセージを確認</li>
                        <li>「OK」をクリックして接続を追加</li>
                    </ol>

                    <h4><span class="step-number">3</span>SQL Server Management Studio (SSMS) の設定（オプション）</h4>
                    <p>より詳細なデータベース管理を行いたい場合は、SSMSを使用できます：</p>
                    <ol>
                        <li>SSMSのダウンロード・インストール:
                            <ol type="a">
                                <li><a href="https://docs.microsoft.com/ja-jp/sql/ssms/download-sql-server-management-studio-ssms" target="_blank">SSMS ダウンロードページ</a>にアクセス</li>
                                <li>「SSMS 21 のダウンロード」ボタンをクリック</li>
                                <li>ダウンロードしたファイル（vs_SSMS.exe）を実行</li>
                                <li>インストールウィザードに従ってインストールを完了</li>
                            </ol>
                        </li>
                        <li>SSMSを起動し、以下の情報で接続:
                            <ul>
                                <li><strong>サーバー名:</strong> <code>(localdb)\MSSQLLocalDB</code></li>
                                <li><strong>認証:</strong> Windows認証</li>
                            </ul>
                        </li>
                        <li>接続成功を確認</li>
                    </ol>

                    <div class="warning">
                        <h6>⚠️ トラブルシューティング</h6>
                        <p>接続テストが失敗する場合は、以下を確認してください：</p>
                        <ul>
                            <li>LocalDBが正常に起動しているか（<code>sqllocaldb info MSSQLLocalDB</code>）</li>
                            <li>Visual Studio を管理者権限で実行しているか</li>
                            <li>Windows ファイアウォールがSQL Serverをブロックしていないか</li>
                        </ul>
                    </div>

                    <h3 class="section-title">1.5 VB.NETの基本構文</h3>
                    <p>ASP.NET Web FormsのコードビハインドファイルではVB.NETを使用します。基本的な文法を確認しましょう。</p>

                    <h4>変数の宣言と初期化</h4>
                    <pre><code>' VB.NETの変数宣言
Dim userName As String = "田中太郎"
Dim age As Integer = 25
Dim isActive As Boolean = True
Dim birthDate As DateTime = New DateTime(1998, 5, 15)

' 型推論（Option Inferが有効な場合）
Dim autoString = "自動で文字列型"
Dim autoNumber = 100  ' 自動で整数型</code></pre>

                    <h4>配列の宣言と操作</h4>
                    <pre><code>' 配列の宣言
Dim numbers(4) As Integer  ' 5要素の配列
Dim names() As String = {"太郎", "花子", "次郎", "美子"}

' 動的配列（List）
Dim userList As New List(Of String)()
userList.Add("ユーザー1")
userList.Add("ユーザー2")

' 配列の要素へのアクセス
For i As Integer = 0 To names.Length - 1
    Debug.WriteLine($"名前[{i}]: {names(i)}")
Next

' For Each文
For Each name As String In names
    Debug.WriteLine($"名前: {name}")
Next</code></pre>

                    <h4>条件分岐とループ</h4>
                    <pre><code>' If文
If age >= 20 Then
    Debug.WriteLine("成年です")
ElseIf age >= 13 Then
    Debug.WriteLine("未成年です")
Else
    Debug.WriteLine("子供です")
End If

' Select Case文
Select Case age
    Case 0 To 12
        Debug.WriteLine("子供")
    Case 13 To 19
        Debug.WriteLine("未成年")
    Case Else
        Debug.WriteLine("成年")
End Select</code></pre>

                    <!-- 実習2 -->
                    <div class="exercise-container">
                        <h5>実習 1-2: 初めてのASP.NETページ作成</h5>
                        <p>VB.NETコードを使ってサーバーサイド処理を含むWebページを作成します。</p>
                        
                        <div class="info">
                            <h6>💡 ASP.NETファイルの種類について</h6>
                            <ul>
                                <li><strong>.aspx ファイル</strong>: HTMLマークアップとサーバーコントロールを記述（画面の見た目）</li>
                                <li><strong>.aspx.vb ファイル</strong>: VB.NETコード（サーバーサイドの処理ロジック）を記述</li>
                                <li>この2つのファイルが連携してWebページを作成します</li>
                            </ul>
                        </div>

                        <h6>手順</h6>
                        <ol>
                            <li><strong>新しいWebフォームの作成</strong>
                                <ol type="a">
                                    <li>ソリューションエクスプローラーでプロジェクト名（UserManagementApp）を右クリック</li>
                                    <li>「追加」→「Webフォーム」を選択</li>
                                    <li>「項目の追加 - UserManagementApp」ダイアログが表示される</li>
                                    <li>名前欄に <code>HelloWorld.aspx</code> と入力</li>
                                    <li>「追加」ボタンをクリック</li>
                                </ol>
                            </li>
                            <li><strong>HelloWorld.aspxファイルの編集</strong>
                                <ol type="a">
                                    <li>作成されたHelloWorld.aspxファイルが自動で開かれる</li>
                                    <li>既存の内容を全て削除</li>
                                    <li>以下のマークアップコードを貼り付け</li>
                                    <li>Ctrl + S で保存</li>
                                </ol>
                            </li>
                        </ol>
                        
                        <h6>HelloWorld.aspx（マークアップ）</h6>
                        <pre><code>&lt;%@ Page Language="vb" AutoEventWireup="false" CodeBehind="HelloWorld.aspx.vb" Inherits="UserManagementApp.HelloWorld" %&gt;

&lt;!DOCTYPE html&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;head runat="server"&gt;
    &lt;meta http-equiv="Content-Type" content="text/html; charset=utf-8"/&gt;
    &lt;title&gt;Hello ASP.NET World&lt;/title&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form id="form1" runat="server"&gt;
        &lt;div class="container mt-5"&gt;
            &lt;h1 class="text-primary"&gt;ASP.NET VB.NET チュートリアル&lt;/h1&gt;
            
            &lt;div class="card mt-4"&gt;
                &lt;div class="card-body"&gt;
                    &lt;h5 class="card-title"&gt;サーバー情報&lt;/h5&gt;
                    &lt;p&gt;&lt;strong&gt;現在時刻:&lt;/strong&gt; 
                        &lt;asp:Label ID="lblCurrentTime" runat="server" CssClass="text-info"&gt;&lt;/asp:Label&gt;
                    &lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;サーバー名:&lt;/strong&gt; 
                        &lt;asp:Label ID="lblServerName" runat="server" CssClass="text-info"&gt;&lt;/asp:Label&gt;
                    &lt;/p&gt;
                    &lt;p&gt;&lt;strong&gt;アプリケーション名:&lt;/strong&gt; 
                        &lt;asp:Label ID="lblAppName" runat="server" CssClass="text-info"&gt;&lt;/asp:Label&gt;
                    &lt;/p&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="card mt-4"&gt;
                &lt;div class="card-body"&gt;
                    &lt;h5 class="card-title"&gt;インタラクティブ機能&lt;/h5&gt;
                    &lt;div class="mb-3"&gt;
                        &lt;label for="txtName" class="form-label"&gt;お名前を入力してください:&lt;/label&gt;
                        &lt;asp:TextBox ID="txtName" runat="server" CssClass="form-control" placeholder="名前を入力"&gt;&lt;/asp:TextBox&gt;
                    &lt;/div&gt;
                    &lt;asp:Button ID="btnSayHello" runat="server" Text="挨拶する" CssClass="btn btn-primary" OnClick="btnSayHello_Click" /&gt;
                    &lt;asp:Button ID="btnReset" runat="server" Text="リセット" CssClass="btn btn-secondary ms-2" OnClick="btnReset_Click" /&gt;
                    
                    &lt;div id="resultArea" runat="server" class="mt-3"&gt;
                        &lt;asp:Label ID="lblResult" runat="server" CssClass="alert alert-success d-block" Visible="false"&gt;&lt;/asp:Label&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;

            &lt;div class="card mt-4"&gt;
                &lt;div class="card-body"&gt;
                    &lt;h5 class="card-title"&gt;VB.NET配列デモ&lt;/h5&gt;
                    &lt;asp:Button ID="btnShowArray" runat="server" Text="サンプルデータ表示" CssClass="btn btn-info" OnClick="btnShowArray_Click" /&gt;
                    &lt;asp:Panel ID="pnlArrayResult" runat="server" Visible="false" CssClass="mt-3"&gt;
                        &lt;h6&gt;ユーザーリスト:&lt;/h6&gt;
                        &lt;asp:BulletedList ID="blUsers" runat="server" CssClass="list-group"&gt;&lt;/asp:BulletedList&gt;
                    &lt;/asp:Panel&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                        <ol start="3">
                            <li><strong>HelloWorld.aspx.vbファイル（コードビハインド）の編集</strong>
                                <ol type="a">
                                    <li><strong>方法1: F7キー（推奨）</strong>
                                        <ul>
                                            <li>HelloWorld.aspxファイルが開いている状態で<strong>F7キー</strong>を押す</li>
                                            <li>自動でコードビハインドファイル（HelloWorld.aspx.vb）が開かれる</li>
                                        </ul>
                                    </li>
                                    <li><strong>方法2: 右クリックメニュー</strong>
                                        <ul>
                                            <li>HelloWorld.aspxファイルのタブを右クリック</li>
                                            <li>「コードの表示」を選択</li>
                                        </ul>
                                    </li>
                                </ol>
                            </li>
                            <li><strong>VB.NETコードの入力</strong>
                                <ol type="a">
                                    <li>HelloWorld.aspx.vbファイルが開かれたことを確認</li>
                                    <li>既存のコード（空のクラス定義）を全て削除</li>
                                    <li>以下のVB.NETコードを貼り付け</li>
                                    <li>Ctrl + S で保存</li>
                                </ol>
                            </li>
                        </ol>

                        <div class="info">
                            <h6>💡 ファイル間の移動方法</h6>
                            <ul>
                                <li><strong>F7キー</strong>: ASPXファイル → コードビハインドファイル</li>
                                <li><strong>Shift + F7キー</strong>: コードビハインドファイル → ASPXファイル（デザイナー）</li>
                                <li><strong>タブ</strong>: 開いているファイル間の切り替え</li>
                            </ul>
                        </div>

                        <h6>HelloWorld.aspx.vb（コードビハインド）</h6>
                        <pre><code>Public Class HelloWorld
    Inherits System.Web.UI.Page

    Protected Sub Page_Load(ByVal sender As Object, ByVal e As System.EventArgs) Handles Me.Load
        ' ページ読み込み時の処理
        If Not IsPostBack Then
            InitializePageData()
        End If
    End Sub

    Private Sub InitializePageData()
        ' サーバー情報の表示
        lblCurrentTime.Text = DateTime.Now.ToString("yyyy年MM月dd日 HH時mm分ss秒")
        lblServerName.Text = Environment.MachineName
        lblAppName.Text = "UserManagementApp v1.0"
    End Sub

    Protected Sub btnSayHello_Click(sender As Object, e As EventArgs) Handles btnSayHello.Click
        Try
            Dim userName As String = txtName.Text.Trim()
            
            ' 入力値チェック
            If String.IsNullOrEmpty(userName) Then
                lblResult.Text = "名前を入力してください。"
                lblResult.CssClass = "alert alert-warning d-block"
                lblResult.Visible = True
                Return
            End If
            
            ' 挨拶メッセージの生成
            Dim greetingMessages() As String = {
                $"こんにちは、{userName}さん！",
                $"ようこそ、{userName}さん！",
                $"{userName}さん、お疲れ様です！",
                $"はじめまして、{userName}さん！"
            }
            
            ' ランダムに挨拶を選択
            Dim rand As New Random()
            Dim selectedMessage As String = greetingMessages(rand.Next(greetingMessages.Length))
            
            ' 現在時刻による挨拶の調整
            Dim currentHour As Integer = DateTime.Now.Hour
            Dim timeGreeting As String = ""
            
            Select Case currentHour
                Case 5 To 11
                    timeGreeting = "おはようございます"
                Case 12 To 17
                    timeGreeting = "こんにちは"
                Case 18 To 22
                    timeGreeting = "こんばんは"
                Case Else
                    timeGreeting = "お疲れ様です"
            End Select
            
            lblResult.Text = $"{timeGreeting}！{selectedMessage} 現在時刻は{DateTime.Now:HH:mm}です。"
            lblResult.CssClass = "alert alert-success d-block"
            lblResult.Visible = True
            
        Catch ex As Exception
            ' エラーハンドリング
            lblResult.Text = $"エラーが発生しました: {ex.Message}"
            lblResult.CssClass = "alert alert-danger d-block"
            lblResult.Visible = True
        End Try
    End Sub

    Protected Sub btnReset_Click(sender As Object, e As EventArgs) Handles btnReset.Click
        ' フォームのリセット
        txtName.Text = ""
        lblResult.Visible = False
        pnlArrayResult.Visible = False
        blUsers.Items.Clear()
    End Sub

    Protected Sub btnShowArray_Click(sender As Object, e As EventArgs) Handles btnShowArray.Click
        Try
            ' サンプルユーザーデータの作成
            Dim sampleUsers() As String = {
                "田中太郎 (25歳)",
                "佐藤花子 (30歳)",
                "鈴木次郎 (28歳)",
                "高橋美子 (24歳)",
                "山田一郎 (35歳)"
            }
            
            ' BulletedListに追加
            blUsers.Items.Clear()
            
            For Each user As String In sampleUsers
                blUsers.Items.Add(user)
            Next
            
            ' パネルを表示
            pnlArrayResult.Visible = True
            
        Catch ex As Exception
            lblResult.Text = $"配列表示エラー: {ex.Message}"
            lblResult.CssClass = "alert alert-danger d-block"
            lblResult.Visible = True
        End Try
    End Sub
End Class</code></pre>
                        
                        <h6>実行手順</h6>
                        <ol>
                            <li><strong>プロジェクトのビルドと実行</strong>
                                <ol type="a">
                                    <li>両方のファイル（HelloWorld.aspxとHelloWorld.aspx.vb）を保存</li>
                                    <li><strong>F5キー</strong>を押してデバッグ実行開始</li>
                                    <li>または「デバッグ」メニュー →「デバッグ開始」を選択</li>
                                    <li>初回実行時は「Web.configを変更しますか？」と聞かれるので「OK」をクリック</li>
                                </ol>
                            </li>
                            <li><strong>ブラウザでの確認</strong>
                                <ol type="a">
                                    <li>自動でブラウザが起動し、Default.aspxページが表示される</li>
                                    <li>URLを「localhost:ポート番号/HelloWorld.aspx」に変更</li>
                                    <li>例: <code>https://localhost:44300/HelloWorld.aspx</code></li>
                                    <li>HelloWorldページが表示されることを確認</li>
                                </ol>
                            </li>
                            <li><strong>機能の動作確認</strong>
                                <ol type="a">
                                    <li>ページが正常に表示され、現在時刻が表示される</li>
                                    <li>名前を入力して「挨拶する」ボタンをクリック</li>
                                    <li>「サンプルデータ表示」ボタンをクリック</li>
                                    <li>「リセット」ボタンをクリック</li>
                                </ol>
                            </li>
                        </ol>

                        <h6>期待される結果</h6>
                        <ul>
                            <li>現在時刻とサーバー情報が正しく表示される</li>
                            <li>名前を入力して「挨拶する」ボタンを押すと、時間帯に応じた挨拶が表示される</li>
                            <li>「サンプルデータ表示」ボタンでユーザーリストが表示される</li>
                            <li>「リセット」ボタンで全ての入力と結果がクリアされる</li>
                        </ul>

                        <div class="warning">
                            <h6>⚠️ よくあるトラブルと対処法</h6>
                            <ul>
                                <li><strong>コンパイルエラー</strong>: VB.NETコードの構文エラーを確認</li>
                                <li><strong>ページが表示されない</strong>: URLにHelloWorld.aspxが含まれているか確認</li>
                                <li><strong>ボタンが動作しない</strong>: .aspxと.aspx.vbファイルが正しく関連付けられているか確認</li>
                                <li><strong>ビルドエラー</strong>: プロジェクトを右クリック →「リビルド」を実行</li>
                            </ul>
                        </div>
                    </div>

                    <h3 class="section-title">1.5 ASP.NET Web Formsの基本概念</h3>
                    <p>ASP.NET Web Formsの核となる概念を理解しましょう。</p>

                    <h4>ページライフサイクル</h4>
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>段階</th>
                                <th>イベント</th>
                                <th>説明</th>
                                <th>用途</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1. 初期化</td>
                                <td>Page_PreInit</td>
                                <td>ページ初期化前</td>
                                <td>マスターページ設定、テーマ設定</td>
                            </tr>
                            <tr>
                                <td>2. 読み込み</td>
                                <td>Page_Load</td>
                                <td>ページ読み込み</td>
                                <td>データ初期化、コントロール設定</td>
                            </tr>
                            <tr>
                                <td>3. イベント処理</td>
                                <td>Button_Click等</td>
                                <td>ユーザーアクション処理</td>
                                <td>ボタンクリック、テキスト変更処理</td>
                            </tr>
                            <tr>
                                <td>4. レンダリング前</td>
                                <td>Page_PreRender</td>
                                <td>HTML出力前</td>
                                <td>最終的なデータ設定</td>
                            </tr>
                            <tr>
                                <td>5. アンロード</td>
                                <td>Page_Unload</td>
                                <td>ページ破棄</td>
                                <td>リソース解放、クリーンアップ</td>
                            </tr>
                        </tbody>
                    </table>

                    <h4>サーバーコントロールの特徴</h4>
                    <ul>
                        <li><strong>runat="server"属性</strong>: サーバーサイドで処理されるコントロール</li>
                        <li><strong>ViewState</strong>: ポストバック間でのコントロール状態の保持</li>
                        <li><strong>イベントドリブン</strong>: ユーザーアクションに応じたサーバーサイド処理</li>
                        <li><strong>プロパティベース</strong>: .NETオブジェクトとして操作可能</li>
                    </ul>

                    <div class="info">
                        <h6>💡 Web Formsの利点</h6>
                        <ul>
                            <li><strong>RAD開発</strong>: ドラッグ&ドロップでUI作成</li>
                            <li><strong>イベント駆動</strong>: デスクトップアプリのような開発体験</li>
                            <li><strong>状態管理</strong>: ViewStateによる自動的な状態保持</li>
                            <li><strong>コントロール豊富</strong>: 多様な標準コントロール</li>
                        </ul>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>ASP.NET・VB.NET理解度クイズ</h5>
                        <ol>
                            <li>ASP.NET Web Formsでサーバーサイド処理を行うコントロールに必要な属性は何ですか？</li>
                            <li>VB.NETで文字列型の変数を宣言する正しい構文を書いてください。</li>
                            <li>Page_Loadイベントはページライフサイクルのどの段階で発生しますか？</li>
                            <li>VB.NETのFor Each文を使って配列の全要素を出力するコードを書いてください。</li>
                            <li>ASP.NETのPostBackとは何ですか？簡潔に説明してください。</li>
                            <li>IsPostBackプロパティの用途を説明してください。</li>
                        </ol>
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li><code>runat="server"</code></li>
                                <li><code>Dim userName As String = "値"</code></li>
                                <li>ページ読み込み段階（初期化後、イベント処理前）</li>
                                <li><code>For Each item As String In array<br>&nbsp;&nbsp;&nbsp;&nbsp;Debug.WriteLine(item)<br>Next</code></li>
                                <li>サーバーコントロールのイベント発生時にページがサーバーに送信される仕組み</li>
                                <li>初回ページ読み込みとポストバック時の処理を分岐するために使用</li>
                            </ol>
                        </details>
                    </div>

                    <h3 class="section-title">1.6 次のステップへの準備</h3>
                    <p>Step 2では、作成した環境を使ってSQL Serverとの接続を実装します。</p>

                    <div class="highlight">
                        <h6>次回の準備</h6>
                        <ul>
                            <li>SQL Server LocalDBへの接続が正常に動作することを確認</li>
                            <li>SSMSでの接続確認</li>
                            <li>作成したHelloWorld.aspxが正常に動作することを確認</li>
                            <li>Visual Studioのデバッグ機能の基本操作を覚える</li>
                        </ul>
                    </div>

                    <!-- ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="README.md" class="btn btn-secondary">← チュートリアルTOP</a>
                        <a href="step2-database-connection.html" class="btn btn-primary">次のステップ: データベース設計と接続 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>