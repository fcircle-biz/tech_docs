<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spring AI + Ollama チュートリアル ステップ1 - 環境構築とプロジェクト作成</title>

    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>

    <style>
        :root {
            --primary-color: #f57c00;
            --secondary-color: #ff9800;
            --accent-color: #4caf50;
            --background-color: #fff3e0;
            --text-color: #333;
            --border-color: #ddd;
        }

        body {
            font-family: 'Noto Sans JP', sans-serif;
            background-color: #f8f9fa;
            padding-top: 56px;
        }

        .navbar {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
        }

        .sidebar {
            position: fixed;
            top: 56px;
            bottom: 0;
            left: 0;
            z-index: 100;
            padding: 48px 0 0;
            box-shadow: inset -1px 0 0 rgba(0, 0, 0, .1);
            background-color: #f8f9fa;
            overflow-y: auto;
        }

        .sidebar-heading {
            font-size: .75rem;
            text-transform: uppercase;
        }

        .sidebar .nav-link {
            font-weight: 500;
            color: #333;
            padding: 0.5rem 1rem;
            border-left: 3px solid transparent;
        }

        .sidebar .nav-link:hover {
            color: var(--primary-color);
            background-color: var(--background-color);
            border-left-color: var(--primary-color);
        }

        .sidebar .nav-link.active {
            color: var(--primary-color);
            background-color: var(--background-color);
            border-left-color: var(--primary-color);
            font-weight: 700;
        }

        main {
            padding-top: 20px;
        }

        .chapter-title {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            padding-bottom: 10px;
            margin-bottom: 30px;
            font-weight: 700;
        }

        .section-title {
            color: var(--secondary-color);
            margin-top: 30px;
            margin-bottom: 20px;
            font-weight: 600;
            border-left: 4px solid var(--secondary-color);
            padding-left: 15px;
        }

        .highlight {
            background: linear-gradient(to right, #fff3e0, #ffe0b2);
            border-left: 4px solid var(--primary-color);
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .highlight h5 {
            color: var(--primary-color);
            font-weight: 700;
            margin-bottom: 15px;
        }

        .code-block {
            background-color: #282c34;
            border-radius: 5px;
            padding: 15px;
            margin: 15px 0;
            overflow-x: auto;
        }

        .code-block code {
            color: #abb2bf;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
        }

        .exercise-container {
            background-color: #f0f7ff;
            border: 2px solid #2196F3;
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
        }

        .exercise-container h5 {
            color: #1976D2;
            font-weight: 700;
            margin-bottom: 15px;
        }

        .quiz-container {
            background-color: #f1f8e9;
            border: 2px solid var(--accent-color);
            border-radius: 8px;
            padding: 25px;
            margin: 25px 0;
        }

        .quiz-container h5 {
            color: var(--accent-color);
            font-weight: 700;
            margin-bottom: 15px;
        }

        .alert-custom {
            border-radius: 8px;
            padding: 15px 20px;
            margin: 15px 0;
        }

        footer {
            margin-top: 50px;
            padding: 30px 0;
            background-color: #212529;
        }

        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        .btn-primary:hover {
            background-color: #e65100;
            border-color: #e65100;
        }

        .mermaid {
            background-color: white;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <i class="fab fa-java"></i>
                <strong>Spring AI + Ollama + Qwen3 実践チュートリアル</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>チュートリアルステップ</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="step1-environment-setup.html">
                                <i class="fas fa-cog"></i> ステップ1: 環境構築とプロジェクト作成
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-spring-ai-ollama-integration.html">
                                <i class="fas fa-plug"></i> ステップ2: Spring AIとOllamaの統合設定
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-chat-implementation.html">
                                <i class="fas fa-comments"></i> ステップ3: チャット機能の実装
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-thymeleaf-view.html">
                                <i class="fas fa-file-code"></i> ステップ4: Thymeleafビューの作成
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-testing.html">
                                <i class="fas fa-check-circle"></i> ステップ5: 動作確認
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2"><i class="fas fa-cog"></i> ステップ1: 環境構築とプロジェクト作成</h1>
                </div>

                <div id="step1">
                    <!-- ステップタイトル -->
                    <h2 class="chapter-title">Spring AI開発環境のセットアップとGradleプロジェクト作成</h2>

                    <!-- このステップの目標 -->
                    <div class="highlight">
                        <h5><i class="fas fa-bullseye"></i> このステップで実装すること</h5>
                        <ul>
                            <li><strong>JDK 21のインストール</strong> - Java開発環境の構築と環境変数設定</li>
                            <li><strong>Visual Studio Codeのセットアップ</strong> - IDEと必要な拡張機能のインストール</li>
                            <li><strong>Rancher Desktopのインストール</strong> - コンテナ環境の準備と動作確認</li>
                            <li><strong>Gradleプロジェクトの作成</strong> - Spring Bootプロジェクトの初期化</li>
                            <li><strong>build.gradleの設定</strong> - Spring Boot 3.4.0とSpring AI BOM 1.0.0-M6の追加</li>
                            <li><strong>依存関係の追加</strong> - web、thymeleaf、spring-ai-ollama、lombokの設定</li>
                            <li><strong>Lombokアノテーションプロセッサの有効化</strong> - compileOnly/annotationProcessorの設定</li>
                            <li><strong>Hello Worldアプリの作成と実行</strong> - 開発環境の動作確認</li>
                        </ul>
                        <p><strong>所要時間：</strong> 約2時間</p>
                    </div>

                    <!-- 前提条件 -->
                    <div class="alert alert-info alert-custom">
                        <h6><i class="fas fa-info-circle"></i> 前提条件</h6>
                        <ul class="mb-0">
                            <li>コマンドライン操作の基本的な知識</li>
                            <li>テキストエディタやIDEの基本的な使用経験</li>
                            <li>インターネット接続（ソフトウェアダウンロード用）</li>
                            <li>管理者権限のあるPC（ソフトウェアインストール用）</li>
                        </ul>
                    </div>

                    <!-- セクション1.1: JDK 21のインストール -->
                    <h3 class="section-title">1.1 JDK 21のインストールと環境変数設定</h3>
                    <p>Spring Boot 3.4.0を使用するため、Java Development Kit(JDK)21以上が必要です。ここではOracle公式サイトからJDK 21をダウンロードしてインストールします。</p>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-1: JDK 21のインストール</h5>
                        <p>Oracle JDK 21は、Oracle社が提供する公式JDKです。</p>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>JDK 21のダウンロード</strong>:
                                <ul>
                                    <li>Oracle JDK公式サイトにアクセス: <a href="https://www.oracle.com/java/technologies/downloads/#java21" target="_blank">https://www.oracle.com/java/technologies/downloads/#java21</a></li>
                                    <li>「Java 21」セクションで使用しているOS(Windows/macOS/Linux)を選択</li>
                                    <li>適切なインストーラー(.exe、.dmg、.tar.gz)をダウンロード</li>
                                </ul>
                            </li>

                            <li><strong>インストールの実行</strong>:
                                <ul>
                                    <li><strong>Windows</strong>: ダウンロードした.exeファイルを実行し、インストールウィザードに従う</li>
                                    <li><strong>macOS</strong>: .dmgファイルを実行し、インストールウィザードに従う</li>
                                    <li><strong>Linux</strong>: tar.gzを展開してインストール</li>
                                </ul>
                                <pre class="code-block"><code class="language-bash"># Linux手動インストール例
sudo mkdir -p /usr/lib/jvm
sudo tar -xzf jdk-21_linux-x64_bin.tar.gz -C /usr/lib/jvm
sudo ln -s /usr/lib/jvm/jdk-21 /usr/lib/jvm/java-21-oracle

# または、Ubuntuでaptを使用する場合
sudo apt update
sudo apt install -y openjdk-21-jdk</code></pre>
                            </li>

                            <li><strong>環境変数の設定</strong>:
                                <p><strong>Windows:</strong></p>
                                <ul>
                                    <li>システム環境変数を開く（「システムの詳細設定」→「環境変数」）</li>
                                    <li>システム変数で「新規」をクリック</li>
                                    <li>変数名: <code>JAVA_HOME</code></li>
                                    <li>変数値: <code>C:\Program Files\Java\jdk-21</code></li>
                                    <li>Path変数に <code>%JAVA_HOME%\bin</code> を追加</li>
                                </ul>

                                <p><strong>macOS/Linux:</strong></p>
                                <pre class="code-block"><code class="language-bash"># ~/.bashrc または ~/.zshrc に追加
export JAVA_HOME=/Library/Java/JavaVirtualMachines/jdk-21.jdk/Contents/Home
export PATH=$JAVA_HOME/bin:$PATH

# 設定を反映
source ~/.bashrc  # または source ~/.zshrc</code></pre>
                            </li>
                        </ol>

                        <h6><i class="fas fa-check-circle"></i> 動作確認</h6>
                        <p>新しいターミナル/コマンドプロンプトを開いて、以下のコマンドを実行します：</p>
                        <pre class="code-block"><code class="language-bash">java -version
javac -version</code></pre>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <pre class="mb-0">openjdk version "21.0.x" 2024-xx-xx LTS
OpenJDK Runtime Environment (build 21.0.x.x.1 (build 21.0.x+xx-LTS)
OpenJDK 64-Bit Server VM (build 21.0.x.x.1 (build 21.0.x+xx-LTS, mixed mode, sharing)</pre>
                        </div>

                        <h6><i class="fas fa-exclamation-triangle"></i> トラブルシューティング</h6>
                        <div class="alert alert-warning">
                            <p><strong>エラー:</strong> 'java' は、内部コマンドまたは外部コマンド、操作可能なプログラムまたはバッチ ファイルとして認識されていません。</p>
                            <p><strong>解決方法:</strong></p>
                            <ul class="mb-0">
                                <li>環境変数PATHにJAVA_HOME\binが正しく追加されているか確認</li>
                                <li>ターミナル/コマンドプロンプトを再起動して再度確認</li>
                                <li>JAVA_HOMEのパスが正しいか確認（フォルダが実際に存在するか）</li>
                            </ul>
                        </div>
                    </div>

                    <!-- セクション1.2: Visual Studio Codeのセットアップ -->
                    <h3 class="section-title">1.2 Visual Studio Codeのセットアップと必要な拡張機能</h3>
                    <p>Visual Studio Code（VS Code）は軽量で高機能なコードエディタです。Java開発に必要な拡張機能をインストールします。</p>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-2: VS Codeと拡張機能のインストール</h5>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>VS Codeのインストール</strong>:
                                <ul>
                                    <li>公式サイトからダウンロード: <a href="https://code.visualstudio.com/" target="_blank">https://code.visualstudio.com/</a></li>
                                    <li>インストーラーを実行し、デフォルト設定でインストール</li>
                                    <li>「PATHへの追加」オプションにチェックを入れることを推奨</li>
                                </ul>
                            </li>

                            <li><strong>必須拡張機能のインストール</strong>:
                                <p>VS Codeを起動し、左サイドバーの拡張機能アイコン（四角が4つ）をクリックして、以下を検索してインストール：</p>
                                <ul>
                                    <li><strong>Extension Pack for Java</strong> (Microsoft) - Java開発の基本パック（Lombokサポート含む）</li>
                                    <li><strong>Spring Boot Extension Pack</strong> (VMware) - Spring Boot開発支援</li>
                                    <li><strong>Docker</strong> (Microsoft) - Dockerファイル編集とコンテナ管理</li>
                                    <li><strong>Gradle for Java</strong> (Microsoft) - Gradleビルドツール統合</li>
                                </ul>

                                <div class="alert alert-info mt-2">
                                    <strong>注意:</strong> Extension Pack for JavaにはLombokサポートが組み込まれているため、個別のLombok拡張機能をインストールする必要はありません。
                                </div>

                                <p>または、ターミナルから一括インストール：</p>
                                <pre class="code-block"><code class="language-bash">code --install-extension vscjava.vscode-java-pack
code --install-extension vmware.vscode-boot-dev-pack
code --install-extension ms-azuretools.vscode-docker
code --install-extension vscjava.vscode-gradle</code></pre>
                            </li>

                            <li><strong>VS Code設定の最適化</strong>:
                                <p>設定（Ctrl+,またはCmd+,）を開いて、以下を確認：</p>
                                <ul>
                                    <li>「Java: Home」がJDK 21のパスに設定されていることを確認</li>
                                    <li>自動保存を有効化: 「Files: Auto Save」を「afterDelay」に設定</li>
                                </ul>
                            </li>
                        </ol>

                        <h6><i class="fas fa-check-circle"></i> 動作確認</h6>
                        <p>VS Codeでコマンドパレット（Ctrl+Shift+P / Cmd+Shift+P）を開き、「Java: Configure Java Runtime」と入力して実行します。</p>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <p>Java Runtimeの設定画面が開き、JDK 21が認識されていることを確認できます。</p>
                        </div>
                    </div>

                    <!-- セクション1.3: Rancher Desktopのインストール -->
                    <h3 class="section-title">1.3 Rancher Desktopのインストールと動作確認</h3>
                    <p>Ollamaをコンテナで実行するため、Rancher Desktopをインストールします。Rancher Desktopは無料でオープンソースのコンテナ管理ツールです。</p>

                    <div class="alert alert-info alert-custom">
                        <h6><i class="fas fa-info-circle"></i> Windows環境の方へ</h6>
                        <p>Windows環境でRancher Desktopを使用するには、<strong>WSL 2（Windows Subsystem for Linux 2）</strong>が必要です。まだインストールしていない場合は、以下の手順でWSL 2をインストールしてください。</p>
                    </div>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-3A: Windows環境 - WSL 2のインストール（事前準備）</h5>
                        <p class="text-muted"><em>※ macOS/Linuxユーザーはこの手順をスキップして「実装 1-3B」に進んでください</em></p>

                        <h6><i class="fas fa-info-circle"></i> WSL 2とは</h6>
                        <p>WSL 2（Windows Subsystem for Linux 2）は、Windows上でLinux環境を実行するための機能です。Rancher DesktopはWSL 2をバックエンドとして使用し、コンテナを実行します。</p>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>PowerShellを管理者として起動</strong>:
                                <ul>
                                    <li>スタートメニューで「PowerShell」を検索</li>
                                    <li>「Windows PowerShell」を右クリック → 「管理者として実行」を選択</li>
                                </ul>
                            </li>

                            <li><strong>WSL 2のインストール</strong>:
                                <p>PowerShellで以下のコマンドを実行します：</p>
                                <pre class="code-block"><code class="language-bash"># WSL 2とUbuntuディストリビューションをインストール
wsl --install</code></pre>
                                <p>このコマンドは以下を自動的に実行します：</p>
                                <ul>
                                    <li>WSL機能の有効化</li>
                                    <li>仮想マシンプラットフォーム機能の有効化</li>
                                    <li>Linuxカーネルコンポーネントのダウンロードとインストール</li>
                                    <li>WSL 2をデフォルトバージョンに設定</li>
                                    <li>Ubuntuディストリビューションのインストール</li>
                                </ul>
                            </li>

                            <li><strong>システムの再起動</strong>:
                                <p>インストールが完了したら、PCを再起動します：</p>
                                <pre class="code-block"><code class="language-bash">shutdown /r /t 0</code></pre>
                            </li>

                            <li><strong>再起動後の初期設定</strong>:
                                <p>再起動後、Ubuntuが自動的に起動し、ユーザー名とパスワードの設定を求められます：</p>
                                <ul>
                                    <li>任意のユーザー名を入力（小文字英数字推奨）</li>
                                    <li>パスワードを入力（入力中は画面に表示されません）</li>
                                    <li>パスワードを再入力して確認</li>
                                </ul>
                                <div class="alert alert-warning mt-2">
                                    <strong>注意:</strong> このパスワードは忘れないようにメモしてください。sudo コマンド実行時に必要になります。
                                </div>
                            </li>

                            <li><strong>WSLのバージョン確認</strong>:
                                <p>新しいPowerShellウィンドウを開き、以下のコマンドでWSL 2が正しくインストールされたか確認します：</p>
                                <pre class="code-block"><code class="language-bash">wsl --list --verbose</code></pre>
                            </li>
                        </ol>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <pre class="mb-0">  NAME      STATE           VERSION
* Ubuntu    Running         2</pre>
                            <p class="mt-2 mb-0">VERSIONが「2」になっていればWSL 2が正しくインストールされています。</p>
                        </div>

                        <h6><i class="fas fa-exclamation-triangle"></i> トラブルシューティング</h6>
                        <div class="alert alert-warning">
                            <p><strong>エラー:</strong> VERSIONが「1」になっている場合</p>
                            <p><strong>解決方法:</strong> 以下のコマンドでWSL 2に変換します：</p>
                            <pre class="code-block"><code class="language-bash">wsl --set-version Ubuntu 2
wsl --set-default-version 2</code></pre>

                            <p class="mt-3"><strong>エラー:</strong> 仮想化が有効になっていないというエラーが出る場合</p>
                            <p><strong>解決方法:</strong> BIOS/UEFIで仮想化機能（Intel VT-x / AMD-V）を有効化する必要があります：</p>
                            <ul class="mb-0">
                                <li>PCを再起動し、起動時にBIOS/UEFI設定画面に入る（通常はF2、F10、DELキーなど）</li>
                                <li>「Virtualization Technology」や「VT-x」、「AMD-V」などの項目を探す</li>
                                <li>これらを「Enabled」に設定</li>
                                <li>設定を保存して再起動</li>
                            </ul>
                        </div>
                    </div>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-3B: Rancher Desktopのインストール</h5>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>Rancher Desktopのダウンロードとインストール</strong>:
                                <ul>
                                    <li>公式サイトからダウンロード: <a href="https://rancherdesktop.io/" target="_blank">https://rancherdesktop.io/</a></li>
                                    <li>OSに応じたインストーラーをダウンロード（Windows/macOS/Linux）</li>
                                    <li>インストーラーを実行</li>
                                    <li><strong>Windows:</strong> WSL 2バックエンドを有効化（推奨）</li>
                                    <li>インストール完了後、Rancher Desktopを起動</li>
                                </ul>
                            </li>


                            <li><strong>コンテナランタイムの選択(初回起動時)</strong>:
                                <p>Rancher Desktop初回起動時に、コンテナランタイムを選択します:</p>
                                <ul>
                                    <li><strong>dockerd (moby)</strong> を選択(推奨)</li>
                                    <li>このチュートリアルではdocker composeを使用するため、dockerdが必要です</li>
                                    <li>Preferences → Container Runtimeで後から変更可能</li>
                                </ul>
                            </li>

                            <li><strong>リソース設定の最適化</strong>:
                                <p>Ollamaのモデル（Qwen3:1.7b）を実行するために、十分なリソースを割り当てます。設定方法は環境によって異なります。</p>

                                <h6 class="mt-3"><i class="fab fa-windows"></i> Windows環境の場合</h6>
                                <p>Windows環境では、WSL 2のリソース設定を行います。</p>
                                <ol type="a">
                                    <li><strong>.wslconfigファイルの作成</strong>:
                                        <p>エクスプローラーでユーザーフォルダ（<code>C:\Users\ユーザー名</code>）を開き、メモ帳で新規ファイル <code>.wslconfig</code> を作成します。</p>
                                        <p>または、PowerShellで以下を実行：</p>
                                        <pre class="code-block"><code class="language-bash"># メモ帳で.wslconfigを作成
notepad $env:USERPROFILE\.wslconfig</code></pre>
                                    </li>

                                    <li><strong>リソース設定を記述</strong>:
                                        <p>.wslconfigファイルに以下の内容を記述して保存します：</p>
                                        <pre class="code-block"><code class="language-ini">[wsl2]
memory=8GB
processors=4
swap=2GB
localhostForwarding=true</code></pre>
                                        <div class="alert alert-info mt-2">
                                            <strong>設定の説明:</strong>
                                            <ul class="mb-0">
                                                <li><code>memory=8GB</code> - WSL 2に割り当てる最大メモリ（Qwen3:1.7bモデル用）</li>
                                                <li><code>processors=4</code> - WSL 2に割り当てるCPUコア数</li>
                                                <li><code>swap=2GB</code> - スワップメモリのサイズ</li>
                                                <li><code>localhostForwarding=true</code> - Windowsとのポート転送を有効化</li>
                                            </ul>
                                        </div>
                                    </li>

                                    <li><strong>WSLを再起動</strong>:
                                        <p>PowerShellで以下を実行して設定を反映します：</p>
                                        <pre class="code-block"><code class="language-bash"># WSLをシャットダウン
wsl --shutdown

# 設定が反映されたか確認（数秒待ってから実行）
wsl -l -v</code></pre>
                                    </li>
                                </ol>

                                <h6 class="mt-3"><i class="fab fa-apple"></i> macOS / <i class="fab fa-linux"></i> Linux環境の場合</h6>
                                <p>macOS/Linux環境では、Rancher Desktopの設定画面から直接リソースを設定できます。</p>
                                <ol type="a">
                                    <li>Rancher Desktopを起動</li>
                                    <li>メニューから <strong>Preferences</strong>（環境設定）を開く</li>
                                    <li><strong>Virtual Machine</strong> タブを選択</li>
                                    <li>以下のように設定:
                                        <ul>
                                            <li><strong>Memory:</strong> 8GB以上（Qwen3:1.7bモデル用）</li>
                                            <li><strong>CPUs:</strong> 4コア以上（推奨）</li>
                                            <li><strong>Disk:</strong> 20GB以上</li>
                                        </ul>
                                    </li>
                                    <li>設定を保存し、Rancher Desktopを再起動</li>
                                </ol>

                                <div class="alert alert-warning mt-3">
                                    <strong>注意:</strong> PCの物理メモリが16GB未満の場合は、メモリ割り当てを6GB程度に調整してください。割り当てすぎるとホストOSが不安定になる可能性があります。
                                </div>
                            </li>
                        </ol>

                        <h6><i class="fas fa-check-circle"></i> 動作確認</h6>
                        <p>ターミナルで以下のコマンドを実行します：</p>
                        <pre class="code-block"><code class="language-bash">docker --version
docker compose version
docker run hello-world</code></pre>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <pre class="mb-0">Docker version 24.0.x, build xxxxx
Docker Compose version v2.x.x

Hello from Docker!
This message shows that your installation appears to be working correctly.</pre>
                        </div>

                        <h6><i class="fas fa-exclamation-triangle"></i> トラブルシューティング</h6>
                        <div class="alert alert-warning">
                            <p><strong>Windows:</strong> "WSL 2が必要です" エラー</p>
                            <p><strong>解決方法:</strong> 上記の「実装 1-3A: Windows環境 - WSL 2のインストール」を参照してWSL 2をインストールしてください。</p>

                            <p class="mt-3"><strong>エラー:</strong> Dockerコマンドが見つからない</p>
                            <p><strong>解決方法:</strong></p>
                            <ul class="mb-0">
                                <li>Rancher Desktopが正しく起動しているか確認</li>
                                <li>ターミナル/コマンドプロンプトを再起動してパスを更新</li>
                                <li>Rancher Desktop → Preferences → Kubernetes で「Enable Kubernetes」のチェックを外すと起動が軽くなります（このチュートリアルではKubernetesは不要）</li>
                            </ul>
                        </div>
                    </div>

                    <!-- セクション1.4: Spring Initializrでプロジェクト作成 -->
                    <h3 class="section-title">1.4 Spring Initializrを使用したプロジェクト作成</h3>
                    <p>Spring InitializrのWebサイトを使用して、必要な依存関係を含むSpring Bootプロジェクトを簡単に作成します。</p>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-4: Spring Initializrでプロジェクト生成</h5>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>Spring Initializrにアクセス</strong>:
                                <p>ブラウザで <a href="https://start.spring.io/" target="_blank">https://start.spring.io/</a> を開きます。</p>
                            </li>

                            <li><strong>プロジェクト設定</strong>:
                                <ul>
                                    <li><strong>Project:</strong> Gradle - Groovy</li>
                                    <li><strong>Language:</strong> Java</li>
                                    <li><strong>Spring Boot:</strong> 3.4.0 (最新の安定版)</li>
                                    <li><strong>Project Metadata:</strong>
                                        <ul>
                                            <li>Group: <code>com.example</code></li>
                                            <li>Artifact: <code>ai-chat</code></li>
                                            <li>Name: <code>ai-chat</code></li>
                                            <li>Description: <code>AI Chat Application with Spring AI and Ollama</code></li>
                                            <li>Package name: <code>com.example.aichat</code></li>
                                            <li>Packaging: <code>Jar</code></li>
                                            <li>Java: <code>21</code></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>

                            <li><strong>依存関係の追加</strong>:
                                <p>右側の「ADD DEPENDENCIES」ボタンをクリックして、以下の依存関係を検索して追加します：</p>
                                <ul>
                                    <li><strong>Spring Web</strong> - RESTful Webアプリケーション開発</li>
                                    <li><strong>Thymeleaf</strong> - サーバーサイドテンプレートエンジン</li>
                                    <li><strong>Validation</strong> - Bean Validationサポート</li>
                                    <li><strong>Spring Boot DevTools</strong> - 開発時の自動リロード機能</li>
                                    <li><strong>Lombok</strong> - ボイラープレートコード削減（getter/setter自動生成）</li>
                                </ul>
                                <div class="alert alert-info mt-2">
                                    <strong>注意:</strong> Spring AI関連の依存関係は、後ほど手動でbuild.gradleに追加します。
                                </div>
                            </li>

                            <li><strong>プロジェクトの生成とダウンロード</strong>:
                                <p>「GENERATE」ボタン（Ctrl+Enter）をクリックして、ZIPファイルをダウンロードします。</p>
                            </li>

                            <li><strong>プロジェクトの展開</strong>:
                                <p>ダウンロードしたZIPファイルを任意のディレクトリに展開します：</p>
                                <pre class="code-block"><code class="language-bash"># Windowsの場合
# ダウンロードフォルダからZIPファイルを右クリック → すべて展開

# macOS/Linuxの場合
cd ~/Downloads
unzip ai-chat.zip
cd ai-chat</code></pre>
                            </li>

                            <li><strong>VS Codeでプロジェクトを開く</strong>:
                                <pre class="code-block"><code class="language-bash"># プロジェクトディレクトリで実行
code .</code></pre>
                            </li>
                        </ol>

                        <h6><i class="fas fa-info-circle"></i> 生成されたプロジェクト構造</h6>
                        <pre class="code-block"><code class="language-bash">ai-chat/
├── gradle/
│   └── wrapper/
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── src/
│   ├── main/
│   │   ├── java/com/example/aichat/
│   │   │   └── AiChatApplication.java    # メインクラス（自動生成）
│   │   └── resources/
│   │       ├── application.properties     # 設定ファイル
│   │       ├── static/                    # 静的リソース
│   │       └── templates/                 # Thymeleafテンプレート
│   └── test/
│       └── java/com/example/aichat/
│           └── AiChatApplicationTests.java
├── build.gradle                           # Gradleビルド設定
├── settings.gradle                        # プロジェクト設定
├── gradlew                                # Gradle Wrapper (Unix)
├── gradlew.bat                            # Gradle Wrapper (Windows)
└── HELP.md                                # 参考ドキュメント</code></pre>
                    </div>

                    <!-- セクション1.5: build.gradleの設定 -->
                    <h3 class="section-title">1.5 build.gradleにSpring AI依存関係を追加</h3>
                    <p>Spring InitializrではSpring AIの依存関係が選択できないため、手動でbuild.gradleに追加します。</p>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-5: build.gradleの編集</h5>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>build.gradleファイルを開く</strong>:
                                <p>VS Codeでプロジェクトルートの <code>build.gradle</code> を開きます。</p>
                            </li>

                            <li><strong>repositoriesセクションにSpring Milestoneリポジトリを追加</strong>:
                                <p><code>repositories</code> セクションを以下のように修正します：</p>
                                <pre class="code-block"><code class="language-groovy">repositories {
    mavenCentral()
    maven { url 'https://repo.spring.io/milestone' }  // この行を追加
}</code></pre>
                            </li>

                            <li><strong>dependenciesセクションにSpring AI依存関係を追加</strong>:
                                <p><code>dependencies</code> セクションに以下を追加します：</p>
                                <pre class="code-block"><code class="language-groovy">dependencies {
    // 既存の依存関係（Spring Initializrで生成されたもの）
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

    // Lombok（ボイラープレートコード削減）
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'

    // 以下を追加: Spring AI BOM
    implementation platform('org.springframework.ai:spring-ai-bom:1.0.0-M6')

    // 以下を追加: Spring AI Ollama
    implementation 'org.springframework.ai:spring-ai-ollama-spring-boot-starter'
}</code></pre>
                            </li>

                            <li><strong>完成したbuild.gradle</strong>:
                                <p>最終的なbuild.gradleの全体像：</p>
                                <pre class="code-block"><code class="language-groovy">plugins {
    id 'java'
    id 'org.springframework.boot' version '3.4.0'
    id 'io.spring.dependency-management' version '1.1.6'
}

group = 'com.example'
version = '0.0.1-SNAPSHOT'

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(21)
    }
}

repositories {
    mavenCentral()
    maven { url 'https://repo.spring.io/milestone' }
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    implementation 'org.springframework.boot:spring-boot-starter-web'
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'

    // Lombok
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'

    // Spring AI BOM
    implementation platform('org.springframework.ai:spring-ai-bom:1.0.0-M6')

    // Spring AI Ollama
    implementation 'org.springframework.ai:spring-ai-ollama-spring-boot-starter'
}

tasks.named('test') {
    useJUnitPlatform()
}</code></pre>
                            </li>
                        </ol>

                        <h6><i class="fas fa-check-circle"></i> 依存関係の解決と動作確認</h6>
                        <p>Gradle依存関係をダウンロードしてビルドを実行します：</p>
                        <pre class="code-block"><code class="language-bash"># Windows (コマンドプロンプト)
gradlew build --refresh-dependencies

# Windows (PowerShell)
.\gradlew build --refresh-dependencies

# macOS / Linux
./gradlew build --refresh-dependencies</code></pre>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <pre class="mb-0">BUILD SUCCESSFUL in 30s
7 actionable tasks: 7 executed</pre>
                        </div>

                        <h6><i class="fas fa-exclamation-triangle"></i> トラブルシューティング</h6>
                        <div class="alert alert-warning">
                            <p><strong>エラー:</strong> Could not resolve org.springframework.ai:spring-ai-bom:1.0.0-M6</p>
                            <p><strong>解決方法:</strong></p>
                            <ul class="mb-0">
                                <li>repositoriesセクションに <code>maven { url 'https://repo.spring.io/milestone' }</code> が追加されているか確認</li>
                                <li>インターネット接続を確認</li>
                                <li>Gradleキャッシュをクリア:
                                    <ul>
                                        <li>Windows: <code>gradlew clean --refresh-dependencies</code></li>
                                        <li>macOS/Linux: <code>./gradlew clean --refresh-dependencies</code></li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </div>

                    <!-- セクション1.6: Hello Worldアプリケーション -->
                    <h3 class="section-title">1.6 Hello Worldアプリケーションの作成と実行</h3>
                    <p>Spring Bootの基本的なアプリケーションを作成して、環境が正しく構築されているか確認します。</p>

                    <div class="exercise-container">
                        <h5><i class="fas fa-tasks"></i> 実装 1-6: メインクラスとコントローラーの作成</h5>

                        <h6><i class="fas fa-list-ol"></i> 手順</h6>
                        <ol>
                            <li><strong>メインクラスの確認</strong>:
                                <p>Spring Initializrによって、メインクラス <code>src/main/java/com/example/aichat/AiChatApplication.java</code> が既に生成されています。内容を確認します:</p>
                                <pre class="code-block"><code class="language-java">package com.example.aichat;

import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
public class AiChatApplication {

    public static void main(String[] args) {
        SpringApplication.run(AiChatApplication.class, args);
    }
}</code></pre>
                                <p>このファイルは既に存在するため、変更不要です。</p>
                            </li>
                            </li>

                            <li><strong>テストコントローラーの作成</strong>:
                                <p>src/main/java/com/example/aichat/HelloController.javaを作成：</p>
                                <pre class="code-block"><code class="language-java">package com.example.aichat;

import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RestController;

@RestController
public class HelloController {

    @GetMapping("/")
    public String hello() {
        return "Hello, Spring AI + Ollama World!";
    }
}</code></pre>
                            </li>

                            <li><strong>application.properties を application.yml に変更</strong>:
                                <p>Spring Initializrはデフォルトで <code>src/main/resources/application.properties</code> を生成します。
                                このファイルを削除して、代わりに <code>application.yml</code> を作成します:</p>
                                <pre class="code-block"><code class="language-bash"># Windows (コマンドプロンプト)
del src\main\resources\application.properties

# Windows (PowerShell)
Remove-Item src\main\resources\application.properties

# macOS / Linux
rm src/main/resources/application.properties</code></pre>
                                <p>次に、<code>src/main/resources/application.yml</code> を新規作成して以下の内容を記述します:</p>
                                <pre class="code-block"><code class="language-yaml">server:
  port: 8080

spring:
  application:
    name: ai-chat</code></pre>
                            </li>
                        </ol>

                        <h6><i class="fas fa-check-circle"></i> アプリケーションの実行</h6>
                        <p>Gradleコマンドでアプリケーションを起動します：</p>
                        <pre class="code-block"><code class="language-bash"># Windows (コマンドプロンプト)
gradlew bootRun

# Windows (PowerShell)
.\gradlew bootRun

# macOS / Linux
./gradlew bootRun</code></pre>

                        <h6><i class="fas fa-thumbs-up"></i> 期待される結果</h6>
                        <div class="alert alert-success">
                            <p>ブラウザで <code>http://localhost:8080</code> にアクセスすると、以下が表示されます：</p>
                            <pre class="mb-0">Hello, Spring AI + Ollama World!</pre>

                            <p class="mt-3">コンソールには以下のようなログが表示されます：</p>
                            <pre class="mb-0">  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::               (v3.4.0)

2025-11-11 xx:xx:xx.xxx  INFO xxxxx --- [  main] c.e.aichat.AiChatApplication   : Started AiChatApplication in x.xxx seconds</pre>
                        </div>

                        <h6><i class="fas fa-exclamation-triangle"></i> トラブルシューティング</h6>
                        <div class="alert alert-warning">
                            <p><strong>エラー:</strong> Port 8080 already in use</p>
                            <p><strong>解決方法:</strong></p>
                            <ul class="mb-0">
                                <li>別のアプリケーションがポート8080を使用している場合、そのアプリケーションを停止する</li>
                                <li>または、application.ymlでserver.portを別の値（例: 8081）に変更する</li>
                            </ul>
                        </div>
                    </div>

                    <!-- システム構成図 -->
                    <h3 class="section-title">1.7 構築した環境の全体像</h3>
                    <p>このステップで構築した開発環境の構成を図で確認します。</p>

                    <div class="mermaid">
                        flowchart TB
                            subgraph Dev["開発環境"]
                                JDK["JDK 21<br/>Oracle JDK"]
                                VSCode["VS Code<br/>+ 拡張機能"]
                                Docker["Rancher Desktop"]
                            end

                            subgraph Project["Gradleプロジェクト"]
                                Gradle["Gradle 7.6+<br/>Wrapper"]
                                Build["build.gradle<br/>Spring Boot 3.4.0<br/>Spring AI BOM 1.0.0-M6"]
                                App["AiChatApplication<br/>メインクラス"]
                            end

                            JDK --> Gradle
                            VSCode --> Project
                            Gradle --> Build
                            Build --> App
                            Docker -.-> |次ステップで使用| Future["Ollama<br/>コンテナ"]

                            style Dev fill:#fff3e0
                            style Project fill:#f0f7ff
                            style JDK fill:#f57c00,color:#fff
                            style VSCode fill:#007acc,color:#fff
                            style Docker fill:#2496ed,color:#fff
                    </div>

                    <!-- ステップ完了チェック -->
                    <div class="quiz-container">
                        <h5><i class="fas fa-clipboard-check"></i> ステップ1完了チェックリスト</h5>
                        <p>以下の項目が完了していることを確認してください：</p>
                        <ul class="list-unstyled">
                            <li><input type="checkbox"> JDK 21がインストールされ、<code>java -version</code>で確認できる</li>
                            <li><input type="checkbox"> JAVA_HOME環境変数が正しく設定されている</li>
                            <li><input type="checkbox"> Visual Studio Codeと必要な拡張機能がインストールされている</li>
                            <li><input type="checkbox"> Rancher Desktopがインストールされ、<code>docker --version</code>で確認できる</li>
                            <li><input type="checkbox"> <code>docker run hello-world</code>が成功する</li>
                            <li><input type="checkbox"> Spring Initializrでai-chatプロジェクトが生成されている</li>
                            <li><input type="checkbox"> build.gradleにSpring Boot 3.4.0とSpring AI BOM 1.0.0-M6が設定されている</li>
                            <li><input type="checkbox"> build.gradleにLombok依存関係（compileOnly/annotationProcessor）が設定されている</li>
                            <li><input type="checkbox"> AiChatApplicationメインクラスが存在する(Spring Initializrで自動生成)</li>
                            <li><input type="checkbox"> <code>gradlew bootRun</code> (Windows) または <code>./gradlew bootRun</code> (macOS/Linux) でアプリケーションが起動する</li>
                            <li><input type="checkbox"> ブラウザで http://localhost:8080 にアクセスして「Hello, Spring AI + Ollama World!」が表示される</li>
                        </ul>
                    </div>

                    <!-- 現在のファイル構成 -->
                    <div class="alert alert-light alert-custom">
                        <h6><i class="fas fa-folder-tree"></i> 現在のプロジェクト構成</h6>
                        <pre class="code-block"><code class="language-bash">ai-chat/
├── gradle/
│   └── wrapper/
│       ├── gradle-wrapper.jar
│       └── gradle-wrapper.properties
├── src/
│   ├── main/
│   │   ├── java/com/example/aichat/
│   │   │   ├── AiChatApplication.java    # メインクラス(自動生成)
│   │   │   └── HelloController.java      # テストコントローラー
│   │   └── resources/
│   │       └── application.yml           # アプリケーション設定
│   └── test/
│       └── java/com/example/aichat/
│           └── AiChatApplicationTests.java
├── build.gradle                          # Gradle依存関係設定
├── settings.gradle                       # プロジェクト設定
├── gradlew                               # Gradle Wrapper (Unix)
├── gradlew.bat                           # Gradle Wrapper (Windows)
└── HELP.md                               # 参考ドキュメント</code></pre>

                    <!-- 次のステップ -->
                    <div class="alert alert-info alert-custom">
                        <h6><i class="fas fa-forward"></i> 次のステップの予告</h6>
                        <p><strong>ステップ2: Spring AIとOllamaの統合設定</strong>では、以下の内容を実装します：</p>
                        <ul class="mb-0">
                            <li>Spring AIフレームワークの概要理解</li>
                            <li>spring-ai-ollama-spring-boot-starterの設定</li>
                            <li>application.ymlでのOllama接続設定</li>
                            <li>ChatClientインターフェースを使用した基本的なAI対話機能</li>
                        </ul>
                    </div>

                    <!-- ステップ間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-5 mb-4">
                        <a href="README.html" class="btn btn-secondary">
                            <i class="fas fa-home"></i> チュートリアルTOP
                        </a>
                        <a href="step2-spring-ai-ollama-integration.html" class="btn btn-primary">
                            次のステップ：Spring AIとOllama統合 <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">© 2025 F-Circle. All rights reserved.<br>
本資料はAIツールを活用し、人間による編集・監修のもと作成されています。無断転載・再配布を禁じます。</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>

    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>
