<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Struts 1.xè¶…å…¥é–€ ç¬¬3ç«  - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã¨DAOè¨­è¨ˆï¼ˆWindows + Eclipseå¯¾å¿œï¼‰</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ãƒ™ãƒ¼ã‚¹ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ - Javaç”Ÿæ…‹ç³»ãƒ†ãƒ¼ãƒ */
        .navbar {
            background-color: #f57c00;
        }

        .navbar-brand, .navbar-nav .nav-link {
            color: white !important;
        }

        .navbar-nav .nav-link:hover {
            color: #fff3e0 !important;
        }

        /* ã‚µã‚¤ãƒ‰ãƒãƒ¼ */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: white;
            border-right: 1px solid #dee2e6;
        }

        .sidebar .nav-link {
            color: #495057;
            font-weight: 500;
        }

        .sidebar .nav-link:hover {
            background-color: #fff3e0;
            color: #f57c00;
        }

        .sidebar .nav-link.active {
            background-color: #f57c00 !important;
            color: white !important;
        }

        /* ã‚¿ã‚¤ãƒˆãƒ« */
        .chapter-title {
            color: #f57c00;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #f57c00;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #ff9800;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãƒœãƒƒã‚¯ã‚¹ */
        .quiz-container {
            background-color: #fff3e0;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #f57c00;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
        .nav-link.active {
            background-color: #f57c00 !important;
            color: white !important;
        }

        /* ã‚³ãƒ¼ãƒ‰ãƒ–ãƒ­ãƒƒã‚¯ */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
        }
    </style>
</head>
<body>
    <!-- ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="index.html">Struts 1.x è¶…å…¥é–€ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="https://fcircle-biz.github.io/tech_docs/">ãƒ›ãƒ¼ãƒ </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«æ¦‚è¦</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#section3-1">3.1 PostgreSQLè¨­å®š</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#section3-2">3.2 JDBCæ¥ç¶šè¨­å®š</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#section3-3">3.3 DAOãƒ‘ã‚¿ãƒ¼ãƒ³å®Ÿè£…</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#section3-4">3.4 æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#section3-5">3.5 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#quiz">ç†è§£åº¦ç¢ºèª</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ç¬¬3ç« : ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã¨DAOè¨­è¨ˆï¼ˆåˆå¿ƒè€…å‘ã‘ï¼‰</h1>
                </div>

                <div id="chapter3">
                    <!-- ç« ã‚¿ã‚¤ãƒˆãƒ« -->
                    <h2 class="chapter-title">PostgreSQLé€£æºã¨ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã®å®Ÿè£…</h2>
                    
                    <div class="highlight">
                        <h5>ğŸ‘‹ åˆå¿ƒè€…ã®æ–¹ã¸</h5>
                        <p>ã“ã®ç« ã§ã¯ã€Webã‚¢ãƒ—ãƒªãŒ<strong>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹</strong>ã¨ã‚„ã‚Šå–ã‚Šã™ã‚‹æ–¹æ³•ã‚’å­¦ã³ã¾ã™ã€‚<strong>Windowsç’°å¢ƒã§PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</strong>ã—ã€Eclipseã§Javaã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’ä¿å­˜ãƒ»å–å¾—ã—ã¾ã™ã€‚</p>
                        <p><strong>ã€Œãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã€ã‚„ã€ŒDAOã€ãªã©ã€é›£ã—ã„å˜èªã‚‚ä¸å¯§ã«èª¬æ˜ã—ã¾ã™ï¼</strong></p>
                    </div>
                    
                    <!-- å­¦ç¿’ç›®æ¨™ï¼ˆå¿…é ˆï¼‰ -->
                    <div class="highlight">
                        <h5>ğŸ¯ ã“ã®ç« ã§å­¦ã¶ã“ã¨</h5>
                        <ul>
                            <li><strong>ğŸ’¾ PostgreSQL</strong> - Windowsã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚½ãƒ•ãƒˆã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦è¨­å®š</li>
                            <li><strong>ğŸ“ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ãƒ¼ãƒ–ãƒ«</strong> - ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹è¡¨ã‚’ä½œæˆ</li>
                            <li><strong>ğŸ”— JDBCæ¥ç¶š</strong> - Javaã‚¢ãƒ—ãƒªã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹æ–¹æ³•</li>
                            <li><strong>ğŸ  DAOãƒ‘ã‚¿ãƒ¼ãƒ³</strong> - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œã‚’æ•´ç†ã™ã‚‹æ–¹æ³•</li>
                            <li><strong>ğŸŠ æ¥ç¶šãƒ—ãƒ¼ãƒ«</strong> - ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šã‚’åŠ¹ç‡çš„ã«ç®¡ç†ã™ã‚‹æŠ€è¡“</li>
                            <li><strong>ğŸ”„ ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³</strong> - ãƒ‡ãƒ¼ã‚¿ã®ä¸€è²«æ€§ã‚’ä¿ã¤ä»•çµ„ã¿</li>
                        </ul>
                        <p><em>ãƒ¡ãƒ¢: é›£ã—ã„å˜èªãŒãŸãã•ã‚“å‡ºã¦ãã¾ã™ãŒã€ä¸€ã¤ãšã¤ä¸å¯§ã«èª¬æ˜ã—ã¾ã™ï¼</em></p>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3.1 -->
                    <h3 class="section-title" id="section3-1">3.1 ğŸ’¾ Windowsã§PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†</h3>
                    <p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã£ã¦ä½•ï¼Ÿã©ã†ã‚„ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ï¼Ÿåˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒã—ã¦Windowsã§PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã€ã‚¢ãƒ—ãƒªç”¨ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œã£ã¦ã¿ã¾ã—ã‚‡ã†ï¼</p>
                    
                    <div class="highlight">
                        <h5>ğŸ’¡ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã£ã¦ä½•ï¼Ÿ</h5>
                        <p>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¯ã€Œ<strong>ãƒ‡ã‚¸ã‚¿ãƒ«ã®ãƒ•ã‚¡ã‚¤ãƒªãƒ³ã‚°ã‚­ãƒ£ãƒ“ãƒãƒƒãƒˆ</strong>ã€ã¿ãŸã„ãªã‚‚ã®ã§ã™ã€‚</p>
                        <ul>
                            <li>ğŸ“ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã€å•†å“æƒ…å ±ãªã©ã‚’æ•´ç†ã—ã¦ä¿å­˜</li>
                            <li>ğŸ” å¿…è¦ãªæƒ…å ±ã‚’ç´ æ—©ãæ¢ã—ã¦å–ã‚Šå‡ºã—</li>
                            <li>ğŸ”’ ãƒ‡ãƒ¼ã‚¿ã®ä¸€è²«æ€§ã¨å®‰å…¨æ€§ã‚’ä¿è­·</li>
                        </ul>
                        <p><strong>PostgreSQL</strong>ã¯ç„¡æ–™ã§ä½¿ãˆã‚‹é«˜æ€§èƒ½ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚½ãƒ•ãƒˆã§ã™ï¼</p>
                    </div>

                    <!-- å®Ÿç¿’ï¼ˆå¿…é ˆï¼‰ -->
                    <div class="exercise-container">
                        <h5>ğŸ“‹ å®Ÿç¿’ 3-1: Windowsã§PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†</h5>
                        <p>åˆå¿ƒè€…ã§ã‚‚å®‰å¿ƒï¼Windowsã§PostgreSQLã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>ğŸ”¸ ã‚¹ãƒ†ãƒƒãƒ— 1: PostgreSQLã®Windowsã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</h6>
                        <ol>
                            <li><a href="https://www.postgresql.org/download/windows/" target="_blank">PostgreSQLå…¬å¼ã‚µã‚¤ãƒˆ</a>ã«ã‚¢ã‚¯ã‚»ã‚¹</li>
                            <li>ã€Œ<strong>Download the installer</strong>ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li><strong>Windows x86-64</strong>ã®æœ€æ–°ç‰ˆï¼ˆä¾‹: 15.xï¼‰ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰</li>
                            <li>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸ<code>.exe</code>ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã§å®Ÿè¡Œ</li>
                            <li>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã®æŒ‡ç¤ºã«å¾“ã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚’é€²ã‚ã‚‹</li>
                        </ol>
                        
                        <div class="warning">
                            <h6>âš ï¸ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã®é‡è¦ãªè¨­å®š</h6>
                            <ul>
                                <li><strong>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰è¨­å®š</strong>: postgresãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™ã€‚<strong>å¿…ãšè¦šãˆã¦ãŠã„ã¦ãã ã•ã„ï¼</strong></li>
                                <li><strong>ãƒãƒ¼ãƒˆç•ªå·</strong>: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã®5432ã®ã¾ã¾ã§OK</li>
                                <li><strong>ãƒ­ã‚±ãƒ¼ãƒ«</strong>: ã€ŒJapanese, Japanã€ã‚’é¸æŠ</li>
                            </ul>
                        </div>
                        
                        <h6>ğŸ”¸ ã‚¹ãƒ†ãƒƒãƒ— 2: pgAdminã§PostgreSQLã«æ¥ç¶š</h6>
                        <p>PostgreSQLã¨ä¸€ç·’ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã‚‹<strong>pgAdmin</strong>ã¨ã„ã†ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ“ä½œã—ã¾ã™ã€‚</p>
                        <ol>
                            <li><strong>Windowsãƒ¡ãƒ‹ãƒ¥ãƒ¼</strong>ã‹ã‚‰ã€ŒpgAdmin 4ã€ã‚’èµ·å‹•</li>
                            <li>ãƒ–ãƒ©ã‚¦ã‚¶ã§pgAdminãŒé–‹ãã¾ã™</li>
                            <li>å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã€Œ<strong>Servers</strong>ã€ â†’ ã€Œ<strong>PostgreSQL 15</strong>ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            <li>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ™‚ã«è¨­å®šã—ãŸ<strong>ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰</strong>ã‚’å…¥åŠ›</li>
                            <li>æ¥ç¶šæˆåŠŸï¼ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
                        </ol>

                        <h6>ğŸ”¸ ã‚¹ãƒ†ãƒƒãƒ— 3: ã‚¢ãƒ—ãƒªç”¨ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ</h6>
                        <p>pgAdminã§ã‚°ãƒ©ãƒ•ã‚£ã‚«ãƒ«ã«ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã¨ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <div class="highlight">
                            <h6>3-1. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ä½œæˆ</h6>
                            <ol>
                                <li>pgAdminã§ã€Œ<strong>PostgreSQL 15</strong>ã€ â†’ ã€Œ<strong>Databases</strong>ã€ã‚’å³ã‚¯ãƒªãƒƒã‚¯</li>
                                <li>ã€Œ<strong>Create</strong>ã€ â†’ ã€Œ<strong>Database...</strong>ã€ã‚’é¸æŠ</li>
                                <li>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹åã«ã€Œ<strong>strutsdb</strong>ã€ã¨å…¥åŠ›</li>
                                <li>ã€Œ<strong>Save</strong>ã€ã‚’ã‚¯ãƒªãƒƒã‚¯</li>
                            </ol>
                        </div>
                        
                        <div class="highlight">
                            <h6>3-2. usersãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆ</h6>
                            <ol>
                                <li>ä½œæˆã—ãŸã€Œ<strong>strutsdb</strong>ã€ã‚’å±•é–‹ â†’ ã€Œ<strong>Schemas</strong>ã€ â†’ ã€Œ<strong>public</strong>ã€</li>
                                <li>ã€Œ<strong>Tools</strong>ã€ãƒ¡ãƒ‹ãƒ¥ãƒ¼ â†’ ã€Œ<strong>Query Tool</strong>ã€ã‚’é¸æŠ</li>
                                <li>ä»¥ä¸‹ã®SQLã‚’ã‚³ãƒ”ãƒ¼ã—ã¦è²¼ã‚Šä»˜ã‘ï¼š</li>
                            </ol>
                        </div>
                        
                        <h6>ğŸ“„ SQLã‚³ãƒ¼ãƒ‰ï¼ˆã‚³ãƒ”ãƒ¼ã—ã¦pgAdminã«è²¼ã‚Šä»˜ã‘ï¼‰</h6>
                        <pre><code>-- usersãƒ†ãƒ¼ãƒ–ãƒ«ä½œæˆï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’ä¿å­˜ã™ã‚‹è¡¨ï¼‰
CREATE TABLE users (
    user_id SERIAL PRIMARY KEY,              -- è‡ªå‹•æ¡ç•ªã®ID
    username VARCHAR(50) NOT NULL UNIQUE,    -- ãƒ¦ãƒ¼ã‚¶ãƒ¼åï¼ˆé‡è¤‡ä¸å¯ï¼‰
    email VARCHAR(100) NOT NULL,             -- ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹
    full_name VARCHAR(100) NOT NULL,         -- æ°å
    birth_date DATE,                         -- ç”Ÿå¹´æœˆæ—¥
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,  -- ä½œæˆæ—¥æ™‚
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP   -- æ›´æ–°æ—¥æ™‚
);

-- ç´¢å¼•ä½œæˆï¼ˆæ¤œç´¢ã‚’é«˜é€ŸåŒ–ï¼‰
CREATE INDEX idx_users_username ON users(username);
CREATE INDEX idx_users_email ON users(email);

-- ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿æŒ¿å…¥ï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
INSERT INTO users (username, email, full_name, birth_date) VALUES
('admin', 'admin@example.com', 'ç®¡ç†è€…', '1990-01-01'),
('user01', 'user01@example.com', 'ç”°ä¸­å¤ªéƒ', '1985-05-15'),
('user02', 'user02@example.com', 'ä½è—¤èŠ±å­', '1992-08-20');

-- ãƒ‡ãƒ¼ã‚¿ç¢ºèªï¼ˆä½œæˆã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã‚’è¡¨ç¤ºï¼‰
SELECT * FROM users;</code></pre>
                        
                        <div class="highlight">
                            <h6>3-3. SQLå®Ÿè¡Œæ–¹æ³•</h6>
                            <ol>
                                <li>ä¸Šè¨˜SQLã‚’pgAdminã®Query Toolã«è²¼ã‚Šä»˜ã‘</li>
                                <li>ã€Œ<strong>â–¶ï¸ å®Ÿè¡Œ</strong>ã€ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ï¼ˆã¾ãŸã¯F5ã‚­ãƒ¼ï¼‰</li>
                                <li>ã‚¨ãƒ©ãƒ¼ãŒãªã‘ã‚Œã°æˆåŠŸï¼ä¸‹éƒ¨ã«ã‚µãƒ³ãƒ—ãƒ«ãƒ‡ãƒ¼ã‚¿ãŒè¡¨ç¤ºã•ã‚Œã¾ã™</li>
                            </ol>
                        </div>

                        <h6>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ</h6>
                        <pre><code>-- ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ç”¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
CREATE USER strutsuser WITH PASSWORD 'password123';

-- æ¨©é™ä»˜ä¸
GRANT CONNECT ON DATABASE strutsdb TO strutsuser;
GRANT USAGE ON SCHEMA public TO strutsuser;
GRANT SELECT, INSERT, UPDATE, DELETE ON TABLE users TO strutsuser;
GRANT USAGE, SELECT ON SEQUENCE users_user_id_seq TO strutsuser;</code></pre>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3.2 -->
                    <h3 class="section-title" id="section3-2">3.2 JDBCæ¥ç¶šè¨­å®š</h3>
                    <p>PostgreSQL JDBCãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã®è¿½åŠ ã¨æ¥ç¶šè¨­å®šã‚’è¡Œã„ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 3-2: JDBCä¾å­˜é–¢ä¿‚è¿½åŠ </h5>
                        <p>pom.xmlã«PostgreSQL JDBCãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚’è¿½åŠ ã—ã¾ã™ã€‚</p>
                        
                        <h6>pom.xml ä¾å­˜é–¢ä¿‚è¿½åŠ </h6>
                        <pre><code>&lt;dependencies&gt;
    &lt;!-- æ—¢å­˜ã®ä¾å­˜é–¢ä¿‚... --&gt;
    
    &lt;!-- PostgreSQL JDBC ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.postgresql&lt;/groupId&gt;
        &lt;artifactId&gt;postgresql&lt;/artifactId&gt;
        &lt;version&gt;42.6.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- Apache Commons DBCP (æ¥ç¶šãƒ—ãƒ¼ãƒ«) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
        &lt;artifactId&gt;commons-dbcp2&lt;/artifactId&gt;
        &lt;version&gt;2.9.0&lt;/version&gt;
    &lt;/dependency&gt;
    
    &lt;!-- H2 Database (ãƒ†ã‚¹ãƒˆç”¨) --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.h2database&lt;/groupId&gt;
        &lt;artifactId&gt;h2&lt;/artifactId&gt;
        &lt;version&gt;2.2.220&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</code></pre>

                        <h6>database.propertiesä½œæˆ</h6>
                        <p>src/main/resources/database.properties:</p>
                        <pre><code># PostgreSQLæœ¬ç•ªç’°å¢ƒè¨­å®š
db.driver=org.postgresql.Driver
db.url=jdbc:postgresql://localhost:5432/strutsdb
db.username=strutsuser
db.password=password123

# æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š
db.initialSize=5
db.maxTotal=20
db.maxIdle=10
db.minIdle=5
db.maxWaitMillis=10000

# H2é–‹ç™ºç’°å¢ƒè¨­å®šï¼ˆã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆï¼‰
#db.driver=org.h2.Driver
#db.url=jdbc:h2:mem:testdb;DB_CLOSE_DELAY=-1;MODE=PostgreSQL
#db.username=sa
#db.password=</code></pre>

                        <h6>DatabaseManager.javaå®Ÿè£…</h6>
                        <p>src/main/java/com/example/struts/db/DatabaseManager.java:</p>
                        <pre><code>package com.example.struts.db;

import java.io.IOException;
import java.io.InputStream;
import java.sql.Connection;
import java.sql.SQLException;
import java.util.Properties;

import org.apache.commons.dbcp2.BasicDataSource;

public class DatabaseManager {
    
    private static DatabaseManager instance;
    private BasicDataSource dataSource;
    
    private DatabaseManager() {
        initializeDataSource();
    }
    
    public static synchronized DatabaseManager getInstance() {
        if (instance == null) {
            instance = new DatabaseManager();
        }
        return instance;
    }
    
    private void initializeDataSource() {
        try {
            // ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿
            Properties props = new Properties();
            InputStream is = getClass().getClassLoader()
                .getResourceAsStream("database.properties");
            props.load(is);
            is.close();
            
            // ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹è¨­å®š
            dataSource = new BasicDataSource();
            dataSource.setDriverClassName(props.getProperty("db.driver"));
            dataSource.setUrl(props.getProperty("db.url"));
            dataSource.setUsername(props.getProperty("db.username"));
            dataSource.setPassword(props.getProperty("db.password"));
            
            // æ¥ç¶šãƒ—ãƒ¼ãƒ«è¨­å®š
            dataSource.setInitialSize(
                Integer.parseInt(props.getProperty("db.initialSize", "5")));
            dataSource.setMaxTotal(
                Integer.parseInt(props.getProperty("db.maxTotal", "20")));
            dataSource.setMaxIdle(
                Integer.parseInt(props.getProperty("db.maxIdle", "10")));
            dataSource.setMinIdle(
                Integer.parseInt(props.getProperty("db.minIdle", "5")));
            dataSource.setMaxWaitMillis(
                Long.parseLong(props.getProperty("db.maxWaitMillis", "10000")));
            
        } catch (IOException e) {
            throw new RuntimeException("ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹è¨­å®šã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ", e);
        }
    }
    
    public Connection getConnection() throws SQLException {
        return dataSource.getConnection();
    }
    
    public void shutdown() throws SQLException {
        if (dataSource != null) {
            dataSource.close();
        }
    }
}</code></pre>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3.3 -->
                    <h3 class="section-title" id="section3-3">3.3 DAOãƒ‘ã‚¿ãƒ¼ãƒ³ã®å®Ÿè£…</h3>
                    <p>Data Access Object ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ä½¿ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹å±¤ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 3-3: User ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã¨DAOå®Ÿè£…</h5>
                        <p>ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ‡ãƒ¼ã‚¿ã®ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¯ãƒ©ã‚¹ã¨DAOã‚’ä½œæˆã—ã¾ã™ã€‚</p>
                        
                        <h6>User.java ã‚¨ãƒ³ãƒ†ã‚£ãƒ†ã‚£ã‚¯ãƒ©ã‚¹</h6>
                        <p>src/main/java/com/example/struts/model/User.java:</p>
                        <pre><code>package com.example.struts.model;

import java.sql.Date;
import java.sql.Timestamp;

public class User {
    private int userId;
    private String username;
    private String email;
    private String fullName;
    private Date birthDate;
    private Timestamp createdAt;
    private Timestamp updatedAt;
    
    // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    public User() {}
    
    // ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ä»˜ãã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿
    public User(String username, String email, String fullName, Date birthDate) {
        this.username = username;
        this.email = email;
        this.fullName = fullName;
        this.birthDate = birthDate;
    }
    
    // getter/setterãƒ¡ã‚½ãƒƒãƒ‰
    public int getUserId() { return userId; }
    public void setUserId(int userId) { this.userId = userId; }
    
    public String getUsername() { return username; }
    public void setUsername(String username) { this.username = username; }
    
    public String getEmail() { return email; }
    public void setEmail(String email) { this.email = email; }
    
    public String getFullName() { return fullName; }
    public void setFullName(String fullName) { this.fullName = fullName; }
    
    public Date getBirthDate() { return birthDate; }
    public void setBirthDate(Date birthDate) { this.birthDate = birthDate; }
    
    public Timestamp getCreatedAt() { return createdAt; }
    public void setCreatedAt(Timestamp createdAt) { this.createdAt = createdAt; }
    
    public Timestamp getUpdatedAt() { return updatedAt; }
    public void setUpdatedAt(Timestamp updatedAt) { this.updatedAt = updatedAt; }
    
    @Override
    public String toString() {
        return String.format("User{userId=%d, username='%s', email='%s', fullName='%s'}",
                userId, username, email, fullName);
    }
}</code></pre>

                        <h6>UserDAO ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ•ã‚§ãƒ¼ã‚¹</h6>
                        <p>src/main/java/com/example/struts/dao/UserDAO.java:</p>
                        <pre><code>package com.example.struts.dao;

import java.sql.SQLException;
import java.util.List;
import com.example.struts.model.User;

public interface UserDAO {
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’ç™»éŒ²
     * @param user ç™»éŒ²ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼
     * @return ç™»éŒ²ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ï¼ˆIDãŒè¨­å®šã•ã‚Œã‚‹ï¼‰
     */
    User insert(User user) throws SQLException;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
     * @param userId ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
     * @return æ¤œç´¢ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã€å­˜åœ¨ã—ãªã„å ´åˆã¯null
     */
    User findById(int userId) throws SQLException;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼åã§ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æ¤œç´¢
     * @param username ãƒ¦ãƒ¼ã‚¶ãƒ¼å
     * @return æ¤œç´¢ã•ã‚ŒãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã€å­˜åœ¨ã—ãªã„å ´åˆã¯null
     */
    User findByUsername(String username) throws SQLException;
    
    /**
     * å…¨ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å–å¾—
     * @return ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒªã‚¹ãƒˆ
     */
    List&lt;User&gt; findAll() throws SQLException;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’æ›´æ–°
     * @param user æ›´æ–°ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼
     * @return æ›´æ–°ãŒæˆåŠŸã—ãŸå ´åˆtrue
     */
    boolean update(User user) throws SQLException;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤
     * @param userId å‰Šé™¤ã™ã‚‹ãƒ¦ãƒ¼ã‚¶ãƒ¼ID
     * @return å‰Šé™¤ãŒæˆåŠŸã—ãŸå ´åˆtrue
     */
    boolean delete(int userId) throws SQLException;
    
    /**
     * ãƒ¦ãƒ¼ã‚¶ãƒ¼æ•°ã‚’ã‚«ã‚¦ãƒ³ãƒˆ
     * @return ãƒ¦ãƒ¼ã‚¶ãƒ¼ç·æ•°
     */
    int count() throws SQLException;
}</code></pre>

                        <h6>UserDAOImpl å®Ÿè£…ã‚¯ãƒ©ã‚¹</h6>
                        <p>src/main/java/com/example/struts/dao/impl/UserDAOImpl.java:</p>
                        <pre><code>package com.example.struts.dao.impl;

import java.sql.*;
import java.util.ArrayList;
import java.util.List;

import com.example.struts.dao.UserDAO;
import com.example.struts.db.DatabaseManager;
import com.example.struts.model.User;

public class UserDAOImpl implements UserDAO {
    
    private static final String INSERT_SQL = 
        "INSERT INTO users (username, email, full_name, birth_date) VALUES (?, ?, ?, ?)";
    
    private static final String SELECT_BY_ID_SQL = 
        "SELECT * FROM users WHERE user_id = ?";
    
    private static final String SELECT_BY_USERNAME_SQL = 
        "SELECT * FROM users WHERE username = ?";
    
    private static final String SELECT_ALL_SQL = 
        "SELECT * FROM users ORDER BY created_at DESC";
    
    private static final String UPDATE_SQL = 
        "UPDATE users SET username = ?, email = ?, full_name = ?, birth_date = ?, " +
        "updated_at = CURRENT_TIMESTAMP WHERE user_id = ?";
    
    private static final String DELETE_SQL = 
        "DELETE FROM users WHERE user_id = ?";
    
    private static final String COUNT_SQL = 
        "SELECT COUNT(*) FROM users";
    
    @Override
    public User insert(User user) throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             PreparedStatement pstmt = conn.prepareStatement(INSERT_SQL, 
                     Statement.RETURN_GENERATED_KEYS)) {
            
            pstmt.setString(1, user.getUsername());
            pstmt.setString(2, user.getEmail());
            pstmt.setString(3, user.getFullName());
            pstmt.setDate(4, user.getBirthDate());
            
            int affectedRows = pstmt.executeUpdate();
            
            if (affectedRows &gt; 0) {
                try (ResultSet generatedKeys = pstmt.getGeneratedKeys()) {
                    if (generatedKeys.next()) {
                        user.setUserId(generatedKeys.getInt(1));
                        return user;
                    }
                }
            }
            throw new SQLException("ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆã«å¤±æ•—ã—ã¾ã—ãŸ");
        }
    }
    
    @Override
    public User findById(int userId) throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             PreparedStatement pstmt = conn.prepareStatement(SELECT_BY_ID_SQL)) {
            
            pstmt.setInt(1, userId);
            
            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return mapResultSetToUser(rs);
                }
            }
        }
        return null;
    }
    
    @Override
    public User findByUsername(String username) throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             PreparedStatement pstmt = conn.prepareStatement(SELECT_BY_USERNAME_SQL)) {
            
            pstmt.setString(1, username);
            
            try (ResultSet rs = pstmt.executeQuery()) {
                if (rs.next()) {
                    return mapResultSetToUser(rs);
                }
            }
        }
        return null;
    }
    
    @Override
    public List&lt;User&gt; findAll() throws SQLException {
        List&lt;User&gt; users = new ArrayList&lt;&gt;();
        
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(SELECT_ALL_SQL)) {
            
            while (rs.next()) {
                users.add(mapResultSetToUser(rs));
            }
        }
        return users;
    }
    
    @Override
    public boolean update(User user) throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             PreparedStatement pstmt = conn.prepareStatement(UPDATE_SQL)) {
            
            pstmt.setString(1, user.getUsername());
            pstmt.setString(2, user.getEmail());
            pstmt.setString(3, user.getFullName());
            pstmt.setDate(4, user.getBirthDate());
            pstmt.setInt(5, user.getUserId());
            
            return pstmt.executeUpdate() &gt; 0;
        }
    }
    
    @Override
    public boolean delete(int userId) throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             PreparedStatement pstmt = conn.prepareStatement(DELETE_SQL)) {
            
            pstmt.setInt(1, userId);
            return pstmt.executeUpdate() &gt; 0;
        }
    }
    
    @Override
    public int count() throws SQLException {
        try (Connection conn = DatabaseManager.getInstance().getConnection();
             Statement stmt = conn.createStatement();
             ResultSet rs = stmt.executeQuery(COUNT_SQL)) {
            
            if (rs.next()) {
                return rs.getInt(1);
            }
        }
        return 0;
    }
    
    private User mapResultSetToUser(ResultSet rs) throws SQLException {
        User user = new User();
        user.setUserId(rs.getInt("user_id"));
        user.setUsername(rs.getString("username"));
        user.setEmail(rs.getString("email"));
        user.setFullName(rs.getString("full_name"));
        user.setBirthDate(rs.getDate("birth_date"));
        user.setCreatedAt(rs.getTimestamp("created_at"));
        user.setUpdatedAt(rs.getTimestamp("updated_at"));
        return user;
    }
}</code></pre>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3.4 -->
                    <h3 class="section-title" id="section3-4">3.4 æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®è¨­å®š</h3>
                    <p>Apache Commons DBCPã‚’ä½¿ç”¨ã—ãŸæ¥ç¶šãƒ—ãƒ¼ãƒ«ã®è©³ç´°è¨­å®šã‚’å­¦ç¿’ã—ã¾ã™ã€‚</p>

                    <div class="highlight">
                        <h5>æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®åˆ©ç‚¹</h5>
                        <ul>
                            <li><strong>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š</strong>: æ¥ç¶šã®ä½œæˆãƒ»ç ´æ£„ã®ã‚ªãƒ¼ãƒãƒ¼ãƒ˜ãƒƒãƒ‰å‰Šæ¸›</li>
                            <li><strong>ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†</strong>: åŒæ™‚æ¥ç¶šæ•°ã®åˆ¶å¾¡</li>
                            <li><strong>å®‰å®šæ€§å‘ä¸Š</strong>: ä¸æ­£ãªæ¥ç¶šã®è‡ªå‹•æ¤œå‡ºã¨å›å¾©</li>
                        </ul>
                    </div>

                    <!-- ã‚»ã‚¯ã‚·ãƒ§ãƒ³3.5 -->
                    <h3 class="section-title" id="section3-5">3.5 ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†</h3>
                    <p>ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã‚’ä¿ã¤ãŸã‚ã®ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>

                    <div class="exercise-container">
                        <h5>å®Ÿç¿’ 3-4: ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†å®Ÿè£…</h5>
                        <p>UserServiceã‚¯ãƒ©ã‚¹ã§ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã‚’å®Ÿè£…ã—ã¾ã™ã€‚</p>
                        
                        <h6>UserService.java</h6>
                        <p>src/main/java/com/example/struts/service/UserService.java:</p>
                        <pre><code>package com.example.struts.service;

import java.sql.Connection;
import java.sql.SQLException;
import java.util.List;

import com.example.struts.dao.UserDAO;
import com.example.struts.dao.impl.UserDAOImpl;
import com.example.struts.db.DatabaseManager;
import com.example.struts.model.User;

public class UserService {
    
    private UserDAO userDAO = new UserDAOImpl();
    
    public boolean authenticate(String username, String password) {
        try {
            User user = userDAO.findByUsername(username);
            // å®Ÿéš›ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–ãŒå¿…è¦
            return user != null && "password".equals(password);
        } catch (SQLException e) {
            return false;
        }
    }
    
    public User createUser(User user) throws SQLException {
        Connection conn = null;
        try {
            conn = DatabaseManager.getInstance().getConnection();
            conn.setAutoCommit(false);
            
            // é‡è¤‡ãƒã‚§ãƒƒã‚¯
            User existing = userDAO.findByUsername(user.getUsername());
            if (existing != null) {
                throw new SQLException("ãƒ¦ãƒ¼ã‚¶ãƒ¼åãŒæ—¢ã«å­˜åœ¨ã—ã¾ã™: " + user.getUsername());
            }
            
            // ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
            User createdUser = userDAO.insert(user);
            
            // ã“ã“ã§ä»–ã®é–¢é€£ãƒ†ãƒ¼ãƒ–ãƒ«ã®å‡¦ç†ã‚‚è¡Œãˆã‚‹
            // ä¾‹: ãƒ­ã‚°ãƒ†ãƒ¼ãƒ–ãƒ«ã¸ã®è¨˜éŒ²ãªã©
            
            conn.commit();
            return createdUser;
            
        } catch (SQLException e) {
            if (conn != null) {
                try {
                    conn.rollback();
                } catch (SQLException rollbackEx) {
                    e.addSuppressed(rollbackEx);
                }
            }
            throw e;
        } finally {
            if (conn != null) {
                try {
                    conn.setAutoCommit(true);
                    conn.close();
                } catch (SQLException e) {
                    // ãƒ­ã‚°å‡ºåŠ›
                }
            }
        }
    }
    
    public User getUserById(int userId) throws SQLException {
        return userDAO.findById(userId);
    }
    
    public User getUserByUsername(String username) throws SQLException {
        return userDAO.findByUsername(username);
    }
    
    public List&lt;User&gt; getAllUsers() throws SQLException {
        return userDAO.findAll();
    }
    
    public boolean updateUser(User user) throws SQLException {
        Connection conn = null;
        try {
            conn = DatabaseManager.getInstance().getConnection();
            conn.setAutoCommit(false);
            
            // æ—¢å­˜ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å­˜åœ¨ç¢ºèª
            User existing = userDAO.findById(user.getUserId());
            if (existing == null) {
                throw new SQLException("æ›´æ–°å¯¾è±¡ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã—ã¾ã›ã‚“: " + user.getUserId());
            }
            
            // æ›´æ–°å®Ÿè¡Œ
            boolean result = userDAO.update(user);
            
            if (result) {
                conn.commit();
                return true;
            } else {
                conn.rollback();
                return false;
            }
            
        } catch (SQLException e) {
            if (conn != null) {
                try {
                    conn.rollback();
                } catch (SQLException rollbackEx) {
                    e.addSuppressed(rollbackEx);
                }
            }
            throw e;
        } finally {
            if (conn != null) {
                try {
                    conn.setAutoCommit(true);
                    conn.close();
                } catch (SQLException e) {
                    // ãƒ­ã‚°å‡ºåŠ›
                }
            }
        }
    }
    
    public boolean deleteUser(int userId) throws SQLException {
        return userDAO.delete(userId);
    }
    
    public int getUserCount() throws SQLException {
        return userDAO.count();
    }
}</code></pre>
                    </div>

                    <!-- æ³¨æ„ç‚¹ -->
                    <div class="warning">
                        <h5>âš ï¸ é‡è¦ãªãƒã‚¤ãƒ³ãƒˆ</h5>
                        <ul>
                            <li>PostgreSQLã®SERIALå‹ã¯è‡ªå‹•çš„ã«ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™</li>
                            <li>æ¥ç¶šãƒ—ãƒ¼ãƒ«ã®ã‚µã‚¤ã‚ºã¯ç’°å¢ƒã«å¿œã˜ã¦èª¿æ•´ã—ã¦ãã ã•ã„</li>
                            <li>æœ¬ç•ªç’°å¢ƒã§ã¯é©åˆ‡ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ¦ãƒ¼ã‚¶ãƒ¼æ¨©é™è¨­å®šãŒå¿…è¦ã§ã™</li>
                            <li>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³å‡¦ç†ã§ã¯å¿…ãšrollbackã¨connection.close()ã‚’é©åˆ‡ã«å®Ÿè£…ã—ã¦ãã ã•ã„</li>
                            <li>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã®ãŸã‚PreparedStatementã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„</li>
                        </ul>
                    </div>

                    <!-- ç†è§£åº¦ç¢ºèªï¼ˆå¿…é ˆï¼‰ -->
                    <div class="quiz-container" id="quiz">
                        <h5>ç†è§£åº¦ç¢ºèªã‚¯ã‚¤ã‚º</h5>
                        <ol>
                            <li>PostgreSQLã§è‡ªå‹•æ¡ç•ªã‚’è¡Œã†éš›ã«ä½¿ç”¨ã™ã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>DAOãƒ‘ã‚¿ãƒ¼ãƒ³ã®ä¸»ãªåˆ©ç‚¹ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>æ¥ç¶šãƒ—ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã™ã‚‹ä¸»ãªãƒ¡ãƒªãƒƒãƒˆã‚’2ã¤æŒ™ã’ã¦ãã ã•ã„ã€‚</li>
                            <li>ãƒˆãƒ©ãƒ³ã‚¶ã‚¯ã‚·ãƒ§ãƒ³ç®¡ç†ã§å¿…é ˆã®å‡¦ç†ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>SQLã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³å¯¾ç­–ã¨ã—ã¦æ¨å¥¨ã•ã‚Œã‚‹JDBCã®æ©Ÿèƒ½ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                            <li>PreparedStatementã§ã‚¯ã‚¨ãƒªçµæœã‚’å–å¾—ã™ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã¯ä½•ã§ã™ã‹ï¼Ÿ</li>
                        </ol>
                        
                        <details class="mt-3">
                            <summary>è§£ç­”ã‚’ç¢ºèª</summary>
                            <ol>
                                <li>SERIAL</li>
                                <li>ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã¨ãƒ‡ãƒ¼ã‚¿ã‚¢ã‚¯ã‚»ã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã®åˆ†é›¢ã€ãƒ†ã‚¹ã‚¿ãƒ“ãƒªãƒ†ã‚£ã®å‘ä¸Š</li>
                                <li>ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Šï¼ˆæ¥ç¶šã®å†åˆ©ç”¨ï¼‰ã€ãƒªã‚½ãƒ¼ã‚¹ç®¡ç†ï¼ˆåŒæ™‚æ¥ç¶šæ•°åˆ¶å¾¡ï¼‰</li>
                                <li>commit()ã€rollback()ã€connection.close()ã®é©åˆ‡ãªå®Ÿè£…</li>
                                <li>PreparedStatement</li>
                                <li>executeQuery()</li>
                            </ol>
                        </details>
                    </div>

                    <!-- ç« é–“ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ï¼ˆå¿…é ˆï¼‰ -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step2-struts-config-mvc.html" class="btn btn-secondary">â† å‰ã®ç« : Strutsè¨­å®šã¨MVC</a>
                        <a href="step4-user-create-read.html" class="btn btn-primary">æ¬¡ã®ç« : ãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†æ©Ÿèƒ½ï¼ˆCREATE, READï¼‰ â†’</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ã‚¹ãƒ ãƒ¼ã‚¹ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });

        // ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãƒªãƒ³ã‚¯æ›´æ–°
        window.addEventListener('scroll', function() {
            let current = '';
            const sections = document.querySelectorAll('h3[id], div[id]');
            
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }
            });

            document.querySelectorAll('.sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === '#' + current) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>