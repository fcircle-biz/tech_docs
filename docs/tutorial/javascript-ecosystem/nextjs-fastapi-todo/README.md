# Next.js + FastAPI + PostgreSQL Todoアプリ 完全入門チュートリアル

プログラミング未経験の方でも安心して学べる、Todoアプリ開発の完全入門チュートリアルです。フロントエンド（画面）にNext.js、バックエンド（サーバー）にFastAPI、データベースにPostgreSQL（Docker）を使用し、Windows環境で一からアプリケーションを構築していきます。

## このチュートリアルについて

### 何を作るの？

シンプルな「Todoリスト」アプリケーションを作ります。Todoリストとは、やることリストのことです。

```
┌─────────────────────────────────────────────────────┐
│  Todo リスト                                         │
├─────────────────────────────────────────────────────┤
│  ┌───────────────────────────────────┐ [追加]      │
│  │ 新しいタスクを入力...              │              │
│  └───────────────────────────────────┘              │
│                                                      │
│  [すべて] [未完了] [完了済み]                         │
│                                                      │
│  ☐ 牛乳を買う                          [編集][削除] │
│  ☑ レポートを提出（取り消し線）         [編集][削除] │
│  ☐ 部屋を掃除する                      [編集][削除] │
│                                                      │
└─────────────────────────────────────────────────────┘
```

### 完成するとできること

1. **タスクを追加できる** - 「牛乳を買う」などのやることを登録
2. **タスク一覧を見られる** - 登録したやることを一覧で確認
3. **タスクを編集できる** - 内容を後から変更
4. **タスクを削除できる** - 不要になったものを消去
5. **完了/未完了を切り替えられる** - 終わったらチェックを付ける
6. **フィルターで絞り込める** - 未完了だけ、完了だけを表示

### なぜこの技術を使うの？

| 技術 | 役割 | たとえると... |
|------|------|--------------|
| **Next.js** | 画面を作る（フロントエンド） | お店の「店頭」。お客様が見る部分 |
| **FastAPI** | データを処理する（バックエンド） | お店の「バックヤード」。裏で作業する部分 |
| **PostgreSQL** | データを保存する（データベース） | お店の「倉庫」。商品を保管する場所 |
| **Docker** | 環境を簡単に作る（コンテナ） | 「引っ越し用の箱」。環境をまとめて運べる |

## 学習目標

このチュートリアルを終えると、以下のことができるようになります。

### 理解できること

- Webアプリケーションの仕組み（フロントエンド・バックエンド・データベースの関係）
- APIとは何か、どうやって通信するのか
- データベースにデータを保存・取得する方法
- Dockerを使った開発環境の構築方法

### できるようになること

- Windows環境での開発環境セットアップ
- Next.jsで画面（UI）を作成
- FastAPIでAPIサーバーを構築
- PostgreSQLでデータを管理
- フロントエンドとバックエンドの連携

## 対象読者

### このチュートリアルに向いている人

- プログラミングを始めたばかりの方
- Webアプリケーション開発に興味がある方
- 「フロントエンド」「バックエンド」の違いを知りたい方
- 手を動かしながら学びたい方
- Windows環境で開発したい方

### 前提知識（なくても大丈夫！）

以下の知識があると理解しやすいですが、なくてもチュートリアル内で説明します。

- パソコンの基本操作（ファイル作成、フォルダ移動など）
- キーボード入力（英数字、記号の入力）
- ブラウザの使い方（Chrome、Edgeなど）

## 前提条件・環境要件

### 必要なもの

| 項目 | 要件 | 説明 |
|------|------|------|
| **パソコン** | Windows 10/11（64ビット版） | お使いのWindowsパソコン |
| **メモリ** | 8GB以上推奨 | Dockerを動かすために必要 |
| **ストレージ** | 空き容量10GB以上 | ソフトウェアをインストールするため |
| **インターネット** | 常時接続 | ソフトウェアのダウンロードに必要 |

### インストールするソフトウェア

チュートリアルの中で以下のソフトウェアをインストールします。事前にインストールする必要はありません。

| ソフトウェア | バージョン | 用途 |
|-------------|-----------|------|
| **Visual Studio Code** | 最新版 | コードを書くためのエディタ |
| **Node.js** | 18.17以上（LTS版） | Next.jsを動かすために必要 |
| **Python** | 3.10以上 | FastAPIを動かすために必要 |
| **Docker Desktop** | 最新版 | PostgreSQLを簡単に動かすため |
| **Git** | 最新版 | バージョン管理（必須ではない） |

## チュートリアル構成

全11ステップで、段階的にアプリケーションを完成させます。

### Step 1: 開発環境の準備

Windows環境に必要なソフトウェアをインストールし、開発を始める準備をします。

**学ぶこと:**
- Visual Studio Codeのインストールと設定
- Node.jsのインストール
- Pythonのインストール
- Docker Desktopのインストールとセットアップ
- 各ツールの動作確認

**所要時間:** 約2時間

**このステップを終えると:**
- 開発に必要なすべてのソフトウェアが揃います
- コマンドプロンプトやターミナルの基本操作ができるようになります

---

### Step 2: DockerでPostgreSQLデータベースを構築

Dockerを使って、データを保存するためのPostgreSQLデータベースを立ち上げます。

**学ぶこと:**
- Dockerとは何か、なぜ使うのか
- docker-compose.ymlファイルの書き方
- PostgreSQLコンテナの起動と停止
- pgAdminを使ったデータベースの確認
- データベースとテーブルの作成

**所要時間:** 約1.5時間

**このステップを終えると:**
- Dockerでデータベースを起動・停止できるようになります
- pgAdminでデータベースの中身を確認できるようになります

**作成するファイル:**
```yaml
# docker-compose.yml
version: '3.8'
services:
  postgres:
    image: postgres:16
    container_name: todo_postgres
    environment:
      POSTGRES_USER: todo_user
      POSTGRES_PASSWORD: todo_password
      POSTGRES_DB: todo_db
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data

  pgadmin:
    image: dpage/pgadmin4
    container_name: todo_pgadmin
    environment:
      PGADMIN_DEFAULT_EMAIL: admin@example.com
      PGADMIN_DEFAULT_PASSWORD: admin
    ports:
      - "5050:80"
    depends_on:
      - postgres

volumes:
  postgres_data:
```

**作成するテーブル:**
```sql
CREATE TABLE todos (
    id SERIAL PRIMARY KEY,
    title VARCHAR(200) NOT NULL,
    completed BOOLEAN DEFAULT FALSE,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);
```

---

### Step 3: FastAPIバックエンドの基礎

PythonのFastAPIを使って、データを処理するバックエンド（API）を作成します。

**学ぶこと:**
- APIとは何か
- FastAPIプロジェクトの作成
- 仮想環境（venv）の使い方
- 最初のAPIエンドポイント作成
- Swagger UIでAPIをテスト

**所要時間:** 約2時間

**このステップを終えると:**
- FastAPIサーバーを起動できるようになります
- ブラウザからAPIを呼び出せるようになります

**プロジェクト構成:**
```
backend/
├── main.py           # メインのAPIファイル
├── database.py       # データベース接続設定
├── models.py         # データモデル定義
├── schemas.py        # リクエスト/レスポンス定義
├── crud.py           # データベース操作
└── requirements.txt  # 必要なパッケージ一覧
```

**API一覧:**
| メソッド | パス | 説明 |
|----------|------|------|
| GET | /api/todos | タスク一覧を取得 |
| POST | /api/todos | 新しいタスクを作成 |
| PUT | /api/todos/{id} | タスクを更新 |
| DELETE | /api/todos/{id} | タスクを削除 |

---

### Step 4: タスク一覧表示機能（バックエンド）

データベースからタスクを取得して返すAPIを実装します。

**学ぶこと:**
- SQLModelでのデータベース接続
- ORM（オブジェクト関係マッピング）の基本
- GETリクエストの処理
- クエリパラメータによるフィルタリング

**所要時間:** 約2時間

**このステップを終えると:**
- データベースからデータを取得できるようになります
- 条件を指定してデータを絞り込めるようになります

**実装するAPI:**
```python
# タスク一覧取得（フィルター付き）
GET /api/todos?status=all    # すべて
GET /api/todos?status=active # 未完了のみ
GET /api/todos?status=completed # 完了済みのみ
```

---

### Step 5: タスク作成・更新・削除機能（バックエンド）

タスクの追加、編集、削除を行うAPIを実装します。

**学ぶこと:**
- POSTリクエストでデータを作成
- PUTリクエストでデータを更新
- DELETEリクエストでデータを削除
- バリデーション（入力チェック）の基本
- エラーハンドリング

**所要時間:** 約2.5時間

**このステップを終えると:**
- CRUD操作（作成・読取・更新・削除）の基本がわかります
- APIからデータベースを操作できるようになります

**バリデーションルール:**
| 項目 | ルール |
|------|--------|
| タイトル | 必須、1〜200文字 |

**エラーメッセージ例:**
| 状況 | メッセージ |
|------|------------|
| タイトル未入力 | タイトルを入力してください |
| タイトルが長すぎる | タイトルは200文字以内で入力してください |
| タスクが見つからない | 指定されたタスクは存在しません |

---

### Step 6: Next.jsフロントエンドの基礎

ユーザーが操作する画面（UI）をNext.jsで作成します。

**学ぶこと:**
- Next.jsプロジェクトの作成
- コンポーネントの基本
- JSXの書き方
- Tailwind CSSでのスタイリング
- 開発サーバーの起動

**所要時間:** 約2時間

**このステップを終えると:**
- Next.jsでWebページを作れるようになります
- 見た目（CSS）を整えられるようになります

**プロジェクト構成:**
```
frontend/
├── app/
│   ├── layout.tsx    # 共通レイアウト
│   ├── page.tsx      # トップページ
│   └── globals.css   # グローバルスタイル
├── components/
│   ├── TodoList.tsx  # タスク一覧コンポーネント
│   ├── TodoItem.tsx  # タスク1件のコンポーネント
│   ├── TodoForm.tsx  # タスク入力フォーム
│   └── Filter.tsx    # フィルターボタン
├── package.json
└── tailwind.config.js
```

---

### Step 7: CORS設定とタスク一覧表示

フロントエンドとバックエンドを連携させる第一歩として、CORS設定とタスク一覧の取得・表示を行います。

**学ぶこと:**
- CORS（クロスオリジン）とは何か、なぜ必要か
- FastAPIにCORS設定を追加する方法
- fetch APIでバックエンドと通信する基本
- useStateとuseEffectの基本
- タスク一覧を取得して表示する方法

**所要時間:** 約1時間

**このステップを終えると:**
- フロントエンドからAPIを呼び出せるようになります
- データベースのタスクが画面に表示されます

---

### Step 8: タスク追加機能

新しいタスクを入力して追加する機能を実装します。

**学ぶこと:**
- フォームの状態管理
- POSTリクエストでデータを送信する方法
- フォーム送信後の画面更新
- 入力バリデーションの基本

**所要時間:** 約1時間

**このステップを終えると:**
- 画面からタスクを追加できるようになります
- 追加したタスクがデータベースに保存されます

---

### Step 9: タスクの完了切替・削除機能

タスクの完了/未完了を切り替える機能と、タスクを削除する機能を実装します。

**学ぶこと:**
- PUTリクエストでデータを更新する方法
- DELETEリクエストでデータを削除する方法
- チェックボックスのイベント処理
- 削除確認ダイアログの表示

**所要時間:** 約1時間

**このステップを終えると:**
- タスクの完了/未完了を切り替えられるようになります
- 不要なタスクを削除できるようになります

---

### Step 10: フィルター機能の実装

「すべて」「未完了」「完了済み」でタスクを絞り込むフィルター機能を実装します。

**学ぶこと:**
- フィルター状態の管理
- クエリパラメータを使ったAPI呼び出し
- ボタンの選択状態の表示

**所要時間:** 約45分

**このステップを終えると:**
- タスクを条件で絞り込んで表示できるようになります
- 完成したTodoアプリの全機能が動作します

---

### Step 11: アプリの仕上げとまとめ

UIを整え、エラー処理を追加して、アプリケーションを完成させます。

**学ぶこと:**
- エラー表示の実装
- ローディング表示の追加
- UIの改善（アニメーションなど）
- 動作確認とデバッグ
- 次のステップへの案内

**所要時間:** 約1.5時間

**このステップを終えると:**
- 完成したTodoアプリを動かせるようになります
- 次に学ぶべきことがわかります

---

## 環境セットアップ概要

### 1. Visual Studio Codeのインストール

```
1. https://code.visualstudio.com/ にアクセス
2. 「Download for Windows」をクリック
3. ダウンロードしたファイルを実行
4. 画面の指示に従ってインストール
```

**推奨する拡張機能:**
- Japanese Language Pack（日本語化）
- Python
- ES7+ React/Redux/React-Native snippets
- Tailwind CSS IntelliSense
- Docker

### 2. Node.jsのインストール

```
1. https://nodejs.org/ にアクセス
2. 「LTS版」をクリックしてダウンロード
3. ダウンロードしたファイルを実行
4. 画面の指示に従ってインストール
```

**動作確認:**
```bash
# コマンドプロンプトで実行
node --version
# v18.x.x や v20.x.x と表示されればOK

npm --version
# 9.x.x や 10.x.x と表示されればOK
```

### 3. Pythonのインストール

```
1. https://www.python.org/downloads/ にアクセス
2. 「Download Python 3.x.x」をクリック
3. ダウンロードしたファイルを実行
4. 「Add Python to PATH」に必ずチェックを入れる
5. 「Install Now」をクリック
```

**動作確認:**
```bash
# コマンドプロンプトで実行
python --version
# Python 3.10.x や Python 3.11.x と表示されればOK

pip --version
# pip 23.x.x と表示されればOK
```

### 4. Docker Desktopのインストール

```
1. https://www.docker.com/products/docker-desktop/ にアクセス
2. 「Download for Windows」をクリック
3. ダウンロードしたファイルを実行
4. WSL 2のインストールが求められたら「OK」をクリック
5. インストール完了後、PCを再起動
```

**動作確認:**
```bash
# コマンドプロンプトで実行
docker --version
# Docker version 24.x.x と表示されればOK

docker-compose --version
# Docker Compose version v2.x.x と表示されればOK
```

## プロジェクト全体構成

最終的なフォルダ構成は以下のようになります。

```
todo-app/
├── docker-compose.yml      # データベース環境設定
│
├── backend/                # バックエンド（FastAPI）
│   ├── main.py            # メインのAPIファイル
│   ├── database.py        # データベース接続
│   ├── models.py          # データモデル
│   ├── schemas.py         # 入出力定義
│   ├── crud.py            # CRUD操作
│   ├── requirements.txt   # 必要パッケージ
│   └── venv/              # 仮想環境（自動生成）
│
└── frontend/               # フロントエンド（Next.js）
    ├── app/
    │   ├── layout.tsx
    │   ├── page.tsx
    │   └── globals.css
    ├── components/
    │   ├── TodoList.tsx
    │   ├── TodoItem.tsx
    │   ├── TodoForm.tsx
    │   └── Filter.tsx
    ├── package.json
    ├── tailwind.config.js
    └── node_modules/       # パッケージ（自動生成）
```

## 学習の進め方

### おすすめの学習方法

1. **順番に進める**
   - Step 1から順番に進めてください
   - 各ステップは前のステップの知識が必要です

2. **実際にコードを書く**
   - コピー&ペーストだけでなく、自分で入力してみましょう
   - 打ち間違いがあっても、エラーから学べます

3. **動作確認を必ず行う**
   - 各ステップの最後に動作確認があります
   - 動かない場合は、トラブルシューティングを参照

4. **わからないことはメモする**
   - すべてを完璧に理解する必要はありません
   - 後で復習できるようにメモを残しましょう

### 1日の学習目安

| 1日の時間 | 完了までの日数 |
|-----------|---------------|
| 1時間 | 約2〜3週間 |
| 2時間 | 約1〜2週間 |
| 4時間 | 約4〜5日 |

**総所要時間:** 約17時間（個人差あり）

## トラブルシューティング

### よくある問題と解決方法

#### 「コマンドが見つかりません」と表示される

**原因:** ソフトウェアが正しくインストールされていないか、PATHが設定されていない

**解決方法:**
1. パソコンを再起動してみる
2. インストールをやり直す
3. Pythonの場合は「Add Python to PATH」にチェックが入っているか確認

#### Dockerが起動しない

**原因:** WSL 2が有効になっていない、または仮想化が無効

**解決方法:**
1. Windowsの設定 → アプリ → オプション機能 → Windowsのその他の機能
2. 「仮想マシン プラットフォーム」と「Linux用Windowsサブシステム」にチェック
3. PCを再起動

#### データベースに接続できない

**原因:** Dockerコンテナが起動していない

**解決方法:**
```bash
# コンテナの状態を確認
docker-compose ps

# コンテナが停止していたら起動
docker-compose up -d
```

#### 画面が表示されない

**原因:** サーバーが起動していない、またはポートが間違っている

**解決方法:**
1. フロントエンド: http://localhost:3000 を確認
2. バックエンド: http://localhost:8000 を確認
3. サーバーが起動しているかターミナルを確認

## 参考リソース

### 公式ドキュメント

- [Next.js公式ドキュメント（日本語）](https://nextjs.org/docs)
- [FastAPI公式ドキュメント](https://fastapi.tiangolo.com/ja/)
- [PostgreSQL公式ドキュメント](https://www.postgresql.org/docs/)
- [Docker公式ドキュメント](https://docs.docker.com/)
- [Tailwind CSS公式ドキュメント](https://tailwindcss.com/docs)

### 初心者向けリソース

- [Progate](https://prog-8.com/) - プログラミング学習サービス
- [ドットインストール](https://dotinstall.com/) - 動画でプログラミングを学ぶ
- [Qiita](https://qiita.com/) - プログラマーの情報共有サービス

### 困ったときは

- エラーメッセージをGoogle検索してみる
- ChatGPTに質問してみる
- Qiitaで似たような問題を探す

## このチュートリアルで学べないこと

初心者向けのため、以下の内容は含まれていません。将来的に学ぶことをおすすめします。

- **ユーザー認証・ログイン機能** - セキュリティの基本
- **本番環境へのデプロイ** - インターネットに公開する方法
- **テストの書き方** - 品質を保証する方法
- **TypeScriptの詳細** - 型安全な開発
- **状態管理ライブラリ** - Redux、Zustandなど

## 次のステップ

このチュートリアルを完了したら、以下のことに挑戦してみましょう。

### すぐにできること

1. **機能を追加してみる**
   - 期限（締め切り日）を追加
   - カテゴリ分け機能を追加
   - 検索機能を追加

2. **デザインを変更してみる**
   - 色を変えてみる
   - レイアウトを変えてみる
   - アニメーションを追加

### 次に学ぶべきこと

1. **ユーザー認証** - NextAuth.jsを使ったログイン機能
2. **TypeScript** - 型を使った安全な開発
3. **テスト** - JestやPytestを使ったテスト
4. **デプロイ** - VercelやAWSへの公開

## まとめ

このチュートリアルでは、プログラミング未経験の方でも理解できるよう、以下の内容を段階的に学びます。

| ステップ | 内容 | 学ぶこと |
|----------|------|----------|
| Step 1 | 環境構築 | 開発ツールのセットアップ |
| Step 2 | データベース設計 | Docker、PostgreSQL |
| Step 3 | バックエンド基礎 | FastAPI、API |
| Step 4 | データ取得 | SQLModel、ORM |
| Step 5 | CRUD操作 | 作成・更新・削除 |
| Step 6 | フロントエンド基礎 | Next.js、React |
| Step 7 | CORS設定と一覧表示 | API通信の基礎 |
| Step 8 | タスク追加 | POSTリクエスト |
| Step 9 | 完了切替・削除 | PUT/DELETEリクエスト |
| Step 10 | フィルター機能 | クエリパラメータ |
| Step 11 | 仕上げ | UI改善、エラー処理 |

一歩一歩進めていけば、必ずアプリケーションを完成させることができます。わからないことがあっても、焦らず一つずつ解決していきましょう。

プログラミングの世界へようこそ！

---

**最初のステップ:** [Step 1: 開発環境の準備](https://fcircle-biz.github.io/tech_docs/tutorial/javascript-ecosystem/nextjs-fastapi-todo/nextjs-fastapi-todo-tutorial-01.html)
