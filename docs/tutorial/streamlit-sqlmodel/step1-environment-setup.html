<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Streamlit + SQLModel チュートリアル Step 1 - 環境構築とDockerセットアップ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <style>
        /* ベースレイアウト */
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }

        /* ナビゲーション */
        .navbar {
            background-color: #0066cc;
        }

        /* サイドバー */
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }

        /* タイトル */
        .chapter-title {
            color: #0066cc;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #0066cc;
            padding-bottom: 0.5rem;
        }

        .section-title {
            color: #3399ff;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }

        /* コンテンツボックス */
        .quiz-container {
            background-color: #e6f2ff;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #0066cc;
        }

        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }

        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }

        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }

        /* ナビゲーション */
        .nav-link.active {
            background-color: #0066cc !important;
            color: white !important;
        }

        .nav-link {
            color: #495057;
        }

        .nav-link:hover {
            background-color: #e6f2ff;
        }

        /* コードブロック */
        pre {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 1rem;
            overflow-x: auto;
        }

        code {
            background-color: #f8f9fa;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            font-size: 0.875em;
        }

        .img-preview {
            max-width: 100%;
            height: auto;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            margin: 1rem 0;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../index.html">Tech Docs</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../index.html">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="../streamlit-sqlmodel/README.html">Streamlit + SQLModel</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading px-3 mt-4 mb-1 text-muted">
                        Streamlit + SQLModel チュートリアル
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="#step1">Step 1: 環境構築</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-design.html">Step 2: データベース設計</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-user-registration.html">Step 3: ユーザー登録機能</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-list-display.html">Step 4: ユーザー一覧表示</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-crud-operations.html">Step 5: CRUD操作</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-security-deployment.html">Step 6: セキュリティとデプロイ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- 章ヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 1: 環境構築とDockerセットアップ</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <div class="btn-group me-2">
                            <span class="badge bg-info">所要時間: 2時間</span>
                        </div>
                    </div>
                </div>

                <div id="step1">
                    <!-- 章タイトル -->
                    <h2 class="chapter-title">Windows環境でのStreamlit + SQLModel開発環境構築</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Windows環境でのDocker Desktop設定とWSL2統合</li>
                            <li>PostgreSQLコンテナの起動と基本設定</li>
                            <li>Python仮想環境の作成と管理</li>
                            <li>Streamlit、SQLModel、psycopg2のインストール</li>
                            <li>プロジェクト構造の設計と作成</li>
                            <li>基本的なStreamlitアプリケーションの動作確認</li>
                        </ul>
                    </div>

                    <!-- セクション1: 前提条件 -->
                    <h3 class="section-title">1.1 前提条件の確認</h3>
                    <p>このチュートリアルを始める前に、以下の環境が準備されていることを確認してください。</p>

                    <div class="warning">
                        <h6>重要な前提条件</h6>
                        <ul>
                            <li><strong>Windows 10/11</strong>（Pro、Enterprise、Education推奨）</li>
                            <li><strong>WSL2の有効化</strong>（Windows Subsystem for Linux 2）</li>
                            <li><strong>Hyper-Vの有効化</strong>または<strong>仮想化機能の有効化</strong></li>
                            <li><strong>管理者権限</strong>でのコマンド実行権限</li>
                            <li>最低8GB以上のRAM（16GB推奨）</li>
                            <li>20GB以上の空きディスク容量</li>
                        </ul>
                    </div>

                    <!-- セクション2: Docker Desktop設定 -->
                    <h3 class="section-title">1.2 Docker Desktop for Windowsのインストールと設定</h3>
                    
                    <h4>Docker Desktopのダウンロードとインストール</h4>
                    <p>Docker Desktop for Windowsを公式サイトからダウンロードし、インストールします。</p>

                    <div class="exercise-container">
                        <h5>実習 1-1: Docker Desktopのインストール</h5>
                        <p>Docker Desktop for Windowsをインストールし、WSL2バックエンドを設定します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><a href="https://www.docker.com/products/docker-desktop/" target="_blank">Docker Desktop公式サイト</a>からDocker Desktop for Windowsをダウンロード</li>
                            <li>ダウンロードしたインストーラーを管理者権限で実行</li>
                            <li>インストール時に「Use WSL 2 instead of Hyper-V」にチェックを入れる</li>
                            <li>インストール完了後、システムを再起動</li>
                            <li>Docker Desktopを起動し、初期設定を完了</li>
                        </ol>

                        <h6>設定確認コマンド</h6>
                        <pre><code># Docker バージョン確認
docker --version

# Docker Compose バージョン確認
docker-compose --version

# WSL2 統合確認
docker run hello-world</code></pre>

                        <h6>期待される結果</h6>
                        <p>各コマンドがエラーなく実行され、hello-worldコンテナが正常に動作することを確認してください。</p>
                    </div>

                    <h4>WSL2統合の設定</h4>
                    <p>Docker DesktopがWSL2と正しく統合されていることを確認し、必要に応じて設定を調整します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-2: WSL2統合の確認と設定</h5>
                        <p>Docker DesktopとWSL2の統合を確認し、最適な設定を行います。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Docker Desktopを開き、Settings（歯車アイコン）をクリック</li>
                            <li>「Resources」→「WSL Integration」を選択</li>
                            <li>「Enable integration with my default WSL distro」をオンにする</li>
                            <li>使用するWSLディストリビューション（Ubuntu等）をオンにする</li>
                            <li>「Apply & Restart」をクリック</li>
                        </ol>

                        <h6>WSL2からのDocker確認</h6>
                        <pre><code># WSL2環境を開く（Windows Terminal等）
wsl

# WSL2環境でDocker確認
docker --version
docker run hello-world</code></pre>

                        <h6>期待される結果</h6>
                        <p>WSL2環境からもDockerコマンドが正常に実行できることを確認してください。</p>
                    </div>

                    <!-- セクション3: PostgreSQL環境構築 -->
                    <h3 class="section-title">1.3 PostgreSQLコンテナの設定</h3>
                    
                    <p>PostgreSQLをDockerコンテナとして起動し、開発用データベース環境を構築します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-3: PostgreSQLコンテナの起動</h5>
                        <p>docker-compose.ymlファイルを作成し、PostgreSQLコンテナを起動します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>プロジェクト用ディレクトリを作成</li>
                            <li>docker-compose.ymlファイルを作成</li>
                            <li>環境変数ファイル（.env）を作成</li>
                            <li>PostgreSQLコンテナを起動</li>
                            <li>データベース接続を確認</li>
                        </ol>

                        <h6>ディレクトリ作成</h6>
                        <pre><code># プロジェクトディレクトリ作成
mkdir streamlit-user-management
cd streamlit-user-management

# 基本ディレクトリ構造作成
mkdir app
mkdir app/models
mkdir app/database
mkdir app/pages
mkdir app/utils
mkdir docker
mkdir docker/postgres</code></pre>

                        <h6>docker-compose.yml作成</h6>
                        <pre><code>version: '3.8'

services:
  postgres:
    image: postgres:15
    container_name: streamlit_postgres
    environment:
      POSTGRES_DB: ${POSTGRES_DB:-userdb}
      POSTGRES_USER: ${POSTGRES_USER:-postgres}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD:-password}
      POSTGRES_HOST_AUTH_METHOD: ${POSTGRES_HOST_AUTH_METHOD:-scram-sha-256}
    ports:
      - "5432:5432"
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./docker/postgres/init.sql:/docker-entrypoint-initdb.d/init.sql
    restart: unless-stopped
    networks:
      - streamlit_network

  adminer:
    image: adminer
    container_name: streamlit_adminer
    ports:
      - "8080:8080"
    depends_on:
      - postgres
    networks:
      - streamlit_network

volumes:
  postgres_data:

networks:
  streamlit_network:
    driver: bridge</code></pre>

                        <h6>.envファイル作成</h6>
                        <pre><code># データベース設定
POSTGRES_DB=userdb
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
POSTGRES_HOST_AUTH_METHOD=scram-sha-256

# アプリケーション設定
DATABASE_URL=postgresql://postgres:password@localhost:5432/userdb</code></pre>

                        <h6>初期化SQLファイル作成</h6>
                        <pre><code># docker/postgres/init.sql
-- データベース初期化スクリプト
CREATE EXTENSION IF NOT EXISTS "uuid-ossp";

-- ユーザーテーブル作成（SQLModelで自動作成されるため、ここでは作成しない）
-- 必要に応じて初期データやインデックスを作成

-- 接続確認用のコメント
-- このファイルはPostgreSQLコンテナ起動時に実行されます</code></pre>

                        <h6>PostgreSQLコンテナ起動</h6>
                        <pre><code># コンテナをバックグラウンドで起動
docker-compose up -d

# コンテナの状態確認
docker-compose ps

# ログ確認
docker-compose logs postgres</code></pre>

                        <h6>期待される結果</h6>
                        <p>PostgreSQLコンテナが正常に起動し、ポート5432でアクセス可能になることを確認してください。</p>
                    </div>

                    <!-- セクション4: Python環境構築 -->
                    <h3 class="section-title">1.4 Python仮想環境の構築</h3>
                    
                    <p>Pythonの仮想環境を作成し、必要なパッケージをインストールします。</p>

                    <div class="exercise-container">
                        <h5>実習 1-4: Python仮想環境の作成</h5>
                        <p>venvを使用してPython仮想環境を作成し、プロジェクト用の分離された環境を構築します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>Python 3.11以上がインストールされていることを確認</li>
                            <li>仮想環境を作成</li>
                            <li>仮想環境を有効化</li>
                            <li>pipを最新版にアップグレード</li>
                        </ol>

                        <h6>Python バージョン確認</h6>
                        <pre><code># Python バージョン確認
python --version

# Python 3.11以上であることを確認
# もし古いバージョンの場合は、Python公式サイトから最新版をインストール</code></pre>

                        <h6>仮想環境作成（Windows Command Prompt）</h6>
                        <pre><code># 仮想環境作成
python -m venv venv

# 仮想環境有効化（Windows）
venv\Scripts\activate

# pip アップグレード
python -m pip install --upgrade pip</code></pre>

                        <h6>仮想環境作成（WSL2/PowerShell）</h6>
                        <pre><code># 仮想環境作成
python3 -m venv venv

# 仮想環境有効化（WSL2/Linux）
source venv/bin/activate

# 仮想環境有効化（PowerShell）
.\venv\Scripts\Activate.ps1

# pip アップグレード
python -m pip install --upgrade pip</code></pre>

                        <h6>期待される結果</h6>
                        <p>コマンドプロンプトの先頭に<code>(venv)</code>が表示され、仮想環境が有効化されることを確認してください。</p>
                    </div>

                    <!-- セクション5: パッケージインストール -->
                    <h3 class="section-title">1.5 必要パッケージのインストール</h3>
                    
                    <p>Streamlit、SQLModel、その他の必要なパッケージをインストールします。</p>

                    <div class="exercise-container">
                        <h5>実習 1-5: 必要パッケージのインストール</h5>
                        <p>requirements.txtファイルを作成し、必要なパッケージを一括インストールします。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>requirements.txtファイルを作成</li>
                            <li>必要なパッケージとバージョンを記載</li>
                            <li>pip installでパッケージを一括インストール</li>
                            <li>インストールの確認</li>
                        </ol>

                        <h6>requirements.txt作成</h6>
                        <pre><code># Core packages
streamlit>=1.28.0
sqlmodel>=0.0.14
psycopg2-binary>=2.9.7

# Database and ORM
sqlalchemy>=2.0.21
pandas>=2.0.3
alembic>=1.12.0

# Environment and configuration
python-dotenv>=1.0.0

# Development and debugging
python-dateutil>=2.8.2

# UI and styling
plotly>=5.15.0
matplotlib>=3.7.0
seaborn>=0.12.0

# Development tools (optional)
pytest>=7.4.0
black>=23.7.0
flake8>=6.0.0</code></pre>

                        <h6>パッケージインストール</h6>
                        <pre><code># 仮想環境がアクティブであることを確認
# (venv) が表示されていることを確認

# パッケージ一括インストール
pip install -r requirements.txt

# インストール確認
pip list

# 特定パッケージの確認
pip show streamlit
pip show sqlmodel</code></pre>

                        <h6>期待される結果</h6>
                        <p>すべてのパッケージがエラーなくインストールされ、pip listで一覧表示されることを確認してください。</p>
                    </div>

                    <!-- セクション6: プロジェクト構造 -->
                    <h3 class="section-title">1.6 プロジェクト構造の作成</h3>
                    
                    <p>整理されたプロジェクト構造を作成し、各ディレクトリの役割を理解します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-6: プロジェクト構造の構築</h5>
                        <p>推奨されるプロジェクト構造を作成し、各ファイルの初期バージョンを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>ディレクトリ構造を確認・補完</li>
                            <li>必要な__init__.pyファイルを作成</li>
                            <li>設定ファイルの雛形を作成</li>
                            <li>.gitignoreファイルを作成</li>
                        </ol>

                        <h6>最終的なディレクトリ構造</h6>
                        <pre><code>streamlit-user-management/
│  .env
│  .gitignore
│  docker-compose.yml
│  requirements.txt
│  README.md
│
├─app/
│  │  main.py
│  │  config.py
│  │  __init__.py
│  │
│  ├─models/
│  │      user.py
│  │      __init__.py
│  │
│  ├─database/
│  │      connection.py
│  │      crud.py
│  │      __init__.py
│  │
│  ├─pages/
│  │      1_👥_User_List.py
│  │      2_➕_Add_User.py
│  │      __init__.py
│  │
│  └─utils/
│          validators.py
│          helpers.py
│          __init__.py
│
├─docker/
│      postgres/
│          init.sql
│
└─venv/
    (仮想環境ファイル)</code></pre>

                        <h6>__init__.pyファイル作成</h6>
                        <pre><code># すべての必要なディレクトリに空の__init__.pyファイルを作成
touch app/__init__.py
touch app/models/__init__.py
touch app/database/__init__.py
touch app/pages/__init__.py
touch app/utils/__init__.py

# Windowsの場合
type nul > app\__init__.py
type nul > app\models\__init__.py
type nul > app\database\__init__.py
type nul > app\pages\__init__.py
type nul > app\utils\__init__.py</code></pre>

                        <h6>.gitignore作成</h6>
                        <pre><code># Python
__pycache__/
*.py[cod]
*$py.class
*.so
.Python
build/
develop-eggs/
dist/
downloads/
eggs/
.eggs/
lib/
lib64/
parts/
sdist/
var/
wheels/
*.egg-info/
.installed.cfg
*.egg

# Virtual Environment
venv/
env/
ENV/

# Environment variables
.env
.env.local
.env.production

# IDE
.vscode/
.idea/
*.swp
*.swo

# Database
*.db
*.sqlite

# Logs
*.log

# OS
.DS_Store
Thumbs.db

# Docker
.docker/

# Streamlit
.streamlit/</code></pre>

                        <h6>期待される結果</h6>
                        <p>プロジェクト構造が整理され、すべての必要なディレクトリとファイルが作成されることを確認してください。</p>
                    </div>

                    <!-- セクション7: 基本設定ファイル -->
                    <h3 class="section-title">1.7 基本設定ファイルの作成</h3>
                    
                    <p>アプリケーションの設定を管理するためのconfig.pyファイルを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-7: 設定ファイルの作成</h5>
                        <p>環境変数を読み込み、アプリケーション設定を管理するconfig.pyファイルを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>app/config.pyファイルを作成</li>
                            <li>環境変数読み込み機能を実装</li>
                            <li>データベース接続設定を定義</li>
                            <li>設定の動作確認</li>
                        </ol>

                        <h6>app/config.py作成</h6>
                        <pre><code>"""
アプリケーション設定管理
環境変数から設定を読み込み、アプリケーション全体で使用する設定を管理します。
"""

import os
from typing import Optional
from dotenv import load_dotenv

# .envファイルから環境変数を読み込み
load_dotenv()

class Settings:
    """アプリケーション設定クラス"""
    
    # データベース設定
    DATABASE_URL: str = os.getenv(
        "DATABASE_URL", 
        "postgresql://postgres:password@localhost:5432/userdb"
    )
    
    # PostgreSQL個別設定
    POSTGRES_HOST: str = os.getenv("POSTGRES_HOST", "localhost")
    POSTGRES_PORT: int = int(os.getenv("POSTGRES_PORT", "5432"))
    POSTGRES_DB: str = os.getenv("POSTGRES_DB", "userdb")
    POSTGRES_USER: str = os.getenv("POSTGRES_USER", "postgres")
    POSTGRES_PASSWORD: str = os.getenv("POSTGRES_PASSWORD", "password")
    
    # アプリケーション設定
    APP_NAME: str = "Modern User Management Dashboard"
    APP_VERSION: str = "1.0.0"
    DEBUG: bool = os.getenv("DEBUG", "False").lower() == "true"
    
    # Streamlit設定
    STREAMLIT_PORT: int = int(os.getenv("STREAMLIT_PORT", "8501"))
    
    @property
    def database_url(self) -> str:
        """データベースURL を構築して返す"""
        return (
            f"postgresql://{self.POSTGRES_USER}:{self.POSTGRES_PASSWORD}"
            f"@{self.POSTGRES_HOST}:{self.POSTGRES_PORT}/{self.POSTGRES_DB}"
        )
    
    def __repr__(self) -> str:
        return f"Settings(app_name='{self.APP_NAME}', debug={self.DEBUG})"

# 設定インスタンスを作成（シングルトンパターン）
settings = Settings()

# 設定確認用の関数
def print_settings() -> None:
    """設定内容を表示（デバッグ用）"""
    print(f"App Name: {settings.APP_NAME}")
    print(f"Database URL: {settings.database_url}")
    print(f"Debug Mode: {settings.DEBUG}")
    print(f"Streamlit Port: {settings.STREAMLIT_PORT}")

if __name__ == "__main__":
    print_settings()</code></pre>

                        <h6>設定ファイルの動作確認</h6>
                        <pre><code># 設定ファイルの動作確認
cd app
python config.py

# 期待される出力例:
# App Name: Modern User Management Dashboard
# Database URL: postgresql://postgres:password@localhost:5432/userdb
# Debug Mode: False
# Streamlit Port: 8501</code></pre>

                        <h6>期待される結果</h6>
                        <p>config.pyが正常に実行され、環境変数から設定が読み込まれることを確認してください。</p>
                    </div>

                    <!-- セクション8: 基本Streamlitアプリ -->
                    <h3 class="section-title">1.8 基本Streamlitアプリケーションの作成</h3>
                    
                    <p>Streamlitの動作確認のため、基本的なアプリケーションを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-8: 基本Streamlitアプリの作成と起動</h5>
                        <p>Streamlitの基本機能を確認するための簡単なアプリケーションを作成し、動作確認を行います。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>app/main.pyファイルを作成</li>
                            <li>基本的なStreamlitアプリケーションを実装</li>
                            <li>Streamlitアプリケーションを起動</li>
                            <li>ブラウザでの動作確認</li>
                        </ol>

                        <h6>app/main.py作成</h6>
                        <pre><code>"""
Modern User Management Dashboard
メインアプリケーションファイル
"""

import streamlit as st
from config import settings

def main():
    """メインアプリケーション"""
    
    # ページ設定
    st.set_page_config(
        page_title=settings.APP_NAME,
        page_icon="👥",
        layout="wide",
        initial_sidebar_state="expanded"
    )
    
    # メインタイトル
    st.title(settings.APP_NAME)
    st.markdown(f"**Version:** {settings.APP_VERSION}")
    
    # サイドバー
    with st.sidebar:
        st.header("📋 メニュー")
        st.info("このアプリケーションではユーザー管理を行います。")
        
        # 環境情報表示
        st.subheader("🛠️ 環境情報")
        st.write(f"**Debug Mode:** {settings.DEBUG}")
        st.write(f"**Database:** PostgreSQL")
        st.write(f"**Port:** {settings.STREAMLIT_PORT}")
    
    # メインコンテンツ
    col1, col2 = st.columns([2, 1])
    
    with col1:
        st.header("🎯 チュートリアル進行状況")
        
        # 進行状況表示
        progress_steps = [
            ("✅ Step 1: 環境構築", True),
            ("⏳ Step 2: データベース設計", False),
            ("⏳ Step 3: ユーザー登録機能", False),
            ("⏳ Step 4: ユーザー一覧表示", False),
            ("⏳ Step 5: CRUD操作", False),
            ("⏳ Step 6: セキュリティとデプロイ", False)
        ]
        
        for step, completed in progress_steps:
            if completed:
                st.success(step)
            else:
                st.info(step)
    
    with col2:
        st.header("📊 システム概要")
        
        # システム情報カード
        with st.container():
            st.markdown("""
            **技術スタック:**
            - 🐍 Python 3.11+
            - 🚀 Streamlit 1.28+
            - 🗄️ SQLModel 0.0.14+
            - 🐘 PostgreSQL 15+
            - 🐳 Docker Desktop
            """)
        
        # 接続テスト（後で実装）
        st.subheader("🔌 接続テスト")
        if st.button("データベース接続テスト"):
            st.info("データベース接続機能は Step 2 で実装予定です。")
    
    # フッター
    st.markdown("---")
    st.markdown(
        "<div style='text-align: center; color: gray;'>"
        "Streamlit + SQLModel チュートリアル | Step 1: 環境構築完了 ✅"
        "</div>", 
        unsafe_allow_html=True
    )

if __name__ == "__main__":
    main()</code></pre>

                        <h6>Streamlitアプリケーションの起動</h6>
                        <pre><code># プロジェクトルートディレクトリから起動
# 仮想環境がアクティブであることを確認

# Streamlit アプリ起動
streamlit run app/main.py

# カスタムポートでの起動（オプション）
streamlit run app/main.py --server.port 8502

# WSL2環境での起動（推奨）
streamlit run app/main.py --server.address 0.0.0.0</code></pre>

                        <h6>ブラウザでの確認</h6>
                        <p>Streamlitアプリケーションが起動したら、以下のURLでアクセスしてください：</p>
                        <ul>
                            <li><strong>ローカル:</strong> http://localhost:8501</li>
                            <li><strong>WSL2:</strong> http://localhost:8501 または http://127.0.0.1:8501</li>
                            <li><strong>カスタムポート:</strong> http://localhost:8502</li>
                        </ul>

                        <h6>期待される結果</h6>
                        <p>ブラウザでStreamlitアプリケーションが表示され、タイトル、サイドバー、進行状況などが正常に表示されることを確認してください。</p>
                    </div>

                    <!-- セクション9: データベース接続確認 -->
                    <h3 class="section-title">1.9 データベース接続の確認</h3>
                    
                    <p>PostgreSQLコンテナとの接続を確認し、基本的なデータベース操作を試します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-9: データベース接続テスト</h5>
                        <p>作成したPostgreSQLコンテナに接続し、基本的なSQL操作を実行します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>PostgreSQLコンテナが起動していることを確認</li>
                            <li>psqlクライアントでの接続テスト</li>
                            <li>Adminerでの管理画面確認</li>
                            <li>Pythonからの接続テスト</li>
                        </ol>

                        <h6>PostgreSQLコンテナ状態確認</h6>
                        <pre><code># コンテナ状態確認
docker-compose ps

# PostgreSQLログ確認
docker-compose logs postgres

# コンテナ内部接続テスト
docker exec -it streamlit_postgres psql -U postgres -d userdb</code></pre>

                        <h6>SQL接続テスト</h6>
                        <pre><code>-- PostgreSQL内部での基本テスト
-- \l でデータベース一覧確認
\l

-- \dt でテーブル一覧確認（まだ空）
\dt

-- 簡単なクエリテスト
SELECT version();
SELECT current_database();
SELECT current_user;

-- 接続終了
\q</code></pre>

                        <h6>Adminer管理画面確認</h6>
                        <p>ブラウザで <code>http://localhost:8080</code> にアクセスし、以下の情報でログイン：</p>
                        <ul>
                            <li><strong>データベースの種類:</strong> PostgreSQL</li>
                            <li><strong>サーバ:</strong> postgres</li>
                            <li><strong>ユーザ名:</strong> postgres</li>
                            <li><strong>パスワード:</strong> password</li>
                            <li><strong>データベース:</strong> userdb</li>
                        </ul>

                        <h6>Pythonからの接続テスト</h6>
                        <pre><code># test_db_connection.py (一時ファイル)
import psycopg2
from app.config import settings

def test_connection():
    """データベース接続テスト"""
    try:
        # 接続テスト
        conn = psycopg2.connect(
            host=settings.POSTGRES_HOST,
            port=settings.POSTGRES_PORT,
            dbname=settings.POSTGRES_DB,
            user=settings.POSTGRES_USER,
            password=settings.POSTGRES_PASSWORD
        )
        
        # カーソル作成
        cur = conn.cursor()
        
        # 簡単なクエリ実行
        cur.execute("SELECT version();")
        version = cur.fetchone()
        print(f"PostgreSQL Version: {version[0]}")
        
        # 接続クローズ
        cur.close()
        conn.close()
        
        print("✅ データベース接続テスト成功!")
        return True
        
    except Exception as e:
        print(f"❌ データベース接続エラー: {e}")
        return False

if __name__ == "__main__":
    test_connection()</code></pre>

                        <h6>接続テスト実行</h6>
                        <pre><code># 接続テスト実行
python test_db_connection.py

# 成功した場合の出力例:
# PostgreSQL Version: PostgreSQL 15.x on x86_64-pc-linux-gnu...
# ✅ データベース接続テスト成功!</code></pre>

                        <h6>期待される結果</h6>
                        <p>PostgreSQLコンテナへの接続が成功し、Adminer管理画面とPythonの両方からアクセスできることを確認してください。</p>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>Docker Desktop</strong>でWSL2統合を有効にする理由は何ですか？</li>
                            <li><strong>仮想環境（venv）</strong>を使用する主な利点を2つ挙げてください。</li>
                            <li><strong>PostgreSQLコンテナ</strong>のデフォルトポートは何番ですか？</li>
                            <li><strong>Streamlitアプリ</strong>のデフォルトポートは何番ですか？</li>
                            <li><strong>.envファイル</strong>で管理すべき情報の種類を3つ挙げてください。</li>
                            <li><strong>requirements.txt</strong>ファイルの目的は何ですか？</li>
                            <li><strong>SQLModel</strong>と従来のSQLAlchemyの主な違いは何ですか？</li>
                            <li><strong>config.py</strong>でシングルトンパターンを使用する理由は何ですか？</li>
                        </ol>
                        
                        <details>
                            <summary>解答例</summary>
                            <ol>
                                <li>LinuxカーネルベースでDockerが動作し、パフォーマンスが向上し、ファイルシステムの互換性が改善される</li>
                                <li>プロジェクト間の依存関係の分離、システムPythonの保護、バージョン管理の容易さ</li>
                                <li>5432番</li>
                                <li>8501番</li>
                                <li>データベース接続情報、APIキー、シークレットキー、環境固有の設定</li>
                                <li>プロジェクトの依存関係を記録し、他の環境で同じパッケージ構成を再現するため</li>
                                <li>SQLModelは型ヒント（Type Hints）をネイティブサポートし、PydanticとSQLAlchemyの機能を統合している</li>
                                <li>アプリケーション全体で同じ設定インスタンスを共有し、メモリ効率と設定の一貫性を保つため</li>
                            </ol>
                        </details>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">1.10 Step 1のまとめ</h3>
                    
                    <div class="highlight">
                        <h5>Step 1で習得したスキル</h5>
                        <ul>
                            <li>Windows環境でのDocker Desktop設定とWSL2統合</li>
                            <li>PostgreSQLコンテナの構築と管理</li>
                            <li>Python仮想環境の作成と依存関係管理</li>
                            <li>Streamlitアプリケーションの基本構造</li>
                            <li>プロジェクト構成の設計とベストプラクティス</li>
                            <li>環境変数による設定管理</li>
                            <li>データベース接続の確認とテスト</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h6>次のStepに進む前に確認すること</h6>
                        <ul>
                            <li>✅ Docker Desktopが正常に動作している</li>
                            <li>✅ PostgreSQLコンテナが起動している</li>
                            <li>✅ Python仮想環境が有効化されている</li>
                            <li>✅ 必要なパッケージがインストールされている</li>
                            <li>✅ Streamlitアプリケーションが起動している</li>
                            <li>✅ データベース接続が確認できている</li>
                            <li>✅ プロジェクト構造が整理されている</li>
                        </ul>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="../streamlit-sqlmodel/README.html" class="btn btn-secondary">← チュートリアル概要</a>
                        <a href="step2-database-design.html" class="btn btn-primary">Step 2: データベース設計 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>