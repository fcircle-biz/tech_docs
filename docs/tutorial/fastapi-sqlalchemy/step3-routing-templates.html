<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI + SQLAlchemy チュートリアル Step 3 - FastAPIルーティングとJinja2テンプレート</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        
        .navbar {
            background-color: #009688;
        }
        
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        
        .chapter-title {
            color: #009688;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #009688;
            padding-bottom: 0.5rem;
        }
        
        .section-title {
            color: #00695c;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        
        .quiz-container {
            background-color: #e0f2f1;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #009688;
        }
        
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .nav-link.active {
            background-color: #009688 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../index.html">FastAPI + SQLAlchemy チュートリアル</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../index.html">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">チュートリアル概要</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h5>チュートリアル目次</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="step1-environment-setup.html">Step 1: 環境構築</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-design.html">Step 2: データベース設計</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="step3-routing-templates.html">Step 3: ルーティング</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-registration.html">Step 4: ユーザー登録</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-list-detail.html">Step 5: 一覧・詳細</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-user-update-delete.html">Step 6: 編集・削除</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step7-search-summary.html">Step 7: 検索・まとめ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 3: FastAPIルーティングとJinja2テンプレート</h1>
                </div>

                <div id="step3">
                    <h2 class="chapter-title">FastAPIルーティングとJinja2テンプレート</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>FastAPIでのHTMLテンプレート表示の基本</li>
                            <li>Jinja2テンプレートエンジンの設定と使用方法</li>
                            <li>静的ファイル（CSS、JavaScript、画像）の配信設定</li>
                            <li>ベーステンプレートを使用したレイアウト継承</li>
                            <li>トップページの実装とナビゲーション作成</li>
                        </ul>
                    </div>

                    <!-- 所要時間と前提条件 -->
                    <div class="warning">
                        <h6>所要時間: 約2時間</h6>
                        <h6>前提条件:</h6>
                        <ul>
                            <li>Step 1、2の内容が完了していること</li>
                            <li>HTMLとCSSの基本的な知識</li>
                            <li>Webアプリケーションの基本概念の理解</li>
                        </ul>
                    </div>

                    <h3 class="section-title">3.1 FastAPIでのテンプレート設定</h3>
                    <p>FastAPIでHTMLテンプレートを表示するために、Jinja2テンプレートエンジンを設定します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-1: テンプレート設定</h5>
                        <p>main.pyにJinja2テンプレートとStaticFilesの設定を追加します。</p>
                        
                        <h6>main.py の更新</h6>
                        <pre class="code-block"><code class="language-python">from fastapi import FastAPI, Depends, HTTPException, Request
from fastapi.templating import Jinja2Templates
from fastapi.staticfiles import StaticFiles
from fastapi.responses import HTMLResponse
from sqlalchemy.orm import Session
from database import engine, get_db
import models
import crud

# データベーステーブルの作成
models.Base.metadata.create_all(bind=engine)

app = FastAPI()

# テンプレート設定
templates = Jinja2Templates(directory="templates")

# 静的ファイル設定
app.mount("/static", StaticFiles(directory="static"), name="static")

@app.get("/", response_class=HTMLResponse)
async def home(request: Request):
    """トップページ"""
    return templates.TemplateResponse("index.html", {"request": request})

# 既存のAPIエンドポイントはそのまま維持
@app.get("/api/health")
async def health_check(db: Session = Depends(get_db)):
    """データベース接続確認エンドポイント"""
    try:
        result = db.execute("SELECT 1")
        return {"status": "healthy", "database": "connected"}
    except Exception as e:
        return {"status": "error", "message": str(e)}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)</code></pre>
                        
                        <h6>設定の説明</h6>
                        <ul>
                            <li><strong>Jinja2Templates:</strong> テンプレートエンジンの初期化</li>
                            <li><strong>StaticFiles:</strong> CSS、JavaScript、画像などの静的ファイル配信</li>
                            <li><strong>templates.TemplateResponse:</strong> テンプレートを使ったHTMLレスポンス</li>
                            <li><strong>request:</strong> テンプレートに渡すRequestオブジェクト</li>
                        </ul>
                        
                        <h6>期待される結果</h6>
                        <p>FastAPIでHTMLテンプレートが表示できるようになります。</p>
                    </div>

                    <h3 class="section-title">3.2 ベーステンプレートの作成</h3>
                    <p>共通のレイアウトを定義するベーステンプレートを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-2: base.html の作成</h5>
                        <p>すべてのページで共通のレイアウトとなるベーステンプレートを作成します。</p>
                        
                        <h6>templates/base.html</h6>
                        <pre class="code-block"><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;{% block title %}Simple User Manager{% endblock %}&lt;/title&gt;
    
    &lt;!-- Bootstrap 5 CDN --&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    
    &lt;!-- Font Awesome CDN --&gt;
    &lt;link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet"&gt;
    
    &lt;!-- カスタムCSS --&gt;
    &lt;link href="{{ url_for('static', path='/css/style.css') }}" rel="stylesheet"&gt;
    
    {% block extra_head %}{% endblock %}
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- ナビゲーションバー --&gt;
    &lt;nav class="navbar navbar-expand-lg navbar-dark bg-primary"&gt;
        &lt;div class="container"&gt;
            &lt;a class="navbar-brand" href="/"&gt;
                &lt;strong&gt;Simple User Manager&lt;/strong&gt;
            &lt;/a&gt;
            
            &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" 
                    data-bs-target="#navbarNav"&gt;
                &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
            &lt;/button&gt;
            
            &lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
                &lt;ul class="navbar-nav me-auto"&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="/"&gt;ホーム&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="/users"&gt;ユーザー一覧&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="/users/new"&gt;新規登録&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    &lt;!-- メインコンテンツ --&gt;
    &lt;main class="container my-4"&gt;
        {% block content %}{% endblock %}
    &lt;/main&gt;

    &lt;!-- フッター --&gt;
    &lt;footer class="bg-light py-4 mt-5"&gt;
        &lt;div class="container"&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-6"&gt;
                    &lt;p&gt;&amp;copy; 2024 Simple User Manager Tutorial&lt;/p&gt;
                &lt;/div&gt;
                &lt;div class="col-md-6 text-end"&gt;
                    &lt;p&gt;FastAPI + SQLAlchemy + Jinja2&lt;/p&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;!-- Bootstrap JavaScript --&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
    
    {% block extra_scripts %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                        <h6>テンプレートの特徴</h6>
                        <ul>
                            <li><strong>{% block %}:</strong> 子テンプレートで上書き可能な領域</li>
                            <li><strong>url_for:</strong> 静的ファイルのURLを生成</li>
                            <li><strong>Bootstrap:</strong> レスポンシブデザインのためのCSSフレームワーク</li>
                            <li><strong>ナビゲーション:</strong> 各ページへのリンク</li>
                        </ul>
                        
                        <h6>期待される結果</h6>
                        <p>共通レイアウトのベーステンプレートが作成されます。</p>
                    </div>

                    <h3 class="section-title">3.3 スタイルシートの作成</h3>
                    <p>アプリケーション専用のCSSスタイルを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-3: style.css の作成</h5>
                        <p>アプリケーションのカスタムスタイルを定義します。</p>
                        
                        <h6>static/css/style.css</h6>
                        <pre class="code-block"><code class="language-css">/* カスタムスタイル */
body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f8f9fa;
}

/* ナビゲーションバー */
.navbar-brand {
    font-weight: bold;
}

/* カード */
.card {
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    border: none;
    border-radius: 8px;
}

.card-header {
    background-color: #007bff;
    color: white;
    border-radius: 8px 8px 0 0 !important;
}

/* ボタン */
.btn {
    border-radius: 6px;
}

/* テーブル */
.table {
    background-color: white;
    border-radius: 8px;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.table thead th {
    background-color: #e9ecef;
    border-bottom: 2px solid #dee2e6;
    font-weight: 600;
}

/* フォーム */
.form-control, .form-select {
    border-radius: 6px;
    border: 1px solid #ced4da;
}

.form-control:focus, .form-select:focus {
    border-color: #007bff;
    box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);
}

/* アラート */
.alert {
    border-radius: 6px;
    border: none;
}

/* ユーティリティ */
.text-muted {
    color: #6c757d !important;
}

.bg-light-custom {
    background-color: #f8f9fa !important;
}

/* レスポンシブ調整 */
@media (max-width: 768px) {
    .container {
        padding-left: 15px;
        padding-right: 15px;
    }
    
    .table-responsive {
        font-size: 0.9rem;
    }
}</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>アプリケーションのスタイルが整い、見た目が向上します。</p>
                    </div>

                    <h3 class="section-title">3.4 トップページテンプレートの作成</h3>
                    <p>アプリケーションのトップページを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-4: index.html の作成</h5>
                        <p>ベーステンプレートを継承したトップページを作成します。</p>
                        
                        <h6>templates/index.html</h6>
                        <pre class="code-block"><code class="language-html">{% extends "base.html" %}
{% block title %}ホーム - Simple User Manager{% endblock %}
{% block content %}
&lt;div class="row"&gt;
    &lt;div class="col-lg-8 mx-auto"&gt;
        &lt;!-- ウェルカムセクション --&gt;
        &lt;div class="card mb-4"&gt;
            &lt;div class="card-header"&gt;
                &lt;h3 class="mb-0"&gt;
                    &lt;i class="fas fa-home"&gt;&lt;/i&gt; 
                    Simple User Manager へようこそ
                &lt;/h3&gt;
            &lt;/div&gt;
            &lt;div class="card-body"&gt;
                &lt;p class="lead"&gt;
                    FastAPI + SQLAlchemy + Jinja2 を使用した
                    シンプルなユーザー管理システムです。
                &lt;/p&gt;
                &lt;p&gt;
                    このアプリケーションでは、ユーザーの登録、表示、編集、削除の
                    基本的なCRUD操作を学ぶことができます。
                &lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- 機能紹介 --&gt;
        &lt;div class="row mb-4"&gt;
            &lt;div class="col-md-4 mb-3"&gt;
                &lt;div class="card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;i class="fas fa-user-plus fa-3x text-primary mb-3"&gt;&lt;/i&gt;
                        &lt;h5 class="card-title"&gt;ユーザー登録&lt;/h5&gt;
                        &lt;p class="card-text"&gt;
                            新しいユーザーを簡単に登録できます。
                        &lt;/p&gt;
                        &lt;a href="/users/new" class="btn btn-primary"&gt;登録画面へ&lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4 mb-3"&gt;
                &lt;div class="card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;i class="fas fa-users fa-3x text-success mb-3"&gt;&lt;/i&gt;
                        &lt;h5 class="card-title"&gt;ユーザー一覧&lt;/h5&gt;
                        &lt;p class="card-text"&gt;
                            登録されたユーザーを一覧で確認できます。
                        &lt;/p&gt;
                        &lt;a href="/users" class="btn btn-success"&gt;一覧を見る&lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4 mb-3"&gt;
                &lt;div class="card h-100"&gt;
                    &lt;div class="card-body text-center"&gt;
                        &lt;i class="fas fa-search fa-3x text-info mb-3"&gt;&lt;/i&gt;
                        &lt;h5 class="card-title"&gt;ユーザー検索&lt;/h5&gt;
                        &lt;p class="card-text"&gt;
                            名前でユーザーを検索できます。
                        &lt;/p&gt;
                        &lt;a href="/users?search=" class="btn btn-info"&gt;検索する&lt;/a&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;!-- 技術スタック --&gt;
        &lt;div class="card"&gt;
            &lt;div class="card-header"&gt;
                &lt;h4 class="mb-0"&gt;使用技術&lt;/h4&gt;
            &lt;/div&gt;
            &lt;div class="card-body"&gt;
                &lt;div class="row"&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;ul class="list-unstyled"&gt;
                            &lt;li&gt;&lt;strong&gt;Backend:&lt;/strong&gt; FastAPI&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;ORM:&lt;/strong&gt; SQLAlchemy&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;Database:&lt;/strong&gt; PostgreSQL&lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                    &lt;div class="col-sm-6"&gt;
                        &lt;ul class="list-unstyled"&gt;
                            &lt;li&gt;&lt;strong&gt;Template:&lt;/strong&gt; Jinja2&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;CSS:&lt;/strong&gt; Bootstrap 5&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;Language:&lt;/strong&gt; Python 3.8+&lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock %}</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>魅力的なトップページが表示され、各機能へのナビゲーションが提供されます。</p>
                    </div>

                    <h3 class="section-title">3.5 エラーページの作成</h3>
                    <p>404エラーなどのエラーページを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-5: エラーハンドリング</h5>
                        <p>カスタムエラーページとエラーハンドラーを追加します。</p>
                        
                        <h6>templates/error.html</h6>
                        <pre class="code-block"><code class="language-html">{% extends "base.html" %}

{% block title %}エラー - Simple User Manager{% endblock %}

{% block content %}
&lt;div class="row"&gt;
    &lt;div class="col-md-6 mx-auto"&gt;
        &lt;div class="card"&gt;
            &lt;div class="card-body text-center"&gt;
                &lt;i class="fas fa-exclamation-triangle fa-4x text-warning mb-4"&gt;&lt;/i&gt;
                &lt;h2&gt;{{ status_code }}&lt;/h2&gt;
                &lt;h4&gt;{{ message }}&lt;/h4&gt;
                &lt;p class="text-muted"&gt;{{ detail }}&lt;/p&gt;
                &lt;a href="/" class="btn btn-primary"&gt;ホームに戻る&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock %}</code></pre>
                        
                        <h6>main.py にエラーハンドラー追加</h6>
                        <pre class="code-block"><code class="language-python"># main.py に追加
from fastapi import FastAPI, Depends, HTTPException, Request
from fastapi.exceptions import RequestValidationError
from fastapi.responses import HTMLResponse
from starlette.exceptions import HTTPException as StarletteHTTPException

@app.exception_handler(StarletteHTTPException)
async def http_exception_handler(request: Request, exc: StarletteHTTPException):
    """HTTP例外ハンドラー"""
    if exc.status_code == 404:
        return templates.TemplateResponse(
            "error.html", 
            {
                "request": request, 
                "status_code": 404,
                "message": "ページが見つかりません",
                "detail": "お探しのページは存在しないか、移動した可能性があります。"
            },
            status_code=404
        )
    
    return templates.TemplateResponse(
        "error.html", 
        {
            "request": request, 
            "status_code": exc.status_code,
            "message": "エラーが発生しました",
            "detail": str(exc.detail)
        },
        status_code=exc.status_code
    )</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>ユーザーフレンドリーなエラーページが表示されます。</p>
                    </div>

                    <h3 class="section-title">3.6 動作確認</h3>
                    <p>作成したテンプレートとルーティングの動作を確認します。</p>

                    <div class="exercise-container">
                        <h5>実習 3-6: アプリケーションテスト</h5>
                        <p>すべての設定が正しく動作することを確認します。</p>
                        
                        <h6>アプリケーション起動</h6>
                        <pre class="code-block"><code class="language-bash"># アプリケーションの起動
python main.py

# または
uvicorn main:app --reload</code></pre>
                        
                        <h6>確認項目</h6>
                        <ul>
                            <li><code>http://localhost:8000/</code> - トップページの表示</li>
                            <li><code>http://localhost:8000/static/css/style.css</code> - CSSファイルの配信</li>
                            <li><code>http://localhost:8000/nonexistent</code> - 404エラーページ</li>
                            <li>ナビゲーションメニューの表示</li>
                            <li>レスポンシブデザインの動作（画面サイズ変更）</li>
                        </ul>
                        
                        <h6>期待される結果</h6>
                        <p>美しいデザインのWebアプリケーションが表示され、ナビゲーションが正常に動作します。</p>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>FastAPIでテンプレートエンジンを設定する際に使用するクラス名は何ですか？</li>
                            <li>静的ファイルを配信するために使用するFastAPIのクラス名は何ですか？</li>
                            <li>Jinja2テンプレートで継承を行う際に使用するタグは何ですか？</li>
                            <li>テンプレート内で静的ファイルのURLを生成する関数名は何ですか？</li>
                            <li>作成したベーステンプレートに含まれるblockの名前を3つ挙げてください。</li>
                        </ol>
                        
                        <details class="mt-3">
                            <summary>解答例</summary>
                            <ol>
                                <li>Jinja2Templates</li>
                                <li>StaticFiles</li>
                                <li>{% extends %}</li>
                                <li>url_for</li>
                                <li>title, content, extra_head, extra_scripts（任意の3つ）</li>
                            </ol>
                        </details>
                    </div>

                    <!-- トラブルシューティング -->
                    <h3 class="section-title">3.7 よくある問題と解決方法</h3>
                    
                    <div class="warning">
                        <h6>テンプレートが見つからないエラー</h6>
                        <p><strong>症状:</strong> "TemplateNotFound" エラー</p>
                        <p><strong>解決方法:</strong></p>
                        <ul>
                            <li>templatesディレクトリが存在するか確認</li>
                            <li>ファイル名のスペルミスがないか確認</li>
                            <li>Jinja2Templatesの directory パラメータを確認</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h6>静的ファイルが読み込めない</h6>
                        <p><strong>症状:</strong> CSSやJavaScriptが適用されない</p>
                        <p><strong>解決方法:</strong></p>
                        <ul>
                            <li>staticディレクトリが存在するか確認</li>
                            <li>app.mount()の設定を確認</li>
                            <li>url_for()の使用方法を確認</li>
                        </ul>
                    </div>

                    <!-- まとめ -->
                    <h3 class="section-title">3.8 この章のまとめ</h3>
                    <div class="highlight">
                        <h6>習得したスキル</h6>
                        <ul>
                            <li>FastAPIでのJinja2テンプレート設定</li>
                            <li>静的ファイルの配信設定</li>
                            <li>テンプレート継承を使用したレイアウト設計</li>
                            <li>Bootstrap を使用したレスポンシブデザイン</li>
                            <li>エラーハンドリングとカスタムエラーページ</li>
                        </ul>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step2-database-design.html" class="btn btn-secondary">← Step 2: データベース設計</a>
                        <a href="step4-user-registration.html" class="btn btn-primary">Step 4: ユーザー登録 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
</body>
</html>