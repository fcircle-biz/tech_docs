<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI + SQLAlchemy チュートリアル Step 6 - ユーザー情報の編集と削除</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        
        .navbar {
            background-color: #009688;
        }
        
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        
        .chapter-title {
            color: #009688;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #009688;
            padding-bottom: 0.5rem;
        }
        
        .section-title {
            color: #00695c;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        
        .quiz-container {
            background-color: #e0f2f1;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #009688;
        }
        
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .nav-link.active {
            background-color: #009688 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">FastAPI + SQLAlchemy チュートリアル</a>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebar" class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="step1-environment-setup.html">Step 1: 環境構築</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-design.html">Step 2: データベース設計</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-routing-templates.html">Step 3: ルーティングとテンプレート</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-registration.html">Step 4: ユーザー登録機能</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-list-detail.html">Step 5: ユーザー一覧と詳細</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="step6-user-update-delete.html">Step 6: 編集と削除</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step7-search-summary.html">Step 7: 検索機能とまとめ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 6: ユーザー情報の編集と削除</h1>
                </div>

                <div id="step6">
                    <h2 class="chapter-title">6. ユーザー情報の編集と削除</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>SQLAlchemyでのデータ更新処理</li>
                            <li>編集フォームの実装方法</li>
                            <li>データの削除処理</li>
                            <li>削除確認画面の実装</li>
                            <li>エラーハンドリングの強化</li>
                        </ul>
                    </div>

                    <p>この章では、CRUD操作の最後となる更新（Update）と削除（Delete）機能を実装します。既存データの変更と削除の安全な処理方法を学習します。</p>

                    <h3 class="section-title">6.1 編集フォームテンプレートの作成</h3>
                    
                    <p>既存のユーザー情報を編集するためのフォームテンプレートを作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 6-1: ユーザー編集フォームの作成</h5>
                        <p>現在のユーザー情報を表示し、編集可能なフォームを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><code>templates/user_edit.html</code>ファイルを作成</li>
                            <li>以下のコードを入力して保存</li>
                        </ol>
                        
                        <h6>コード例</h6>
                        <pre class="code-block"><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;{{ user.username }}の編集 - Simple User Manager&lt;/title&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    &lt;link href="/static/css/style.css" rel="stylesheet"&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div class="container mt-5"&gt;
        &lt;div class="row justify-content-center"&gt;
            &lt;div class="col-md-8"&gt;
                &lt;div class="card"&gt;
                    &lt;div class="card-header bg-warning text-dark"&gt;
                        &lt;h3 class="card-title mb-0"&gt;ユーザー情報の編集&lt;/h3&gt;
                    &lt;/div&gt;
                    &lt;div class="card-body"&gt;
                        {% if message %}
                            {% if error %}
                                &lt;div class="alert alert-danger" role="alert"&gt;
                                    {{ message }}
                                &lt;/div&gt;
                            {% else %}
                                &lt;div class="alert alert-success" role="alert"&gt;
                                    {{ message }}
                                &lt;/div&gt;
                            {% endif %}
                        {% endif %}

                        &lt;form method="post" action="/users/{{ user.id }}/edit"&gt;
                            &lt;div class="mb-3"&gt;
                                &lt;label for="username" class="form-label"&gt;ユーザー名 &lt;span class="text-danger"&gt;*&lt;/span&gt;&lt;/label&gt;
                                &lt;input type="text" class="form-control" id="username" name="username" 
                                       value="{{ user.username }}" required&gt;
                                &lt;div class="form-text"&gt;他のユーザーと重複しないユーザー名を入力してください&lt;/div&gt;
                            &lt;/div&gt;
                            
                            &lt;div class="mb-3"&gt;
                                &lt;label for="email" class="form-label"&gt;メールアドレス &lt;span class="text-danger"&gt;*&lt;/span&gt;&lt;/label&gt;
                                &lt;input type="email" class="form-control" id="email" name="email" 
                                       value="{{ user.email }}" required&gt;
                                &lt;div class="form-text"&gt;有効なメールアドレスを入力してください&lt;/div&gt;
                            &lt;/div&gt;
                            
                            &lt;div class="mb-3"&gt;
                                &lt;label for="full_name" class="form-label"&gt;氏名 &lt;span class="text-danger"&gt;*&lt;/span&gt;&lt;/label&gt;
                                &lt;input type="text" class="form-control" id="full_name" name="full_name" 
                                       value="{{ user.full_name }}" required&gt;
                            &lt;/div&gt;
                            
                            &lt;div class="mb-3"&gt;
                                &lt;div class="form-text"&gt;
                                    &lt;strong&gt;登録日時:&lt;/strong&gt; {{ user.created_at.strftime('%Y年%m月%d日 %H:%M:%S') }}
                                &lt;/div&gt;
                            &lt;/div&gt;
                        &lt;/form&gt;
                    &lt;/div&gt;
                    &lt;div class="card-footer"&gt;
                        &lt;div class="d-flex justify-content-between"&gt;
                            &lt;a href="/users/{{ user.id }}" class="btn btn-secondary"&gt;← キャンセル&lt;/a&gt;
                            &lt;div&gt;
                                &lt;button type="submit" form="edit-form" class="btn btn-warning"&gt;更新する&lt;/button&gt;
                                &lt;button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"&gt;
                                    削除
                                &lt;/button&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;!-- 削除確認モーダル --&gt;
    &lt;div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true"&gt;
        &lt;div class="modal-dialog"&gt;
            &lt;div class="modal-content"&gt;
                &lt;div class="modal-header bg-danger text-white"&gt;
                    &lt;h5 class="modal-title" id="deleteModalLabel"&gt;削除の確認&lt;/h5&gt;
                    &lt;button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"&gt;&lt;/button&gt;
                &lt;/div&gt;
                &lt;div class="modal-body"&gt;
                    &lt;p&gt;&lt;strong&gt;本当に「{{ user.username }}」を削除しますか？&lt;/strong&gt;&lt;/p&gt;
                    &lt;p class="text-muted"&gt;この操作は取り消すことができません。&lt;/p&gt;
                    &lt;div class="alert alert-warning"&gt;
                        &lt;strong&gt;削除される情報:&lt;/strong&gt;
                        &lt;ul class="mb-0"&gt;
                            &lt;li&gt;ユーザー名: {{ user.username }}&lt;/li&gt;
                            &lt;li&gt;メール: {{ user.email }}&lt;/li&gt;
                            &lt;li&gt;氏名: {{ user.full_name }}&lt;/li&gt;
                        &lt;/ul&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class="modal-footer"&gt;
                    &lt;button type="button" class="btn btn-secondary" data-bs-dismiss="modal"&gt;キャンセル&lt;/button&gt;
                    &lt;form method="post" action="/users/{{ user.id }}/delete" style="display: inline;"&gt;
                        &lt;button type="submit" class="btn btn-danger"&gt;削除する&lt;/button&gt;
                    &lt;/form&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
    &lt;script&gt;
        // フォームにid属性を追加
        document.querySelector('form[action*="edit"]').id = 'edit-form';
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                        
                        <h6>ポイント解説</h6>
                        <ul>
                            <li><strong>value="{{ user.username }}"</strong>: 既存データをフォームに表示</li>
                            <li><strong>Bootstrap Modal</strong>: 削除確認ダイアログ</li>
                            <li><strong>form属性</strong>: ボタンを別の場所に配置してもフォーム送信可能</li>
                            <li><strong>data-bs-toggle</strong>: Bootstrap5のモーダル起動</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.2 更新処理の実装</h3>
                    
                    <p><code>main.py</code>にユーザー編集機能を追加します。</p>

                    <div class="exercise-container">
                        <h5>実習 6-2: ユーザー更新ルートの実装</h5>
                        <p>編集フォームの表示と更新処理を実装します。</p>
                        
                        <h6>コード例 - main.pyに追加</h6>
                        <pre class="code-block"><code class="language-python"># ユーザー編集フォーム表示
@app.get("/users/{user_id}/edit", response_class=HTMLResponse)
async def show_edit_form(request: Request, user_id: int, db: Session = Depends(get_db)):
    """ユーザー編集フォームを表示"""
    user = db.query(User).filter(User.id == user_id).first()
    
    if user is None:
        raise HTTPException(status_code=404, detail="ユーザーが見つかりません")
    
    return templates.TemplateResponse(
        "user_edit.html",
        {"request": request, "user": user}
    )

# ユーザー更新処理
@app.post("/users/{user_id}/edit", response_class=HTMLResponse)
async def update_user(
    request: Request,
    user_id: int,
    username: str = Form(...),
    email: str = Form(...),
    full_name: str = Form(...),
    db: Session = Depends(get_db)
):
    """ユーザー情報を更新"""
    try:
        # 更新対象のユーザーを取得
        user = db.query(User).filter(User.id == user_id).first()
        
        if user is None:
            raise HTTPException(status_code=404, detail="ユーザーが見つかりません")
        
        # バリデーション
        if len(username.strip()) < 3:
            return templates.TemplateResponse(
                "user_edit.html",
                {
                    "request": request,
                    "user": user,
                    "message": "ユーザー名は3文字以上で入力してください",
                    "error": True
                }
            )
        
        if "@" not in email:
            return templates.TemplateResponse(
                "user_edit.html",
                {
                    "request": request,
                    "user": user,
                    "message": "正しいメールアドレスを入力してください",
                    "error": True
                }
            )
        
        # 他のユーザーが同じユーザー名・メールを使用していないかチェック
        existing_user = db.query(User).filter(
            User.username == username.strip(),
            User.id != user_id
        ).first()
        
        if existing_user:
            return templates.TemplateResponse(
                "user_edit.html",
                {
                    "request": request,
                    "user": user,
                    "message": "そのユーザー名は既に使用されています",
                    "error": True
                }
            )
        
        existing_email = db.query(User).filter(
            User.email == email.strip(),
            User.id != user_id
        ).first()
        
        if existing_email:
            return templates.TemplateResponse(
                "user_edit.html",
                {
                    "request": request,
                    "user": user,
                    "message": "そのメールアドレスは既に使用されています",
                    "error": True
                }
            )
        
        # ユーザー情報を更新
        user.username = username.strip()
        user.email = email.strip()
        user.full_name = full_name.strip()
        
        db.commit()
        db.refresh(user)
        
        return templates.TemplateResponse(
            "user_edit.html",
            {
                "request": request,
                "user": user,
                "message": "ユーザー情報を正常に更新しました！",
                "error": False
            }
        )
        
    except Exception as e:
        db.rollback()
        return templates.TemplateResponse(
            "user_edit.html",
            {
                "request": request,
                "user": user,
                "message": f"更新中にエラーが発生しました: {str(e)}",
                "error": True
            }
        )</code></pre>
                        
                        <h6>ポイント解説</h6>
                        <ul>
                            <li><strong>既存データ取得</strong>: 更新前に対象レコードを取得</li>
                            <li><strong>重複チェック</strong>: 自分以外のユーザーとの重複を確認</li>
                            <li><strong>直接更新</strong>: オブジェクトのプロパティを直接変更</li>
                            <li><strong>db.refresh()</strong>: 更新後のデータを再取得</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.3 削除処理の実装</h3>
                    
                    <p>ユーザー削除機能を実装します。</p>

                    <div class="exercise-container">
                        <h5>実習 6-3: ユーザー削除ルートの実装</h5>
                        <p>ユーザーをデータベースから削除する処理を実装します。</p>
                        
                        <h6>コード例 - main.pyに追加</h6>
                        <pre class="code-block"><code class="language-python"># ユーザー削除処理
@app.post("/users/{user_id}/delete", response_class=HTMLResponse)
async def delete_user(
    request: Request,
    user_id: int,
    db: Session = Depends(get_db)
):
    """ユーザーを削除"""
    try:
        # 削除対象のユーザーを取得
        user = db.query(User).filter(User.id == user_id).first()
        
        if user is None:
            raise HTTPException(status_code=404, detail="ユーザーが見つかりません")
        
        # ユーザー名を削除前に保存（成功メッセージ用）
        deleted_username = user.username
        
        # ユーザーを削除
        db.delete(user)
        db.commit()
        
        # 削除成功後はユーザー一覧にリダイレクト
        users = db.query(User).order_by(User.created_at.desc()).all()
        return templates.TemplateResponse(
            "user_list.html",
            {
                "request": request,
                "users": users,
                "message": f"ユーザー「{deleted_username}」を削除しました",
                "error": False
            }
        )
        
    except Exception as e:
        db.rollback()
        # エラー時は編集画面に戻る
        user = db.query(User).filter(User.id == user_id).first()
        return templates.TemplateResponse(
            "user_edit.html",
            {
                "request": request,
                "user": user,
                "message": f"削除中にエラーが発生しました: {str(e)}",
                "error": True
            }
        )</code></pre>
                        
                        <h6>ポイント解説</h6>
                        <ul>
                            <li><strong>db.delete()</strong>: SQLAlchemyでのレコード削除</li>
                            <li><strong>削除前情報保存</strong>: メッセージ表示用にデータを保存</li>
                            <li><strong>削除後リダイレクト</strong>: 削除後は一覧ページに戻る</li>
                            <li><strong>エラーハンドリング</strong>: 削除失敗時の適切な処理</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.4 詳細ページの更新</h3>
                    
                    <p>Step 5で作成した詳細ページの編集・削除ボタンを有効化します。</p>

                    <div class="exercise-container">
                        <h5>実習 6-4: 詳細ページのボタン有効化</h5>
                        <p><code>templates/user_detail.html</code>を更新してボタンを有効にします。</p>
                        
                        <h6>変更箇所</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- 変更前 --&gt;
&lt;a href="/users/{{ user.id }}/edit" class="btn btn-warning disabled"&gt;編集（次章で実装）&lt;/a&gt;
&lt;button class="btn btn-danger disabled"&gt;削除（次章で実装）&lt;/button&gt;

&lt;!-- 変更後 --&gt;
&lt;a href="/users/{{ user.id }}/edit" class="btn btn-warning"&gt;編集&lt;/a&gt;
&lt;button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#deleteModal"&gt;
    削除
&lt;/button&gt;</code></pre>
                        
                        <p>また、詳細ページにも削除確認モーダルを追加します（編集ページと同様のモーダルコードを追加）。</p>
                    </div>

                    <h3 class="section-title">6.5 一覧ページにメッセージ表示機能追加</h3>
                    
                    <p>削除成功メッセージを表示するため、一覧ページを更新します。</p>

                    <div class="exercise-container">
                        <h5>実習 6-5: 一覧ページのメッセージ表示</h5>
                        <p><code>templates/user_list.html</code>にメッセージ表示機能を追加します。</p>
                        
                        <h6>追加コード</h6>
                        <pre class="code-block"><code class="language-html">&lt;!-- ページタイトルの後に追加 --&gt;
{% if message %}
    {% if error %}
        &lt;div class="alert alert-danger alert-dismissible fade show" role="alert"&gt;
            {{ message }}
            &lt;button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"&gt;&lt;/button&gt;
        &lt;/div&gt;
    {% else %}
        &lt;div class="alert alert-success alert-dismissible fade show" role="alert"&gt;
            {{ message }}
            &lt;button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"&gt;&lt;/button&gt;
        &lt;/div&gt;
    {% endif %}
{% endif %}</code></pre>
                    </div>

                    <h3 class="section-title">6.6 動作確認とテスト</h3>
                    
                    <div class="exercise-container">
                        <h5>実習 6-6: 編集・削除機能の動作確認</h5>
                        <p>実装した機能が正常に動作することを確認します。</p>
                        
                        <h6>テスト手順</h6>
                        <ol>
                            <li>FastAPIサーバーを起動</li>
                            <li>既存ユーザーの詳細ページから「編集」をクリック</li>
                            <li>フォームの内容を変更して「更新する」をクリック</li>
                            <li>更新成功メッセージが表示されることを確認</li>
                            <li>同じユーザー名で他のユーザーを更新し、エラーメッセージを確認</li>
                            <li>「削除」ボタンをクリックしてモーダルが表示されることを確認</li>
                            <li>「削除する」をクリックして削除が実行されることを確認</li>
                            <li>一覧ページで削除成功メッセージが表示されることを確認</li>
                        </ol>
                        
                        <h6>確認ポイント</h6>
                        <ul>
                            <li><strong>更新機能</strong>: フォームから正しく更新される</li>
                            <li><strong>バリデーション</strong>: 重複チェックが正常動作</li>
                            <li><strong>削除確認</strong>: モーダルで安全に削除確認</li>
                            <li><strong>削除処理</strong>: データが確実に削除される</li>
                            <li><strong>エラーハンドリング</strong>: 適切なエラーメッセージ表示</li>
                        </ul>
                    </div>

                    <h3 class="section-title">6.7 セキュリティとベストプラクティス</h3>
                    
                    <div class="warning">
                        <h6>重要な注意事項</h6>
                        <p>実際のアプリケーションでは、以下のセキュリティ対策が必要です：</p>
                        <ul>
                            <li><strong>認証・認可</strong>: ユーザーが自分のデータのみ編集・削除可能にする</li>
                            <li><strong>CSRF対策</strong>: クロスサイトリクエストフォージェリの防止</li>
                            <li><strong>ソフトデリート</strong>: 物理削除ではなく論理削除の検討</li>
                            <li><strong>監査ログ</strong>: 変更履歴の記録</li>
                        </ul>
                    </div>

                    <div class="highlight">
                        <h6>発展的な実装例</h6>
                        <p>より堅牢なアプリケーションのための改善案：</p>
                        
                        <pre class="code-block"><code class="language-python"># ソフトデリートの実装例
from datetime import datetime

class User(Base):
    __tablename__ = "users"
    
    id = Column(Integer, primary_key=True, index=True)
    username = Column(String, unique=True, index=True)
    email = Column(String, unique=True, index=True)
    full_name = Column(String)
    created_at = Column(DateTime, default=datetime.utcnow)
    deleted_at = Column(DateTime, nullable=True)  # 削除日時
    is_active = Column(Boolean, default=True)     # アクティブ状態

# アクティブなユーザーのみ取得
active_users = db.query(User).filter(User.is_active == True).all()</code></pre>
                    </div>

                    <!-- 理解度確認クイズ -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>SQLAlchemyでレコードを更新する際の基本的な手順を説明してください。</li>
                            <li>他のユーザーとの重複をチェックする際に、自分自身を除外する方法を書いてください。</li>
                            <li>SQLAlchemyでレコードを削除するメソッドは何ですか？</li>
                            <li>Bootstrap 5でモーダルダイアログを表示するために必要な属性を2つ挙げてください。</li>
                            <li>データ変更処理でエラーが発生した場合に実行すべきSQLAlchemyのメソッドは何ですか？</li>
                        </ol>
                        
                        <details class="mt-3">
                            <summary>解答例</summary>
                            <ol>
                                <li>1. 対象レコードを取得 2. プロパティを変更 3. db.commit() 4. db.refresh()</li>
                                <li><code>User.id != user_id</code>の条件を追加</li>
                                <li><code>db.delete()</code></li>
                                <li><code>data-bs-toggle="modal"</code>と<code>data-bs-target="#modalId"</code></li>
                                <li><code>db.rollback()</code></li>
                            </ol>
                        </details>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step5-user-list-detail.html" class="btn btn-secondary">← Step 5: ユーザー一覧と詳細</a>
                        <a href="step7-search-summary.html" class="btn btn-primary">Step 7: 検索機能とまとめ →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
</body>
</html>