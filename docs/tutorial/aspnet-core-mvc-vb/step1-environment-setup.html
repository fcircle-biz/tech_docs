<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASP.NET Core MVC学習教材 Step 1 - 環境構築とプロジェクト作成</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js for syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/vs2015.min.css">
    
    <style>
        /* ASP.NET用カラーテーマ */
        :root {
            --primary-color: #512bd4;
            --secondary-color: #7c3aed;
            --background-color: #f8f9ff;
        }
        
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        
        .navbar {
            background-color: var(--primary-color) !important;
        }
        
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
            background-color: #f8f9fa;
        }
        
        .chapter-title {
            color: var(--primary-color);
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 0.5rem;
        }
        
        .section-title {
            color: var(--secondary-color);
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        
        .quiz-container {
            background-color: var(--background-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid var(--primary-color);
        }
        
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        
        .nav-link.active {
            background-color: var(--primary-color) !important;
            color: white !important;
        }
        
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .step-indicator {
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="#">ASP.NET Core MVC チュートリアル</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.html">チュートリアル概要</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- Sidebar -->
            <nav class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        チュートリアル ステップ
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="step1-environment-setup.html">
                                Step 1: 環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-mvc-architecture.html">
                                Step 2: MVCアーキテクチャ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-database-design.html">
                                Step 3: データベース設計
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-registration.html">
                                Step 4: ユーザー登録機能
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-list-detail.html">
                                Step 5: 一覧・詳細表示
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-user-update-delete.html">
                                Step 6: 編集・削除機能
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step7-security-optimization.html">
                                Step 7: セキュリティと最適化
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- Main Content -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- Chapter Header -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 1: 環境構築とプロジェクト作成</h1>
                    <div class="btn-toolbar mb-2 mb-md-0">
                        <small class="text-muted">所要時間: 約1.5時間</small>
                    </div>
                </div>

                <div id="step1">
                    <!-- Chapter Title -->
                    <h2 class="chapter-title">ASP.NET Core MVC開発環境の構築</h2>
                    
                    <!-- Learning Objectives -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Visual Studio 2022でのASP.NET Core プロジェクト作成</li>
                            <li>VB.NETプロジェクトテンプレートの選択と設定</li>
                            <li>MVCプロジェクト構造の理解（Controllers、Models、Views）</li>
                            <li>NuGetパッケージ管理とEntity Framework Coreのインストール</li>
                            <li>初回実行と基本的な動作確認</li>
                        </ul>
                    </div>

                    <!-- Prerequisites -->
                    <div class="warning">
                        <h5>前提条件の確認</h5>
                        <p>このチュートリアルを始める前に、以下がインストールされていることを確認してください：</p>
                        <ul>
                            <li><strong>Visual Studio 2022</strong>: Community Edition以上（最新版推奨）</li>
                            <li><strong>.NET 8 SDK</strong>: 最新版</li>
                            <li><strong>SQL Server</strong>: SQL Server 2019 Express以上（LocalDB可）</li>
                            <li><strong>ブラウザ</strong>: Chrome、Edge、Firefoxなど最新版</li>
                        </ul>
                    </div>

                    <!-- Section 1.1 -->
                    <h3 class="section-title">1.1 Visual Studioでの新規プロジェクト作成</h3>
                    <p>まず、Visual Studio 2022を使用してASP.NET Core MVCプロジェクトを作成します。VB.NETでのプロジェクト作成は、C#とは若干手順が異なりますので注意深く進めましょう。</p>

                    <!-- Exercise 1-1 -->
                    <div class="exercise-container">
                        <h5>実習 1-1: ASP.NET Core MVCプロジェクトの作成</h5>
                        <p>Visual Studio 2022を使用して、VB.NETによるASP.NET Core MVCプロジェクトを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><span class="step-indicator">1</span>Visual Studio 2022を起動し、「新しいプロジェクトの作成」をクリック</li>
                            <li><span class="step-indicator">2</span>プロジェクトテンプレート選択画面で以下を設定：
                                <ul>
                                    <li>言語: <strong>Visual Basic</strong></li>
                                    <li>プラットフォーム: <strong>すべてのプラットフォーム</strong></li>
                                    <li>プロジェクトの種類: <strong>Web</strong></li>
                                </ul>
                            </li>
                            <li><span class="step-indicator">3</span>「ASP.NET Core Web アプリ (Model-View-Controller)」を選択し、「次へ」をクリック</li>
                            <li><span class="step-indicator">4</span>プロジェクト情報を入力：
                                <ul>
                                    <li>プロジェクト名: <code>UserManagerPro</code></li>
                                    <li>場所: 任意の場所（例: <code>C:\Projects\</code>）</li>
                                    <li>ソリューション名: <code>UserManagerPro</code></li>
                                </ul>
                            </li>
                            <li><span class="step-indicator">5</span>追加情報の設定：
                                <ul>
                                    <li>フレームワーク: <strong>.NET 8.0 (長期サポート)</strong></li>
                                    <li>認証の種類: <strong>なし</strong>（後の章で設定）</li>
                                    <li>HTTPS用の構成: <strong>チェック</strong></li>
                                    <li>Docker を有効にする: <strong>チェックしない</strong></li>
                                </ul>
                            </li>
                            <li><span class="step-indicator">6</span>「作成」をクリックしてプロジェクトを生成</li>
                        </ol>

                        <h6>期待される結果</h6>
                        <p>Visual Studioで新しいASP.NET Core MVCプロジェクトが作成され、ソリューションエクスプローラーに以下のような構造が表示されます。</p>
                    </div>

                    <!-- Section 1.2 -->
                    <h3 class="section-title">1.2 プロジェクト構造の理解</h3>
                    <p>作成されたプロジェクトの構造を理解することは、ASP.NET Core MVCを効率的に開発するために重要です。</p>

                    <div class="highlight">
                        <h5>MVCプロジェクトの基本構造</h5>
                        <pre><code>UserManagerPro/
│  appsettings.json          # アプリケーション設定
│  appsettings.Development.json  # 開発環境用設定
│  Program.vb                # アプリケーションエントリポイント
│  UserManagerPro.vbproj     # プロジェクトファイル
│
├─Controllers/               # コントローラー（ビジネスロジック）
│      HomeController.vb
│
├─Models/                    # モデル（データ構造）
│      ErrorViewModel.vb
│
├─Views/                     # ビュー（画面表示）
│  ├─Home/
│  │      Index.vbhtml
│  │      Privacy.vbhtml
│  │
│  └─Shared/
│          _Layout.vbhtml
│          _ViewImports.vbhtml
│          _ViewStart.vbhtml
│          Error.vbhtml
│
├─wwwroot/                   # 静的ファイル
│  ├─css/
│  ├─js/
│  └─lib/
│
└─Properties/
        launchSettings.json   # 起動設定</code></pre>
                    </div>

                    <!-- Web Forms vs MVC Comparison -->
                    <div class="quiz-container">
                        <h5>Web Forms との構造比較</h5>
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th>Web Forms</th>
                                    <th>ASP.NET Core MVC</th>
                                    <th>説明</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>.aspx ページ</td>
                                    <td>Views (*.vbhtml)</td>
                                    <td>画面表示を担当</td>
                                </tr>
                                <tr>
                                    <td>コードビハインド (.vb)</td>
                                    <td>Controllers (*.vb)</td>
                                    <td>処理ロジックを担当</td>
                                </tr>
                                <tr>
                                    <td>App_Code</td>
                                    <td>Models</td>
                                    <td>データ構造を定義</td>
                                </tr>
                                <tr>
                                    <td>Global.asax</td>
                                    <td>Program.vb</td>
                                    <td>アプリケーション設定</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <!-- Section 1.3 -->
                    <h3 class="section-title">1.3 Entity Framework Core の追加</h3>
                    <p>データベース操作のために、Entity Framework Coreパッケージを追加します。</p>

                    <!-- Exercise 1-2 -->
                    <div class="exercise-container">
                        <h5>実習 1-2: Entity Framework Core パッケージのインストール</h5>
                        <p>NuGetパッケージマネージャーを使用して、必要なEntity Framework Coreパッケージをインストールします。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><span class="step-indicator">1</span>ソリューションエクスプローラーでプロジェクトを右クリック → 「NuGetパッケージの管理」を選択</li>
                            <li><span class="step-indicator">2</span>「参照」タブで以下のパッケージを検索・インストール：</li>
                        </ol>

                        <div class="table-responsive">
                            <table class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>パッケージ名</th>
                                        <th>バージョン</th>
                                        <th>用途</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td><code>Microsoft.EntityFrameworkCore.SqlServer</code></td>
                                        <td>8.0.x</td>
                                        <td>SQL Server プロバイダー</td>
                                    </tr>
                                    <tr>
                                        <td><code>Microsoft.EntityFrameworkCore.Tools</code></td>
                                        <td>8.0.x</td>
                                        <td>マイグレーションツール</td>
                                    </tr>
                                    <tr>
                                        <td><code>Microsoft.EntityFrameworkCore.Design</code></td>
                                        <td>8.0.x</td>
                                        <td>デザイン時ツール</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <h6>パッケージマネージャーコンソールでのインストール（代替方法）</h6>
                        <p>「ツール」→「NuGetパッケージマネージャー」→「パッケージマネージャーコンソール」で以下を実行：</p>
                        <div class="code-block">
                            <pre><code class="language-powershell">Install-Package Microsoft.EntityFrameworkCore.SqlServer -Version 8.0.0
Install-Package Microsoft.EntityFrameworkCore.Tools -Version 8.0.0
Install-Package Microsoft.EntityFrameworkCore.Design -Version 8.0.0</code></pre>
                        </div>
                    </div>

                    <!-- Section 1.4 -->
                    <h3 class="section-title">1.4 初回実行と動作確認</h3>
                    <p>プロジェクトが正しく作成されたことを確認するため、初回実行を行います。</p>

                    <!-- Exercise 1-3 -->
                    <div class="exercise-container">
                        <h5>実習 1-3: アプリケーションの初回実行</h5>
                        <p>作成したプロジェクトを実行して、正常に動作することを確認します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><span class="step-indicator">1</span>Visual Studioで「F5」キーを押すか、「デバッグ」→「デバッグの開始」を選択</li>
                            <li><span class="step-indicator">2</span>ブラウザが自動起動し、アプリケーションが表示されることを確認</li>
                            <li><span class="step-indicator">3</span>画面上部のナビゲーションで「Home」「Privacy」リンクをクリックし、正常に画面遷移することを確認</li>
                            <li><span class="step-indicator">4</span>ブラウザのアドレス欄のURLが <code>https://localhost:XXXX</code> 形式になっていることを確認</li>
                        </ol>

                        <h6>期待される結果</h6>
                        <ul>
                            <li>ブラウザで「Welcome」画面が表示される</li>
                            <li>ナビゲーションバーが正常に機能する</li>
                            <li>HTTPSでアクセスできる</li>
                            <li>Visual Studioの出力ウィンドウにエラーがない</li>
                        </ul>

                        <div class="warning">
                            <h6>トラブルシューティング</h6>
                            <ul>
                                <li><strong>「VB.NETテンプレートが見つからない」</strong>: Visual Studio Installerで「ASP.NETとWeb開発」ワークロードを確認・再インストール</li>
                                <li><strong>「ビルドエラーが発生」</strong>: プロジェクトのプロパティでVB.NETの言語バージョン設定を確認</li>
                                <li><strong>「ブラウザが起動しない」</strong>: プロジェクトのプロパティで起動設定を確認</li>
                            </ul>
                        </div>
                    </div>

                    <!-- Section 1.5 -->
                    <h3 class="section-title">1.5 開発環境の最適化</h3>
                    <p>効率的な開発のために、Visual Studioの設定を最適化します。</p>

                    <div class="highlight">
                        <h5>推奨設定</h5>
                        <ol>
                            <li><strong>コードファーストワークフロー</strong>: Entity Framework Coreのコードファーストアプローチに慣れましょう</li>
                            <li><strong>デバッグ設定</strong>: ブレークポイントとステップ実行を活用</li>
                            <li><strong>IntelliSense</strong>: VB.NET用のコード補完機能を最大限活用</li>
                            <li><strong>エラーリスト</strong>: コンパイルエラーと警告の監視</li>
                        </ol>
                    </div>

                    <!-- Understanding Check Quiz -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li><strong>Question 1</strong>: ASP.NET Core MVCにおいて、画面表示を担当するのはどのフォルダですか？
                                <ul style="list-style-type: none;">
                                    <li>a) Controllers</li>
                                    <li>b) Models</li>
                                    <li>c) Views</li>
                                    <li>d) wwwroot</li>
                                </ul>
                            </li>
                            <li><strong>Question 2</strong>: Entity Framework Coreで SQL Server を使用するために必要な主要なNuGetパッケージは何ですか？</li>
                            <li><strong>Question 3</strong>: Web Forms の「コードビハインド」に相当するMVCの概念は何ですか？</li>
                            <li><strong>Question 4</strong>: 静的ファイル（CSS、JavaScript、画像など）はどのフォルダに配置しますか？</li>
                        </ol>
                        
                        <details class="mt-3">
                            <summary>解答を表示</summary>
                            <ol class="mt-2">
                                <li>c) Views - ビューがHTMLの生成とユーザーへの表示を担当します</li>
                                <li>Microsoft.EntityFrameworkCore.SqlServer - SQL Server データベースとの接続を提供します</li>
                                <li>Controllers - コントローラーがビジネスロジックと処理を担当します</li>
                                <li>wwwroot - webルートフォルダが静的ファイルの配信を担当します</li>
                            </ol>
                        </details>
                    </div>

                    <!-- Next Steps -->
                    <div class="highlight">
                        <h5>次のステップの準備</h5>
                        <p>Step 1 が完了したら、以下を確認してください：</p>
                        <ul>
                            <li>✅ Visual Studio 2022 でVB.NET MVCプロジェクトが作成できた</li>
                            <li>✅ プロジェクト構造（MVC）を理解した</li>
                            <li>✅ Entity Framework Core パッケージがインストールされた</li>
                            <li>✅ アプリケーションが正常に実行できた</li>
                            <li>✅ Web Forms との違いを理解した</li>
                        </ul>
                        <p>これらが完了したら、<strong>Step 2: MVCアーキテクチャとルーティング</strong>に進みましょう。</p>
                    </div>

                    <!-- Navigation -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="README.html" class="btn btn-secondary">← チュートリアル概要</a>
                        <a href="step2-mvc-architecture.html" class="btn btn-primary">Step 2: MVCアーキテクチャ →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/vbnet.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/powershell.min.js"></script>
    <script>hljs.highlightAll();</script>
</body>
</html>