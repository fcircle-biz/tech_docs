<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Django実践チュートリアル ステップ5 - ビュー、テンプレート、URLルーティング</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <!-- Mermaid.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        .navbar {
            background-color: #4caf50;
        }
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        .chapter-title {
            color: #4caf50;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #4caf50;
            padding-bottom: 0.5rem;
        }
        .section-title {
            color: #66bb6a;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        .quiz-container {
            background-color: #e8f5e8;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #4caf50;
        }
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        .nav-link.active {
            background-color: #4caf50 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand">
                <strong>Django実践チュートリアル</strong>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block sidebar collapse">
                <div class="position-sticky pt-3">
                    <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                        <span>チュートリアルステップ</span>
                    </h6>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link" href="step1-environment-setup.html">
                                ステップ1: 開発環境構築
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-docker-postgresql.html">
                                ステップ2: Docker・PostgreSQL
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-django-project-init.html">
                                ステップ3: プロジェクト初期化
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-models-migration.html">
                                ステップ4: モデル・マイグレーション
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link active" href="step5-views-templates-urls.html">
                                ステップ5: ビュー・テンプレート・URL
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-admin-interface.html">
                                ステップ6: 管理サイト
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step7-crud-operations.html">
                                ステップ7: CRUD操作
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step8-validation-security.html">
                                ステップ8: バリデーション・セキュリティ
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step9-testing-debugging.html">
                                ステップ9: テスト・デバッグ
                            </a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <!-- ステップヘッダー -->
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">ステップ5: ビュー、テンプレート、URLルーティング</h1>
                </div>

                <div id="step5">
                    <!-- このステップの目標 -->
                    <div class="highlight">
                        <h5>このステップで実装すること</h5>
                        <ul>
                            <li>MVTアーキテクチャの理解</li>
                            <li>関数ベースビューとクラスベースビュー</li>
                            <li>URLパターンの設定と名前付きURL</li>
                            <li>テンプレートの作成と継承</li>
                            <li>コンテキストデータの受け渡し</li>
                            <li>静的ファイルの管理</li>
                        </ul>
                    </div>

                    <!-- 前提条件・準備 -->
                    <div class="alert alert-info">
                        <h6>前提条件</h6>
                        <ul>
                            <li>ステップ1〜4が完了していること</li>
                            <li>カスタムUserモデルが作成済み</li>
                            <li>管理サイトが正常に動作すること</li>
                            <li>テストデータが存在すること</li>
                        </ul>
                    </div>

                    <h2 class="chapter-title">DjangoのMVTアーキテクチャ実装</h2>

                    <div class="mermaid">
                        graph LR
                            A["ブラウザ"] --> B["URL Dispatcher"]
                            B --> C["View (ビュー)"]
                            C --> D["Model (モデル)"]
                            C --> E["Template (テンプレート)"]
                            D --> F["Database"]
                            E --> G["HTML Response"]
                            G --> A
                    </div>

                    <!-- セクション1: URLパターン設定 -->
                    <h3 class="section-title">5.1 URLルーティングの設定</h3>
                    <p>ユーザー管理機能のURLパターンを設定し、適切なビューにルーティングします。</p>

                    <!-- 実装手順1 -->
                    <div class="exercise-container">
                        <h5>実装 5-1: URLルーティング設定</h5>
                        <p>プロジェクト全体とusersアプリのURL設定を行います。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><strong>usersアプリのurls.py作成</strong>:
                                <pre class="code-block"><code class="language-python"># users/urls.py (新規作成)
from django.urls import path
from . import views

app_name = 'users'

urlpatterns = [
    # ユーザー管理のURL
    path('', views.UserListView.as_view(), name='user_list'),
    path('&lt;int:pk&gt;/', views.UserDetailView.as_view(), name='user_detail'),
    path('create/', views.UserCreateView.as_view(), name='user_create'),
    path('&lt;int:pk&gt;/edit/', views.UserUpdateView.as_view(), name='user_update'),
    path('&lt;int:pk&gt;/delete/', views.UserDeleteView.as_view(), name='user_delete'),
    
    # 関数ベースビューの例
    path('dashboard/', views.dashboard_view, name='dashboard'),
]</code></pre>
                            </li>
                            <li><strong>プロジェクトのurls.py更新</strong>: myproject/urls.pyを編集
                                <pre class="code-block"><code class="language-python"># myproject/urls.py
from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static
from django.shortcuts import redirect

def redirect_to_users(request):
    """ルートURLからusersアプリにリダイレクト"""
    return redirect('users:user_list')

urlpatterns = [
    path('admin/', admin.site.urls),
    path('users/', include('users.urls')),
    path('', redirect_to_users, name='home'),
]

# 開発環境での静的・メディアファイル配信
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)
    urlpatterns += static(settings.STATIC_URL, document_root=settings.STATIC_ROOT)
    
    # Debug Toolbar用URL
    import debug_toolbar
    urlpatterns = [
        path('__debug__/', include(debug_toolbar.urls)),
    ] + urlpatterns</code></pre>
                            </li>
                        </ol>
                        
                        <h6>動作確認</h6>
                        <p>URL設定の構文チェック:</p>
                        <pre class="code-block"><code class="language-bash">python manage.py check</code></pre>
                        
                        <h6>期待される結果</h6>
                        <div class="alert alert-success">
                            <p>URL設定エラーが発生せず、ルーティングが正しく設定されている</p>
                        </div>
                    </div>

                    <!-- セクション2: ベーステンプレート作成 -->
                    <h3 class="section-title">5.2 テンプレート構造の構築</h3>
                    <p>テンプレート継承を活用した効率的なHTML構造を作成します。</p>

                    <!-- 実装手順2 -->
                    <div class="exercise-container">
                        <h5>実装 5-2: ベーステンプレートの作成</h5>
                        <p>全ページで共通利用するベーステンプレートを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><strong>テンプレートディレクトリ作成</strong>:
                                <pre class="code-block"><code class="language-bash">mkdir templates
mkdir templates\users</code></pre>
                            </li>
                            <li><strong>settings.pyでテンプレート設定</strong>:
                                <pre class="code-block"><code class="language-python"># myproject/settings.py のTEMPLATES設定を更新
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'],  # この行を追加
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]</code></pre>
                            </li>
                            <li><strong>base.htmlテンプレート作成</strong>:
                                <pre class="code-block"><code class="language-html">&lt;!-- templates/base.html --&gt;
&lt;!DOCTYPE html&gt;
&lt;html lang="ja"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;meta name="viewport" content="width=device-width, initial-scale=1.0"&gt;
    &lt;title&gt;{% block title %}Django ユーザー管理システム{% endblock %}&lt;/title&gt;
    
    &lt;!-- Bootstrap 5 CSS --&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    
    &lt;!-- カスタムCSS --&gt;
    {% load static %}
    &lt;link rel="stylesheet" href="{% static 'css/base.css' %}"&gt;
    
    {% block extra_css %}{% endblock %}
&lt;/head&gt;
&lt;body&gt;
    &lt;!-- ナビゲーションバー --&gt;
    &lt;nav class="navbar navbar-expand-lg navbar-dark bg-success"&gt;
        &lt;div class="container"&gt;
            &lt;a class="navbar-brand" href="{% url 'users:user_list' %}"&gt;
                ユーザー管理システム
            &lt;/a&gt;
            &lt;button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"&gt;
                &lt;span class="navbar-toggler-icon"&gt;&lt;/span&gt;
            &lt;/button&gt;
            &lt;div class="collapse navbar-collapse" id="navbarNav"&gt;
                &lt;ul class="navbar-nav me-auto"&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="{% url 'users:user_list' %}"&gt;ユーザー一覧&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="{% url 'users:user_create' %}"&gt;ユーザー登録&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="{% url 'users:dashboard' %}"&gt;ダッシュボード&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul class="navbar-nav"&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="/admin/"&gt;管理サイト&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/nav&gt;

    &lt;!-- メインコンテンツ --&gt;
    &lt;main class="container mt-4"&gt;
        &lt;!-- メッセージ表示 --&gt;
        {% if messages %}
            {% for message in messages %}
                &lt;div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert"&gt;
                    {{ message }}
                    &lt;button type="button" class="btn-close" data-bs-dismiss="alert"&gt;&lt;/button&gt;
                &lt;/div&gt;
            {% endfor %}
        {% endif %}

        {% block content %}
        &lt;!-- ページ固有のコンテンツがここに入る --&gt;
        {% endblock %}
    &lt;/main&gt;

    &lt;!-- フッター --&gt;
    &lt;footer class="bg-dark text-white text-center py-3 mt-5"&gt;
        &lt;div class="container"&gt;
            &lt;p class="mb-0"&gt;&copy; 2025 Django ユーザー管理システム&lt;/p&gt;
        &lt;/div&gt;
    &lt;/footer&gt;

    &lt;!-- Bootstrap 5 JavaScript --&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
    {% block extra_js %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                            </li>
                        </ol>
                        
                        <h6>動作確認</h6>
                        <p>テンプレート設定の確認:</p>
                        <pre class="code-block"><code class="language-bash"># テンプレートディレクトリ構造確認
tree templates /F</code></pre>
                        
                        <h6>期待される結果</h6>
                        <div class="alert alert-success">
                            <p>templatesディレクトリが作成され、base.htmlが正しく配置されている</p>
                        </div>
                    </div>

                    <!-- セクション3: ビューの実装 -->
                    <h3 class="section-title">5.3 ビューの実装</h3>
                    <p>関数ベースビューとクラスベースビューを実装し、ユーザー管理機能を作成します。</p>

                    <!-- 実装手順3 -->
                    <div class="exercise-container">
                        <h5>実装 5-3: ビューの作成</h5>
                        <p>ユーザーのCRUD操作に対応するビューを実装します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><strong>users/views.py実装</strong>:
                                <pre class="code-block"><code class="language-python"># users/views.py
from django.shortcuts import render
from django.urls import reverse_lazy
from django.views.generic import ListView, DetailView, CreateView, UpdateView, DeleteView
from django.contrib import messages
from django.db.models import Q
from .models import User


# 関数ベースビューの例
def dashboard_view(request):
    """ダッシュボードページ"""
    context = {
        'total_users': User.objects.count(),
        'active_users': User.objects.filter(is_active=True).count(),
        'recent_users': User.objects.order_by('-date_joined')[:5],
    }
    return render(request, 'users/dashboard.html', context)


# クラスベースビュー
class UserListView(ListView):
    """ユーザー一覧表示"""
    model = User
    template_name = 'users/user_list.html'
    context_object_name = 'users'
    paginate_by = 10
    
    def get_queryset(self):
        queryset = User.objects.all()
        search_query = self.request.GET.get('search')
        if search_query:
            queryset = queryset.filter(
                Q(username__icontains=search_query) |
                Q(email__icontains=search_query) |
                Q(first_name__icontains=search_query) |
                Q(last_name__icontains=search_query)
            )
        return queryset.order_by('-date_joined')
    
    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        context['search_query'] = self.request.GET.get('search', '')
        return context


class UserDetailView(DetailView):
    """ユーザー詳細表示"""
    model = User
    template_name = 'users/user_detail.html'
    context_object_name = 'user'


class UserCreateView(CreateView):
    """ユーザー作成"""
    model = User
    template_name = 'users/user_form.html'
    fields = ['username', 'email', 'first_name', 'last_name', 'phone_number', 'birth_date']
    success_url = reverse_lazy('users:user_list')
    
    def form_valid(self, form):
        messages.success(self.request, 'ユーザーが正常に作成されました。')
        return super().form_valid(form)


class UserUpdateView(UpdateView):
    """ユーザー更新"""
    model = User
    template_name = 'users/user_form.html'
    fields = ['username', 'email', 'first_name', 'last_name', 'phone_number', 'birth_date', 'is_active']
    success_url = reverse_lazy('users:user_list')
    
    def form_valid(self, form):
        messages.success(self.request, 'ユーザー情報が正常に更新されました。')
        return super().form_valid(form)


class UserDeleteView(DeleteView):
    """ユーザー削除"""
    model = User
    template_name = 'users/user_confirm_delete.html'
    success_url = reverse_lazy('users:user_list')
    
    def delete(self, request, *args, **kwargs):
        messages.success(request, 'ユーザーが正常に削除されました。')
        return super().delete(request, *args, **kwargs)</code></pre>
                            </li>
                        </ol>
                        
                        <h6>動作確認</h6>
                        <p>ビュー実装の構文チェック:</p>
                        <pre class="code-block"><code class="language-bash">python manage.py check users</code></pre>
                        
                        <h6>期待される結果</h6>
                        <div class="alert alert-success">
                            <p>ビューの実装にエラーがなく、正常に動作する準備が整っている</p>
                        </div>
                    </div>

                    <!-- セクション4: 個別テンプレート作成 -->
                    <h3 class="section-title">5.4 個別テンプレートの作成</h3>
                    <p>各ビューに対応するテンプレートファイルを作成します。</p>

                    <!-- 実装手順4 -->
                    <div class="exercise-container">
                        <h5>実装 5-4: ユーザー管理テンプレートの作成</h5>
                        <p>ユーザー一覧、詳細、作成・編集、削除確認のテンプレートを作成します。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li><strong>ユーザー一覧テンプレート</strong>:
                                <pre class="code-block"><code class="language-html">&lt;!-- templates/users/user_list.html --&gt;
{% extends 'base.html' %}
{% load static %}

{% block title %}ユーザー一覧 - {{ block.super }}{% endblock %}

{% block content %}
&lt;div class="row"&gt;
    &lt;div class="col-12"&gt;
        &lt;div class="d-flex justify-content-between align-items-center mb-4"&gt;
            &lt;h2&gt;ユーザー一覧&lt;/h2&gt;
            &lt;a href="{% url 'users:user_create' %}" class="btn btn-success"&gt;
                新規ユーザー登録
            &lt;/a&gt;
        &lt;/div&gt;

        &lt;!-- 検索フォーム --&gt;
        &lt;form method="get" class="mb-4"&gt;
            &lt;div class="row"&gt;
                &lt;div class="col-md-8"&gt;
                    &lt;input type="text" name="search" class="form-control" 
                           placeholder="ユーザー名、メールアドレス、氏名で検索..." 
                           value="{{ search_query }}"&gt;
                &lt;/div&gt;
                &lt;div class="col-md-4"&gt;
                    &lt;button type="submit" class="btn btn-primary"&gt;検索&lt;/button&gt;
                    &lt;a href="{% url 'users:user_list' %}" class="btn btn-outline-secondary"&gt;クリア&lt;/a&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/form&gt;

        &lt;!-- ユーザーテーブル --&gt;
        &lt;div class="table-responsive"&gt;
            &lt;table class="table table-striped"&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;ユーザー名&lt;/th&gt;
                        &lt;th&gt;氏名&lt;/th&gt;
                        &lt;th&gt;メールアドレス&lt;/th&gt;
                        &lt;th&gt;電話番号&lt;/th&gt;
                        &lt;th&gt;ステータス&lt;/th&gt;
                        &lt;th&gt;登録日&lt;/th&gt;
                        &lt;th&gt;操作&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    {% for user in users %}
                    &lt;tr&gt;
                        &lt;td&gt;{{ user.username }}&lt;/td&gt;
                        &lt;td&gt;{{ user.get_full_name|default:'-' }}&lt;/td&gt;
                        &lt;td&gt;{{ user.email }}&lt;/td&gt;
                        &lt;td&gt;{{ user.phone_number|default:'-' }}&lt;/td&gt;
                        &lt;td&gt;
                            {% if user.is_active %}
                                &lt;span class="badge bg-success"&gt;アクティブ&lt;/span&gt;
                            {% else %}
                                &lt;span class="badge bg-secondary"&gt;非アクティブ&lt;/span&gt;
                            {% endif %}
                        &lt;/td&gt;
                        &lt;td&gt;{{ user.date_joined|date:"Y/m/d" }}&lt;/td&gt;
                        &lt;td&gt;
                            &lt;a href="{% url 'users:user_detail' user.pk %}" class="btn btn-sm btn-outline-info"&gt;詳細&lt;/a&gt;
                            &lt;a href="{% url 'users:user_update' user.pk %}" class="btn btn-sm btn-outline-warning"&gt;編集&lt;/a&gt;
                            &lt;a href="{% url 'users:user_delete' user.pk %}" class="btn btn-sm btn-outline-danger"&gt;削除&lt;/a&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    {% empty %}
                    &lt;tr&gt;
                        &lt;td colspan="7" class="text-center text-muted"&gt;
                            {% if search_query %}
                                検索条件に一致するユーザーが見つかりません。
                            {% else %}
                                ユーザーが登録されていません。
                            {% endif %}
                        &lt;/td&gt;
                    &lt;/tr&gt;
                    {% endfor %}
                &lt;/tbody&gt;
            &lt;/table&gt;
        &lt;/div&gt;

        &lt;!-- ページネーション --&gt;
        {% if is_paginated %}
        &lt;nav aria-label="ユーザー一覧ページネーション"&gt;
            &lt;ul class="pagination justify-content-center"&gt;
                {% if page_obj.has_previous %}
                    &lt;li class="page-item"&gt;
                        &lt;a class="page-link" href="?page=1{% if search_query %}&amp;search={{ search_query }}{% endif %}"&gt;最初&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="page-item"&gt;
                        &lt;a class="page-link" href="?page={{ page_obj.previous_page_number }}{% if search_query %}&amp;search={{ search_query }}{% endif %}"&gt;前へ&lt;/a&gt;
                    &lt;/li&gt;
                {% endif %}
                
                &lt;li class="page-item active"&gt;
                    &lt;span class="page-link"&gt;{{ page_obj.number }} / {{ page_obj.paginator.num_pages }}&lt;/span&gt;
                &lt;/li&gt;
                
                {% if page_obj.has_next %}
                    &lt;li class="page-item"&gt;
                        &lt;a class="page-link" href="?page={{ page_obj.next_page_number }}{% if search_query %}&amp;search={{ search_query }}{% endif %}"&gt;次へ&lt;/a&gt;
                    &lt;/li&gt;
                    &lt;li class="page-item"&gt;
                        &lt;a class="page-link" href="?page={{ page_obj.paginator.num_pages }}{% if search_query %}&amp;search={{ search_query }}{% endif %}"&gt;最後&lt;/a&gt;
                    &lt;/li&gt;
                {% endif %}
            &lt;/ul&gt;
        &lt;/nav&gt;
        {% endif %}
    &lt;/div&gt;
&lt;/div&gt;
{% endblock %}</code></pre>
                            </li>
                            <li><strong>ダッシュボードテンプレート</strong>:
                                <pre class="code-block"><code class="language-html">&lt;!-- templates/users/dashboard.html --&gt;
{% extends 'base.html' %}

{% block title %}ダッシュボード - {{ block.super }}{% endblock %}

{% block content %}
&lt;div class="row"&gt;
    &lt;div class="col-12"&gt;
        &lt;h2&gt;ダッシュボード&lt;/h2&gt;
        
        &lt;!-- 統計情報 --&gt;
        &lt;div class="row mb-4"&gt;
            &lt;div class="col-md-4"&gt;
                &lt;div class="card bg-primary text-white"&gt;
                    &lt;div class="card-body"&gt;
                        &lt;h5 class="card-title"&gt;総ユーザー数&lt;/h5&gt;
                        &lt;h2&gt;{{ total_users }}&lt;/h2&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4"&gt;
                &lt;div class="card bg-success text-white"&gt;
                    &lt;div class="card-body"&gt;
                        &lt;h5 class="card-title"&gt;アクティブユーザー&lt;/h5&gt;
                        &lt;h2&gt;{{ active_users }}&lt;/h2&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="col-md-4"&gt;
                &lt;div class="card bg-info text-white"&gt;
                    &lt;div class="card-body"&gt;
                        &lt;h5 class="card-title"&gt;最近の登録&lt;/h5&gt;
                        &lt;h2&gt;{{ recent_users|length }}&lt;/h2&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;

        &lt;!-- 最近登録されたユーザー --&gt;
        &lt;div class="card"&gt;
            &lt;div class="card-header"&gt;
                &lt;h5&gt;最近登録されたユーザー&lt;/h5&gt;
            &lt;/div&gt;
            &lt;div class="card-body"&gt;
                {% if recent_users %}
                    &lt;ul class="list-group list-group-flush"&gt;
                        {% for user in recent_users %}
                        &lt;li class="list-group-item d-flex justify-content-between align-items-center"&gt;
                            &lt;span&gt;
                                &lt;strong&gt;{{ user.username }}&lt;/strong&gt; ({{ user.get_full_name }})
                                &lt;br&gt;&lt;small class="text-muted"&gt;{{ user.email }}&lt;/small&gt;
                            &lt;/span&gt;
                            &lt;span&gt;
                                &lt;small&gt;{{ user.date_joined|date:"Y/m/d H:i" }}&lt;/small&gt;
                                &lt;a href="{% url 'users:user_detail' user.pk %}" class="btn btn-sm btn-outline-primary ms-2"&gt;詳細&lt;/a&gt;
                            &lt;/span&gt;
                        &lt;/li&gt;
                        {% endfor %}
                    &lt;/ul&gt;
                {% else %}
                    &lt;p class="text-muted"&gt;登録されたユーザーがありません。&lt;/p&gt;
                {% endif %}
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock %}</code></pre>
                            </li>
                        </ol>
                        
                        <h6>動作確認</h6>
                        <p>開発サーバーを起動してテンプレートをテスト:</p>
                        <pre class="code-block"><code class="language-bash">python manage.py runserver</code></pre>
                        <p>ブラウザで http://127.0.0.1:8000/ にアクセスしてユーザー一覧を確認</p>
                        
                        <h6>期待される結果</h6>
                        <div class="alert alert-success">
                            <p>ユーザー一覧ページとダッシュボードページが正常に表示され、ナビゲーションが機能する</p>
                        </div>
                    </div>

                    <!-- ステップ完了チェック -->
                    <div class="quiz-container">
                        <h5>ステップ完了チェック</h5>
                        <p>以下の項目が完了していることを確認してください：</p>
                        <ul class="list-unstyled">
                            <li>☐ URLパターンが適切に設定されている</li>
                            <li>☐ ベーステンプレートが作成され、継承が動作する</li>
                            <li>☐ 関数ベースビューとクラスベースビューが実装されている</li>
                            <li>☐ ユーザー一覧ページが表示される</li>
                            <li>☐ ダッシュボードページが表示される</li>
                            <li>☐ ナビゲーションバーが機能する</li>
                            <li>☐ 検索機能が動作する</li>
                        </ul>
                    </div>

                    <!-- ファイル構成確認 -->
                    <div class="alert alert-light">
                        <h6>現在のプロジェクト構成</h6>
                        <pre class="code-block"><code class="language-bash">django-tutorial/
├── templates/                      # テンプレートディレクトリ
│   ├── base.html                  # ベーステンプレート
│   └── users/                     # usersアプリ用テンプレート
│       ├── user_list.html         # ユーザー一覧
│       └── dashboard.html         # ダッシュボード
├── users/
│   ├── urls.py                    # URLパターン
│   ├── views.py                   # ビュー実装
│   └── models.py                  # Userモデル
├── myproject/
│   ├── urls.py                    # プロジェクトURL設定
│   └── settings.py                # テンプレート設定更新
└── static/                        # 静的ファイル
    └── css/
        └── base.css               # カスタムCSS</code></pre>
                    </div>

                    <!-- ステップ間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="step4-models-migration.html" class="btn btn-secondary">← 前のステップ: モデル・マイグレーション</a>
                        <a href="step6-admin-interface.html" class="btn btn-primary">次のステップ: 管理サイト →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>
    
    <!-- フッター -->
    <footer class="bg-dark text-white mt-5">
        <div class="container-fluid py-3">
            <div class="row">
                <div class="col-12 text-center">
                    <p class="mb-0">&copy; 2025 F-Circle All rights reserved.</p>
                </div>
            </div>
        </div>
    </footer>
    
    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
    
    <!-- Mermaid.js 初期化 -->
    <script>
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default'
        });
    </script>
</body>
</html>