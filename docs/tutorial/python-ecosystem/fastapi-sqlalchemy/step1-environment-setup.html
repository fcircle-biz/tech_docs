<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FastAPI + SQLAlchemy チュートリアル Step 1 - 環境構築とプロジェクトセットアップ</title>
    
    <!-- Bootstrap 5 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Google Fonts - Noto Sans JP -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Highlight.js CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    
    <style>
        body {
            font-family: 'Noto Sans JP', sans-serif;
            padding-top: 56px;
        }
        
        .navbar {
            background-color: #009688;
        }
        
        .sidebar {
            position: sticky;
            top: 70px;
            height: calc(100vh - 70px);
            overflow-y: auto;
        }
        
        .chapter-title {
            color: #009688;
            margin-top: 1.5rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #009688;
            padding-bottom: 0.5rem;
        }
        
        .section-title {
            color: #00695c;
            margin-top: 1.2rem;
            margin-bottom: 0.8rem;
        }
        
        .quiz-container {
            background-color: #e0f2f1;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #009688;
        }
        
        .exercise-container {
            background-color: #f3e5f5;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
            border-left: 4px solid #9c27b0;
        }
        
        .highlight {
            background-color: #ffecb3;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #ffc107;
        }
        
        .warning {
            background-color: #ffebee;
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            border-left: 4px solid #f44336;
        }
        
        .code-block {
            background-color: #1e1e1e;
            border-radius: 5px;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .nav-link.active {
            background-color: #009688 !important;
            color: white !important;
        }
    </style>
</head>
<body>
    <!-- ナビゲーションバー -->
    <nav class="navbar navbar-expand-lg navbar-dark fixed-top">
        <div class="container-fluid">
            <a class="navbar-brand" href="../../../index.html">FastAPI + SQLAlchemy チュートリアル</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../../../index.html">ホーム</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="README.md">チュートリアル概要</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <!-- サイドバー -->
            <nav class="col-md-3 col-lg-2 d-md-block bg-light sidebar">
                <div class="position-sticky pt-3">
                    <h5>チュートリアル目次</h5>
                    <ul class="nav flex-column">
                        <li class="nav-item">
                            <a class="nav-link active" href="step1-environment-setup.html">Step 1: 環境構築</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step2-database-design.html">Step 2: データベース設計</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step3-routing-templates.html">Step 3: ルーティング</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step4-user-registration.html">Step 4: ユーザー登録</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step5-user-list-detail.html">Step 5: 一覧・詳細</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step6-user-update-delete.html">Step 6: 編集・削除</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="step7-search-summary.html">Step 7: 検索・まとめ</a>
                        </li>
                    </ul>
                </div>
            </nav>

            <!-- メインコンテンツ -->
            <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
                <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                    <h1 class="h2">Step 1: 環境構築とプロジェクトセットアップ</h1>
                </div>

                <div id="step1">
                    <h2 class="chapter-title">環境構築とプロジェクトセットアップ</h2>
                    
                    <!-- 学習目標 -->
                    <div class="highlight">
                        <h5>この章で学ぶこと</h5>
                        <ul>
                            <li>Python仮想環境の作成と管理</li>
                            <li>PostgreSQLのインストールと初期設定</li>
                            <li>FastAPI、SQLAlchemy、Jinja2の基本パッケージインストール</li>
                            <li>プロジェクト構造の理解と作成</li>
                            <li>最初のFastAPIアプリケーションの起動確認</li>
                        </ul>
                    </div>

                    <!-- 所要時間と前提条件 -->
                    <div class="warning">
                        <h6>所要時間: 約1.5時間</h6>
                        <h6>前提条件:</h6>
                        <ul>
                            <li>Python 3.8以上がインストール済み</li>
                            <li>コマンドライン操作の基本的な知識</li>
                            <li>テキストエディタ（VS Code推奨）</li>
                        </ul>
                    </div>

                    <h3 class="section-title">1.1 Python仮想環境の作成</h3>
                    <p>プロジェクト専用の仮想環境を作成することで、パッケージの競合を避け、プロジェクトを分離できます。</p>

                    <div class="exercise-container">
                        <h5>実習 1-1: 仮想環境の作成</h5>
                        <p>プロジェクト用のディレクトリを作成し、Python仮想環境をセットアップします。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>プロジェクトディレクトリを作成</li>
                            <li>仮想環境を作成</li>
                            <li>仮想環境を有効化</li>
                            <li>Pythonバージョンの確認</li>
                        </ol>
                        
                        <h6>実行例（Windows）</h6>
                        <pre class="code-block"><code class="language-bash"># プロジェクトディレクトリの作成
mkdir simple-user-manager
cd simple-user-manager

# 仮想環境の作成
python -m venv venv

# 仮想環境の有効化
venv\Scripts\activate

# Pythonバージョンの確認
python --version</code></pre>

                        <h6>実行例（macOS/Linux）</h6>
                        <pre class="code-block"><code class="language-bash"># プロジェクトディレクトリの作成
mkdir simple-user-manager
cd simple-user-manager

# 仮想環境の作成
python3 -m venv venv

# 仮想環境の有効化
source venv/bin/activate

# Pythonバージョンの確認
python --version</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>コマンドプロンプトの先頭に <code>(venv)</code> が表示され、Python 3.8以上のバージョンが確認できます。</p>
                    </div>

                    <h3 class="section-title">1.2 PostgreSQLのインストールと設定</h3>
                    <p>データベースとしてPostgreSQLを使用します。開発環境にインストールし、基本的な設定を行います。</p>

                    <div class="exercise-container">
                        <h5>実習 1-2: PostgreSQLのセットアップ</h5>
                        <p>PostgreSQLをインストールし、開発用データベースを作成します。</p>
                        
                        <h6>インストール方法</h6>
                        <ul>
                            <li><strong>Windows:</strong> <a href="https://www.postgresql.org/download/windows/" target="_blank">公式サイト</a>からインストーラーをダウンロード</li>
                            <li><strong>macOS:</strong> Homebrewを使用: <code>brew install postgresql</code></li>
                            <li><strong>Ubuntu/Debian:</strong> <code>sudo apt-get install postgresql postgresql-contrib</code></li>
                        </ul>
                        
                        <h6>データベースの作成</h6>
                        <pre class="code-block"><code class="language-bash"># PostgreSQLに接続（デフォルトユーザー: postgres）
psql -U postgres

# データベースの作成
CREATE DATABASE simple_user_manager;

# ユーザーの作成（オプション）
CREATE USER app_user WITH PASSWORD 'password123';

# 権限の付与
GRANT ALL PRIVILEGES ON DATABASE simple_user_manager TO app_user;

# 接続確認
\c simple_user_manager

# 終了
\q</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>データベース <code>simple_user_manager</code> が作成され、接続できることを確認できます。</p>
                    </div>

                    <h3 class="section-title">1.3 必要パッケージのインストール</h3>
                    <p>FastAPI、SQLAlchemy、Jinja2など、プロジェクトに必要なPythonパッケージをインストールします。</p>

                    <div class="exercise-container">
                        <h5>実習 1-3: パッケージのインストール</h5>
                        <p>requirements.txtファイルを作成し、必要なパッケージを一括インストールします。</p>
                        
                        <h6>手順</h6>
                        <ol>
                            <li>requirements.txtファイルを作成</li>
                            <li>パッケージをインストール</li>
                            <li>インストール確認</li>
                        </ol>
                        
                        <h6>requirements.txt</h6>
                        <pre class="code-block"><code class="language-text">fastapi==0.104.1
uvicorn[standard]==0.24.0
sqlalchemy==2.0.23
psycopg2-binary==2.9.9
jinja2==3.1.2
python-multipart==0.0.6</code></pre>
                        
                        <h6>インストール実行</h6>
                        <pre class="code-block"><code class="language-bash"># パッケージのインストール
pip install -r requirements.txt

# インストール確認
pip list</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>指定したパッケージがすべてインストールされ、<code>pip list</code>で確認できます。</p>
                    </div>

                    <h3 class="section-title">1.4 プロジェクト構造の作成</h3>
                    <p>アプリケーションの基本的なディレクトリ構造を作成します。</p>

                    <div class="exercise-container">
                        <h5>実習 1-4: ディレクトリ構造の作成</h5>
                        <p>プロジェクトの基本構造を作成し、各ファイルの役割を理解します。</p>
                        
                        <h6>ディレクトリ構造</h6>
                        <pre class="code-block"><code class="language-text">simple-user-manager/
│  main.py              # メインアプリケーションファイル
│  database.py          # データベース接続設定
│  models.py            # SQLAlchemyモデル定義
│  requirements.txt     # 依存パッケージリスト
│  README.md           # プロジェクト説明
│
├─templates/           # Jinja2テンプレート
│      base.html       # ベーステンプレート
│      index.html      # トップページ
│      user_form.html  # ユーザー登録フォーム
│      user_list.html  # ユーザー一覧
│      user_detail.html # ユーザー詳細
│      user_edit.html  # ユーザー編集
│
└─static/             # 静的ファイル
    └─css/
            style.css  # スタイル定義</code></pre>
                        
                        <h6>ディレクトリ作成コマンド</h6>
                        <pre class="code-block"><code class="language-bash"># ディレクトリの作成
mkdir templates
mkdir static
mkdir static/css

# 基本ファイルの作成
touch main.py database.py models.py
touch templates/base.html templates/index.html
touch static/css/style.css</code></pre>
                        
                        <h6>期待される結果</h6>
                        <p>指定した構造でディレクトリとファイルが作成されます。</p>
                    </div>

                    <h3 class="section-title">1.5 最初のFastAPIアプリケーション</h3>
                    <p>環境構築の確認として、最小限のFastAPIアプリケーションを作成し、動作確認を行います。</p>

                    <div class="exercise-container">
                        <h5>実習 1-5: Hello World アプリケーション</h5>
                        <p>FastAPIの基本的な動作を確認するため、簡単なアプリケーションを作成します。</p>
                        
                        <h6>main.py の作成</h6>
                        <pre class="code-block"><code class="language-python">from fastapi import FastAPI
from fastapi.responses import HTMLResponse

app = FastAPI()

@app.get("/")
async def read_root():
    return {"message": "Hello World"}

@app.get("/html", response_class=HTMLResponse)
async def read_html():
    return """
    <html>
        <head>
            <title>FastAPI チュートリアル</title>
        </head>
        <body>
            <h1>FastAPI + SQLAlchemy チュートリアル</h1>
            <p>環境構築が正常に完了しました！</p>
        </body>
    </html>
    """

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000)</code></pre>
                        
                        <h6>アプリケーションの起動</h6>
                        <pre class="code-block"><code class="language-bash"># 開発サーバーの起動
python main.py

# または、uvicornを直接使用
uvicorn main:app --reload</code></pre>
                        
                        <h6>動作確認</h6>
                        <ul>
                            <li>ブラウザで <code>http://localhost:8000</code> にアクセス</li>
                            <li>JSON形式の「Hello World」メッセージが表示される</li>
                            <li><code>http://localhost:8000/html</code> でHTMLページが表示される</li>
                            <li><code>http://localhost:8000/docs</code> で自動生成されたAPI docが確認できる</li>
                        </ul>
                        
                        <h6>期待される結果</h6>
                        <p>アプリケーションが正常に起動し、各URLで適切なレスポンスが返されます。</p>
                    </div>

                    <!-- 理解度確認 -->
                    <div class="quiz-container">
                        <h5>理解度確認クイズ</h5>
                        <ol>
                            <li>Python仮想環境を作成するコマンドは何ですか？</li>
                            <li>仮想環境を有効化した際に、コマンドプロンプトに表示される目印は何ですか？</li>
                            <li>PostgreSQLでデータベースを作成するSQLコマンドを書いてください。</li>
                            <li>FastAPIアプリケーションを起動するために使用するツールの名前は何ですか？</li>
                            <li>自動生成されるFastAPI APIドキュメントにアクセスするURLパスは何ですか？</li>
                        </ol>
                        
                        <details class="mt-3">
                            <summary>解答例</summary>
                            <ol>
                                <li><code>python -m venv venv</code> または <code>python3 -m venv venv</code></li>
                                <li><code>(venv)</code></li>
                                <li><code>CREATE DATABASE データベース名;</code></li>
                                <li>uvicorn</li>
                                <li><code>/docs</code></li>
                            </ol>
                        </details>
                    </div>

                    <!-- トラブルシューティング -->
                    <h3 class="section-title">1.6 よくある問題と解決方法</h3>
                    
                    <div class="warning">
                        <h6>PostgreSQL接続エラー</h6>
                        <p><strong>症状:</strong> PostgreSQLに接続できない</p>
                        <p><strong>解決方法:</strong></p>
                        <ul>
                            <li>PostgreSQLサービスが起動しているか確認</li>
                            <li>ユーザー名、パスワード、データベース名を確認</li>
                            <li>ポート番号（デフォルト: 5432）の確認</li>
                        </ul>
                    </div>

                    <div class="warning">
                        <h6>モジュールインポートエラー</h6>
                        <p><strong>症状:</strong> <code>ModuleNotFoundError</code> が発生</p>
                        <p><strong>解決方法:</strong></p>
                        <ul>
                            <li>仮想環境が有効化されているか確認</li>
                            <li><code>pip install -r requirements.txt</code> の再実行</li>
                            <li><code>pip list</code> でパッケージインストール状況の確認</li>
                        </ul>
                    </div>

                    <!-- 章間ナビゲーション -->
                    <div class="d-flex justify-content-between mt-4">
                        <a href="README.md" class="btn btn-secondary">← チュートリアル概要</a>
                        <a href="step2-database-design.html" class="btn btn-primary">Step 2: データベース設計 →</a>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <!-- Bootstrap JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Highlight.js 初期化 -->
    <script>hljs.highlightAll();</script>
</body>
</html>